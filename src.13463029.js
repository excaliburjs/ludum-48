parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"KA2S":[function(require,module,exports) {
var define;
var t,r=function(t){"use strict";var r,e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{u({},"")}catch(P){u=function(t,r,e){return t[r]=e}}function h(t,r,e,n){var o=r&&r.prototype instanceof d?r:d,i=Object.create(o.prototype),a=new G(n||[]);return i._invoke=function(t,r,e){var n=l;return function(o,i){if(n===p)throw new Error("Generator is already running");if(n===y){if("throw"===o)throw i;return F()}for(e.method=o,e.arg=i;;){var a=e.delegate;if(a){var c=j(a,e);if(c){if(c===v)continue;return c}}if("next"===e.method)e.sent=e._sent=e.arg;else if("throw"===e.method){if(n===l)throw n=y,e.arg;e.dispatchException(e.arg)}else"return"===e.method&&e.abrupt("return",e.arg);n=p;var u=f(t,r,e);if("normal"===u.type){if(n=e.done?y:s,u.arg===v)continue;return{value:u.arg,done:e.done}}"throw"===u.type&&(n=y,e.method="throw",e.arg=u.arg)}}}(t,e,a),i}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(P){return{type:"throw",arg:P}}}t.wrap=h;var l="suspendedStart",s="suspendedYield",p="executing",y="completed",v={};function d(){}function g(){}function m(){}var w={};w[i]=function(){return this};var L=Object.getPrototypeOf,x=L&&L(L(N([])));x&&x!==e&&n.call(x,i)&&(w=x);var b=m.prototype=d.prototype=Object.create(w);function E(t){["next","throw","return"].forEach(function(r){u(t,r,function(t){return this._invoke(r,t)})})}function _(t,r){var e;this._invoke=function(o,i){function a(){return new r(function(e,a){!function e(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var h=u.arg,l=h.value;return l&&"object"==typeof l&&n.call(l,"__await")?r.resolve(l.__await).then(function(t){e("next",t,a,c)},function(t){e("throw",t,a,c)}):r.resolve(l).then(function(t){h.value=t,a(h)},function(t){return e("throw",t,a,c)})}c(u.arg)}(o,i,e,a)})}return e=e?e.then(a,a):a()}}function j(t,e){var n=t.iterator[e.method];if(n===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=r,j(t,e),"throw"===e.method))return v;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var o=f(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,v;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=r),e.delegate=null,v):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,v)}function O(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function k(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function G(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function N(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function e(){for(;++o<t.length;)if(n.call(t,o))return e.value=t[o],e.done=!1,e;return e.value=r,e.done=!0,e};return a.next=a}}return{next:F}}function F(){return{value:r,done:!0}}return g.prototype=b.constructor=m,m.constructor=g,g.displayName=u(m,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===g||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,u(t,c,"GeneratorFunction")),t.prototype=Object.create(b),t},t.awrap=function(t){return{__await:t}},E(_.prototype),_.prototype[a]=function(){return this},t.AsyncIterator=_,t.async=function(r,e,n,o,i){void 0===i&&(i=Promise);var a=new _(h(r,e,n,o),i);return t.isGeneratorFunction(e)?a:a.next().then(function(t){return t.done?t.value:a.next()})},E(b),u(b,c,"Generator"),b[i]=function(){return this},b.toString=function(){return"[object Generator]"},t.keys=function(t){var r=[];for(var e in t)r.push(e);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=N,G.prototype={constructor:G,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=r)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function o(n,o){return c.type="throw",c.arg=t,e.next=n,o&&(e.method="next",e.arg=r),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),h=n.call(a,"finallyLoc");if(u&&h){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!h)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),v},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),k(e),v}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;k(e)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:N(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=r),v}},t}("object"==typeof module?module.exports:{});try{regeneratorRuntime=r}catch(e){Function("r","regeneratorRuntime = r")(r)}
},{}],"rBuz":[function(require,module,exports) {
var o=Math.ceil,r=Math.floor;module.exports=function(t){return isNaN(t=+t)?0:(t>0?r:o)(t)};
},{}],"H2B4":[function(require,module,exports) {
module.exports=function(o){if(null==o)throw TypeError("Can't call method on "+o);return o};
},{}],"OMAC":[function(require,module,exports) {
var e=require("../internals/to-integer"),r=require("../internals/require-object-coercible"),t=function(t){return function(n,i){var c,o,a=String(r(n)),u=e(i),l=a.length;return u<0||u>=l?t?"":void 0:(c=a.charCodeAt(u))<55296||c>56319||u+1===l||(o=a.charCodeAt(u+1))<56320||o>57343?t?a.charAt(u):c:t?a.slice(u,u+2):o-56320+(c-55296<<10)+65536}};module.exports={codeAt:t(!1),charAt:t(!0)};
},{"../internals/to-integer":"rBuz","../internals/require-object-coercible":"H2B4"}],"RdwD":[function(require,module,exports) {
var global = arguments[3];
var t=arguments[3],o=function(t){return t&&t.Math==Math&&t};module.exports=o("object"==typeof globalThis&&globalThis)||o("object"==typeof window&&window)||o("object"==typeof self&&self)||o("object"==typeof t&&t)||function(){return this}()||Function("return this")();
},{}],"HhtF":[function(require,module,exports) {
module.exports=function(r){try{return!!r()}catch(t){return!0}};
},{}],"r2hA":[function(require,module,exports) {
var e=require("../internals/fails");module.exports=!e(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]});
},{"../internals/fails":"HhtF"}],"QYQv":[function(require,module,exports) {
module.exports=function(o){return"object"==typeof o?null!==o:"function"==typeof o};
},{}],"hMem":[function(require,module,exports) {

var e=require("../internals/global"),r=require("../internals/is-object"),t=e.document,n=r(t)&&r(t.createElement);module.exports=function(e){return n?t.createElement(e):{}};
},{"../internals/global":"RdwD","../internals/is-object":"QYQv"}],"L6FV":[function(require,module,exports) {
var e=require("../internals/descriptors"),r=require("../internals/fails"),n=require("../internals/document-create-element");module.exports=!e&&!r(function(){return 7!=Object.defineProperty(n("div"),"a",{get:function(){return 7}}).a});
},{"../internals/descriptors":"r2hA","../internals/fails":"HhtF","../internals/document-create-element":"hMem"}],"vY5p":[function(require,module,exports) {
var r=require("../internals/is-object");module.exports=function(e){if(!r(e))throw TypeError(String(e)+" is not an object");return e};
},{"../internals/is-object":"QYQv"}],"rm5K":[function(require,module,exports) {
var t=require("../internals/is-object");module.exports=function(r,e){if(!t(r))return r;var n,o;if(e&&"function"==typeof(n=r.toString)&&!t(o=n.call(r)))return o;if("function"==typeof(n=r.valueOf)&&!t(o=n.call(r)))return o;if(!e&&"function"==typeof(n=r.toString)&&!t(o=n.call(r)))return o;throw TypeError("Can't convert object to primitive value")};
},{"../internals/is-object":"QYQv"}],"lxmH":[function(require,module,exports) {
var e=require("../internals/descriptors"),r=require("../internals/ie8-dom-define"),i=require("../internals/an-object"),t=require("../internals/to-primitive"),n=Object.defineProperty;exports.f=e?n:function(e,o,s){if(i(e),o=t(o,!0),i(s),r)try{return n(e,o,s)}catch(u){}if("get"in s||"set"in s)throw TypeError("Accessors not supported");return"value"in s&&(e[o]=s.value),e};
},{"../internals/descriptors":"r2hA","../internals/ie8-dom-define":"L6FV","../internals/an-object":"vY5p","../internals/to-primitive":"rm5K"}],"aTKp":[function(require,module,exports) {
module.exports=function(e,r){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:r}};
},{}],"XRrN":[function(require,module,exports) {
var r=require("../internals/descriptors"),e=require("../internals/object-define-property"),t=require("../internals/create-property-descriptor");module.exports=r?function(r,n,i){return e.f(r,n,t(1,i))}:function(r,e,t){return r[e]=t,r};
},{"../internals/descriptors":"r2hA","../internals/object-define-property":"lxmH","../internals/create-property-descriptor":"aTKp"}],"AcoG":[function(require,module,exports) {

var e=require("../internals/global"),r=require("../internals/create-non-enumerable-property");module.exports=function(n,t){try{r(e,n,t)}catch(a){e[n]=t}return t};
},{"../internals/global":"RdwD","../internals/create-non-enumerable-property":"XRrN"}],"Q5DL":[function(require,module,exports) {

var e=require("../internals/global"),r=require("../internals/set-global"),l="__core-js_shared__",a=e[l]||r(l,{});module.exports=a;
},{"../internals/global":"RdwD","../internals/set-global":"AcoG"}],"dQBG":[function(require,module,exports) {
var e=require("../internals/shared-store"),n=Function.toString;"function"!=typeof e.inspectSource&&(e.inspectSource=function(e){return n.call(e)}),module.exports=e.inspectSource;
},{"../internals/shared-store":"Q5DL"}],"pMwR":[function(require,module,exports) {

var e=require("../internals/global"),r=require("../internals/inspect-source"),t=e.WeakMap;module.exports="function"==typeof t&&/native code/.test(r(t));
},{"../internals/global":"RdwD","../internals/inspect-source":"dQBG"}],"Gdzi":[function(require,module,exports) {
var r={}.hasOwnProperty;module.exports=function(e,n){return r.call(e,n)};
},{}],"pi8Y":[function(require,module,exports) {
module.exports=!1;
},{}],"AP6n":[function(require,module,exports) {
var r=require("../internals/is-pure"),e=require("../internals/shared-store");(module.exports=function(r,i){return e[r]||(e[r]=void 0!==i?i:{})})("versions",[]).push({version:"3.10.0",mode:r?"pure":"global",copyright:"© 2021 Denis Pushkarev (zloirock.ru)"});
},{"../internals/is-pure":"pi8Y","../internals/shared-store":"Q5DL"}],"aUJY":[function(require,module,exports) {
var o=0,r=Math.random();module.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++o+r).toString(36)};
},{}],"Hosz":[function(require,module,exports) {
var e=require("../internals/shared"),r=require("../internals/uid"),n=e("keys");module.exports=function(e){return n[e]||(n[e]=r(e))};
},{"../internals/shared":"AP6n","../internals/uid":"aUJY"}],"u6aE":[function(require,module,exports) {
module.exports={};
},{}],"FDlA":[function(require,module,exports) {

var e,r,n,t=require("../internals/native-weak-map"),a=require("../internals/global"),i=require("../internals/is-object"),u=require("../internals/create-non-enumerable-property"),s=require("../internals/has"),o=require("../internals/shared-store"),l=require("../internals/shared-key"),c=require("../internals/hidden-keys"),f=a.WeakMap,q=function(t){return n(t)?r(t):e(t,{})},d=function(e){return function(n){var t;if(!i(n)||(t=r(n)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return t}};if(t){var p=o.state||(o.state=new f),h=p.get,v=p.has,y=p.set;e=function(e,r){return r.facade=e,y.call(p,e,r),r},r=function(e){return h.call(p,e)||{}},n=function(e){return v.call(p,e)}}else{var b=l("state");c[b]=!0,e=function(e,r){return r.facade=e,u(e,b,r),r},r=function(e){return s(e,b)?e[b]:{}},n=function(e){return s(e,b)}}module.exports={set:e,get:r,has:n,enforce:q,getterFor:d};
},{"../internals/native-weak-map":"pMwR","../internals/global":"RdwD","../internals/is-object":"QYQv","../internals/create-non-enumerable-property":"XRrN","../internals/has":"Gdzi","../internals/shared-store":"Q5DL","../internals/shared-key":"Hosz","../internals/hidden-keys":"u6aE"}],"J64n":[function(require,module,exports) {
"use strict";var r={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,t=e&&!r.call({1:2},1);exports.f=t?function(r){var t=e(this,r);return!!t&&t.enumerable}:r;
},{}],"oWVo":[function(require,module,exports) {
var r={}.toString;module.exports=function(t){return r.call(t).slice(8,-1)};
},{}],"wRpf":[function(require,module,exports) {
var r=require("../internals/fails"),e=require("../internals/classof-raw"),t="".split;module.exports=r(function(){return!Object("z").propertyIsEnumerable(0)})?function(r){return"String"==e(r)?t.call(r,""):Object(r)}:Object;
},{"../internals/fails":"HhtF","../internals/classof-raw":"oWVo"}],"xooR":[function(require,module,exports) {
var e=require("../internals/indexed-object"),r=require("../internals/require-object-coercible");module.exports=function(i){return e(r(i))};
},{"../internals/indexed-object":"wRpf","../internals/require-object-coercible":"H2B4"}],"NkfH":[function(require,module,exports) {
var e=require("../internals/descriptors"),r=require("../internals/object-property-is-enumerable"),i=require("../internals/create-property-descriptor"),t=require("../internals/to-indexed-object"),n=require("../internals/to-primitive"),s=require("../internals/has"),a=require("../internals/ie8-dom-define"),o=Object.getOwnPropertyDescriptor;exports.f=e?o:function(e,c){if(e=t(e),c=n(c,!0),a)try{return o(e,c)}catch(u){}if(s(e,c))return i(!r.f.call(e,c),e[c])};
},{"../internals/descriptors":"r2hA","../internals/object-property-is-enumerable":"J64n","../internals/create-property-descriptor":"aTKp","../internals/to-indexed-object":"xooR","../internals/to-primitive":"rm5K","../internals/has":"Gdzi","../internals/ie8-dom-define":"L6FV"}],"PceW":[function(require,module,exports) {

var e=require("../internals/global"),n=require("../internals/create-non-enumerable-property"),r=require("../internals/has"),t=require("../internals/set-global"),i=require("../internals/inspect-source"),o=require("../internals/internal-state"),s=o.get,a=o.enforce,u=String(String).split("String");(module.exports=function(i,o,s,l){var c,p=!!l&&!!l.unsafe,f=!!l&&!!l.enumerable,g=!!l&&!!l.noTargetGet;"function"==typeof s&&("string"!=typeof o||r(s,"name")||n(s,"name",o),(c=a(s)).source||(c.source=u.join("string"==typeof o?o:""))),i!==e?(p?!g&&i[o]&&(f=!0):delete i[o],f?i[o]=s:n(i,o,s)):f?i[o]=s:t(o,s)})(Function.prototype,"toString",function(){return"function"==typeof this&&s(this).source||i(this)});
},{"../internals/global":"RdwD","../internals/create-non-enumerable-property":"XRrN","../internals/has":"Gdzi","../internals/set-global":"AcoG","../internals/inspect-source":"dQBG","../internals/internal-state":"FDlA"}],"FSlT":[function(require,module,exports) {

var e=require("../internals/global");module.exports=e;
},{"../internals/global":"RdwD"}],"tM1E":[function(require,module,exports) {

var n=require("../internals/path"),e=require("../internals/global"),r=function(n){return"function"==typeof n?n:void 0};module.exports=function(t,i){return arguments.length<2?r(n[t])||r(e[t]):n[t]&&n[t][i]||e[t]&&e[t][i]};
},{"../internals/path":"FSlT","../internals/global":"RdwD"}],"HnVY":[function(require,module,exports) {
var e=require("../internals/to-integer"),r=Math.min;module.exports=function(n){return n>0?r(e(n),9007199254740991):0};
},{"../internals/to-integer":"rBuz"}],"CYMe":[function(require,module,exports) {
var r=require("../internals/to-integer"),e=Math.max,t=Math.min;module.exports=function(n,a){var i=r(n);return i<0?e(i+a,0):t(i,a)};
},{"../internals/to-integer":"rBuz"}],"nH1t":[function(require,module,exports) {
var e=require("../internals/to-indexed-object"),r=require("../internals/to-length"),n=require("../internals/to-absolute-index"),t=function(t){return function(i,u,o){var l,f=e(i),s=r(f.length),a=n(o,s);if(t&&u!=u){for(;s>a;)if((l=f[a++])!=l)return!0}else for(;s>a;a++)if((t||a in f)&&f[a]===u)return t||a||0;return!t&&-1}};module.exports={includes:t(!0),indexOf:t(!1)};
},{"../internals/to-indexed-object":"xooR","../internals/to-length":"HnVY","../internals/to-absolute-index":"CYMe"}],"KrZT":[function(require,module,exports) {
var e=require("../internals/has"),r=require("../internals/to-indexed-object"),n=require("../internals/array-includes").indexOf,i=require("../internals/hidden-keys");module.exports=function(s,t){var u,a=r(s),d=0,l=[];for(u in a)!e(i,u)&&e(a,u)&&l.push(u);for(;t.length>d;)e(a,u=t[d++])&&(~n(l,u)||l.push(u));return l};
},{"../internals/has":"Gdzi","../internals/to-indexed-object":"xooR","../internals/array-includes":"nH1t","../internals/hidden-keys":"u6aE"}],"FsV0":[function(require,module,exports) {
module.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"];
},{}],"F6CC":[function(require,module,exports) {
var e=require("../internals/object-keys-internal"),r=require("../internals/enum-bug-keys"),t=r.concat("length","prototype");exports.f=Object.getOwnPropertyNames||function(r){return e(r,t)};
},{"../internals/object-keys-internal":"KrZT","../internals/enum-bug-keys":"FsV0"}],"TAPg":[function(require,module,exports) {
exports.f=Object.getOwnPropertySymbols;
},{}],"vYBh":[function(require,module,exports) {
var e=require("../internals/get-built-in"),r=require("../internals/object-get-own-property-names"),n=require("../internals/object-get-own-property-symbols"),t=require("../internals/an-object");module.exports=e("Reflect","ownKeys")||function(e){var o=r.f(t(e)),i=n.f;return i?o.concat(i(e)):o};
},{"../internals/get-built-in":"tM1E","../internals/object-get-own-property-names":"F6CC","../internals/object-get-own-property-symbols":"TAPg","../internals/an-object":"vY5p"}],"nWtI":[function(require,module,exports) {
var e=require("../internals/has"),r=require("../internals/own-keys"),n=require("../internals/object-get-own-property-descriptor"),t=require("../internals/object-define-property");module.exports=function(i,o){for(var a=r(o),s=t.f,l=n.f,p=0;p<a.length;p++){var u=a[p];e(i,u)||s(i,u,l(o,u))}};
},{"../internals/has":"Gdzi","../internals/own-keys":"vYBh","../internals/object-get-own-property-descriptor":"NkfH","../internals/object-define-property":"lxmH"}],"V7dp":[function(require,module,exports) {
var r=require("../internals/fails"),e=/#|\.prototype\./,t=function(e,t){var u=o[n(e)];return u==i||u!=a&&("function"==typeof t?r(t):!!t)},n=t.normalize=function(r){return String(r).replace(e,".").toLowerCase()},o=t.data={},a=t.NATIVE="N",i=t.POLYFILL="P";module.exports=t;
},{"../internals/fails":"HhtF"}],"EhLp":[function(require,module,exports) {

var e=require("../internals/global"),r=require("../internals/object-get-own-property-descriptor").f,t=require("../internals/create-non-enumerable-property"),n=require("../internals/redefine"),o=require("../internals/set-global"),i=require("../internals/copy-constructor-properties"),a=require("../internals/is-forced");module.exports=function(s,l){var p,u,f,c,q,d=s.target,g=s.global,y=s.stat;if(p=g?e:y?e[d]||o(d,{}):(e[d]||{}).prototype)for(u in l){if(c=l[u],f=s.noTargetGet?(q=r(p,u))&&q.value:p[u],!a(g?u:d+(y?".":"#")+u,s.forced)&&void 0!==f){if(typeof c==typeof f)continue;i(c,f)}(s.sham||f&&f.sham)&&t(c,"sham",!0),n(p,u,c,s)}};
},{"../internals/global":"RdwD","../internals/object-get-own-property-descriptor":"NkfH","../internals/create-non-enumerable-property":"XRrN","../internals/redefine":"PceW","../internals/set-global":"AcoG","../internals/copy-constructor-properties":"nWtI","../internals/is-forced":"V7dp"}],"jvja":[function(require,module,exports) {
var e=require("../internals/require-object-coercible");module.exports=function(r){return Object(e(r))};
},{"../internals/require-object-coercible":"H2B4"}],"ffM1":[function(require,module,exports) {
var t=require("../internals/fails");module.exports=!t(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype});
},{"../internals/fails":"HhtF"}],"wKQH":[function(require,module,exports) {
var t=require("../internals/has"),e=require("../internals/to-object"),r=require("../internals/shared-key"),o=require("../internals/correct-prototype-getter"),n=r("IE_PROTO"),c=Object.prototype;module.exports=o?Object.getPrototypeOf:function(r){return r=e(r),t(r,n)?r[n]:"function"==typeof r.constructor&&r instanceof r.constructor?r.constructor.prototype:r instanceof Object?c:null};
},{"../internals/has":"Gdzi","../internals/to-object":"jvja","../internals/shared-key":"Hosz","../internals/correct-prototype-getter":"ffM1"}],"mSBD":[function(require,module,exports) {

var r=require("../internals/classof-raw"),e=require("../internals/global");module.exports="process"==r(e.process);
},{"../internals/classof-raw":"oWVo","../internals/global":"RdwD"}],"rPED":[function(require,module,exports) {
var e=require("../internals/get-built-in");module.exports=e("navigator","userAgent")||"";
},{"../internals/get-built-in":"tM1E"}],"o3qS":[function(require,module,exports) {


var e,r,s=require("../internals/global"),n=require("../internals/engine-user-agent"),a=s.process,i=a&&a.versions,t=i&&i.v8;t?r=(e=t.split("."))[0]+e[1]:n&&(!(e=n.match(/Edge\/(\d+)/))||e[1]>=74)&&(e=n.match(/Chrome\/(\d+)/))&&(r=e[1]),module.exports=r&&+r;
},{"../internals/global":"RdwD","../internals/engine-user-agent":"rPED"}],"SXW0":[function(require,module,exports) {
var e=require("../internals/engine-is-node"),n=require("../internals/engine-v8-version"),r=require("../internals/fails");module.exports=!!Object.getOwnPropertySymbols&&!r(function(){return!Symbol.sham&&(e?38===n:n>37&&n<41)});
},{"../internals/engine-is-node":"mSBD","../internals/engine-v8-version":"o3qS","../internals/fails":"HhtF"}],"mSSr":[function(require,module,exports) {
var e=require("../internals/native-symbol");module.exports=e&&!Symbol.sham&&"symbol"==typeof Symbol.iterator;
},{"../internals/native-symbol":"SXW0"}],"sPFN":[function(require,module,exports) {

var e=require("../internals/global"),r=require("../internals/shared"),i=require("../internals/has"),n=require("../internals/uid"),t=require("../internals/native-symbol"),s=require("../internals/use-symbol-as-uid"),l=r("wks"),u=e.Symbol,a=s?u:u&&u.withoutSetter||n;module.exports=function(e){return i(l,e)&&(t||"string"==typeof l[e])||(t&&i(u,e)?l[e]=u[e]:l[e]=a("Symbol."+e)),l[e]};
},{"../internals/global":"RdwD","../internals/shared":"AP6n","../internals/has":"Gdzi","../internals/uid":"aUJY","../internals/native-symbol":"SXW0","../internals/use-symbol-as-uid":"mSSr"}],"jbL0":[function(require,module,exports) {
"use strict";var e,r,t,n=require("../internals/fails"),i=require("../internals/object-get-prototype-of"),o=require("../internals/create-non-enumerable-property"),a=require("../internals/has"),l=require("../internals/well-known-symbol"),s=require("../internals/is-pure"),u=l("iterator"),p=!1,c=function(){return this};[].keys&&("next"in(t=[].keys())?(r=i(i(t)))!==Object.prototype&&(e=r):p=!0);var y=null==e||n(function(){var r={};return e[u].call(r)!==r});y&&(e={}),s&&!y||a(e,u)||o(e,u,c),module.exports={IteratorPrototype:e,BUGGY_SAFARI_ITERATORS:p};
},{"../internals/fails":"HhtF","../internals/object-get-prototype-of":"wKQH","../internals/create-non-enumerable-property":"XRrN","../internals/has":"Gdzi","../internals/well-known-symbol":"sPFN","../internals/is-pure":"pi8Y"}],"tzYM":[function(require,module,exports) {
var e=require("../internals/object-keys-internal"),r=require("../internals/enum-bug-keys");module.exports=Object.keys||function(n){return e(n,r)};
},{"../internals/object-keys-internal":"KrZT","../internals/enum-bug-keys":"FsV0"}],"eVWU":[function(require,module,exports) {
var e=require("../internals/descriptors"),r=require("../internals/object-define-property"),n=require("../internals/an-object"),t=require("../internals/object-keys");module.exports=e?Object.defineProperties:function(e,i){n(e);for(var o,s=t(i),a=s.length,u=0;a>u;)r.f(e,o=s[u++],i[o]);return e};
},{"../internals/descriptors":"r2hA","../internals/object-define-property":"lxmH","../internals/an-object":"vY5p","../internals/object-keys":"tzYM"}],"ZA3F":[function(require,module,exports) {
var e=require("../internals/get-built-in");module.exports=e("document","documentElement");
},{"../internals/get-built-in":"tM1E"}],"NYfz":[function(require,module,exports) {
var e,n=require("../internals/an-object"),r=require("../internals/object-define-properties"),t=require("../internals/enum-bug-keys"),i=require("../internals/hidden-keys"),u=require("../internals/html"),o=require("../internals/document-create-element"),c=require("../internals/shared-key"),l=">",a="<",s="prototype",d="script",m=c("IE_PROTO"),p=function(){},f=function(e){return a+d+l+e+a+"/"+d+l},v=function(e){e.write(f("")),e.close();var n=e.parentWindow.Object;return e=null,n},b=function(){var e,n=o("iframe"),r="java"+d+":";return n.style.display="none",u.appendChild(n),n.src=String(r),(e=n.contentWindow.document).open(),e.write(f("document.F=Object")),e.close(),e.F},h=function(){try{e=document.domain&&new ActiveXObject("htmlfile")}catch(r){}h=e?v(e):b();for(var n=t.length;n--;)delete h[s][t[n]];return h()};i[m]=!0,module.exports=Object.create||function(e,t){var i;return null!==e?(p[s]=n(e),i=new p,p[s]=null,i[m]=e):i=h(),void 0===t?i:r(i,t)};
},{"../internals/an-object":"vY5p","../internals/object-define-properties":"eVWU","../internals/enum-bug-keys":"FsV0","../internals/hidden-keys":"u6aE","../internals/html":"ZA3F","../internals/document-create-element":"hMem","../internals/shared-key":"Hosz"}],"F3Dn":[function(require,module,exports) {
var e=require("../internals/object-define-property").f,r=require("../internals/has"),n=require("../internals/well-known-symbol"),o=n("toStringTag");module.exports=function(n,t,i){n&&!r(n=i?n:n.prototype,o)&&e(n,o,{configurable:!0,value:t})};
},{"../internals/object-define-property":"lxmH","../internals/has":"Gdzi","../internals/well-known-symbol":"sPFN"}],"N9YG":[function(require,module,exports) {
"use strict";var r=require("../internals/iterators-core").IteratorPrototype,e=require("../internals/object-create"),t=require("../internals/create-property-descriptor"),i=require("../internals/set-to-string-tag"),n=require("../internals/iterators"),o=function(){return this};module.exports=function(a,s,u){var c=s+" Iterator";return a.prototype=e(r,{next:t(1,u)}),i(a,c,!1,!0),n[c]=o,a};
},{"../internals/iterators-core":"jbL0","../internals/object-create":"NYfz","../internals/create-property-descriptor":"aTKp","../internals/set-to-string-tag":"F3Dn","../internals/iterators":"u6aE"}],"zP4J":[function(require,module,exports) {
var r=require("../internals/is-object");module.exports=function(t){if(!r(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype");return t};
},{"../internals/is-object":"QYQv"}],"nEq4":[function(require,module,exports) {
var t=require("../internals/an-object"),r=require("../internals/a-possible-prototype");module.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,o=!1,n={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),o=n instanceof Array}catch(c){}return function(n,c){return t(n),r(c),o?e.call(n,c):n.__proto__=c,n}}():void 0);
},{"../internals/an-object":"vY5p","../internals/a-possible-prototype":"zP4J"}],"A0h2":[function(require,module,exports) {
"use strict";var e=require("../internals/export"),r=require("../internals/create-iterator-constructor"),t=require("../internals/object-get-prototype-of"),n=require("../internals/object-set-prototype-of"),i=require("../internals/set-to-string-tag"),o=require("../internals/create-non-enumerable-property"),s=require("../internals/redefine"),a=require("../internals/well-known-symbol"),u=require("../internals/is-pure"),c=require("../internals/iterators"),l=require("../internals/iterators-core"),f=l.IteratorPrototype,p=l.BUGGY_SAFARI_ITERATORS,q=a("iterator"),y="keys",w="values",b="entries",h=function(){return this};module.exports=function(a,l,g,m,v,A,I){r(g,l,m);var d,j,k,x=function(e){if(e===v&&T)return T;if(!p&&e in O)return O[e];switch(e){case y:case w:case b:return function(){return new g(this,e)}}return function(){return new g(this)}},R=l+" Iterator",G=!1,O=a.prototype,S=O[q]||O["@@iterator"]||v&&O[v],T=!p&&S||x(v),_="Array"==l&&O.entries||S;if(_&&(d=t(_.call(new a)),f!==Object.prototype&&d.next&&(u||t(d)===f||(n?n(d,f):"function"!=typeof d[q]&&o(d,q,h)),i(d,R,!0,!0),u&&(c[R]=h))),v==w&&S&&S.name!==w&&(G=!0,T=function(){return S.call(this)}),u&&!I||O[q]===T||o(O,q,T),c[l]=T,v)if(j={values:x(w),keys:A?T:x(y),entries:x(b)},I)for(k in j)!p&&!G&&k in O||s(O,k,j[k]);else e({target:l,proto:!0,forced:p||G},j);return j};
},{"../internals/export":"EhLp","../internals/create-iterator-constructor":"N9YG","../internals/object-get-prototype-of":"wKQH","../internals/object-set-prototype-of":"nEq4","../internals/set-to-string-tag":"F3Dn","../internals/create-non-enumerable-property":"XRrN","../internals/redefine":"PceW","../internals/well-known-symbol":"sPFN","../internals/is-pure":"pi8Y","../internals/iterators":"u6aE","../internals/iterators-core":"jbL0"}],"DV5e":[function(require,module,exports) {
"use strict";var t=require("../internals/string-multibyte").charAt,e=require("../internals/internal-state"),r=require("../internals/define-iterator"),n="String Iterator",i=e.set,a=e.getterFor(n);r(String,"String",function(t){i(this,{type:n,string:String(t),index:0})},function(){var e,r=a(this),n=r.string,i=r.index;return i>=n.length?{value:void 0,done:!0}:(e=t(n,i),r.index+=e.length,{value:e,done:!1})});
},{"../internals/string-multibyte":"OMAC","../internals/internal-state":"FDlA","../internals/define-iterator":"A0h2"}],"aHwm":[function(require,module,exports) {
module.exports=function(n){if("function"!=typeof n)throw TypeError(String(n)+" is not a function");return n};
},{}],"hoEO":[function(require,module,exports) {
var n=require("../internals/a-function");module.exports=function(r,t,e){if(n(r),void 0===t)return r;switch(e){case 0:return function(){return r.call(t)};case 1:return function(n){return r.call(t,n)};case 2:return function(n,e){return r.call(t,n,e)};case 3:return function(n,e,u){return r.call(t,n,e,u)}}return function(){return r.apply(t,arguments)}};
},{"../internals/a-function":"aHwm"}],"oM6R":[function(require,module,exports) {
var r=require("../internals/an-object");module.exports=function(e){var n=e.return;if(void 0!==n)return r(n.call(e)).value};
},{"../internals/an-object":"vY5p"}],"I2rg":[function(require,module,exports) {
var r=require("../internals/an-object"),e=require("../internals/iterator-close");module.exports=function(t,n,o,a){try{return a?n(r(o)[0],o[1]):n(o)}catch(i){throw e(t),i}};
},{"../internals/an-object":"vY5p","../internals/iterator-close":"oM6R"}],"YCBX":[function(require,module,exports) {
var r=require("../internals/well-known-symbol"),e=require("../internals/iterators"),t=r("iterator"),o=Array.prototype;module.exports=function(r){return void 0!==r&&(e.Array===r||o[t]===r)};
},{"../internals/well-known-symbol":"sPFN","../internals/iterators":"u6aE"}],"cfb1":[function(require,module,exports) {
"use strict";var e=require("../internals/to-primitive"),r=require("../internals/object-define-property"),i=require("../internals/create-property-descriptor");module.exports=function(t,n,o){var p=e(n);p in t?r.f(t,p,i(0,o)):t[p]=o};
},{"../internals/to-primitive":"rm5K","../internals/object-define-property":"lxmH","../internals/create-property-descriptor":"aTKp"}],"YSRT":[function(require,module,exports) {
var e=require("../internals/well-known-symbol"),r=e("toStringTag"),n={};n[r]="z",module.exports="[object z]"===String(n);
},{"../internals/well-known-symbol":"sPFN"}],"ENb8":[function(require,module,exports) {
var n=require("../internals/to-string-tag-support"),r=require("../internals/classof-raw"),t=require("../internals/well-known-symbol"),e=t("toStringTag"),u="Arguments"==r(function(){return arguments}()),i=function(n,r){try{return n[r]}catch(t){}};module.exports=n?r:function(n){var t,o,l;return void 0===n?"Undefined":null===n?"Null":"string"==typeof(o=i(t=Object(n),e))?o:u?r(t):"Object"==(l=r(t))&&"function"==typeof t.callee?"Arguments":l};
},{"../internals/to-string-tag-support":"YSRT","../internals/classof-raw":"oWVo","../internals/well-known-symbol":"sPFN"}],"OSUf":[function(require,module,exports) {
var r=require("../internals/classof"),e=require("../internals/iterators"),n=require("../internals/well-known-symbol"),t=n("iterator");module.exports=function(n){if(null!=n)return n[t]||n["@@iterator"]||e[r(n)]};
},{"../internals/classof":"ENb8","../internals/iterators":"u6aE","../internals/well-known-symbol":"sPFN"}],"J8mD":[function(require,module,exports) {
"use strict";var e=require("../internals/function-bind-context"),r=require("../internals/to-object"),t=require("../internals/call-with-safe-iteration-closing"),n=require("../internals/is-array-iterator-method"),i=require("../internals/to-length"),l=require("../internals/create-property"),a=require("../internals/get-iterator-method");module.exports=function(o){var s,u,c,h,d,f,q=r(o),v="function"==typeof this?this:Array,g=arguments.length,y=g>1?arguments[1]:void 0,p=void 0!==y,m=a(q),w=0;if(p&&(y=e(y,g>2?arguments[2]:void 0,2)),null==m||v==Array&&n(m))for(u=new v(s=i(q.length));s>w;w++)f=p?y(q[w],w):q[w],l(u,w,f);else for(d=(h=m.call(q)).next,u=new v;!(c=d.call(h)).done;w++)f=p?t(h,y,[c.value,w],!0):c.value,l(u,w,f);return u.length=w,u};
},{"../internals/function-bind-context":"hoEO","../internals/to-object":"jvja","../internals/call-with-safe-iteration-closing":"I2rg","../internals/is-array-iterator-method":"YCBX","../internals/to-length":"HnVY","../internals/create-property":"cfb1","../internals/get-iterator-method":"OSUf"}],"lybY":[function(require,module,exports) {
var r=require("../internals/well-known-symbol"),n=r("iterator"),t=!1;try{var e=0,o={next:function(){return{done:!!e++}},return:function(){t=!0}};o[n]=function(){return this},Array.from(o,function(){throw 2})}catch(u){}module.exports=function(r,e){if(!e&&!t)return!1;var o=!1;try{var i={};i[n]=function(){return{next:function(){return{done:o=!0}}}},r(i)}catch(u){}return o};
},{"../internals/well-known-symbol":"sPFN"}],"mYO5":[function(require,module,exports) {
var r=require("../internals/export"),e=require("../internals/array-from"),t=require("../internals/check-correctness-of-iteration"),a=!t(function(r){Array.from(r)});r({target:"Array",stat:!0,forced:a},{from:e});
},{"../internals/export":"EhLp","../internals/array-from":"J8mD","../internals/check-correctness-of-iteration":"lybY"}],"kQZP":[function(require,module,exports) {
var r=require("../internals/classof-raw");module.exports=Array.isArray||function(a){return"Array"==r(a)};
},{"../internals/classof-raw":"oWVo"}],"Kgm1":[function(require,module,exports) {
var r=require("../internals/export"),a=require("../internals/is-array");r({target:"Array",stat:!0},{isArray:a});
},{"../internals/export":"EhLp","../internals/is-array":"kQZP"}],"jmYt":[function(require,module,exports) {
"use strict";var r=require("../internals/export"),t=require("../internals/fails"),e=require("../internals/create-property"),n=t(function(){function r(){}return!(Array.of.call(r)instanceof r)});r({target:"Array",stat:!0,forced:n},{of:function(){for(var r=0,t=arguments.length,n=new("function"==typeof this?this:Array)(t);t>r;)e(n,r,arguments[r++]);return n.length=t,n}});
},{"../internals/export":"EhLp","../internals/fails":"HhtF","../internals/create-property":"cfb1"}],"L85L":[function(require,module,exports) {
var r=require("../internals/is-object"),e=require("../internals/is-array"),n=require("../internals/well-known-symbol"),o=n("species");module.exports=function(n,i){var t;return e(n)&&("function"!=typeof(t=n.constructor)||t!==Array&&!e(t.prototype)?r(t)&&null===(t=t[o])&&(t=void 0):t=void 0),new(void 0===t?Array:t)(0===i?0:i)};
},{"../internals/is-object":"QYQv","../internals/is-array":"kQZP","../internals/well-known-symbol":"sPFN"}],"JnhI":[function(require,module,exports) {
var n=require("../internals/fails"),e=require("../internals/well-known-symbol"),r=require("../internals/engine-v8-version"),o=e("species");module.exports=function(e){return r>=51||!n(function(){var n=[];return(n.constructor={})[o]=function(){return{foo:1}},1!==n[e](Boolean).foo})};
},{"../internals/fails":"HhtF","../internals/well-known-symbol":"sPFN","../internals/engine-v8-version":"o3qS"}],"bupr":[function(require,module,exports) {
"use strict";var r=require("../internals/export"),e=require("../internals/fails"),n=require("../internals/is-array"),t=require("../internals/is-object"),i=require("../internals/to-object"),a=require("../internals/to-length"),o=require("../internals/create-property"),s=require("../internals/array-species-create"),l=require("../internals/array-method-has-species-support"),u=require("../internals/well-known-symbol"),c=require("../internals/engine-v8-version"),f=u("isConcatSpreadable"),p=9007199254740991,q="Maximum allowed index exceeded",h=c>=51||!e(function(){var r=[];return r[f]=!1,r.concat()[0]!==r}),d=l("concat"),y=function(r){if(!t(r))return!1;var e=r[f];return void 0!==e?!!e:n(r)},v=!h||!d;r({target:"Array",proto:!0,forced:v},{concat:function(r){var e,n,t,l,u,c=i(this),f=s(c,0),h=0;for(e=-1,t=arguments.length;e<t;e++)if(u=-1===e?c:arguments[e],y(u)){if(h+(l=a(u.length))>p)throw TypeError(q);for(n=0;n<l;n++,h++)n in u&&o(f,h,u[n])}else{if(h>=p)throw TypeError(q);o(f,h++,u)}return f.length=h,f}});
},{"../internals/export":"EhLp","../internals/fails":"HhtF","../internals/is-array":"kQZP","../internals/is-object":"QYQv","../internals/to-object":"jvja","../internals/to-length":"HnVY","../internals/create-property":"cfb1","../internals/array-species-create":"L85L","../internals/array-method-has-species-support":"JnhI","../internals/well-known-symbol":"sPFN","../internals/engine-v8-version":"o3qS"}],"l1VS":[function(require,module,exports) {
"use strict";var e=require("../internals/to-object"),t=require("../internals/to-absolute-index"),i=require("../internals/to-length"),n=Math.min;module.exports=[].copyWithin||function(r,o){var l=e(this),s=i(l.length),u=t(r,s),a=t(o,s),h=arguments.length>2?arguments[2]:void 0,d=n((void 0===h?s:t(h,s))-a,s-u),c=1;for(a<u&&u<a+d&&(c=-1,a+=d-1,u+=d-1);d-- >0;)a in l?l[u]=l[a]:delete l[u],u+=c,a+=c;return l};
},{"../internals/to-object":"jvja","../internals/to-absolute-index":"CYMe","../internals/to-length":"HnVY"}],"xpMP":[function(require,module,exports) {
var e=require("../internals/well-known-symbol"),r=require("../internals/object-create"),n=require("../internals/object-define-property"),l=e("unscopables"),o=Array.prototype;null==o[l]&&n.f(o,l,{configurable:!0,value:r(null)}),module.exports=function(e){o[l][e]=!0};
},{"../internals/well-known-symbol":"sPFN","../internals/object-create":"NYfz","../internals/object-define-property":"lxmH"}],"vMH9":[function(require,module,exports) {
var r=require("../internals/export"),e=require("../internals/array-copy-within"),i=require("../internals/add-to-unscopables");r({target:"Array",proto:!0},{copyWithin:e}),i("copyWithin");
},{"../internals/export":"EhLp","../internals/array-copy-within":"l1VS","../internals/add-to-unscopables":"xpMP"}],"GJih":[function(require,module,exports) {
var e=require("../internals/function-bind-context"),r=require("../internals/indexed-object"),n=require("../internals/to-object"),t=require("../internals/to-length"),i=require("../internals/array-species-create"),a=[].push,s=function(s){var c=1==s,u=2==s,l=3==s,o=4==s,f=6==s,d=7==s,h=5==s||f;return function(q,v,p,x){for(var b,m,g=n(q),j=r(g),w=e(v,p,3),y=t(j.length),E=0,I=x||i,O=c?I(q,y):u||d?I(q,0):void 0;y>E;E++)if((h||E in j)&&(m=w(b=j[E],E,g),s))if(c)O[E]=m;else if(m)switch(s){case 3:return!0;case 5:return b;case 6:return E;case 2:a.call(O,b)}else switch(s){case 4:return!1;case 7:a.call(O,b)}return f?-1:l||o?o:O}};module.exports={forEach:s(0),map:s(1),filter:s(2),some:s(3),every:s(4),find:s(5),findIndex:s(6),filterOut:s(7)};
},{"../internals/function-bind-context":"hoEO","../internals/indexed-object":"wRpf","../internals/to-object":"jvja","../internals/to-length":"HnVY","../internals/array-species-create":"L85L"}],"MTB4":[function(require,module,exports) {
"use strict";var n=require("../internals/fails");module.exports=function(r,t){var u=[][r];return!!u&&n(function(){u.call(null,t||function(){throw 1},1)})};
},{"../internals/fails":"HhtF"}],"wJSt":[function(require,module,exports) {
"use strict";var r=require("../internals/export"),e=require("../internals/array-iteration").every,t=require("../internals/array-method-is-strict"),i=t("every");r({target:"Array",proto:!0,forced:!i},{every:function(r){return e(this,r,arguments.length>1?arguments[1]:void 0)}});
},{"../internals/export":"EhLp","../internals/array-iteration":"GJih","../internals/array-method-is-strict":"MTB4"}],"Mbic":[function(require,module,exports) {
"use strict";var e=require("../internals/to-object"),t=require("../internals/to-absolute-index"),r=require("../internals/to-length");module.exports=function(i){for(var n=e(this),o=r(n.length),l=arguments.length,s=t(l>1?arguments[1]:void 0,o),u=l>2?arguments[2]:void 0,a=void 0===u?o:t(u,o);a>s;)n[s++]=i;return n};
},{"../internals/to-object":"jvja","../internals/to-absolute-index":"CYMe","../internals/to-length":"HnVY"}],"SShL":[function(require,module,exports) {
var r=require("../internals/export"),e=require("../internals/array-fill"),a=require("../internals/add-to-unscopables");r({target:"Array",proto:!0},{fill:e}),a("fill");
},{"../internals/export":"EhLp","../internals/array-fill":"Mbic","../internals/add-to-unscopables":"xpMP"}],"uVzF":[function(require,module,exports) {
"use strict";var r=require("../internals/export"),e=require("../internals/array-iteration").filter,t=require("../internals/array-method-has-species-support"),i=t("filter");r({target:"Array",proto:!0,forced:!i},{filter:function(r){return e(this,r,arguments.length>1?arguments[1]:void 0)}});
},{"../internals/export":"EhLp","../internals/array-iteration":"GJih","../internals/array-method-has-species-support":"JnhI"}],"Iz1a":[function(require,module,exports) {
"use strict";var r=require("../internals/export"),n=require("../internals/array-iteration").find,e=require("../internals/add-to-unscopables"),i="find",t=!0;i in[]&&Array(1)[i](function(){t=!1}),r({target:"Array",proto:!0,forced:t},{find:function(r){return n(this,r,arguments.length>1?arguments[1]:void 0)}}),e(i);
},{"../internals/export":"EhLp","../internals/array-iteration":"GJih","../internals/add-to-unscopables":"xpMP"}],"MqTg":[function(require,module,exports) {
"use strict";var r=require("../internals/export"),n=require("../internals/array-iteration").findIndex,e=require("../internals/add-to-unscopables"),i="findIndex",t=!0;i in[]&&Array(1)[i](function(){t=!1}),r({target:"Array",proto:!0,forced:t},{findIndex:function(r){return n(this,r,arguments.length>1?arguments[1]:void 0)}}),e(i);
},{"../internals/export":"EhLp","../internals/array-iteration":"GJih","../internals/add-to-unscopables":"xpMP"}],"QH08":[function(require,module,exports) {
"use strict";var e=require("../internals/is-array"),r=require("../internals/to-length"),t=require("../internals/function-bind-context"),n=function(i,a,l,o,s,u,c,f){for(var h,d=s,g=0,p=!!c&&t(c,f,3);g<o;){if(g in l){if(h=p?p(l[g],g,a):l[g],u>0&&e(h))d=n(i,a,h,r(h.length),d,u-1)-1;else{if(d>=9007199254740991)throw TypeError("Exceed the acceptable array length");i[d]=h}d++}g++}return d};module.exports=n;
},{"../internals/is-array":"kQZP","../internals/to-length":"HnVY","../internals/function-bind-context":"hoEO"}],"iI6T":[function(require,module,exports) {
"use strict";var e=require("../internals/export"),r=require("../internals/flatten-into-array"),t=require("../internals/to-object"),n=require("../internals/to-length"),i=require("../internals/to-integer"),a=require("../internals/array-species-create");e({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,l=t(this),o=n(l.length),s=a(l,0);return s.length=r(s,l,l,o,0,void 0===e?1:i(e)),s}});
},{"../internals/export":"EhLp","../internals/flatten-into-array":"QH08","../internals/to-object":"jvja","../internals/to-length":"HnVY","../internals/to-integer":"rBuz","../internals/array-species-create":"L85L"}],"T996":[function(require,module,exports) {
"use strict";var r=require("../internals/export"),e=require("../internals/flatten-into-array"),t=require("../internals/to-object"),n=require("../internals/to-length"),a=require("../internals/a-function"),i=require("../internals/array-species-create");r({target:"Array",proto:!0},{flatMap:function(r){var l,s=t(this),o=n(s.length);return a(r),(l=i(s,0)).length=e(l,s,s,o,0,1,r,arguments.length>1?arguments[1]:void 0),l}});
},{"../internals/export":"EhLp","../internals/flatten-into-array":"QH08","../internals/to-object":"jvja","../internals/to-length":"HnVY","../internals/a-function":"aHwm","../internals/array-species-create":"L85L"}],"S2cL":[function(require,module,exports) {
"use strict";var r=require("../internals/array-iteration").forEach,t=require("../internals/array-method-is-strict"),e=t("forEach");module.exports=e?[].forEach:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)};
},{"../internals/array-iteration":"GJih","../internals/array-method-is-strict":"MTB4"}],"FQOo":[function(require,module,exports) {
"use strict";var r=require("../internals/export"),e=require("../internals/array-for-each");r({target:"Array",proto:!0,forced:[].forEach!=e},{forEach:e});
},{"../internals/export":"EhLp","../internals/array-for-each":"S2cL"}],"QP13":[function(require,module,exports) {
"use strict";var r=require("../internals/export"),e=require("../internals/array-includes").includes,n=require("../internals/add-to-unscopables");r({target:"Array",proto:!0},{includes:function(r){return e(this,r,arguments.length>1?arguments[1]:void 0)}}),n("includes");
},{"../internals/export":"EhLp","../internals/array-includes":"nH1t","../internals/add-to-unscopables":"xpMP"}],"NlZ3":[function(require,module,exports) {
"use strict";var r=require("../internals/export"),e=require("../internals/array-includes").indexOf,i=require("../internals/array-method-is-strict"),t=[].indexOf,n=!!t&&1/[1].indexOf(1,-0)<0,a=i("indexOf");r({target:"Array",proto:!0,forced:n||!a},{indexOf:function(r){return n?t.apply(this,arguments)||0:e(this,r,arguments.length>1?arguments[1]:void 0)}});
},{"../internals/export":"EhLp","../internals/array-includes":"nH1t","../internals/array-method-is-strict":"MTB4"}],"nY8y":[function(require,module,exports) {
"use strict";var e=require("../internals/to-indexed-object"),r=require("../internals/add-to-unscopables"),t=require("../internals/iterators"),n=require("../internals/internal-state"),a=require("../internals/define-iterator"),i="Array Iterator",s=n.set,u=n.getterFor(i);module.exports=a(Array,"Array",function(r,t){s(this,{type:i,target:e(r),index:0,kind:t})},function(){var e=u(this),r=e.target,t=e.kind,n=e.index++;return!r||n>=r.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==t?{value:n,done:!1}:"values"==t?{value:r[n],done:!1}:{value:[n,r[n]],done:!1}},"values"),t.Arguments=t.Array,r("keys"),r("values"),r("entries");
},{"../internals/to-indexed-object":"xooR","../internals/add-to-unscopables":"xpMP","../internals/iterators":"u6aE","../internals/internal-state":"FDlA","../internals/define-iterator":"A0h2"}],"aWLa":[function(require,module,exports) {
"use strict";var e=require("../internals/export"),r=require("../internals/indexed-object"),t=require("../internals/to-indexed-object"),i=require("../internals/array-method-is-strict"),n=[].join,o=r!=Object,a=i("join",",");e({target:"Array",proto:!0,forced:o||!a},{join:function(e){return n.call(t(this),void 0===e?",":e)}});
},{"../internals/export":"EhLp","../internals/indexed-object":"wRpf","../internals/to-indexed-object":"xooR","../internals/array-method-is-strict":"MTB4"}],"lRdU":[function(require,module,exports) {
"use strict";var e=require("../internals/to-indexed-object"),t=require("../internals/to-integer"),r=require("../internals/to-length"),n=require("../internals/array-method-is-strict"),i=Math.min,s=[].lastIndexOf,a=!!s&&1/[1].lastIndexOf(1,-0)<0,l=n("lastIndexOf"),u=a||!l;module.exports=u?function(n){if(a)return s.apply(this,arguments)||0;var l=e(this),u=r(l.length),o=u-1;for(arguments.length>1&&(o=i(o,t(arguments[1]))),o<0&&(o=u+o);o>=0;o--)if(o in l&&l[o]===n)return o||0;return-1}:s;
},{"../internals/to-indexed-object":"xooR","../internals/to-integer":"rBuz","../internals/to-length":"HnVY","../internals/array-method-is-strict":"MTB4"}],"MPaF":[function(require,module,exports) {
var r=require("../internals/export"),e=require("../internals/array-last-index-of");r({target:"Array",proto:!0,forced:e!==[].lastIndexOf},{lastIndexOf:e});
},{"../internals/export":"EhLp","../internals/array-last-index-of":"lRdU"}],"rc2N":[function(require,module,exports) {
"use strict";var r=require("../internals/export"),e=require("../internals/array-iteration").map,t=require("../internals/array-method-has-species-support"),a=t("map");r({target:"Array",proto:!0,forced:!a},{map:function(r){return e(this,r,arguments.length>1?arguments[1]:void 0)}});
},{"../internals/export":"EhLp","../internals/array-iteration":"GJih","../internals/array-method-has-species-support":"JnhI"}],"VKCE":[function(require,module,exports) {
var e=require("../internals/a-function"),r=require("../internals/to-object"),n=require("../internals/indexed-object"),i=require("../internals/to-length"),t=function(t){return function(o,a,u,f){e(a);var l=r(o),c=n(l),h=i(l.length),s=t?h-1:0,d=t?-1:1;if(u<2)for(;;){if(s in c){f=c[s],s+=d;break}if(s+=d,t?s<0:h<=s)throw TypeError("Reduce of empty array with no initial value")}for(;t?s>=0:h>s;s+=d)s in c&&(f=a(f,c[s],s,l));return f}};module.exports={left:t(!1),right:t(!0)};
},{"../internals/a-function":"aHwm","../internals/to-object":"jvja","../internals/indexed-object":"wRpf","../internals/to-length":"HnVY"}],"Q91u":[function(require,module,exports) {
"use strict";var e=require("../internals/export"),r=require("../internals/array-reduce").left,n=require("../internals/array-method-is-strict"),i=require("../internals/engine-v8-version"),t=require("../internals/engine-is-node"),a=n("reduce"),s=!t&&i>79&&i<83;e({target:"Array",proto:!0,forced:!a||s},{reduce:function(e){return r(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}});
},{"../internals/export":"EhLp","../internals/array-reduce":"VKCE","../internals/array-method-is-strict":"MTB4","../internals/engine-v8-version":"o3qS","../internals/engine-is-node":"mSBD"}],"xGpa":[function(require,module,exports) {
"use strict";var e=require("../internals/export"),r=require("../internals/array-reduce").right,i=require("../internals/array-method-is-strict"),t=require("../internals/engine-v8-version"),n=require("../internals/engine-is-node"),a=i("reduceRight"),s=!n&&t>79&&t<83;e({target:"Array",proto:!0,forced:!a||s},{reduceRight:function(e){return r(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}});
},{"../internals/export":"EhLp","../internals/array-reduce":"VKCE","../internals/array-method-is-strict":"MTB4","../internals/engine-v8-version":"o3qS","../internals/engine-is-node":"mSBD"}],"jABb":[function(require,module,exports) {
"use strict";var r=require("../internals/export"),e=require("../internals/is-array"),t=[].reverse,i=[1,2];r({target:"Array",proto:!0,forced:String(i)===String(i.reverse())},{reverse:function(){return e(this)&&(this.length=this.length),t.call(this)}});
},{"../internals/export":"EhLp","../internals/is-array":"kQZP"}],"EKbL":[function(require,module,exports) {
"use strict";var r=require("../internals/export"),e=require("../internals/is-object"),t=require("../internals/is-array"),i=require("../internals/to-absolute-index"),n=require("../internals/to-length"),o=require("../internals/to-indexed-object"),a=require("../internals/create-property"),s=require("../internals/well-known-symbol"),l=require("../internals/array-method-has-species-support"),u=l("slice"),c=s("species"),p=[].slice,d=Math.max;r({target:"Array",proto:!0,forced:!u},{slice:function(r,s){var l,u,y,q=o(this),h=n(q.length),v=i(r,h),f=i(void 0===s?h:s,h);if(t(q)&&("function"!=typeof(l=q.constructor)||l!==Array&&!t(l.prototype)?e(l)&&null===(l=l[c])&&(l=void 0):l=void 0,l===Array||void 0===l))return p.call(q,v,f);for(u=new(void 0===l?Array:l)(d(f-v,0)),y=0;v<f;v++,y++)v in q&&a(u,y,q[v]);return u.length=y,u}});
},{"../internals/export":"EhLp","../internals/is-object":"QYQv","../internals/is-array":"kQZP","../internals/to-absolute-index":"CYMe","../internals/to-length":"HnVY","../internals/to-indexed-object":"xooR","../internals/create-property":"cfb1","../internals/well-known-symbol":"sPFN","../internals/array-method-has-species-support":"JnhI"}],"Zq1i":[function(require,module,exports) {
"use strict";var r=require("../internals/export"),e=require("../internals/array-iteration").some,t=require("../internals/array-method-is-strict"),i=t("some");r({target:"Array",proto:!0,forced:!i},{some:function(r){return e(this,r,arguments.length>1?arguments[1]:void 0)}});
},{"../internals/export":"EhLp","../internals/array-iteration":"GJih","../internals/array-method-is-strict":"MTB4"}],"iAXB":[function(require,module,exports) {
"use strict";var r=require("../internals/export"),t=require("../internals/a-function"),e=require("../internals/to-object"),i=require("../internals/fails"),n=require("../internals/array-method-is-strict"),o=[],s=o.sort,a=i(function(){o.sort(void 0)}),l=i(function(){o.sort(null)}),u=n("sort"),c=a||!l||!u;r({target:"Array",proto:!0,forced:c},{sort:function(r){return void 0===r?s.call(e(this)):s.call(e(this),t(r))}});
},{"../internals/export":"EhLp","../internals/a-function":"aHwm","../internals/to-object":"jvja","../internals/fails":"HhtF","../internals/array-method-is-strict":"MTB4"}],"mlrj":[function(require,module,exports) {
"use strict";var e=require("../internals/get-built-in"),r=require("../internals/object-define-property"),i=require("../internals/well-known-symbol"),n=require("../internals/descriptors"),t=i("species");module.exports=function(i){var s=e(i),u=r.f;n&&s&&!s[t]&&u(s,t,{configurable:!0,get:function(){return this}})};
},{"../internals/get-built-in":"tM1E","../internals/object-define-property":"lxmH","../internals/well-known-symbol":"sPFN","../internals/descriptors":"r2hA"}],"x9kn":[function(require,module,exports) {
var e=require("../internals/set-species");e("Array");
},{"../internals/set-species":"mlrj"}],"j0jg":[function(require,module,exports) {
"use strict";var e=require("../internals/export"),r=require("../internals/to-absolute-index"),t=require("../internals/to-integer"),i=require("../internals/to-length"),n=require("../internals/to-object"),a=require("../internals/array-species-create"),l=require("../internals/create-property"),o=require("../internals/array-method-has-species-support"),s=o("splice"),u=Math.max,h=Math.min,c=9007199254740991,p="Maximum allowed length exceeded";e({target:"Array",proto:!0,forced:!s},{splice:function(e,o){var s,f,d,g,q,m,x=n(this),y=i(x.length),M=r(e,y),b=arguments.length;if(0===b?s=f=0:1===b?(s=0,f=y-M):(s=b-2,f=h(u(t(o),0),y-M)),y+s-f>c)throw TypeError(p);for(d=a(x,f),g=0;g<f;g++)(q=M+g)in x&&l(d,g,x[q]);if(d.length=f,s<f){for(g=M;g<y-f;g++)m=g+s,(q=g+f)in x?x[m]=x[q]:delete x[m];for(g=y;g>y-f+s;g--)delete x[g-1]}else if(s>f)for(g=y-f;g>M;g--)m=g+s-1,(q=g+f-1)in x?x[m]=x[q]:delete x[m];for(g=0;g<s;g++)x[g+M]=arguments[g+2];return x.length=y-f+s,d}});
},{"../internals/export":"EhLp","../internals/to-absolute-index":"CYMe","../internals/to-integer":"rBuz","../internals/to-length":"HnVY","../internals/to-object":"jvja","../internals/array-species-create":"L85L","../internals/create-property":"cfb1","../internals/array-method-has-species-support":"JnhI"}],"LG5H":[function(require,module,exports) {
var a=require("../internals/add-to-unscopables");a("flat");
},{"../internals/add-to-unscopables":"xpMP"}],"fx1r":[function(require,module,exports) {
var a=require("../internals/add-to-unscopables");a("flatMap");
},{"../internals/add-to-unscopables":"xpMP"}],"I7hB":[function(require,module,exports) {
require("../../modules/es.string.iterator"),require("../../modules/es.array.from"),require("../../modules/es.array.is-array"),require("../../modules/es.array.of"),require("../../modules/es.array.concat"),require("../../modules/es.array.copy-within"),require("../../modules/es.array.every"),require("../../modules/es.array.fill"),require("../../modules/es.array.filter"),require("../../modules/es.array.find"),require("../../modules/es.array.find-index"),require("../../modules/es.array.flat"),require("../../modules/es.array.flat-map"),require("../../modules/es.array.for-each"),require("../../modules/es.array.includes"),require("../../modules/es.array.index-of"),require("../../modules/es.array.iterator"),require("../../modules/es.array.join"),require("../../modules/es.array.last-index-of"),require("../../modules/es.array.map"),require("../../modules/es.array.reduce"),require("../../modules/es.array.reduce-right"),require("../../modules/es.array.reverse"),require("../../modules/es.array.slice"),require("../../modules/es.array.some"),require("../../modules/es.array.sort"),require("../../modules/es.array.species"),require("../../modules/es.array.splice"),require("../../modules/es.array.unscopables.flat"),require("../../modules/es.array.unscopables.flat-map");var e=require("../../internals/path");module.exports=e.Array;
},{"../../modules/es.string.iterator":"DV5e","../../modules/es.array.from":"mYO5","../../modules/es.array.is-array":"Kgm1","../../modules/es.array.of":"jmYt","../../modules/es.array.concat":"bupr","../../modules/es.array.copy-within":"vMH9","../../modules/es.array.every":"wJSt","../../modules/es.array.fill":"SShL","../../modules/es.array.filter":"uVzF","../../modules/es.array.find":"Iz1a","../../modules/es.array.find-index":"MqTg","../../modules/es.array.flat":"iI6T","../../modules/es.array.flat-map":"T996","../../modules/es.array.for-each":"FQOo","../../modules/es.array.includes":"QP13","../../modules/es.array.index-of":"NlZ3","../../modules/es.array.iterator":"nY8y","../../modules/es.array.join":"aWLa","../../modules/es.array.last-index-of":"MPaF","../../modules/es.array.map":"rc2N","../../modules/es.array.reduce":"Q91u","../../modules/es.array.reduce-right":"xGpa","../../modules/es.array.reverse":"jABb","../../modules/es.array.slice":"EKbL","../../modules/es.array.some":"Zq1i","../../modules/es.array.sort":"iAXB","../../modules/es.array.species":"x9kn","../../modules/es.array.splice":"j0jg","../../modules/es.array.unscopables.flat":"LG5H","../../modules/es.array.unscopables.flat-map":"fx1r","../../internals/path":"FSlT"}],"PAJh":[function(require,module,exports) {
var e=require("../internals/to-indexed-object"),t=require("../internals/object-get-own-property-names").f,r={}.toString,n="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],o=function(e){try{return t(e)}catch(r){return n.slice()}};module.exports.f=function(i){return n&&"[object Window]"==r.call(i)?o(i):t(e(i))};
},{"../internals/to-indexed-object":"xooR","../internals/object-get-own-property-names":"F6CC"}],"qU2i":[function(require,module,exports) {
var e=require("../internals/well-known-symbol");exports.f=e;
},{"../internals/well-known-symbol":"sPFN"}],"ZljB":[function(require,module,exports) {
var e=require("../internals/path"),r=require("../internals/has"),n=require("../internals/well-known-symbol-wrapped"),l=require("../internals/object-define-property").f;module.exports=function(a){var i=e.Symbol||(e.Symbol={});r(i,a)||l(i,a,{value:n.f(a)})};
},{"../internals/path":"FSlT","../internals/has":"Gdzi","../internals/well-known-symbol-wrapped":"qU2i","../internals/object-define-property":"lxmH"}],"sqCU":[function(require,module,exports) {

"use strict";var e=require("../internals/export"),r=require("../internals/global"),t=require("../internals/get-built-in"),n=require("../internals/is-pure"),i=require("../internals/descriptors"),o=require("../internals/native-symbol"),s=require("../internals/use-symbol-as-uid"),a=require("../internals/fails"),u=require("../internals/has"),l=require("../internals/is-array"),c=require("../internals/is-object"),f=require("../internals/an-object"),p=require("../internals/to-object"),y=require("../internals/to-indexed-object"),b=require("../internals/to-primitive"),d=require("../internals/create-property-descriptor"),g=require("../internals/object-create"),q=require("../internals/object-keys"),h=require("../internals/object-get-own-property-names"),m=require("../internals/object-get-own-property-names-external"),v=require("../internals/object-get-own-property-symbols"),w=require("../internals/object-get-own-property-descriptor"),j=require("../internals/object-define-property"),O=require("../internals/object-property-is-enumerable"),S=require("../internals/create-non-enumerable-property"),k=require("../internals/redefine"),P=require("../internals/shared"),E=require("../internals/shared-key"),x=require("../internals/hidden-keys"),N=require("../internals/uid"),F=require("../internals/well-known-symbol"),J=require("../internals/well-known-symbol-wrapped"),T=require("../internals/define-well-known-symbol"),C=require("../internals/set-to-string-tag"),D=require("../internals/internal-state"),I=require("../internals/array-iteration").forEach,Q=E("hidden"),z="Symbol",A="prototype",B=F("toPrimitive"),G=D.set,H=D.getterFor(z),K=Object[A],L=r.Symbol,M=t("JSON","stringify"),R=w.f,U=j.f,V=m.f,W=O.f,X=P("symbols"),Y=P("op-symbols"),Z=P("string-to-symbol-registry"),$=P("symbol-to-string-registry"),_=P("wks"),ee=r.QObject,re=!ee||!ee[A]||!ee[A].findChild,te=i&&a(function(){return 7!=g(U({},"a",{get:function(){return U(this,"a",{value:7}).a}})).a})?function(e,r,t){var n=R(K,r);n&&delete K[r],U(e,r,t),n&&e!==K&&U(K,r,n)}:U,ne=function(e,r){var t=X[e]=g(L[A]);return G(t,{type:z,tag:e,description:r}),i||(t.description=r),t},ie=s?function(e){return"symbol"==typeof e}:function(e){return Object(e)instanceof L},oe=function(e,r,t){e===K&&oe(Y,r,t),f(e);var n=b(r,!0);return f(t),u(X,n)?(t.enumerable?(u(e,Q)&&e[Q][n]&&(e[Q][n]=!1),t=g(t,{enumerable:d(0,!1)})):(u(e,Q)||U(e,Q,d(1,{})),e[Q][n]=!0),te(e,n,t)):U(e,n,t)},se=function(e,r){f(e);var t=y(r),n=q(t).concat(fe(t));return I(n,function(r){i&&!ue.call(t,r)||oe(e,r,t[r])}),e},ae=function(e,r){return void 0===r?g(e):se(g(e),r)},ue=function(e){var r=b(e,!0),t=W.call(this,r);return!(this===K&&u(X,r)&&!u(Y,r))&&(!(t||!u(this,r)||!u(X,r)||u(this,Q)&&this[Q][r])||t)},le=function(e,r){var t=y(e),n=b(r,!0);if(t!==K||!u(X,n)||u(Y,n)){var i=R(t,n);return!i||!u(X,n)||u(t,Q)&&t[Q][n]||(i.enumerable=!0),i}},ce=function(e){var r=V(y(e)),t=[];return I(r,function(e){u(X,e)||u(x,e)||t.push(e)}),t},fe=function(e){var r=e===K,t=V(r?Y:y(e)),n=[];return I(t,function(e){!u(X,e)||r&&!u(K,e)||n.push(X[e])}),n};if(o||(k((L=function(){if(this instanceof L)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,r=N(e),t=function(e){this===K&&t.call(Y,e),u(this,Q)&&u(this[Q],r)&&(this[Q][r]=!1),te(this,r,d(1,e))};return i&&re&&te(K,r,{configurable:!0,set:t}),ne(r,e)})[A],"toString",function(){return H(this).tag}),k(L,"withoutSetter",function(e){return ne(N(e),e)}),O.f=ue,j.f=oe,w.f=le,h.f=m.f=ce,v.f=fe,J.f=function(e){return ne(F(e),e)},i&&(U(L[A],"description",{configurable:!0,get:function(){return H(this).description}}),n||k(K,"propertyIsEnumerable",ue,{unsafe:!0}))),e({global:!0,wrap:!0,forced:!o,sham:!o},{Symbol:L}),I(q(_),function(e){T(e)}),e({target:z,stat:!0,forced:!o},{for:function(e){var r=String(e);if(u(Z,r))return Z[r];var t=L(r);return Z[r]=t,$[t]=r,t},keyFor:function(e){if(!ie(e))throw TypeError(e+" is not a symbol");if(u($,e))return $[e]},useSetter:function(){re=!0},useSimple:function(){re=!1}}),e({target:"Object",stat:!0,forced:!o,sham:!i},{create:ae,defineProperty:oe,defineProperties:se,getOwnPropertyDescriptor:le}),e({target:"Object",stat:!0,forced:!o},{getOwnPropertyNames:ce,getOwnPropertySymbols:fe}),e({target:"Object",stat:!0,forced:a(function(){v.f(1)})},{getOwnPropertySymbols:function(e){return v.f(p(e))}}),M){var pe=!o||a(function(){var e=L();return"[null]"!=M([e])||"{}"!=M({a:e})||"{}"!=M(Object(e))});e({target:"JSON",stat:!0,forced:pe},{stringify:function(e,r,t){for(var n,i=[e],o=1;arguments.length>o;)i.push(arguments[o++]);if(n=r,(c(r)||void 0!==e)&&!ie(e))return l(r)||(r=function(e,r){if("function"==typeof n&&(r=n.call(this,e,r)),!ie(r))return r}),i[1]=r,M.apply(null,i)}})}L[A][B]||S(L[A],B,L[A].valueOf),C(L,z),x[Q]=!0;
},{"../internals/export":"EhLp","../internals/global":"RdwD","../internals/get-built-in":"tM1E","../internals/is-pure":"pi8Y","../internals/descriptors":"r2hA","../internals/native-symbol":"SXW0","../internals/use-symbol-as-uid":"mSSr","../internals/fails":"HhtF","../internals/has":"Gdzi","../internals/is-array":"kQZP","../internals/is-object":"QYQv","../internals/an-object":"vY5p","../internals/to-object":"jvja","../internals/to-indexed-object":"xooR","../internals/to-primitive":"rm5K","../internals/create-property-descriptor":"aTKp","../internals/object-create":"NYfz","../internals/object-keys":"tzYM","../internals/object-get-own-property-names":"F6CC","../internals/object-get-own-property-names-external":"PAJh","../internals/object-get-own-property-symbols":"TAPg","../internals/object-get-own-property-descriptor":"NkfH","../internals/object-define-property":"lxmH","../internals/object-property-is-enumerable":"J64n","../internals/create-non-enumerable-property":"XRrN","../internals/redefine":"PceW","../internals/shared":"AP6n","../internals/shared-key":"Hosz","../internals/hidden-keys":"u6aE","../internals/uid":"aUJY","../internals/well-known-symbol":"sPFN","../internals/well-known-symbol-wrapped":"qU2i","../internals/define-well-known-symbol":"ZljB","../internals/set-to-string-tag":"F3Dn","../internals/internal-state":"FDlA","../internals/array-iteration":"GJih"}],"CeKM":[function(require,module,exports) {
"use strict";var e=require("../internals/descriptors"),r=require("../internals/fails"),n=require("../internals/object-keys"),t=require("../internals/object-get-own-property-symbols"),i=require("../internals/object-property-is-enumerable"),o=require("../internals/to-object"),a=require("../internals/indexed-object"),s=Object.assign,l=Object.defineProperty;module.exports=!s||r(function(){if(e&&1!==s({b:1},s(l({},"a",{enumerable:!0,get:function(){l(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var r={},t={},i=Symbol();return r[i]=7,"abcdefghijklmnopqrst".split("").forEach(function(e){t[e]=e}),7!=s({},r)[i]||"abcdefghijklmnopqrst"!=n(s({},t)).join("")})?function(r,s){for(var l=o(r),u=arguments.length,c=1,b=t.f,f=i.f;u>c;)for(var j,p=a(arguments[c++]),q=b?n(p).concat(b(p)):n(p),m=q.length,d=0;m>d;)j=q[d++],e&&!f.call(p,j)||(l[j]=p[j]);return l}:s;
},{"../internals/descriptors":"r2hA","../internals/fails":"HhtF","../internals/object-keys":"tzYM","../internals/object-get-own-property-symbols":"TAPg","../internals/object-property-is-enumerable":"J64n","../internals/to-object":"jvja","../internals/indexed-object":"wRpf"}],"mWsU":[function(require,module,exports) {
var e=require("../internals/export"),r=require("../internals/object-assign");e({target:"Object",stat:!0,forced:Object.assign!==r},{assign:r});
},{"../internals/export":"EhLp","../internals/object-assign":"CeKM"}],"YR5Y":[function(require,module,exports) {
var e=require("../internals/export"),r=require("../internals/descriptors"),t=require("../internals/object-create");e({target:"Object",stat:!0,sham:!r},{create:t});
},{"../internals/export":"EhLp","../internals/descriptors":"r2hA","../internals/object-create":"NYfz"}],"Vnau":[function(require,module,exports) {
var e=require("../internals/export"),r=require("../internals/descriptors"),t=require("../internals/object-define-property");e({target:"Object",stat:!0,forced:!r,sham:!r},{defineProperty:t.f});
},{"../internals/export":"EhLp","../internals/descriptors":"r2hA","../internals/object-define-property":"lxmH"}],"lIg2":[function(require,module,exports) {
var e=require("../internals/export"),r=require("../internals/descriptors"),t=require("../internals/object-define-properties");e({target:"Object",stat:!0,forced:!r,sham:!r},{defineProperties:t});
},{"../internals/export":"EhLp","../internals/descriptors":"r2hA","../internals/object-define-properties":"eVWU"}],"x9Jf":[function(require,module,exports) {
var e=require("../internals/descriptors"),r=require("../internals/object-keys"),n=require("../internals/to-indexed-object"),t=require("../internals/object-property-is-enumerable").f,i=function(i){return function(s){for(var u,o=n(s),l=r(o),a=l.length,c=0,p=[];a>c;)u=l[c++],e&&!t.call(o,u)||p.push(i?[u,o[u]]:o[u]);return p}};module.exports={entries:i(!0),values:i(!1)};
},{"../internals/descriptors":"r2hA","../internals/object-keys":"tzYM","../internals/to-indexed-object":"xooR","../internals/object-property-is-enumerable":"J64n"}],"R1US":[function(require,module,exports) {
var e=require("../internals/export"),r=require("../internals/object-to-array").entries;e({target:"Object",stat:!0},{entries:function(e){return r(e)}});
},{"../internals/export":"EhLp","../internals/object-to-array":"x9Jf"}],"x4c7":[function(require,module,exports) {
var e=require("../internals/fails");module.exports=!e(function(){return Object.isExtensible(Object.preventExtensions({}))});
},{"../internals/fails":"HhtF"}],"KMcc":[function(require,module,exports) {
var e=require("../internals/hidden-keys"),r=require("../internals/is-object"),n=require("../internals/has"),t=require("../internals/object-define-property").f,i=require("../internals/uid"),u=require("../internals/freezing"),a=i("meta"),f=0,o=Object.isExtensible||function(){return!0},s=function(e){t(e,a,{value:{objectID:"O"+ ++f,weakData:{}}})},c=function(e,t){if(!r(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!n(e,a)){if(!o(e))return"F";if(!t)return"E";s(e)}return e[a].objectID},l=function(e,r){if(!n(e,a)){if(!o(e))return!0;if(!r)return!1;s(e)}return e[a].weakData},b=function(e){return u&&D.REQUIRED&&o(e)&&!n(e,a)&&s(e),e},D=module.exports={REQUIRED:!1,fastKey:c,getWeakData:l,onFreeze:b};e[a]=!0;
},{"../internals/hidden-keys":"u6aE","../internals/is-object":"QYQv","../internals/has":"Gdzi","../internals/object-define-property":"lxmH","../internals/uid":"aUJY","../internals/freezing":"x4c7"}],"Iini":[function(require,module,exports) {
var e=require("../internals/export"),r=require("../internals/freezing"),n=require("../internals/fails"),t=require("../internals/is-object"),i=require("../internals/internal-metadata").onFreeze,a=Object.freeze,s=n(function(){a(1)});e({target:"Object",stat:!0,forced:s,sham:!r},{freeze:function(e){return a&&t(e)?a(i(e)):e}});
},{"../internals/export":"EhLp","../internals/freezing":"x4c7","../internals/fails":"HhtF","../internals/is-object":"QYQv","../internals/internal-metadata":"KMcc"}],"YT6W":[function(require,module,exports) {
var e=require("../internals/an-object"),t=require("../internals/is-array-iterator-method"),r=require("../internals/to-length"),n=require("../internals/function-bind-context"),i=require("../internals/get-iterator-method"),o=require("../internals/iterator-close"),a=function(e,t){this.stopped=e,this.result=t};module.exports=function(u,l,f){var s,c,h,T,d,p,q,E=f&&f.that,w=!(!f||!f.AS_ENTRIES),y=!(!f||!f.IS_ITERATOR),R=!(!f||!f.INTERRUPTED),b=n(l,E,1+w+R),g=function(e){return s&&o(s),new a(!0,e)},I=function(t){return w?(e(t),R?b(t[0],t[1],g):b(t[0],t[1])):R?b(t,g):b(t)};if(y)s=u;else{if("function"!=typeof(c=i(u)))throw TypeError("Target is not iterable");if(t(c)){for(h=0,T=r(u.length);T>h;h++)if((d=I(u[h]))&&d instanceof a)return d;return new a(!1)}s=c.call(u)}for(p=s.next;!(q=p.call(s)).done;){try{d=I(q.value)}catch(m){throw o(s),m}if("object"==typeof d&&d&&d instanceof a)return d}return new a(!1)};
},{"../internals/an-object":"vY5p","../internals/is-array-iterator-method":"YCBX","../internals/to-length":"HnVY","../internals/function-bind-context":"hoEO","../internals/get-iterator-method":"OSUf","../internals/iterator-close":"oM6R"}],"I2fa":[function(require,module,exports) {
var r=require("../internals/export"),e=require("../internals/iterate"),t=require("../internals/create-property");r({target:"Object",stat:!0},{fromEntries:function(r){var n={};return e(r,function(r,e){t(n,r,e)},{AS_ENTRIES:!0}),n}});
},{"../internals/export":"EhLp","../internals/iterate":"YT6W","../internals/create-property":"cfb1"}],"rKE0":[function(require,module,exports) {
var e=require("../internals/export"),r=require("../internals/fails"),t=require("../internals/to-indexed-object"),n=require("../internals/object-get-own-property-descriptor").f,i=require("../internals/descriptors"),o=r(function(){n(1)}),s=!i||o;e({target:"Object",stat:!0,forced:s,sham:!i},{getOwnPropertyDescriptor:function(e,r){return n(t(e),r)}});
},{"../internals/export":"EhLp","../internals/fails":"HhtF","../internals/to-indexed-object":"xooR","../internals/object-get-own-property-descriptor":"NkfH","../internals/descriptors":"r2hA"}],"eC8C":[function(require,module,exports) {
var e=require("../internals/export"),r=require("../internals/descriptors"),t=require("../internals/own-keys"),n=require("../internals/to-indexed-object"),i=require("../internals/object-get-own-property-descriptor"),o=require("../internals/create-property");e({target:"Object",stat:!0,sham:!r},{getOwnPropertyDescriptors:function(e){for(var r,s,a=n(e),p=i.f,c=t(a),u={},l=0;c.length>l;)void 0!==(s=p(a,r=c[l++]))&&o(u,r,s);return u}});
},{"../internals/export":"EhLp","../internals/descriptors":"r2hA","../internals/own-keys":"vYBh","../internals/to-indexed-object":"xooR","../internals/object-get-own-property-descriptor":"NkfH","../internals/create-property":"cfb1"}],"ckSq":[function(require,module,exports) {
var e=require("../internals/export"),r=require("../internals/fails"),t=require("../internals/object-get-own-property-names-external").f,n=r(function(){return!Object.getOwnPropertyNames(1)});e({target:"Object",stat:!0,forced:n},{getOwnPropertyNames:t});
},{"../internals/export":"EhLp","../internals/fails":"HhtF","../internals/object-get-own-property-names-external":"PAJh"}],"E0pf":[function(require,module,exports) {
var e=require("../internals/export"),t=require("../internals/fails"),r=require("../internals/to-object"),n=require("../internals/object-get-prototype-of"),o=require("../internals/correct-prototype-getter"),i=t(function(){n(1)});e({target:"Object",stat:!0,forced:i,sham:!o},{getPrototypeOf:function(e){return n(r(e))}});
},{"../internals/export":"EhLp","../internals/fails":"HhtF","../internals/to-object":"jvja","../internals/object-get-prototype-of":"wKQH","../internals/correct-prototype-getter":"ffM1"}],"yNvY":[function(require,module,exports) {
module.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t};
},{}],"mSFo":[function(require,module,exports) {
var e=require("../internals/export"),r=require("../internals/same-value");e({target:"Object",stat:!0},{is:r});
},{"../internals/export":"EhLp","../internals/same-value":"yNvY"}],"vIvw":[function(require,module,exports) {
var e=require("../internals/export"),t=require("../internals/fails"),r=require("../internals/is-object"),i=Object.isExtensible,n=t(function(){i(1)});e({target:"Object",stat:!0,forced:n},{isExtensible:function(e){return!!r(e)&&(!i||i(e))}});
},{"../internals/export":"EhLp","../internals/fails":"HhtF","../internals/is-object":"QYQv"}],"rOzw":[function(require,module,exports) {
var e=require("../internals/export"),r=require("../internals/fails"),t=require("../internals/is-object"),n=Object.isFrozen,i=r(function(){n(1)});e({target:"Object",stat:!0,forced:i},{isFrozen:function(e){return!t(e)||!!n&&n(e)}});
},{"../internals/export":"EhLp","../internals/fails":"HhtF","../internals/is-object":"QYQv"}],"Re6R":[function(require,module,exports) {
var e=require("../internals/export"),r=require("../internals/fails"),t=require("../internals/is-object"),i=Object.isSealed,n=r(function(){i(1)});e({target:"Object",stat:!0,forced:n},{isSealed:function(e){return!t(e)||!!i&&i(e)}});
},{"../internals/export":"EhLp","../internals/fails":"HhtF","../internals/is-object":"QYQv"}],"RyzE":[function(require,module,exports) {
var e=require("../internals/export"),r=require("../internals/to-object"),t=require("../internals/object-keys"),n=require("../internals/fails"),i=n(function(){t(1)});e({target:"Object",stat:!0,forced:i},{keys:function(e){return t(r(e))}});
},{"../internals/export":"EhLp","../internals/to-object":"jvja","../internals/object-keys":"tzYM","../internals/fails":"HhtF"}],"csZT":[function(require,module,exports) {
var e=require("../internals/export"),r=require("../internals/is-object"),n=require("../internals/internal-metadata").onFreeze,t=require("../internals/freezing"),i=require("../internals/fails"),a=Object.preventExtensions,s=i(function(){a(1)});e({target:"Object",stat:!0,forced:s,sham:!t},{preventExtensions:function(e){return a&&r(e)?a(n(e)):e}});
},{"../internals/export":"EhLp","../internals/is-object":"QYQv","../internals/internal-metadata":"KMcc","../internals/freezing":"x4c7","../internals/fails":"HhtF"}],"gwNw":[function(require,module,exports) {
var e=require("../internals/export"),r=require("../internals/is-object"),n=require("../internals/internal-metadata").onFreeze,t=require("../internals/freezing"),a=require("../internals/fails"),i=Object.seal,s=a(function(){i(1)});e({target:"Object",stat:!0,forced:s,sham:!t},{seal:function(e){return i&&r(e)?i(n(e)):e}});
},{"../internals/export":"EhLp","../internals/is-object":"QYQv","../internals/internal-metadata":"KMcc","../internals/freezing":"x4c7","../internals/fails":"HhtF"}],"AIRV":[function(require,module,exports) {
var t=require("../internals/export"),e=require("../internals/object-set-prototype-of");t({target:"Object",stat:!0},{setPrototypeOf:e});
},{"../internals/export":"EhLp","../internals/object-set-prototype-of":"nEq4"}],"xilW":[function(require,module,exports) {
var e=require("../internals/export"),r=require("../internals/object-to-array").values;e({target:"Object",stat:!0},{values:function(e){return r(e)}});
},{"../internals/export":"EhLp","../internals/object-to-array":"x9Jf"}],"aqUy":[function(require,module,exports) {
"use strict";var t=require("../internals/to-string-tag-support"),r=require("../internals/classof");module.exports=t?{}.toString:function(){return"[object "+r(this)+"]"};
},{"../internals/to-string-tag-support":"YSRT","../internals/classof":"ENb8"}],"u3I1":[function(require,module,exports) {
var e=require("../internals/to-string-tag-support"),r=require("../internals/redefine"),t=require("../internals/object-to-string");e||r(Object.prototype,"toString",t,{unsafe:!0});
},{"../internals/to-string-tag-support":"YSRT","../internals/redefine":"PceW","../internals/object-to-string":"aqUy"}],"ASuk":[function(require,module,exports) {

"use strict";var e=require("../internals/is-pure"),r=require("../internals/global"),n=require("../internals/fails");module.exports=e||!n(function(){var e=Math.random();__defineSetter__.call(null,e,function(){}),delete r[e]});
},{"../internals/is-pure":"pi8Y","../internals/global":"RdwD","../internals/fails":"HhtF"}],"GLJW":[function(require,module,exports) {
"use strict";var e=require("../internals/export"),r=require("../internals/descriptors"),t=require("../internals/object-prototype-accessors-forced"),i=require("../internals/to-object"),n=require("../internals/a-function"),o=require("../internals/object-define-property");r&&e({target:"Object",proto:!0,forced:t},{__defineGetter__:function(e,r){o.f(i(this),e,{get:n(r),enumerable:!0,configurable:!0})}});
},{"../internals/export":"EhLp","../internals/descriptors":"r2hA","../internals/object-prototype-accessors-forced":"ASuk","../internals/to-object":"jvja","../internals/a-function":"aHwm","../internals/object-define-property":"lxmH"}],"CzAG":[function(require,module,exports) {
"use strict";var e=require("../internals/export"),r=require("../internals/descriptors"),t=require("../internals/object-prototype-accessors-forced"),i=require("../internals/to-object"),n=require("../internals/a-function"),o=require("../internals/object-define-property");r&&e({target:"Object",proto:!0,forced:t},{__defineSetter__:function(e,r){o.f(i(this),e,{set:n(r),enumerable:!0,configurable:!0})}});
},{"../internals/export":"EhLp","../internals/descriptors":"r2hA","../internals/object-prototype-accessors-forced":"ASuk","../internals/to-object":"jvja","../internals/a-function":"aHwm","../internals/object-define-property":"lxmH"}],"zvUg":[function(require,module,exports) {
"use strict";var e=require("../internals/export"),r=require("../internals/descriptors"),t=require("../internals/object-prototype-accessors-forced"),o=require("../internals/to-object"),i=require("../internals/to-primitive"),n=require("../internals/object-get-prototype-of"),s=require("../internals/object-get-own-property-descriptor").f;r&&e({target:"Object",proto:!0,forced:t},{__lookupGetter__:function(e){var r,t=o(this),c=i(e,!0);do{if(r=s(t,c))return r.get}while(t=n(t))}});
},{"../internals/export":"EhLp","../internals/descriptors":"r2hA","../internals/object-prototype-accessors-forced":"ASuk","../internals/to-object":"jvja","../internals/to-primitive":"rm5K","../internals/object-get-prototype-of":"wKQH","../internals/object-get-own-property-descriptor":"NkfH"}],"oeyk":[function(require,module,exports) {
"use strict";var e=require("../internals/export"),r=require("../internals/descriptors"),t=require("../internals/object-prototype-accessors-forced"),o=require("../internals/to-object"),i=require("../internals/to-primitive"),n=require("../internals/object-get-prototype-of"),s=require("../internals/object-get-own-property-descriptor").f;r&&e({target:"Object",proto:!0,forced:t},{__lookupSetter__:function(e){var r,t=o(this),c=i(e,!0);do{if(r=s(t,c))return r.set}while(t=n(t))}});
},{"../internals/export":"EhLp","../internals/descriptors":"r2hA","../internals/object-prototype-accessors-forced":"ASuk","../internals/to-object":"jvja","../internals/to-primitive":"rm5K","../internals/object-get-prototype-of":"wKQH","../internals/object-get-own-property-descriptor":"NkfH"}],"rVZw":[function(require,module,exports) {

var r=require("../internals/global"),e=require("../internals/set-to-string-tag");e(r.JSON,"JSON",!0);
},{"../internals/global":"RdwD","../internals/set-to-string-tag":"F3Dn"}],"oGvx":[function(require,module,exports) {
var t=require("../internals/set-to-string-tag");t(Math,"Math",!0);
},{"../internals/set-to-string-tag":"F3Dn"}],"OuqS":[function(require,module,exports) {

var e=require("../internals/export"),r=require("../internals/global"),t=require("../internals/set-to-string-tag");e({global:!0},{Reflect:{}}),t(r.Reflect,"Reflect",!0);
},{"../internals/export":"EhLp","../internals/global":"RdwD","../internals/set-to-string-tag":"F3Dn"}],"KgB8":[function(require,module,exports) {
require("../../modules/es.symbol"),require("../../modules/es.object.assign"),require("../../modules/es.object.create"),require("../../modules/es.object.define-property"),require("../../modules/es.object.define-properties"),require("../../modules/es.object.entries"),require("../../modules/es.object.freeze"),require("../../modules/es.object.from-entries"),require("../../modules/es.object.get-own-property-descriptor"),require("../../modules/es.object.get-own-property-descriptors"),require("../../modules/es.object.get-own-property-names"),require("../../modules/es.object.get-prototype-of"),require("../../modules/es.object.is"),require("../../modules/es.object.is-extensible"),require("../../modules/es.object.is-frozen"),require("../../modules/es.object.is-sealed"),require("../../modules/es.object.keys"),require("../../modules/es.object.prevent-extensions"),require("../../modules/es.object.seal"),require("../../modules/es.object.set-prototype-of"),require("../../modules/es.object.values"),require("../../modules/es.object.to-string"),require("../../modules/es.object.define-getter"),require("../../modules/es.object.define-setter"),require("../../modules/es.object.lookup-getter"),require("../../modules/es.object.lookup-setter"),require("../../modules/es.json.to-string-tag"),require("../../modules/es.math.to-string-tag"),require("../../modules/es.reflect.to-string-tag");var e=require("../../internals/path");module.exports=e.Object;
},{"../../modules/es.symbol":"sqCU","../../modules/es.object.assign":"mWsU","../../modules/es.object.create":"YR5Y","../../modules/es.object.define-property":"Vnau","../../modules/es.object.define-properties":"lIg2","../../modules/es.object.entries":"R1US","../../modules/es.object.freeze":"Iini","../../modules/es.object.from-entries":"I2fa","../../modules/es.object.get-own-property-descriptor":"rKE0","../../modules/es.object.get-own-property-descriptors":"eC8C","../../modules/es.object.get-own-property-names":"ckSq","../../modules/es.object.get-prototype-of":"E0pf","../../modules/es.object.is":"mSFo","../../modules/es.object.is-extensible":"vIvw","../../modules/es.object.is-frozen":"rOzw","../../modules/es.object.is-sealed":"Re6R","../../modules/es.object.keys":"RyzE","../../modules/es.object.prevent-extensions":"csZT","../../modules/es.object.seal":"gwNw","../../modules/es.object.set-prototype-of":"AIRV","../../modules/es.object.values":"xilW","../../modules/es.object.to-string":"u3I1","../../modules/es.object.define-getter":"GLJW","../../modules/es.object.define-setter":"CzAG","../../modules/es.object.lookup-getter":"zvUg","../../modules/es.object.lookup-setter":"oeyk","../../modules/es.json.to-string-tag":"rVZw","../../modules/es.math.to-string-tag":"oGvx","../../modules/es.reflect.to-string-tag":"OuqS","../../internals/path":"FSlT"}],"RCMJ":[function(require,module,exports) {
"use strict";var n=require("../internals/a-function"),t=require("../internals/is-object"),r=[].slice,e={},i=function(n,t,r){if(!(t in e)){for(var i=[],o=0;o<t;o++)i[o]="a["+o+"]";e[t]=Function("C,a","return new C("+i.join(",")+")")}return e[t](n,r)};module.exports=Function.bind||function(e){var o=n(this),a=r.call(arguments,1),c=function(){var n=a.concat(r.call(arguments));return this instanceof c?i(o,n.length,n):o.apply(e,n)};return t(o.prototype)&&(c.prototype=o.prototype),c};
},{"../internals/a-function":"aHwm","../internals/is-object":"QYQv"}],"v828":[function(require,module,exports) {
var n=require("../internals/export"),r=require("../internals/function-bind");n({target:"Function",proto:!0},{bind:r});
},{"../internals/export":"EhLp","../internals/function-bind":"RCMJ"}],"f0G1":[function(require,module,exports) {
var r=require("../internals/descriptors"),t=require("../internals/object-define-property").f,e=Function.prototype,n=e.toString,i=/^\s*function ([^ (]*)/,c="name";!r||c in e||t(e,c,{configurable:!0,get:function(){try{return n.call(this).match(i)[1]}catch(r){return""}}});
},{"../internals/descriptors":"r2hA","../internals/object-define-property":"lxmH"}],"r1vU":[function(require,module,exports) {
"use strict";var e=require("../internals/is-object"),t=require("../internals/object-define-property"),r=require("../internals/object-get-prototype-of"),n=require("../internals/well-known-symbol"),i=n("hasInstance"),o=Function.prototype;i in o||t.f(o,i,{value:function(t){if("function"!=typeof this||!e(t))return!1;if(!e(this.prototype))return t instanceof this;for(;t=r(t);)if(this.prototype===t)return!0;return!1}});
},{"../internals/is-object":"QYQv","../internals/object-define-property":"lxmH","../internals/object-get-prototype-of":"wKQH","../internals/well-known-symbol":"sPFN"}],"CEqO":[function(require,module,exports) {
require("../../modules/es.function.bind"),require("../../modules/es.function.name"),require("../../modules/es.function.has-instance");var e=require("../../internals/path");module.exports=e.Function;
},{"../../modules/es.function.bind":"v828","../../modules/es.function.name":"f0G1","../../modules/es.function.has-instance":"r1vU","../../internals/path":"FSlT"}],"oh18":[function(require,module,exports) {
"use strict";function e(){if("undefined"==typeof window&&(window={audioContext:function(){}}),"undefined"==typeof window||window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setInterval(e,1e3/60)}),"undefined"==typeof window||window.cancelAnimationFrame||(window.cancelAnimationFrame=window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(){}),"undefined"!=typeof window&&!window.AudioContext){if(window.webkitAudioContext){var e=window.webkitAudioContext.prototype.decodeAudioData;window.webkitAudioContext.prototype.decodeAudioData=function(o){var i=this;return new Promise(function(n,t){e.call(i,o,n,t)})}}window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext||window.oAudioContext}"undefined"==typeof window||window.devicePixelRatio||(window.devicePixelRatio=window.devicePixelRatio||1)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.polyfill=e,require("core-js/es/array"),require("core-js/es/object"),require("core-js/es/function");
},{"core-js/es/array":"I7hB","core-js/es/object":"KgB8","core-js/es/function":"CEqO"}],"JzY1":[function(require,module,exports) {
"use strict";function e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function n(e,n){for(var r=0;r<n.length;r++){var t=n[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function r(e,r,t){return r&&n(e.prototype,r),t&&n(e,t),e}var t,o;Object.defineProperty(exports,"__esModule",{value:!0}),exports.Flags=exports.Legacy=exports.Experiments=void 0,exports.Experiments=t,function(e){e.WebGL="use-webgl"}(t||(exports.Experiments=t={})),exports.Legacy=o,function(e){e.LegacyDrawing="use-legacy-drawing"}(o||(exports.Legacy=o={}));var a=function(){function n(){e(this,n)}return r(n,null,[{key:"freeze",value:function(){n._FROZEN=!0}},{key:"_reset",value:function(){n._FROZEN=!1,n._FLAGS={}}},{key:"enable",value:function(e){if(this._FROZEN)throw Error("Feature flags can only be enabled before Engine constructor time");n._FLAGS[e]=!0}},{key:"disable",value:function(e){if(this._FROZEN)throw Error("Feature flags can only be disabled before Engine constructor time");n._FLAGS[e]=!1}},{key:"isEnabled",value:function(e){return!!n._FLAGS[e]}},{key:"show",value:function(){return Object.keys(n._FLAGS)}}]),n}();exports.Flags=a,a._FROZEN=!1,a._FLAGS={};
},{}],"p1Gn":[function(require,module,exports) {
"use strict";function e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function n(e,n){for(var o=0;o<n.length;o++){var r=n[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,o,r){return o&&n(e.prototype,o),r&&n(e,r),e}var r;Object.defineProperty(exports,"__esModule",{value:!0}),exports.ScreenAppender=exports.ConsoleAppender=exports.Logger=exports.LogLevel=void 0,exports.LogLevel=r,function(e){e[e.Debug=0]="Debug",e[e.Info=1]="Info",e[e.Warn=2]="Warn",e[e.Error=3]="Error",e[e.Fatal=4]="Fatal"}(r||(exports.LogLevel=r={}));var t=function(){function n(){if(e(this,n),this._appenders=[],this.defaultLevel=r.Info,n._INSTANCE)throw new Error("Logger is a singleton");return n._INSTANCE=this,n._INSTANCE.addAppender(new a),n._INSTANCE}return o(n,[{key:"addAppender",value:function(e){this._appenders.push(e)}},{key:"clearAppenders",value:function(){this._appenders.length=0}},{key:"_log",value:function(e,n){null==e&&(e=this.defaultLevel);for(var o=this._appenders.length,r=0;r<o;r++)e>=this.defaultLevel&&this._appenders[r].log(e,n)}},{key:"debug",value:function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];this._log(r.Debug,n)}},{key:"info",value:function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];this._log(r.Info,n)}},{key:"warn",value:function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];this._log(r.Warn,n)}},{key:"error",value:function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];this._log(r.Error,n)}},{key:"fatal",value:function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];this._log(r.Fatal,n)}}],[{key:"getInstance",value:function(){return null==n._INSTANCE&&(n._INSTANCE=new n),n._INSTANCE}}]),n}();exports.Logger=t,t._INSTANCE=null;var a=function(){function n(){e(this,n)}return o(n,[{key:"log",value:function(e,n){if(console||console.log||!console.warn||!console.error){var o=[];o.unshift.apply(o,n),o.unshift("["+r[e]+"] : "),e<r.Warn?console.log.apply?console.log.apply(console,o):console.log(o.join(" ")):e<r.Error?console.warn.apply?console.warn.apply(console,o):console.warn(o.join(" ")):console.error.apply?console.error.apply(console,o):console.error(o.join(" "))}}}]),n}();exports.ConsoleAppender=a;var s=function(){function n(o,r){e(this,n),this._messages=[],this._canvas=document.createElement("canvas"),this._canvas.width=o||window.innerWidth,this._canvas.height=r||window.innerHeight,this._canvas.style.position="absolute",this._ctx=this._canvas.getContext("2d"),document.body.appendChild(this._canvas)}return o(n,[{key:"log",value:function(e,n){var o=n.join(",");this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._messages.unshift("["+r[e]+"] : "+o);for(var t=10,a=1,s=0;s<this._messages.length;s++)this._ctx.fillStyle="rgba(255,255,255,"+a.toFixed(2)+")",this._ctx.fillText(this._messages[s],200,t),t+=10,a=a>0?a-.05:0}}]),n}();exports.ScreenAppender=s;
},{}],"yYMg":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Random=void 0;var n=4294967295,s=function(){function e(i){t(this,e),this.seed=i,this._lowerMask=2147483647,this._upperMask=2147483648,this._w=32,this._n=624,this._m=397,this._a=2567483615,this._u=11,this._s=7,this._b=2636928640,this._t=15,this._c=4022730752,this._l=18,this._f=1812433253,this._mt=new Array(this._n),this._mt[0]=(i||Date.now())>>>0;for(var n=1;n<this._n;n++){var s=this._mt[n-1]^this._mt[n-1]>>>this._w-2;this._mt[n]=(this._f*((4294901760&s)>>>16)<<16)+this._f*(65535&s)+n>>>0}this._index=this._n}return i(e,[{key:"_twist",value:function(){for(var t=[0,this._a],e=0,i=0;i<this._n-this._m;i++)e=this._mt[i]&this._upperMask|this._mt[i+1]&this._lowerMask,this._mt[i]=this._mt[i+this._m]^e>>>1^t[1&e]&n;for(;i<this._n-1;i++)e=this._mt[i]&this._upperMask|this._mt[i+1]&this._lowerMask,this._mt[i]=this._mt[i+(this._m-this._n)]^e>>>1^t[1&e]&n;e=this._mt[this._n-1]&this._upperMask|this._mt[0]&this._lowerMask,this._mt[this._n-1]=this._mt[this._m-1]^e>>>1^t[1&e]&n,this._index=0}},{key:"nextInt",value:function(){this._index>=this._n&&this._twist();var t=this._mt[this._index++];return t^=t>>>this._u,t^=t<<this._s&this._b,t^=t<<this._t&this._c,(t^=t>>>this._l)>>>0}},{key:"next",value:function(){return this.nextInt()*(1/4294967296)}},{key:"floating",value:function(t,e){return(e-t)*this.next()+t}},{key:"integer",value:function(t,e){return Math.floor((e-t+1)*this.next()+t)}},{key:"bool",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5;return this.next()<=t}},{key:"pickOne",value:function(t){return t[this.integer(0,t.length-1)]}},{key:"pickSet",value:function(t,e){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?this._pickSetWithDuplicates(t,e):this._pickSetWithoutDuplicates(t,e)}},{key:"_pickSetWithoutDuplicates",value:function(t,e){if(e>t.length||e<0)throw new Error("Invalid number of elements to pick, must pick a value 0 < n <= length");if(e===t.length)return t;for(var i=new Array(e),n=0,s=t.slice(0);n<e;){var r=this.integer(0,s.length-1);i[n++]=s[r],s.splice(r,1)}return i}},{key:"_pickSetWithDuplicates",value:function(t,e){if(e<0)throw new Error("Invalid number of elements to pick, must pick a value 0 <= n < MAX_INT");for(var i=new Array(e),n=0;n<e;n++)i[n]=this.pickOne(t);return i}},{key:"shuffle",value:function(t){for(var e=t.slice(0),i=null,n=0;n<e.length-2;n++){var s=this.integer(n,e.length-1);i=e[n],e[n]=e[s],e[s]=i}return e}},{key:"range",value:function(t,e,i){for(var n=new Array(t),s=0;s<t;s++)n[s]=this.integer(e,i);return n}},{key:"d4",value:function(){return this.integer(1,4)}},{key:"d6",value:function(){return this.integer(1,6)}},{key:"d8",value:function(){return this.integer(1,8)}},{key:"d10",value:function(){return this.integer(1,10)}},{key:"d12",value:function(){return this.integer(1,12)}},{key:"d20",value:function(){return this.integer(1,20)}}]),e}();exports.Random=s;
},{}],"YM02":[function(require,module,exports) {
"use strict";var e;Object.defineProperty(exports,"__esModule",{value:!0}),exports.Side=void 0,exports.Side=e,function(e){e.None="None",e.Top="Top",e.Bottom="Bottom",e.Left="Left",e.Right="Right"}(e||(exports.Side=e={}));
},{}],"Kkda":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.extend=u,exports.base64Encode=s,exports.nullish=l,exports.clamp=c,exports.randomInRange=f,exports.randomIntInRange=h,exports.canonicalizeAngle=d,exports.toDegrees=v,exports.toRadians=p,exports.getPosition=y,exports.addItemToArray=A,exports.removeItemFromArray=_,exports.contains=g,exports.getOppositeSide=m,exports.getSideFromDirection=x,exports.fail=S,exports.delay=b,exports.range=exports.Collection=exports.TwoPI=void 0;var t=require("../Algebra"),e=require("../Math/Random"),r=require("../Collision/Side");function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t,e,r){return e&&i(t.prototype,e),r&&i(t,r),t}var a=2*Math.PI;function u(){var t={},e=!1,r=0,n=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(e=arguments[0],r++);var i="function"==typeof Object.assign,o=null;for(o=i?Object.assign:function(r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e&&"[object Object]"===Object.prototype.toString.call(r[n])?t[n]=u(!0,t[n],r[n]):t[n]=r[n])};r<n;r++){var a=arguments[r];i?o(t,a):o(a)}return t}function s(t){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r="",n=0;n<t.length;){var i=255&t.charCodeAt(n++),o=255&t.charCodeAt(n++),a=255&t.charCodeAt(n++),u=i>>2,s=(3&i)<<4|o>>4,l=void 0,c=void 0;isNaN(o)?l=c=64:(l=(15&o)<<2|a>>6,c=isNaN(a)?64:63&a),r+=e.charAt(u)+e.charAt(s)+e.charAt(l)+e.charAt(c)}return r}function l(t,e){return null!=t?t:e}function c(t,e,r){return Math.min(Math.max(e,t),r)}function f(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new e.Random;return n?n.floating(t,r):t+Math.random()*(r-t)}function h(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new e.Random;return n?n.integer(t,r):Math.round(f(t,r))}function d(t){var e=t;if(t>a)for(;e>a;)e-=a;if(t<0)for(;e<0;)e+=a;return e}function v(t){return 180/Math.PI*t}function p(t){return t/180*Math.PI}function y(e){var r=0,n=0;return function t(e){r+=e.offsetLeft,e.offsetParent&&t(e.offsetParent)}(e),function t(e){n+=e.offsetTop,e.offsetParent&&t(e.offsetParent)}(e),new t.Vector(r,n)}function A(t,e){return-1===e.indexOf(t)&&(e.push(t),!0)}function _(t,e){var r;return(r=e.indexOf(t))>-1&&(e.splice(r,1),!0)}function g(t,e){for(var r=0;r<t.length;r++)if(t[r]===e)return!0;return!1}function m(t){return t===r.Side.Top?r.Side.Bottom:t===r.Side.Bottom?r.Side.Top:t===r.Side.Left?r.Side.Right:t===r.Side.Right?r.Side.Left:r.Side.None}function x(e){for(var n=[t.Vector.Left,t.Vector.Right,t.Vector.Up,t.Vector.Down],i=[r.Side.Left,r.Side.Right,r.Side.Top,r.Side.Bottom],o=-Number.MAX_VALUE,a=-1,u=0;u<n.length;u++)n[u].dot(e)>o&&(o=n[u].dot(e),a=u);return i[a]}exports.TwoPI=a;var P=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.DefaultSize;n(this,t),this._internalArray=null,this._endPointer=0,this._internalArray=new Array(e)}return o(t,[{key:"_resize",value:function(){for(var t=2*this._internalArray.length,e=new Array(t),r=this.count(),n=0;n<r;n++)e[n]=this._internalArray[n];delete this._internalArray,this._internalArray=e}},{key:"push",value:function(t){return this._endPointer===this._internalArray.length&&this._resize(),this._internalArray[this._endPointer++]=t}},{key:"pop",value:function(){return this._endPointer=this._endPointer-1<0?0:this._endPointer-1,this._internalArray[this._endPointer]}},{key:"count",value:function(){return this._endPointer}},{key:"clear",value:function(){this._endPointer=0}},{key:"internalSize",value:function(){return this._internalArray.length}},{key:"elementAt",value:function(t){if(t>=this.count())throw new Error("Invalid index "+t);return this._internalArray[t]}},{key:"insert",value:function(t,e){return t>=this.count()&&this._resize(),this._internalArray[t]=e}},{key:"remove",value:function(t){var e=this.count();if(0===e)throw new Error("Invalid parameter "+t);for(var r=this._internalArray[t],n=t;n<e;n++)this._internalArray[n]=this._internalArray[n+1];return this._endPointer--,r}},{key:"removeElement",value:function(t){var e=this._internalArray.indexOf(t);this.remove(e)}},{key:"toArray",value:function(){return this._internalArray.slice(0,this._endPointer)}},{key:"forEach",value:function(t){for(var e=0,r=this.count();e<r;e++)t.call(this,this._internalArray[e],e)}},{key:"map",value:function(t){for(var e=this.count(),r=0;r<e;r++)this._internalArray[r]=t.call(this,this._internalArray[r],r)}}]),t}();function S(t){throw new Error(t)}exports.Collection=P,P.DefaultSize=200;var w=function(t,e){return Array.from(new Array(e-t+1),function(e,r){return r+t})};function b(t){return new Promise(function(e){setTimeout(function(){e()},t)})}exports.range=w;
},{"../Algebra":"NGcQ","../Math/Random":"yYMg","../Collision/Side":"YM02"}],"kQDE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.obsolete=v,exports.resetObsoleteCounter=exports.maxMessages=void 0;var t=require("../Flags"),e=require("./Log"),n=require("./Util");function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=f();return function(){var n,r=l(t);if(e){var o=l(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return a(this,n)}}function a(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?i(t):e}function i(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=5;exports.maxMessages=p;var y={},b=function(){for(var t in y)y[t]=0};exports.resetObsoleteCounter=b;var h=function(n,r){var o=t.Flags.isEnabled("suppress-obsolete-message");y[n]<p&&!o&&(e.Logger.getInstance().warn(n),console.trace&&r.showStackTrace&&console.trace()),y[n]++};function v(t){return t=(0,n.extend)({},{message:"This feature will be removed in future versions of Excalibur.",alternateMethod:null,showStackTrack:!1},t),function(e,n,r){if(r&&"function"!=typeof r.value&&"function"!=typeof r.get&&"function"!=typeof r.set)throw new SyntaxError("Only classes/functions/getters/setters can be marked as obsolete");var s="".concat(e.name||"").concat(e.name&&n?".":"").concat(n||""),a="".concat(s," is marked obsolete: ").concat(t.message)+(t.alternateMethod?" Use ".concat(t.alternateMethod," instead"):"");y[a]||(y[a]=0);var i=r?Object.assign({},r):e;return r?r&&r.value?(i.value=function(){return h(a,t),r.value.apply(this,arguments)},i):(r&&r.get&&(i.get=function(){return h(a,t),r.get.apply(this,arguments)}),r&&r.set&&(i.set=function(){return h(a,t),r.set.apply(this,arguments)}),i):function(e){c(r,i);var n=u(r);function r(){o(this,r),h(a,t);for(var e=arguments.length,c=new Array(e),s=0;s<e;s++)c[s]=arguments[s];return n.call.apply(n,[this].concat(c))}return r}()}}
},{"../Flags":"JzY1","./Log":"p1Gn","./Util":"Kkda"}],"NGcQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.vec=y,exports.GlobalCoordinates=exports.Projection=exports.Line=exports.Ray=exports.Vector=void 0;var e=require("./Util/Decorators");function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function i(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var s=function(e,t,n,i){var s,o=arguments.length,u=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)u=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(u=(o<3?s(u):o>3?s(t,n,u):s(t,n))||u);return o>3&&u&&Object.defineProperty(t,n,u),u},o=function(){function e(n,i){t(this,e),this._x=0,this._y=0,this._x=n,this._y=i}return i(e,[{key:"x",get:function(){return this._x},set:function(e){this._x=e}},{key:"y",get:function(){return this._y},set:function(e){this._y=e}},{key:"setTo",value:function(e,t){this.x=e,this.y=t}},{key:"equals",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.001;return Math.abs(this.x-e.x)<=t&&Math.abs(this.y-e.y)<=t}},{key:"distance",value:function(t){return t||(t=e.Zero),Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))}},{key:"magnitude",value:function(){return this.distance()}},{key:"size",get:function(){return this.distance()},set:function(e){var t=this.normalize().scale(e);this.setTo(t.x,t.y)}},{key:"normalize",value:function(){var t=this.distance();return t>0?new e(this.x/t,this.y/t):new e(0,1)}},{key:"average",value:function(e){return this.add(e).scale(.5)}},{key:"scale",value:function(t){return t instanceof e?new e(this.x*t.x,this.y*t.y):new e(this.x*t,this.y*t)}},{key:"add",value:function(t){return new e(this.x+t.x,this.y+t.y)}},{key:"sub",value:function(t){return new e(this.x-t.x,this.y-t.y)}},{key:"addEqual",value:function(e){return this.setTo(this.x+e.x,this.y+e.y),this}},{key:"subEqual",value:function(e){return this.setTo(this.x-e.x,this.y-e.y),this}},{key:"scaleEqual",value:function(e){return this.setTo(this.x*e,this.y*e),this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y}},{key:"cross",value:function(t){return t instanceof e?this.x*t.y-this.y*t.x:"number"==typeof t?new e(t*this.y,-t*this.x):void 0}},{key:"perpendicular",value:function(){return new e(this.y,-this.x)}},{key:"normal",value:function(){return this.perpendicular().normalize()}},{key:"negate",value:function(){return this.scale(-1)}},{key:"toAngle",value:function(){return Math.atan2(this.y,this.x)}},{key:"rotate",value:function(t,n){n||(n=new e(0,0));var i=Math.sin(t),r=Math.cos(t);return new e(r*(this.x-n.x)-i*(this.y-n.y)+n.x,i*(this.x-n.x)+r*(this.y-n.y)+n.y)}},{key:"clone",value:function(){return new e(this.x,this.y)}},{key:"toString",value:function(){return"(".concat(this.x,", ").concat(this.y,")")}}],[{key:"Zero",get:function(){return new e(0,0)}},{key:"One",get:function(){return new e(1,1)}},{key:"Half",get:function(){return new e(.5,.5)}},{key:"Up",get:function(){return new e(0,-1)}},{key:"Down",get:function(){return new e(0,1)}},{key:"Left",get:function(){return new e(-1,0)}},{key:"Right",get:function(){return new e(1,0)}},{key:"fromAngle",value:function(t){return new e(Math.cos(t),Math.sin(t))}},{key:"isValid",value:function(e){return null!=e&&(!isNaN(e.x)&&!isNaN(e.y)&&(e.x!==1/0&&e.y!==1/0&&e.x!==-1/0&&e.y!==-1/0))}},{key:"distance",value:function(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}}]),e}();exports.Vector=o,s([(0,e.obsolete)({message:"will be removed in favour of `.size` in version 0.25.0"})],o.prototype,"magnitude",null);var u=function(){function e(n,i){t(this,e),this.pos=n,this.dir=i.normalize()}return i(e,[{key:"intersect",value:function(e){var t=e.begin.sub(this.pos);if(0===this.dir.cross(e.getSlope())&&0!==t.cross(this.dir))return-1;var n=this.dir.cross(e.getSlope());if(0===n)return-1;var i=t.cross(e.getSlope())/n;if(i>=0){var r=t.cross(this.dir)/n/e.getLength();if(r>=0&&r<=1)return i}return-1}},{key:"getPoint",value:function(e){return this.pos.add(this.dir.scale(e))}}]),e}();exports.Ray=u;var a=function(){function e(n,i){t(this,e),this.begin=n,this.end=i}return i(e,[{key:"slope",get:function(){return(this.end.y-this.begin.y)/(this.end.x-this.begin.x)}},{key:"intercept",get:function(){return this.begin.y-this.slope*this.begin.x}},{key:"normal",value:function(){return this.end.sub(this.begin).normal()}},{key:"getSlope",value:function(){var e=this.begin,t=this.end,n=e.distance(t);return t.sub(e).scale(1/n)}},{key:"getEdge",value:function(){var e=this.begin;return this.end.sub(e)}},{key:"getLength",value:function(){var e=this.begin,t=this.end;return e.distance(t)}},{key:"midpoint",get:function(){return this.begin.add(this.end).scale(.5)}},{key:"flip",value:function(){return new e(this.end,this.begin)}},{key:"distanceToPoint",value:function(e){var t=e.x,n=e.y,i=this.getLength(),r=this.end.y-this.begin.y,s=this.end.x-this.begin.x;return Math.abs(r*t-s*n+this.end.x*this.begin.y-this.end.y*this.begin.x)/i}},{key:"findVectorToPoint",value:function(e){var t=this.begin.sub(e),n=this.getSlope();return t.sub(n.scale(t.dot(n)))}},{key:"findPoint",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.slope,i=this.intercept;if(null!==e)return new o(e,n*e+i);if(null!==t)return new o((t-i)/n,t);throw new Error("You must provide an X or a Y value")}},{key:"hasPoint",value:function(){var e,t=0;if("number"==typeof arguments[0]&&"number"==typeof arguments[1])e=new o(arguments[0],arguments[1]),t=arguments[2]||0;else{if(!(arguments[0]instanceof o))throw"Could not determine the arguments for Vector.hasPoint";e=arguments[0],t=arguments[1]||0}var n=e.x-this.begin.x,i=e.y-this.begin.y,r=this.end.x-this.begin.x,s=this.end.y-this.begin.y,u=n*s-i*r;return!(Math.abs(u)>t)&&(Math.abs(r)>=Math.abs(s)?r>0?this.begin.x<=e.x&&e.x<=this.end.x:this.end.x<=e.x&&e.x<=this.begin.x:s>0?this.begin.y<=e.y&&e.y<=this.end.y:this.end.y<=e.y&&e.y<=this.begin.y)}}]),e}();exports.Line=a;var h=function(){function e(n,i){t(this,e),this.min=n,this.max=i}return i(e,[{key:"overlaps",value:function(e){return this.max>e.min&&e.max>this.min}},{key:"getOverlap",value:function(e){return this.overlaps(e)?this.max>e.max?e.max-this.min:this.max-e.min:0}}]),e}();exports.Projection=h;var c=function(){function e(n,i,r){t(this,e),this.worldPos=n,this.pagePos=i,this.screenPos=r}return i(e,null,[{key:"fromPagePosition",value:function(t,n,i){var r,s;3===arguments.length?(r=new o(t,n),s=i):((r=t).x,r.y,s=n);var u=s.screen.pageToScreenCoordinates(r);return new e(s.screen.screenToWorldCoordinates(u),r,u)}}]),e}();function y(e,t){return new o(e,t)}exports.GlobalCoordinates=c;
},{"./Util/Decorators":"kQDE"}],"liCD":[function(require,module,exports) {
"use strict";var e;Object.defineProperty(exports,"__esModule",{value:!0}),exports.CollisionType=void 0,exports.CollisionType=e,function(e){e.PreventCollision="PreventCollision",e.Passive="Passive",e.Active="Active",e.Fixed="Fixed"}(e||(exports.CollisionType=e={}));
},{}],"uSEN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Physics=exports.Integrator=exports.BroadphaseStrategy=exports.CollisionResolutionStrategy=void 0;var e=require("./Algebra"),o=require("./Util/Decorators");function t(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}function r(e,o){for(var t=0;t<o.length;t++){var r=o[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,o,t){return o&&r(e.prototype,o),t&&r(e,t),e}function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var l,s,a,c=function(e,o,t,r){var i,l=arguments.length,s=l<3?o:null===r?r=Object.getOwnPropertyDescriptor(o,t):r;if("object"===("undefined"==typeof Reflect?"undefined":n(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,o,t,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(l<3?i(s):l>3?i(o,t,s):i(o,t))||s);return l>3&&s&&Object.defineProperty(o,t,s),s};exports.CollisionResolutionStrategy=l,function(e){e[e.Box=0]="Box",e[e.RigidBody=1]="RigidBody"}(l||(exports.CollisionResolutionStrategy=l={})),exports.BroadphaseStrategy=s,function(e){e[e.Naive=0]="Naive",e[e.DynamicAABBTree=1]="DynamicAABBTree"}(s||(exports.BroadphaseStrategy=s={})),exports.Integrator=a,function(e){e[e.Euler=0]="Euler"}(a||(exports.Integrator=a={}));var u=function(){function e(){t(this,e)}return i(e,null,[{key:"useBoxPhysics",value:function(){e.collisionResolutionStrategy=l.Box}},{key:"useRigidBodyPhysics",value:function(){e.collisionResolutionStrategy=l.RigidBody}},{key:"dynamicTreeVelocityMultiplyer",get:function(){return e.dynamicTreeVelocityMultiplier},set:function(o){e.dynamicTreeVelocityMultiplier=o}}]),e}();exports.Physics=u,u.acc=new e.Vector(0,0),u.enabled=!0,u.collisionPasses=5,u.broadphaseStrategy=s.DynamicAABBTree,u.broadphaseDebug=!1,u.showCollisionNormals=!1,u.showMotionVectors=!1,u.showBounds=!1,u.showArea=!1,u.showContacts=!1,u.showNormals=!1,u.collisionResolutionStrategy=l.Box,u.defaultMass=10,u.integrator=a.Euler,u.integrationSteps=1,u.allowRigidBodyRotation=!0,u.collisionShift=.001,u.dynamicTreeVelocityMultiplier=2,u.boundsPadding=5,u.surfaceEpsilon=.1,u.checkForFastBodies=!0,u.disableMinimumSpeedForFastBody=!1,c([(0,o.obsolete)({message:"Alias for incorrect spelling used in older versions, will be removed in v0.25.0",alternateMethod:"dynamicTreeVelocityMultiplier"})],u,"dynamicTreeVelocityMultiplyer",null);
},{"./Algebra":"NGcQ","./Util/Decorators":"kQDE"}],"XySq":[function(require,module,exports) {
"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function n(t){var e=a();return function(){var r,n=s(t);if(e){var i=s(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return o(this,r)}}function o(e,r){return!r||"object"!==t(r)&&"function"!=typeof r?i(e):r}function i(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function v(t,e,r){return e&&c(t.prototype,e),r&&c(t,r),t}var l;Object.defineProperty(exports,"__esModule",{value:!0}),exports.ExitTriggerEvent=exports.EnterTriggerEvent=exports.EnterViewPortEvent=exports.ExitViewPortEvent=exports.DeactivateEvent=exports.ActivateEvent=exports.InitializeEvent=exports.CollisionEndEvent=exports.CollisionStartEvent=exports.PostCollisionEvent=exports.PreCollisionEvent=exports.HiddenEvent=exports.VisibleEvent=exports.UnsubscribeEvent=exports.SubscribeEvent=exports.GamepadAxisEvent=exports.GamepadButtonEvent=exports.GamepadDisconnectEvent=exports.GamepadConnectEvent=exports.PostFrameEvent=exports.PreFrameEvent=exports.PostUpdateEvent=exports.PreUpdateEvent=exports.PostDebugDrawEvent=exports.PreDebugDrawEvent=exports.PostDrawEvent=exports.PreDrawEvent=exports.GameStopEvent=exports.GameStartEvent=exports.PostKillEvent=exports.PreKillEvent=exports.KillEvent=exports.GameEvent=exports.EventTypes=void 0,exports.EventTypes=l,function(t){t.Kill="kill",t.PreKill="prekill",t.PostKill="postkill",t.PreDraw="predraw",t.PostDraw="postdraw",t.PreDebugDraw="predebugdraw",t.PostDebugDraw="postdebugdraw",t.PreUpdate="preupdate",t.PostUpdate="postupdate",t.PreFrame="preframe",t.PostFrame="postframe",t.PreCollision="precollision",t.CollisionStart="collisionstart",t.CollisionEnd="collisionend",t.PostCollision="postcollision",t.Initialize="initialize",t.Activate="activate",t.Deactivate="deactivate",t.ExitViewport="exitviewport",t.EnterViewport="enterviewport",t.ExitTrigger="exit",t.EnterTrigger="enter",t.Connect="connect",t.Disconnect="disconnect",t.Button="button",t.Axis="axis",t.Subscribe="subscribe",t.Unsubscribe="unsubscribe",t.Visible="visible",t.Hidden="hidden",t.Start="start",t.Stop="stop",t.PointerUp="pointerup",t.PointerDown="pointerdown",t.PointerMove="pointermove",t.PointerEnter="pointerenter",t.PointerLeave="pointerleave",t.PointerCancel="pointercancel",t.PointerWheel="pointerwheel",t.Up="up",t.Down="down",t.Move="move",t.Enter="enter",t.Leave="leave",t.Cancel="cancel",t.Wheel="wheel",t.Press="press",t.Release="release",t.Hold="hold",t.PointerDragStart="pointerdragstart",t.PointerDragEnd="pointerdragend",t.PointerDragEnter="pointerdragenter",t.PointerDragLeave="pointerdragleave",t.PointerDragMove="pointerdragmove"}(l||(exports.EventTypes=l={}));var p=function(){function t(){u(this,t),this._bubbles=!0}return v(t,[{key:"bubbles",get:function(){return this._bubbles},set:function(t){this._bubbles=t}},{key:"stopPropagation",value:function(){this.bubbles=!1}}]),t}();exports.GameEvent=p;var f=function(t){e(o,p);var r=n(o);function o(t){var e;return u(this,o),(e=r.call(this)).target=t,e}return o}();exports.KillEvent=f;var h=function(t){e(o,p);var r=n(o);function o(t){var e;return u(this,o),(e=r.call(this)).target=t,e}return o}();exports.PreKillEvent=h;var x=function(t){e(o,p);var r=n(o);function o(t){var e;return u(this,o),(e=r.call(this)).target=t,e}return o}();exports.PostKillEvent=x;var E=function(t){e(o,p);var r=n(o);function o(t){var e;return u(this,o),(e=r.call(this)).target=t,e}return o}();exports.GameStartEvent=E;var g=function(t){e(o,p);var r=n(o);function o(t){var e;return u(this,o),(e=r.call(this)).target=t,e}return o}();exports.GameStopEvent=g;var b=function(t){e(o,p);var r=n(o);function o(t,e,n){var i;return u(this,o),(i=r.call(this)).ctx=t,i.delta=e,i.target=n,i}return o}();exports.PreDrawEvent=b;var d=function(t){e(o,p);var r=n(o);function o(t,e,n){var i;return u(this,o),(i=r.call(this)).ctx=t,i.delta=e,i.target=n,i}return o}();exports.PostDrawEvent=d;var P=function(t){e(o,p);var r=n(o);function o(t,e){var n;return u(this,o),(n=r.call(this)).ctx=t,n.target=e,n}return o}();exports.PreDebugDrawEvent=P;var y=function(t){e(o,p);var r=n(o);function o(t,e){var n;return u(this,o),(n=r.call(this)).ctx=t,n.target=e,n}return o}();exports.PostDebugDrawEvent=y;var w=function(t){e(o,p);var r=n(o);function o(t,e,n){var i;return u(this,o),(i=r.call(this)).engine=t,i.delta=e,i.target=n,i}return o}();exports.PreUpdateEvent=w;var m=function(t){e(o,p);var r=n(o);function o(t,e,n){var i;return u(this,o),(i=r.call(this)).engine=t,i.delta=e,i.target=n,i}return o}();exports.PostUpdateEvent=m;var D=function(t){e(o,p);var r=n(o);function o(t,e){var n;return u(this,o),(n=r.call(this)).engine=t,n.prevStats=e,n.target=t,n}return o}();exports.PreFrameEvent=D;var S=function(t){e(o,p);var r=n(o);function o(t,e){var n;return u(this,o),(n=r.call(this)).engine=t,n.stats=e,n.target=t,n}return o}();exports.PostFrameEvent=S;var C=function(t){e(o,p);var r=n(o);function o(t,e){var n;return u(this,o),(n=r.call(this)).index=t,n.gamepad=e,n.target=e,n}return o}();exports.GamepadConnectEvent=C;var G=function(t){e(o,p);var r=n(o);function o(t,e){var n;return u(this,o),(n=r.call(this)).index=t,n.gamepad=e,n.target=e,n}return o}();exports.GamepadDisconnectEvent=G;var _=function(t){e(o,p);var r=n(o);function o(t,e,n){var i;return u(this,o),(i=r.call(this)).button=t,i.value=e,i.target=n,i}return o}();exports.GamepadButtonEvent=_;var O=function(t){e(o,p);var r=n(o);function o(t,e,n){var i;return u(this,o),(i=r.call(this)).axis=t,i.value=e,i.target=n,i}return o}();exports.GamepadAxisEvent=O;var T=function(t){e(o,p);var r=n(o);function o(t,e){var n;return u(this,o),(n=r.call(this)).topic=t,n.handler=e,n}return o}();exports.SubscribeEvent=T;var U=function(t){e(o,p);var r=n(o);function o(t,e){var n;return u(this,o),(n=r.call(this)).topic=t,n.handler=e,n}return o}();exports.UnsubscribeEvent=U;var k=function(t){e(o,p);var r=n(o);function o(t){var e;return u(this,o),(e=r.call(this)).target=t,e}return o}();exports.VisibleEvent=k;var K=function(t){e(o,p);var r=n(o);function o(t){var e;return u(this,o),(e=r.call(this)).target=t,e}return o}();exports.HiddenEvent=K;var V=function(t){e(o,p);var r=n(o);function o(t,e,n,i){var a;return u(this,o),(a=r.call(this)).other=e,a.side=n,a.intersection=i,a.target=t,a}return v(o,[{key:"actor",get:function(){return this.target},set:function(t){this.target=t}}]),o}();exports.PreCollisionEvent=V;var j=function(t){e(o,p);var r=n(o);function o(t,e,n,i){var a;return u(this,o),(a=r.call(this)).other=e,a.side=n,a.intersection=i,a.target=t,a}return v(o,[{key:"actor",get:function(){return this.target},set:function(t){this.target=t}}]),o}();exports.PostCollisionEvent=j;var R=function(t){e(o,p);var r=n(o);function o(t,e,n){var i;return u(this,o),(i=r.call(this)).other=e,i.pair=n,i.target=t,i}return v(o,[{key:"actor",get:function(){return this.target},set:function(t){this.target=t}}]),o}();exports.CollisionStartEvent=R;var A=function(t){e(o,p);var r=n(o);function o(t,e){var n;return u(this,o),(n=r.call(this)).other=e,n.target=t,n}return v(o,[{key:"actor",get:function(){return this.target},set:function(t){this.target=t}}]),o}();exports.CollisionEndEvent=A;var F=function(t){e(o,p);var r=n(o);function o(t,e){var n;return u(this,o),(n=r.call(this)).engine=t,n.target=e,n}return o}();exports.InitializeEvent=F;var B=function(t){e(o,p);var r=n(o);function o(t,e){var n;return u(this,o),(n=r.call(this)).oldScene=t,n.target=e,n}return o}();exports.ActivateEvent=B;var z=function(t){e(o,p);var r=n(o);function o(t,e){var n;return u(this,o),(n=r.call(this)).newScene=t,n.target=e,n}return o}();exports.DeactivateEvent=z;var H=function(t){e(o,p);var r=n(o);function o(t){var e;return u(this,o),(e=r.call(this)).target=t,e}return o}();exports.ExitViewPortEvent=H;var M=function(t){e(o,p);var r=n(o);function o(t){var e;return u(this,o),(e=r.call(this)).target=t,e}return o}();exports.EnterViewPortEvent=M;var I=function(t){e(o,p);var r=n(o);function o(t,e){var n;return u(this,o),(n=r.call(this)).target=t,n.actor=e,n}return o}();exports.EnterTriggerEvent=I;var L=function(t){e(o,p);var r=n(o);function o(t,e){var n;return u(this,o),(n=r.call(this)).target=t,n.actor=e,n}return o}();exports.ExitTriggerEvent=L;
},{}],"p7Gh":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Color=void 0;var t=require("../Util/Decorators");function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function n(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o=function(t,e,r,n){var o,u=arguments.length,s=u<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(u<3?o(s):u>3?o(e,r,s):o(e,r))||s);return u>3&&s&&Object.defineProperty(e,r,s),s},u=function(){function t(r,n,i,o){e(this,t),this.r=r,this.g=n,this.b=i,this.a=null!=o?o:1}return n(t,[{key:"lighten",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1,e=s.fromRGBA(this.r,this.g,this.b,this.a);return e.l+=(1-e.l)*t,e.toRGBA()}},{key:"darken",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1,e=s.fromRGBA(this.r,this.g,this.b,this.a);return e.l-=e.l*t,e.toRGBA()}},{key:"saturate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1,e=s.fromRGBA(this.r,this.g,this.b,this.a);return e.s+=e.s*t,e.toRGBA()}},{key:"desaturate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1,e=s.fromRGBA(this.r,this.g,this.b,this.a);return e.s-=e.s*t,e.toRGBA()}},{key:"multiply",value:function(e){return new t(e.r/255*this.r/255*255,e.g/255*this.g/255*255,e.b/255*this.b/255*255,e.a*this.a)}},{key:"mulitiply",value:function(t){return this.multiply(t)}},{key:"screen",value:function(t){var e=t.invert(),r=t.invert();return e.multiply(r).invert()}},{key:"invert",value:function(){return new t(255-this.r,255-this.g,255-this.b,1-this.a)}},{key:"average",value:function(e){return new t((e.r+this.r)/2,(e.g+this.g)/2,(e.b+this.b)/2,(e.a+this.a)/2)}},{key:"equal",value:function(t){return this.toString()===t.toString()}},{key:"toString",value:function(){switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"rgb"){case"rgb":return this.toRGBA();case"hsl":return this.toHSLA();case"hex":return this.toHex();default:throw new Error("Invalid Color format")}}},{key:"_componentToHex",value:function(t){var e=t.toString(16);return 1===e.length?"0"+e:e}},{key:"toHex",value:function(){return"#"+this._componentToHex(this.r)+this._componentToHex(this.g)+this._componentToHex(this.b)}},{key:"toRGBA",value:function(){var t=String(this.r.toFixed(0))+", "+String(this.g.toFixed(0))+", "+String(this.b.toFixed(0));return void 0!==this.a||null!==this.a?"rgba("+t+", "+String(this.a)+")":"rgb("+t+")"}},{key:"toHSLA",value:function(){return s.fromRGBA(this.r,this.g,this.b,this.a).toString()}},{key:"fillStyle",value:function(){return this.toString()}},{key:"clone",value:function(){return new t(this.r,this.g,this.b,this.a)}}],[{key:"fromRGB",value:function(e,r,n,i){return new t(e,r,n,i)}},{key:"fromRGBString",value:function(e){var r;if(r=e.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)/i)){var n=parseInt(r[1],10),i=parseInt(r[2],10),o=parseInt(r[3],10),u=1;return r[4]&&(u=parseFloat(r[4])),new t(n,i,o,u)}throw new Error("Invalid rgb/a string: "+e)}},{key:"fromHex",value:function(e){var r;if(r=e.match(/^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i)){var n=parseInt(r[1],16),i=parseInt(r[2],16),o=parseInt(r[3],16),u=1;return r[4]&&(u=parseInt(r[4],16)/255),new t(n,i,o,u)}throw new Error("Invalid hex string: "+e)}},{key:"fromHSL",value:function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return new s(t,e,r,n).toRGBA()}},{key:"Black",get:function(){return t.fromHex("#000000")}},{key:"White",get:function(){return t.fromHex("#FFFFFF")}},{key:"Gray",get:function(){return t.fromHex("#808080")}},{key:"LightGray",get:function(){return t.fromHex("#D3D3D3")}},{key:"DarkGray",get:function(){return t.fromHex("#A9A9A9")}},{key:"Yellow",get:function(){return t.fromHex("#FFFF00")}},{key:"Orange",get:function(){return t.fromHex("#FFA500")}},{key:"Red",get:function(){return t.fromHex("#FF0000")}},{key:"Vermilion",get:function(){return t.fromHex("#FF5B31")}},{key:"Vermillion",get:function(){return t.Vermilion}},{key:"Rose",get:function(){return t.fromHex("#FF007F")}},{key:"Magenta",get:function(){return t.fromHex("#FF00FF")}},{key:"Violet",get:function(){return t.fromHex("#7F00FF")}},{key:"Blue",get:function(){return t.fromHex("#0000FF")}},{key:"Azure",get:function(){return t.fromHex("#007FFF")}},{key:"Cyan",get:function(){return t.fromHex("#00FFFF")}},{key:"Viridian",get:function(){return t.fromHex("#59978F")}},{key:"Green",get:function(){return t.fromHex("#00FF00")}},{key:"Chartreuse",get:function(){return t.fromHex("#7FFF00")}},{key:"Transparent",get:function(){return t.fromHex("#FFFFFF00")}},{key:"ExcaliburBlue",get:function(){return t.fromHex("#176BAA")}}]),t}();exports.Color=u,o([(0,t.obsolete)({message:"Alias for incorrect spelling used in older versions, use multiply instead, will be removed in v0.25.0"})],u.prototype,"mulitiply",null),o([(0,t.obsolete)({message:"Alias for incorrect spelling used in older versions",alternateMethod:"Vermilion"})],u,"Vermillion",null);var s=function(){function t(r,n,i,o){e(this,t),this.h=r,this.s=n,this.l=i,this.a=o}return n(t,[{key:"toRGBA",value:function(){var e,r,n;if(0===this.s)e=r=n=this.l;else{var i=this.l<.5?this.l*(1+this.s):this.l+this.s-this.l*this.s,o=2*this.l-i;e=t.hue2rgb(o,i,this.h+1/3),r=t.hue2rgb(o,i,this.h),n=t.hue2rgb(o,i,this.h-1/3)}return new u(255*e,255*r,255*n,this.a)}},{key:"toString",value:function(){var t=this.h.toFixed(0),e=this.s.toFixed(0),r=this.l.toFixed(0),n=this.a.toFixed(0);return"hsla(".concat(t,", ").concat(e,", ").concat(r,", ").concat(n,")")}}],[{key:"hue2rgb",value:function(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+(e-t)*(2/3-r)*6:t}},{key:"fromRGBA",value:function(e,r,n,i){e/=255,r/=255,n/=255;var o,u,s=Math.max(e,r,n),a=Math.min(e,r,n),l=(s+a)/2;if(s===a)o=u=0;else{var f=s-a;switch(u=l>.5?f/(2-s-a):f/(s+a),s){case e:o=(r-n)/f+(r<n?6:0);break;case r:o=(n-e)/f+2;break;case n:o=(e-r)/f+4}o/=6}return new t(o,u,l,i)}}]),t}();
},{"../Util/Decorators":"kQDE"}],"oyna":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BoundingBox=void 0;var t=require("./ConvexPolygon"),e=require("../Algebra"),i=require("../Drawing/Color"),o=require("./Side");function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function s(t,e,i){return e&&h(t.prototype,e),i&&h(t,i),t}var a=function(){function h(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;n(this,h),"object"===r(t)?(this.left=t.left,this.top=t.top,this.right=t.right,this.bottom=t.bottom):"number"==typeof t&&(this.left=t,this.top=e,this.right=i,this.bottom=o)}return s(h,[{key:"width",get:function(){return this.right-this.left}},{key:"height",get:function(){return this.bottom-this.top}},{key:"center",get:function(){return new e.Vector((this.left+this.right)/2,(this.top+this.bottom)/2)}},{key:"translate",value:function(t){return new h(this.left+t.x,this.top+t.y,this.right+t.x,this.bottom+t.y)}},{key:"rotate",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.Vector.Zero,o=this.getPoints().map(function(e){return e.rotate(t,i)});return h.fromPoints(o)}},{key:"scale",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.Vector.Zero,o=this.translate(i);return new h(o.left*t.x,o.top*t.y,o.right*t.x,o.bottom*t.y)}},{key:"transform",value:function(t){var e=this.getPoints().map(function(e){return t.multv(e)});return h.fromPoints(e)}},{key:"getPerimeter",value:function(){return 2*(this.width+this.height)}},{key:"getPoints",value:function(){var t=[];return t.push(new e.Vector(this.left,this.top)),t.push(new e.Vector(this.right,this.top)),t.push(new e.Vector(this.right,this.bottom)),t.push(new e.Vector(this.left,this.bottom)),t}},{key:"toPolygon",value:function(i){var o=null;return i&&i.body&&i.body.collider&&(o=i.body.collider),new t.ConvexPolygon({collider:o,points:this.getPoints(),offset:e.Vector.Zero})}},{key:"rayCast",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,i=-1/0,o=1/0,r=0===t.dir.x?Number.MAX_VALUE:1/t.dir.x,n=0===t.dir.y?Number.MAX_VALUE:1/t.dir.y,h=(this.left-t.pos.x)*r,s=(this.right-t.pos.x)*r;i=Math.min(h,s),o=Math.max(h,s);var a=(this.top-t.pos.y)*n,u=(this.bottom-t.pos.y)*n;return i=Math.max(i,Math.min(a,u)),(o=Math.min(o,Math.max(a,u)))>=Math.max(0,i)&&i<e}},{key:"rayCastTime",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,i=-1/0,o=1/0,r=0===t.dir.x?Number.MAX_VALUE:1/t.dir.x,n=0===t.dir.y?Number.MAX_VALUE:1/t.dir.y,h=(this.left-t.pos.x)*r,s=(this.right-t.pos.x)*r;i=Math.min(h,s),o=Math.max(h,s);var a=(this.top-t.pos.y)*n,u=(this.bottom-t.pos.y)*n;return i=Math.max(i,Math.min(a,u)),(o=Math.min(o,Math.max(a,u)))>=Math.max(0,i)&&i<e?i:-1}},{key:"contains",value:function(t){return t instanceof e.Vector?this.left<=t.x&&this.top<=t.y&&this.bottom>=t.y&&this.right>=t.x:t instanceof h&&(this.left<t.left&&this.top<t.top&&t.bottom<this.bottom&&t.right<this.right)}},{key:"combine",value:function(t){return new h(Math.min(this.left,t.left),Math.min(this.top,t.top),Math.max(this.right,t.right),Math.max(this.bottom,t.bottom))}},{key:"dimensions",get:function(){return new e.Vector(this.width,this.height)}},{key:"intersect",value:function(t){var i=this.combine(t);if(i.width<t.width+this.width&&i.height<t.height+this.height&&!i.dimensions.equals(t.dimensions)&&!i.dimensions.equals(this.dimensions)){var o=0;o=this.right>=t.left&&this.right<=t.right?t.left-this.right:t.right-this.left;var r=0;return r=this.top<=t.bottom&&this.top>=t.top?t.bottom-this.top:t.top-this.bottom,Math.abs(o)<Math.abs(r)?new e.Vector(o,0):new e.Vector(0,r)}if(i.dimensions.equals(t.dimensions)||i.dimensions.equals(this.dimensions)){var n=0;n=this.width-t.width>=0?this.right-t.right<=t.left-this.left?t.left-this.right:t.right-this.left:t.right-this.right<=this.left-t.left?this.left-t.right:this.right-t.left;var h=0;return h=this.height-t.height>=0?this.bottom-t.bottom<=t.top-this.top?t.top-this.bottom:t.bottom-this.top:t.bottom-this.bottom<=this.top-t.top?this.top-t.bottom:this.bottom-t.top,Math.abs(n)<Math.abs(h)?new e.Vector(n,0):new e.Vector(0,h)}return null}},{key:"intersectWithSide",value:function(t){var e=this.intersect(t);return h.getSideFromIntersection(e)}},{key:"debugDraw",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.Color.Yellow;t.strokeStyle=e.toString(),t.strokeRect(this.left,this.top,this.width,this.height)}},{key:"draw",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.Color.Yellow;t.debug.drawRect(this.left,this.top,this.width,this.height,{color:e})}}],[{key:"getSideFromIntersection",value:function(t){return t&&t?Math.abs(t.x)>Math.abs(t.y)?t.x<0?o.Side.Right:o.Side.Left:t.y<0?o.Side.Bottom:o.Side.Top:o.Side.None}},{key:"fromPoints",value:function(t){for(var e=1/0,i=1/0,o=-1/0,r=-1/0,n=0;n<t.length;n++)t[n].x<e&&(e=t[n].x),t[n].x>o&&(o=t[n].x),t[n].y<i&&(i=t[n].y),t[n].y>r&&(r=t[n].y);return new h(e,i,o,r)}},{key:"fromDimension",value:function(t,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.Vector.Half,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.Vector.Zero;return new h(-t*o.x+r.x,-i*o.y+r.y,t-t*o.x+r.x,i-i*o.y+r.y)}}]),h}();exports.BoundingBox=a;
},{"./ConvexPolygon":"EI0S","../Algebra":"NGcQ","../Drawing/Color":"p7Gh","./Side":"YM02"}],"rA38":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CollisionContact=void 0;var i=require("../Algebra"),e=require("../Physics"),o=require("../Events"),l=r(require("../Util/Util")),t=require("./CollisionType");function s(){if("function"!=typeof WeakMap)return null;var i=new WeakMap;return s=function(){return i},i}function r(i){if(i&&i.__esModule)return i;if(null===i||"object"!=typeof i&&"function"!=typeof i)return{default:i};var e=s();if(e&&e.has(i))return e.get(i);var o={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var t in i)if(Object.prototype.hasOwnProperty.call(i,t)){var r=l?Object.getOwnPropertyDescriptor(i,t):null;r&&(r.get||r.set)?Object.defineProperty(o,t,r):o[t]=i[t]}return o.default=i,e&&e.set(i,o),o}function n(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function c(i,e){for(var o=0;o<e.length;o++){var l=e[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(i,l.key,l)}}function d(i,e,o){return e&&c(i.prototype,e),o&&c(i,o),i}var a=function(){function s(i,e,o,l,t){n(this,s),this.colliderA=i,this.colliderB=e,this.mtv=o,this.point=l,this.normal=t}return d(s,[{key:"resolve",value:function(i){if(i===e.CollisionResolutionStrategy.RigidBody)this._resolveRigidBodyCollision();else{if(i!==e.CollisionResolutionStrategy.Box)throw new Error("Unknown collision resolution strategy");this._resolveBoxCollision()}}},{key:"_applyBoxImpulse",value:function(i,e,s){if(i.type===t.CollisionType.Active&&e.type!==t.CollisionType.Passive){i.type===t.CollisionType.Active&&e.type===t.CollisionType.Active&&(s=s.scale(.5)),i.body.pos=i.body.pos.add(s);var r=s.normalize();if(r.dot(i.body.vel)<0){var n=r.scale(r.dot(i.body.vel.negate()));i.body.vel=i.body.vel.add(n)}i.emit("postcollision",new o.PostCollisionEvent(i,e,l.getSideFromDirection(s),s))}}},{key:"_resolveBoxCollision",value:function(){var i=l.getSideFromDirection(this.mtv),e=this.mtv.negate();this.colliderA.emit("precollision",new o.PreCollisionEvent(this.colliderA,this.colliderB,i,e)),this.colliderB.emit("precollision",new o.PreCollisionEvent(this.colliderB,this.colliderA,l.getOppositeSide(i),e.negate())),this._applyBoxImpulse(this.colliderA,this.colliderB,e),this._applyBoxImpulse(this.colliderB,this.colliderA,e.negate())}},{key:"_resolveRigidBodyCollision",value:function(){var s=this.colliderA.body,r=this.colliderB.body,n=this.mtv,c=this.normal;if(s!==r){var d=l.getSideFromDirection(this.mtv);if(this.colliderA.emit("precollision",new o.PreCollisionEvent(this.colliderA,this.colliderB,d,this.mtv)),this.colliderB.emit("precollision",new o.PreCollisionEvent(this.colliderB,this.colliderA,l.getOppositeSide(d),this.mtv.negate())),this.colliderA.type!==t.CollisionType.Passive&&this.colliderB.type!==t.CollisionType.Passive){var a=this.colliderA.type===t.CollisionType.Fixed?0:1/this.colliderA.mass,h=this.colliderB.type===t.CollisionType.Fixed?0:1/this.colliderB.mass,p=this.colliderA.type===t.CollisionType.Fixed?0:1/this.colliderA.inertia,v=this.colliderB.type===t.CollisionType.Fixed?0:1/this.colliderB.inertia,y=Math.min(this.colliderA.bounciness,this.colliderB.bounciness),u=Math.min(this.colliderA.friction,this.colliderB.friction),f=(c=c.normalize()).normal().normalize(),B=this.point.sub(this.colliderA.center),m=this.point.sub(this.colliderB.center),b=r.vel.add(m.cross(-r.rx)).sub(s.vel.sub(B.cross(s.rx))),g=b.dot(c),C=b.dot(f),x=B.dot(f),A=B.dot(c),w=m.dot(f),P=m.dot(c);if(!(g>0)){var R=-(1+y)*g/(a+h+p*x*x+v*w*w);if(this.colliderA.type===t.CollisionType.Fixed?(r.vel=r.vel.add(c.scale(R*h)),e.Physics.allowRigidBodyRotation&&(r.rx-=R*v*-m.cross(c)),r.addMtv(n)):this.colliderB.type===t.CollisionType.Fixed?(s.vel=s.vel.sub(c.scale(R*a)),e.Physics.allowRigidBodyRotation&&(s.rx+=R*p*-B.cross(c)),s.addMtv(n.negate())):(r.vel=r.vel.add(c.scale(R*h)),s.vel=s.vel.sub(c.scale(R*a)),e.Physics.allowRigidBodyRotation&&(r.rx-=R*v*-m.cross(c),s.rx+=R*p*-B.cross(c)),r.addMtv(n.scale(.5)),s.addMtv(n.scale(-.5))),u&&C){var T=b.sub(c.scale(b.dot(c))).normalize(),O=b.dot(T)/(a+h+A*A*p+P*P*v),F=new i.Vector(0,0);F=Math.abs(O)<=R*u?T.scale(O).negate():T.scale(-R*u),this.colliderA.type===t.CollisionType.Fixed?(r.vel=r.vel.add(F.scale(h)),e.Physics.allowRigidBodyRotation&&(r.rx+=F.dot(T)*v*m.cross(T))):this.colliderB.type===t.CollisionType.Fixed?(s.vel=s.vel.sub(F.scale(a)),e.Physics.allowRigidBodyRotation&&(s.rx-=F.dot(T)*p*B.cross(T))):(r.vel=r.vel.add(F.scale(h)),s.vel=s.vel.sub(F.scale(a)),e.Physics.allowRigidBodyRotation&&(r.rx+=F.dot(T)*v*m.cross(T),s.rx-=F.dot(T)*p*B.cross(T)))}this.colliderA.emit("postcollision",new o.PostCollisionEvent(this.colliderA,this.colliderB,d,this.mtv)),this.colliderB.emit("postcollision",new o.PostCollisionEvent(this.colliderB,this.colliderA,l.getOppositeSide(d),this.mtv.negate()))}}}}}]),s}();exports.CollisionContact=a;
},{"../Algebra":"NGcQ","../Physics":"uSEN","../Events":"XySq","../Util/Util":"Kkda","./CollisionType":"liCD"}],"fXkm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CollisionJumpTable=void 0;var e=require("./CollisionContact"),n=require("./ConvexPolygon"),l=require("../Algebra"),t={CollideCircleCircle:function(n,l){var t=n.radius+l.radius,r=n.worldPos,i=l.worldPos;if(r.distance(i)>t)return null;var o=i.sub(r).normalize(),a=o.scale(t-i.distance(r)),s=n.getFurthestPoint(o);return new e.CollisionContact(n.collider,l.collider,a,s,o)},CollideCirclePolygon:function(n,l){var t=n.testSeparatingAxisTheorem(l);if(!t)return null;var r=t.dot(l.center.sub(n.center));t=r<0?t.negate():t;var i=[],o=l.getFurthestPoint(t.negate()),a=n.getFurthestPoint(t);return n.contains(o)&&i.push(o),l.contains(a)&&i.push(a),0===i.length?null:new e.CollisionContact(n.collider,l.collider,t,2===i.length?i[0].average(i[1]):i[0],t.normalize())},CollideCircleEdge:function(n,t){var r=n.center,i=t.end.sub(t.begin),o=i.dot(t.end.sub(r)),a=i.dot(r.sub(t.begin));if(a<=0){var s=t.begin.sub(r),d=s.dot(s);return d>n.radius*n.radius?null:new e.CollisionContact(n.collider,t.collider,s.normalize().scale(n.radius-Math.sqrt(d)),t.begin,s.normalize())}if(o<=0){var c=t.end.sub(r),u=c.dot(c);return u>n.radius*n.radius?null:new e.CollisionContact(n.collider,t.collider,c.normalize().scale(n.radius-Math.sqrt(u)),t.end,c.normalize())}var g=i.dot(i),C=t.begin.scale(o).add(t.end.scale(a)).scale(1/g),b=r.sub(C),v=b.dot(b);if(v>n.radius*n.radius)return null;var h=i.perpendicular();h.dot(r.sub(t.begin))<0&&(h=(0,l.vec)(-h.x,-h.y));var f=(h=h.normalize()).scale(Math.abs(n.radius-Math.sqrt(v)));return new e.CollisionContact(n.collider,t.collider,f.negate(),C,h.negate())},CollideEdgeEdge:function(){return null},CollidePolygonEdge:function(l,t){var r=t.end.sub(t.begin).normal();if(l.contains(t.begin)){var i=l.getClosestFace(t.begin),o=i.distance,a=i.face;if(o)return new e.CollisionContact(l.collider,t.collider,o.negate(),t.begin.add(o.negate()),a.normal().negate())}if(l.contains(t.end)){var s=l.getClosestFace(t.end),d=s.distance,c=s.face;if(d)return new e.CollisionContact(l.collider,t.collider,d.negate(),t.end.add(d.negate()),c.normal().negate())}var u=l.center,g=t.center.sub(u).normalize(),C=new n.ConvexPolygon({collider:t.collider,points:[t.begin,t.end,t.end.add(g.scale(30)),t.begin.add(g.scale(30))]}),b=l.testSeparatingAxisTheorem(C);return b?(r=r.dot(g)<0?r.negate():r,b=b.dot(g)<0?b.negate():b,new e.CollisionContact(l.collider,t.collider,b,l.getFurthestPoint(r),r)):null},CollidePolygonPolygon:function(n,l){var t=n.testSeparatingAxisTheorem(l);if(!t)return null;var r=t.dot(l.center.sub(n.center));t=r<0?t.negate():t;var i=[],o=n.getFurthestPoint(t),a=l.getFurthestPoint(t.negate());l.contains(o)&&i.push(o),n.contains(a)&&i.push(a),0===i.length&&i.push(a);var s=2===i.length?i[0].add(i[1]).scale(.5):i[0];return new e.CollisionContact(n.collider,l.collider,t,s,t.normalize())}};exports.CollisionJumpTable=t;
},{"./CollisionContact":"rA38","./ConvexPolygon":"EI0S","../Algebra":"NGcQ"}],"j4ks":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ClosestLine=a,exports.ClosestLineJumpTable=void 0;var e=require("../Algebra");function a(a,s,r,o){var t=a.sub(r),d=s.dot(s),n=s.dot(o),i=o.dot(o),l=s.dot(t),y=o.dot(t),g=d*i-n*n,u=g,c=g;if(0===g||g<=.01){var w=l/n;return new e.Line(a,r.add(o.scale(w)))}var x=n*y-i*l,C=d*y-n*l;return x<0?(x=0,C=y,c=i):x>u&&(x=u,C=y+n,c=i),C<0?(C=0,-l<0?x=0:-l>d?x=u:(x=-l,u=d)):C>c&&(C=c,-l+n<0?x=0:-l+n>d?x=u:(x=-l+n,u=d)),x=Math.abs(x)<.001?0:x/u,C=Math.abs(C)<.001?0:C/c,new e.Line(a.add(s.scale(x)),r.add(o.scale(C)))}var s={PolygonPolygonClosestLine:function(s,r){var o=r.worldPos,t=o.sub(s.worldPos),d=t.negate(),n=new e.Ray(s.worldPos,t),i=new e.Ray(o,d),l=s.rayCast(n).add(n.dir.scale(.1)),y=r.rayCast(i).add(i.dir.scale(.1)),g=s.getClosestFace(l),u=r.getClosestFace(y);return a(g.face.begin,g.face.getEdge(),u.face.begin,u.face.getEdge())},PolygonEdgeClosestLine:function(s,r){var o=r.worldPos.sub(s.worldPos),t=new e.Ray(s.worldPos,o),d=s.rayCast(t).add(t.dir.scale(.1)),n=s.getClosestFace(d),i=n.face.begin,l=n.face.getEdge(),y=r.asLine();return a(i,l,y.begin,y.getEdge())},PolygonCircleClosestLine:function(a,s){var r=s.worldPos,o=r.sub(a.worldPos),t=new e.Ray(a.worldPos,o.normalize()),d=a.rayCast(t).add(t.dir.scale(.1)),n=a.getClosestFace(d),i=n.face.begin,l=n.face.getEdge(),y=(l.x*(r.x-i.x)+l.y*(r.y-i.y))/(l.x*l.x+l.y*l.y);y>1?y=1:y<0&&(y=0);var g=Math.sqrt(Math.pow(i.x+l.x*y-r.x,2)+Math.pow(i.y+l.y*y-r.y,2))-s.radius,u=(i.x+l.x*y-r.x)*s.radius/(s.radius+g),c=(i.y+l.y*y-r.y)*s.radius/(s.radius+g);return new e.Line(l.scale(y).add(i),new e.Vector(r.x+u,r.y+c))},CircleCircleClosestLine:function(a,s){var r=s.worldPos.sub(a.worldPos),o=a.worldPos.sub(s.worldPos),t=new e.Ray(a.worldPos,r),d=new e.Ray(s.worldPos,o),n=a.rayCast(t),i=s.rayCast(d);return new e.Line(n,i)},CircleEdgeClosestLine:function(a,s){var r=a.worldPos,o=s.asLine(),t=o.begin,d=o.getEdge(),n=(d.x*(r.x-t.x)+d.y*(r.y-t.y))/(d.x*d.x+d.y*d.y);n>1?n=1:n<0&&(n=0);var i=Math.sqrt(Math.pow(t.x+d.x*n-r.x,2)+Math.pow(t.y+d.y*n-r.y,2))-a.radius,l=(t.x+d.x*n-r.x)*a.radius/(a.radius+i),y=(t.y+d.y*n-r.y)*a.radius/(a.radius+i);return new e.Line(d.scale(n).add(t),new e.Vector(r.x+l,r.y+y))},EdgeEdgeClosestLine:function(e,s){var r=e.asLine(),o=r.begin,t=r.getEdge(),d=s.asLine();return a(o,t,d.begin,d.getEdge())}};exports.ClosestLineJumpTable=s;
},{"../Algebra":"NGcQ"}],"xS4a":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Circle=void 0;var e=require("./BoundingBox"),t=require("./CollisionJumpTable"),i=require("./ConvexPolygon"),o=require("./Edge"),r=require("../Algebra"),s=require("../Physics"),n=require("../Drawing/Color"),l=require("./ClosestLineJumpTable");function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t,i){return t&&h(e.prototype,t),i&&h(e,i),e}var f=function(){function h(e){a(this,h),this.offset=r.Vector.Zero,this.offset=e.offset||r.Vector.Zero,this.radius=e.radius||0,this.collider=e.collider||null}return c(h,[{key:"worldPos",get:function(){return this.collider&&this.collider.body?this.collider.body.pos.add(this.offset):this.offset}},{key:"clone",value:function(){return new h({offset:this.offset.clone(),radius:this.radius,collider:null})}},{key:"center",get:function(){return this.collider&&this.collider.body?this.offset.add(this.collider.body.pos):this.offset}},{key:"contains",value:function(e){var t=this.offset;return this.collider&&this.collider.body&&(t=this.collider.body.pos),t.distance(e)<=this.radius}},{key:"rayCast",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,i=this.center,o=e.dir,r=e.pos,s=Math.sqrt(Math.pow(o.dot(r.sub(i)),2)-Math.pow(r.sub(i).distance(),2)+Math.pow(this.radius,2));if(s<0)return null;var n=0;if(0===s)return(n=-o.dot(r.sub(i)))>0&&n<t?e.getPoint(n):null;var l=-o.dot(r.sub(i))+s,u=-o.dot(r.sub(i))-s,a=[];l>=0&&a.push(l),u>=0&&a.push(u);var h=Math.min.apply(Math,a);return h<=t?e.getPoint(h):null}},{key:"getClosestLineBetween",value:function(e){if(e instanceof h)return l.ClosestLineJumpTable.CircleCircleClosestLine(this,e);if(e instanceof i.ConvexPolygon)return l.ClosestLineJumpTable.PolygonCircleClosestLine(e,this).flip();if(e instanceof o.Edge)return l.ClosestLineJumpTable.CircleEdgeClosestLine(this,e).flip();throw new Error("Polygon could not collide with unknown CollisionShape ".concat(u(e)))}},{key:"collide",value:function(e){if(e instanceof h)return t.CollisionJumpTable.CollideCircleCircle(this,e);if(e instanceof i.ConvexPolygon)return t.CollisionJumpTable.CollideCirclePolygon(this,e);if(e instanceof o.Edge)return t.CollisionJumpTable.CollideCircleEdge(this,e);throw new Error("Circle could not collide with unknown CollisionShape ".concat(u(e)))}},{key:"getFurthestPoint",value:function(e){return this.center.add(e.normalize().scale(this.radius))}},{key:"bounds",get:function(){var t=r.Vector.Zero;return this.collider&&this.collider.body&&(t=this.collider.body.pos),new e.BoundingBox(this.offset.x+t.x-this.radius,this.offset.y+t.y-this.radius,this.offset.x+t.x+this.radius,this.offset.y+t.y+this.radius)}},{key:"localBounds",get:function(){return new e.BoundingBox(this.offset.x-this.radius,this.offset.y-this.radius,this.offset.x+this.radius,this.offset.y+this.radius)}},{key:"axes",get:function(){return null}},{key:"inertia",get:function(){return(this.collider?this.collider.mass:s.Physics.defaultMass)*this.radius*this.radius/2}},{key:"testSeparatingAxisTheorem",value:function(e){var t=e.axes,i=e.center,o=e.getFurthestPoint(this.offset.sub(i));t.push(this.offset.sub(o).normalize());for(var r=Number.MAX_VALUE,s=null,n=-1,l=0;l<t.length;l++){var u=e.project(t[l]),a=this.project(t[l]),h=u.getOverlap(a);if(h<=0)return null;h<r&&(r=h,s=t[l],n=l)}return n<0?null:s.normalize().scale(r)}},{key:"recalc",value:function(){}},{key:"project",value:function(e){var t=[],i=this.center.dot(e);return t.push(i),t.push(i+this.radius),t.push(i-this.radius),new r.Projection(Math.min.apply(Math,t),Math.max.apply(Math,t))}},{key:"draw",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.Color.Green,i=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.Vector.Zero).add(this.offset);e.beginPath(),e.fillStyle=t.toString(),e.arc(i.x,i.y,this.radius,0,2*Math.PI),e.closePath(),e.fill()}},{key:"debugDraw",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.Color.Green,i=this.collider.body,o=i?i.pos.add(this.offset):this.offset,r=i?i.rotation:0;e.beginPath(),e.strokeStyle=t.toString(),e.arc(o.x,o.y,this.radius,0,2*Math.PI),e.closePath(),e.stroke(),e.beginPath(),e.moveTo(o.x,o.y),e.lineTo(Math.cos(r)*this.radius+o.x,Math.sin(r)*this.radius+o.y),e.closePath(),e.stroke()}}]),h}();exports.Circle=f;
},{"./BoundingBox":"oyna","./CollisionJumpTable":"fXkm","./ConvexPolygon":"EI0S","./Edge":"s26C","../Algebra":"NGcQ","../Physics":"uSEN","../Drawing/Color":"p7Gh","./ClosestLineJumpTable":"j4ks"}],"s26C":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Edge=void 0;var e=require("./BoundingBox"),n=require("./CollisionJumpTable"),t=require("./Circle"),o=require("./ConvexPolygon"),i=require("../Algebra"),r=require("../Physics"),s=require("../Drawing/Color"),l=require("./ClosestLineJumpTable");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function d(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,n,t){return n&&d(e.prototype,n),t&&d(e,t),e}var h=function(){function d(e){u(this,d),this.begin=e.begin||i.Vector.Zero,this.end=e.end||i.Vector.Zero,this.collider=e.collider||null,this.offset=this.center}return c(d,[{key:"clone",value:function(){return new d({begin:this.begin.clone(),end:this.end.clone(),collider:null})}},{key:"worldPos",get:function(){return this.collider&&this.collider.body?this.collider.body.pos.add(this.offset):this.offset}},{key:"center",get:function(){return this.begin.average(this.end).add(this._getBodyPos())}},{key:"_getBodyPos",value:function(){var e=i.Vector.Zero;return this.collider&&this.collider.body&&(e=this.collider.body.pos),e}},{key:"_getTransformedBegin",value:function(){var e=this.collider?this.collider.body:null,n=e?e.rotation:0;return this.begin.rotate(n).add(this._getBodyPos())}},{key:"_getTransformedEnd",value:function(){var e=this.collider?this.collider.body:null,n=e?e.rotation:0;return this.end.rotate(n).add(this._getBodyPos())}},{key:"getSlope",value:function(){var e=this._getTransformedBegin(),n=this._getTransformedEnd(),t=e.distance(n);return n.sub(e).scale(1/t)}},{key:"getLength",value:function(){var e=this._getTransformedBegin(),n=this._getTransformedEnd();return e.distance(n)}},{key:"contains",value:function(){return!1}},{key:"rayCast",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,t=this._getTransformedBegin().sub(e.pos);if(0===e.dir.cross(this.getSlope())&&0!==t.cross(e.dir))return null;var o=e.dir.cross(this.getSlope());if(0===o)return null;var i=t.cross(this.getSlope())/o;if(i>=0&&i<=n){var r=t.cross(e.dir)/o/this.getLength();if(r>=0&&r<=1)return e.getPoint(i)}return null}},{key:"getClosestLineBetween",value:function(e){if(e instanceof t.Circle)return l.ClosestLineJumpTable.CircleEdgeClosestLine(e,this);if(e instanceof o.ConvexPolygon)return l.ClosestLineJumpTable.PolygonEdgeClosestLine(e,this).flip();if(e instanceof d)return l.ClosestLineJumpTable.EdgeEdgeClosestLine(this,e);throw new Error("Polygon could not collide with unknown CollisionShape ".concat(a(e)))}},{key:"collide",value:function(e){if(e instanceof t.Circle)return n.CollisionJumpTable.CollideCircleEdge(e,this);if(e instanceof o.ConvexPolygon)return n.CollisionJumpTable.CollidePolygonEdge(e,this);if(e instanceof d)return n.CollisionJumpTable.CollideEdgeEdge();throw new Error("Edge could not collide with unknown CollisionShape ".concat(a(e)))}},{key:"getFurthestPoint",value:function(e){var n=this._getTransformedBegin(),t=this._getTransformedEnd();return e.dot(n)>0?n:t}},{key:"_boundsFromBeginEnd",value:function(n,t){return new e.BoundingBox(Math.min(n.x,t.x),Math.min(n.y,t.y),Math.max(n.x,t.x),Math.max(n.y,t.y))}},{key:"bounds",get:function(){var e=this._getTransformedBegin(),n=this._getTransformedEnd();return this._boundsFromBeginEnd(e,n)}},{key:"localBounds",get:function(){return this._boundsFromBeginEnd(this.begin,this.end)}},{key:"asLine",value:function(){return new i.Line(this._getTransformedBegin(),this._getTransformedEnd())}},{key:"asLocalLine",value:function(){return new i.Line(this.begin,this.end)}},{key:"axes",get:function(){var e=this._getTransformedEnd().sub(this._getTransformedBegin()).normal(),n=[];return n.push(e),n.push(e.negate()),n.push(e.normal()),n.push(e.normal().negate()),n}},{key:"inertia",get:function(){var e=this.collider?this.collider.mass:r.Physics.defaultMass,n=this.end.sub(this.begin).distance()/2;return e*n*n}},{key:"recalc",value:function(){}},{key:"project",value:function(e){for(var n=[],t=[this._getTransformedBegin(),this._getTransformedEnd()],o=t.length,r=0;r<o;r++)n.push(t[r].dot(e));return new i.Projection(Math.min.apply(Math,n),Math.max.apply(Math,n))}},{key:"draw",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.Color.Green,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.Vector.Zero,o=this.begin.add(t),r=this.end.add(t);e.strokeStyle=n.toString(),e.beginPath(),e.moveTo(o.x,o.y),e.lineTo(r.x,r.y),e.closePath(),e.stroke()}},{key:"debugDraw",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.Color.Red,t=this._getTransformedBegin(),o=this._getTransformedEnd();e.strokeStyle=n.toString(),e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(o.x,o.y),e.closePath(),e.stroke()}}]),d}();exports.Edge=h;
},{"./BoundingBox":"oyna","./CollisionJumpTable":"fXkm","./Circle":"xS4a","./ConvexPolygon":"EI0S","../Algebra":"NGcQ","../Physics":"uSEN","../Drawing/Color":"p7Gh","./ClosestLineJumpTable":"j4ks"}],"EI0S":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ConvexPolygon=void 0;var e=require("../Drawing/Color"),t=require("../Physics"),o=require("./BoundingBox"),n=require("./Edge"),i=require("./CollisionJumpTable"),s=require("./Circle"),r=require("../Algebra"),l=require("./ClosestLineJumpTable");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(e,t,o){return t&&c(e.prototype,t),o&&c(e,o),e}var f=function(){function c(e){u(this,c),this._transformedPoints=[],this._axes=[],this._sides=[],this.offset=e.offset||r.Vector.Zero;var t=!!e.clockwiseWinding;this.points=(t?e.points.reverse():e.points)||[],this.collider=this.collider=e.collider||null,this._calculateTransformation()}return h(c,[{key:"clone",value:function(){return new c({offset:this.offset.clone(),points:this.points.map(function(e){return e.clone()}),collider:null})}},{key:"worldPos",get:function(){return this.collider&&this.collider.body?this.collider.body.pos.add(this.offset):this.offset}},{key:"center",get:function(){var e=this.collider?this.collider.body:null;return e?e.pos.add(this.offset):this.offset}},{key:"_calculateTransformation",value:function(){var e=this.collider?this.collider.body:null,t=e?e.pos.add(this.offset):this.offset,o=e?e.rotation:0,n=e?e.scale:r.Vector.One,i=this.points.length;this._transformedPoints.length=0;for(var s=0;s<i;s++)this._transformedPoints[s]=this.points[s].scale(n).rotate(o).add(t)}},{key:"getTransformedPoints",value:function(){return this._transformedPoints.length&&(!this.collider||!this.collider.body||this.collider.body.oldPos.equals(this.collider.body.pos)&&this.collider.body.oldRotation===this.collider.body.rotation&&this.collider.body.oldScale===this.collider.body.scale)||this._calculateTransformation(),this._transformedPoints}},{key:"getSides",value:function(){if(this._sides.length)return this._sides;for(var e=[],t=this.getTransformedPoints(),o=t.length,n=0;n<o;n++)e.push(new r.Line(t[n],t[(n-1+o)%o]));return this._sides=e,this._sides}},{key:"recalc",value:function(){this._sides.length=0,this._axes.length=0,this._transformedPoints.length=0,this.getTransformedPoints(),this.getSides()}},{key:"contains",value:function(e){var t=new r.Ray(e,new r.Vector(1,0));return this.getSides().reduce(function(e,o){return t.intersect(o)>=0?e+1:e},0)%2!=0}},{key:"getClosestLineBetween",value:function(e){if(e instanceof s.Circle)return l.ClosestLineJumpTable.PolygonCircleClosestLine(this,e);if(e instanceof c)return l.ClosestLineJumpTable.PolygonPolygonClosestLine(this,e);if(e instanceof n.Edge)return l.ClosestLineJumpTable.PolygonEdgeClosestLine(this,e);throw new Error("Polygon could not collide with unknown CollisionShape ".concat(a(e)))}},{key:"collide",value:function(e){if(e instanceof s.Circle)return i.CollisionJumpTable.CollideCirclePolygon(e,this);if(e instanceof c)return i.CollisionJumpTable.CollidePolygonPolygon(this,e);if(e instanceof n.Edge)return i.CollisionJumpTable.CollidePolygonEdge(this,e);throw new Error("Polygon could not collide with unknown CollisionShape ".concat(a(e)))}},{key:"getFurthestPoint",value:function(e){for(var t=this.getTransformedPoints(),o=null,n=-Number.MAX_VALUE,i=0;i<t.length;i++){var s=e.dot(t[i]);s>n&&(n=s,o=t[i])}return o}},{key:"getClosestFace",value:function(e){for(var t=this.getSides(),o=Number.POSITIVE_INFINITY,n=-1,i=-1,s=0;s<t.length;s++){var r=t[s].distanceToPoint(e);r<o&&(o=r,n=s,i=r)}return-1!==n?{distance:t[n].normal().scale(i),face:t[n]}:null}},{key:"bounds",get:function(){var e=this.getTransformedPoints();return o.BoundingBox.fromPoints(e)}},{key:"localBounds",get:function(){return o.BoundingBox.fromPoints(this.points)}},{key:"inertia",get:function(){for(var e=this.collider?this.collider.mass:t.Physics.defaultMass,o=0,n=0,i=0;i<this.points.length;i++){var s=(i+1)%this.points.length,r=this.points[s].cross(this.points[i]);o+=r*(this.points[i].dot(this.points[i])+this.points[i].dot(this.points[s])+this.points[s].dot(this.points[s])),n+=r}return e/6*(o/n)}},{key:"rayCast",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,o=this.getSides(),n=o.length,i=Number.MAX_VALUE,s=-1,r=0;r<n;r++){var l=e.intersect(o[r]);l>=0&&l<i&&l<=t&&(i=l,s=r)}return s>=0?e.getPoint(i):null}},{key:"axes",get:function(){if(this._axes.length)return this._axes;for(var e=[],t=this.getTransformedPoints(),o=t.length,n=0;n<o;n++)e.push(t[n].sub(t[(n+1)%o]).normal());return this._axes=e,this._axes}},{key:"testSeparatingAxisTheorem",value:function(e){for(var t=e,o=this.axes.concat(t.axes),n=Number.MAX_VALUE,i=null,s=-1,r=0;r<o.length;r++){var l=this.project(o[r]),a=t.project(o[r]),u=l.getOverlap(a);if(u<=0)return null;u<n&&(n=u,i=o[r],s=r)}return-1===s?null:i.normalize().scale(n)}},{key:"project",value:function(e){for(var t=this.getTransformedPoints(),o=t.length,n=Number.MAX_VALUE,i=-Number.MAX_VALUE,s=0;s<o;s++){var l=t[s].dot(e);n=Math.min(n,l),i=Math.max(i,l)}return new r.Projection(n,i)}},{key:"draw",value:function(t){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.Color.Green,n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.Vector.Zero).add(this.offset);t.beginPath(),t.fillStyle=o.toString(),t.moveTo(n.x,n.y);var i=this.points[0].sub(n);this.points.map(function(e){return e.sub(i)}).forEach(function(e){t.lineTo(e.x,e.y)}),t.lineTo(n.x,n.y),t.closePath(),t.fill()}},{key:"debugDraw",value:function(t){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.Color.Red;t.beginPath(),t.strokeStyle=o.toString();var n=this.getTransformedPoints()[0];t.moveTo(n.x,n.y),this.getTransformedPoints().forEach(function(e){t.lineTo(e.x,e.y)}),t.lineTo(n.x,n.y),t.closePath(),t.stroke()}}]),c}();exports.ConvexPolygon=f;
},{"../Drawing/Color":"p7Gh","../Physics":"uSEN","./BoundingBox":"oyna","./Edge":"s26C","./CollisionJumpTable":"fXkm","./Circle":"xS4a","../Algebra":"NGcQ","./ClosestLineJumpTable":"j4ks"}],"Mmyc":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Shape=void 0;var e=require("./ConvexPolygon"),n=require("./Circle"),o=require("./Edge"),r=require("./BoundingBox"),t=require("../Algebra");function i(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function u(e,n){for(var o=0;o<n.length;o++){var r=n[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,n,o){return n&&u(e.prototype,n),o&&u(e,o),e}var a=function(){function u(){i(this,u)}return l(u,null,[{key:"Box",value:function(n,o){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.Vector.Half,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.Vector.Zero;return new e.ConvexPolygon({points:new r.BoundingBox(-n*i.x,-o*i.y,n-n*i.x,o-o*i.y).getPoints(),offset:u})}},{key:"Polygon",value:function(n){var o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.Vector.Zero;return new e.ConvexPolygon({points:n,offset:r,clockwiseWinding:o})}},{key:"Circle",value:function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.Vector.Zero;return new n.Circle({radius:e,offset:o})}},{key:"Edge",value:function(e,n){return new o.Edge({begin:e,end:n})}}]),u}();exports.Shape=a;
},{"./ConvexPolygon":"EI0S","./Circle":"xS4a","./Edge":"s26C","./BoundingBox":"oyna","../Algebra":"NGcQ"}],"uPb3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Matrix=exports.MatrixLocations=void 0;var a,t=require(".."),i=require("../Algebra"),d=require("../Util/Util");function s(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function e(a,t){for(var i=0;i<t.length;i++){var d=t[i];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function h(a,t,i){return t&&e(a.prototype,t),i&&e(a,i),a}exports.MatrixLocations=a,function(a){a[a.X=12]="X",a[a.Y=13]="Y"}(a||(exports.MatrixLocations=a={}));var n=function(a){return 0===a?0:a<0?-1:1},c=function(){function a(){s(this,a),this.data=new Float32Array(16),this._scaleSignX=1,this._scaleSignY=1}return h(a,[{key:"clone",value:function(){var t=new a;return t.data[0]=this.data[0],t.data[1]=this.data[1],t.data[2]=this.data[2],t.data[3]=this.data[3],t.data[4]=this.data[4],t.data[5]=this.data[5],t.data[6]=this.data[6],t.data[7]=this.data[7],t.data[8]=this.data[8],t.data[9]=this.data[9],t.data[10]=this.data[10],t.data[11]=this.data[11],t.data[12]=this.data[12],t.data[13]=this.data[13],t.data[14]=this.data[14],t.data[15]=this.data[15],t}},{key:"multv",value:function(a){return a instanceof i.Vector?new i.Vector(a.x*this.data[0]+a.y*this.data[4]+0*this.data[6]+1*this.data[12],a.x*this.data[1]+a.y*this.data[5]+0*this.data[9]+1*this.data[13]):[a[0]*this.data[0]+a[1]*this.data[4]+0*this.data[6]+1*this.data[12],a[0]*this.data[1]+a[1]*this.data[5]+0*this.data[9]+1*this.data[13]]}},{key:"multm",value:function(t){var i=new a,d=this.data[0],s=this.data[1],e=this.data[2],h=this.data[3],c=this.data[4],r=this.data[5],o=this.data[6],u=this.data[7],l=this.data[8],v=this.data[9],y=this.data[10],f=this.data[11],g=this.data[12],S=this.data[13],k=this.data[14],x=this.data[15],_=t.data[0],M=t.data[1],X=t.data[2],Y=t.data[3],p=t.data[4],m=t.data[5],w=t.data[6],b=t.data[7],z=t.data[8],A=t.data[9],P=t.data[10],q=t.data[11],L=t.data[12],j=t.data[13],B=t.data[14],D=t.data[15];i.data[0]=d*_+c*M+l*X+g*Y,i.data[1]=s*_+r*M+v*X+S*Y,i.data[2]=e*_+o*M+y*X+k*Y,i.data[3]=h*_+u*M+f*X+x*Y,i.data[4]=d*p+c*m+l*w+g*b,i.data[5]=s*p+r*m+v*w+S*b,i.data[6]=e*p+o*m+y*w+k*b,i.data[7]=h*p+u*m+f*w+x*b,i.data[8]=d*z+c*A+l*P+g*q,i.data[9]=s*z+r*A+v*P+S*q,i.data[10]=e*z+o*A+y*P+k*q,i.data[11]=h*z+u*A+f*P+x*q,i.data[12]=d*L+c*j+l*B+g*D,i.data[13]=s*L+r*j+v*B+S*D,i.data[14]=e*L+o*j+y*B+k*D,i.data[15]=h*L+u*j+f*B+x*D;var I=this.getScale();return i._scaleSignX=n(I.x)*n(i._scaleSignX),i._scaleSignY=n(I.y)*n(i._scaleSignY),i}},{key:"translate",value:function(a,t){var i=this.data[0],d=this.data[1],s=this.data[2],e=this.data[3],h=this.data[4],n=this.data[5],c=this.data[6],r=this.data[7],o=this.data[8],u=this.data[9],l=this.data[10],v=this.data[11],y=this.data[12],f=this.data[13],g=this.data[14],S=this.data[15];return this.data[12]=i*a+h*t+0*o+1*y,this.data[13]=d*a+n*t+0*u+1*f,this.data[14]=s*a+c*t+0*l+1*g,this.data[15]=e*a+r*t+0*v+1*S,this}},{key:"setPosition",value:function(a,t){this.data[12]=a,this.data[13]=t}},{key:"getPosition",value:function(){return(0,t.vec)(this.data[12],this.data[13])}},{key:"rotate",value:function(a){var t=this.data[0],i=this.data[1],d=this.data[2],s=this.data[3],e=this.data[4],h=this.data[5],n=this.data[6],c=this.data[7],r=Math.sin(a),o=Math.cos(a);return this.data[0]=o*t+r*e,this.data[1]=o*i+r*h,this.data[2]=o*d+r*n,this.data[3]=o*s+r*c,this.data[4]=o*e-r*t,this.data[5]=o*h-r*i,this.data[6]=o*n-r*d,this.data[7]=o*c-r*s,this}},{key:"scale",value:function(a,t){var i=this.data[0],d=this.data[1],s=this.data[2],e=this.data[3],h=this.data[4],n=this.data[5],c=this.data[6],r=this.data[7];return this.data[0]=i*a,this.data[1]=d*a,this.data[2]=s*a,this.data[3]=e*a,this.data[4]=h*t,this.data[5]=n*t,this.data[6]=c*t,this.data[7]=r*t,this}},{key:"setRotation",value:function(a){var t=this.getScale(),i=Math.sin(a),d=Math.cos(a);this.data[0]=d*t.x,this.data[1]=i*t.y,this.data[4]=-i*t.x,this.data[5]=d*t.y}},{key:"getRotation",value:function(){var a=Math.atan2(this.data[1]/this.getScaleY(),this.data[0]/this.getScaleX());return(0,d.canonicalizeAngle)(a)}},{key:"getScaleX",value:function(){var a=(0,t.vec)(this.data[0],this.data[4]).size;return this._scaleSignX*a}},{key:"getScaleY",value:function(){var a=(0,t.vec)(this.data[1],this.data[5]).size;return this._scaleSignY*a}},{key:"getScale",value:function(){return(0,t.vec)(this.getScaleX(),this.getScaleY())}},{key:"setScaleX",value:function(a){this._scaleSignX=n(a);var i=(0,t.vec)(this.data[0]*this._scaleSignX,this.data[4]*this._scaleSignX).normalize();this.data[0]=i.x*a,this.data[4]=i.y*a}},{key:"setScaleY",value:function(a){this._scaleSignY=n(a);var i=(0,t.vec)(this.data[1]*this._scaleSignY,this.data[5]*this._scaleSignY).normalize();this.data[1]=i.x*a,this.data[5]=i.y*a}},{key:"setScale",value:function(a){this.setScaleX(a.x),this.setScaleY(a.y)}},{key:"getBasisDeterminant",value:function(){return this.data[0]*this.data[5]-this.data[1]*this.data[4]}},{key:"getAffineInverse",value:function(){var t=1/this.getBasisDeterminant(),i=this.data[0],d=this.data[4],s=this.data[1],e=this.data[5],h=a.identity();h.data[0]=e*t,h.data[1]=-s*t,h.data[4]=-d*t,h.data[5]=i*t;var n=this.data[12],c=this.data[13];return h.data[12]=-(n*h.data[0]+c*h.data[4]),h.data[13]=-(n*h.data[1]+c*h.data[5]),h}},{key:"isIdentity",value:function(){return 1===this.data[0]&&0===this.data[1]&&0===this.data[2]&&0===this.data[3]&&0===this.data[4]&&1===this.data[5]&&0===this.data[6]&&0===this.data[7]&&0===this.data[8]&&0===this.data[9]&&1===this.data[10]&&0===this.data[11]&&0===this.data[12]&&0===this.data[13]&&0===this.data[14]&&1===this.data[15]}},{key:"toString",value:function(){return"\n[".concat(this.data[0]," ").concat(this.data[4]," ").concat(this.data[8]," ").concat(this.data[12],"]\n[").concat(this.data[1]," ").concat(this.data[5]," ").concat(this.data[9]," ").concat(this.data[13],"]\n[").concat(this.data[2]," ").concat(this.data[6]," ").concat(this.data[10]," ").concat(this.data[14],"]\n[").concat(this.data[3]," ").concat(this.data[7]," ").concat(this.data[11]," ").concat(this.data[15],"]\n")}}],[{key:"ortho",value:function(t,i,d,s,e,h){var n=new a;return n.data[0]=2/(i-t),n.data[1]=0,n.data[2]=0,n.data[3]=0,n.data[4]=0,n.data[5]=2/(s-d),n.data[6]=0,n.data[7]=0,n.data[8]=0,n.data[9]=0,n.data[10]=-2/(h-e),n.data[11]=0,n.data[12]=-(i+t)/(i-t),n.data[13]=-(s+d)/(s-d),n.data[14]=-(h+e)/(h-e),n.data[15]=1,n}},{key:"identity",value:function(){var t=new a;return t.data[0]=1,t.data[1]=0,t.data[2]=0,t.data[3]=0,t.data[4]=0,t.data[5]=1,t.data[6]=0,t.data[7]=0,t.data[8]=0,t.data[9]=0,t.data[10]=1,t.data[11]=0,t.data[12]=0,t.data[13]=0,t.data[14]=0,t.data[15]=1,t}},{key:"translation",value:function(t,i){var d=a.identity();return d.data[12]=t,d.data[13]=i,d}},{key:"scale",value:function(t,i){var d=a.identity();return d.data[0]=t,d.data[5]=i,d.data[10]=1,d.data[15]=1,d}},{key:"rotation",value:function(t){var i=a.identity();return i.data[0]=Math.cos(t),i.data[4]=-Math.sin(t),i.data[1]=Math.sin(t),i.data[5]=Math.cos(t),i}}]),a}();exports.Matrix=c;
},{"..":"A6Lr","../Algebra":"NGcQ","../Util/Util":"Kkda"}],"Nj7a":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.VectorView=void 0;var t=require("../Algebra");function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function i(t){var e=l();return function(){var n,r=a(t);if(e){var o=a(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return f(this,n)}}function f(t,n){return!n||"object"!==e(n)&&"function"!=typeof n?s(t):n}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(e){u(c,t.Vector);var r=i(c);function c(t){var e;return n(this,c),(e=r.call(this,0,0))._getX=t.getX,e._getY=t.getY,e._setX=t.setX,e._setY=t.setY,e}return o(c,[{key:"x",get:function(){return this._getX()},set:function(t){this._setX(t)}},{key:"y",get:function(){return this._getY()},set:function(t){this._setY(t)}}]),c}();exports.VectorView=p;
},{"../Algebra":"NGcQ"}],"r8EA":[function(require,module,exports) {
"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&n(t,e)}function n(t,e){return(n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t){var e=c();return function(){var n,o=i(t);if(e){var u=i(this).constructor;n=Reflect.construct(o,arguments,u)}else n=o.apply(this,arguments);return r(this,n)}}function r(e,n){return!n||"object"!==t(n)&&"function"!=typeof n?u(e):n}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function i(t){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function a(t,e,n){return e&&l(t.prototype,e),n&&l(t,n),t}function s(t){return!!(null==t?void 0:t.clone)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.TagComponent=exports.Component=void 0;var p=function(){function t(){f(this,t),this.owner=null}return a(t,[{key:"clone",value:function(){var t=new this.constructor;for(var e in this)if(this.hasOwnProperty(e)){var n=this[e];s(n)&&"owner"!==e&&"clone"!==e?t[e]=n.clone():t[e]=n}return t}}]),t}();exports.Component=p;var y=function(t){e(r,p);var n=o(r);function r(t,e){var o;return f(this,r),(o=n.call(this)).type=t,o.value=e,o}return r}();exports.TagComponent=y;
},{}],"yq2E":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TransformComponent=exports.CoordPlane=void 0;var t=require("../../Algebra"),e=require("../../Math/matrix"),r=require("../../Math/vector-view"),n=require("../Component");function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return s(t)||l(t,e)||c(t,e)||a()}function a(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(t,e){if(t){if("string"==typeof t)return u(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(t,e):void 0}}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function l(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,c=t[Symbol.iterator]();!(n=(a=c.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(u){o=!0,i=u}finally{try{n||null==c.return||c.return()}finally{if(o)throw i}}return r}}function s(t){if(Array.isArray(t))return t}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function p(t,e,r){return e&&y(t.prototype,e),r&&y(t,r),t}function h(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}function v(t,e){return(v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function d(t){var e=m();return function(){var r,n=x(t);if(e){var o=x(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return g(this,r)}}function g(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?b(t):e}function b(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function m(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function x(t){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var _,S=function(t){var n=t;return new r.VectorView({setX:function(t){n.data[e.MatrixLocations.X]=t},setY:function(t){n.data[e.MatrixLocations.Y]=t},getX:function(){return n.data[e.MatrixLocations.X]},getY:function(){return n.data[e.MatrixLocations.Y]}})},M=function(t){var e=t;return new r.VectorView({setX:function(t){e.setScaleX(t)},setY:function(t){e.setScaleY(t)},getX:function(){return e.getScaleX()},getY:function(){return e.getScaleY()}})};exports.CoordPlane=_,function(t){t.World="world",t.Screen="screen"}(_||(exports.CoordPlane=_={}));var w=function(o){h(c,n.Component);var a=d(c);function c(){var t;return f(this,c),(t=a.apply(this,arguments)).type="transform",t._dirty=!1,t.matrix=e.Matrix.identity().translate(0,0).rotate(0).scale(1,1),t._position=S(t.matrix),t._rotation=0,t._scale=M(t.matrix),t.coordPlane=_.World,t.z=0,t}return p(c,[{key:"_recalculate",value:function(){this._rotation=this.matrix.getRotation(),this._dirty=!1}},{key:"getGlobalMatrix",value:function(){return this.parent?this.parent.getGlobalMatrix().multm(this.matrix):this.matrix}},{key:"parent",get:function(){var t,e;return null===(e=null===(t=null==this?void 0:this.owner)||void 0===t?void 0:t.parent)||void 0===e?void 0:e.get(c)}},{key:"pos",get:function(){return this._dirty&&this._recalculate(),this._position},set:function(t){this.matrix.setPosition(t.x,t.y),this._dirty=!0}},{key:"dirty",get:function(){var t;return(null===(t=null==this?void 0:this.owner)||void 0===t?void 0:t.parent)&&this.parent.dirty||this._dirty}},{key:"globalPos",get:function(){var t=this,n=this.getGlobalMatrix();return new r.VectorView({getX:function(){return n.data[e.MatrixLocations.X]},getY:function(){return n.data[e.MatrixLocations.Y]},setX:function(r){var o;if(t.parent){var a=i(null===(o=t.parent)||void 0===o?void 0:o.getGlobalMatrix().getAffineInverse().multv([r,n.data[e.MatrixLocations.Y]]),1)[0];t.matrix.data[e.MatrixLocations.X]=a}else t.matrix.data[e.MatrixLocations.X]=r},setY:function(r){var o;if(t.parent){var a=i(null===(o=t.parent)||void 0===o?void 0:o.getGlobalMatrix().getAffineInverse().multv([n.data[e.MatrixLocations.X],r]),2)[1];t.matrix.data[e.MatrixLocations.Y]=a}else t.matrix.data[e.MatrixLocations.Y]=r}})},set:function(t){var e=this.parent;this.pos=e?e.getGlobalMatrix().getAffineInverse().multv(t):t}},{key:"rotation",get:function(){return this._dirty&&this._recalculate(),this._rotation},set:function(t){this.matrix.setRotation(t),this._dirty=!0}},{key:"globalRotation",get:function(){return this.getGlobalMatrix().getRotation()},set:function(t){var e=this.parent;this.rotation=e?t-e.globalRotation:t}},{key:"scale",get:function(){return this._dirty&&this._recalculate(),this._scale},set:function(t){this.matrix.setScale(t),this._dirty=!0}},{key:"globalScale",get:function(){var t=this,e=this.getGlobalMatrix();return new r.VectorView({getX:function(){return e.getScaleX()},getY:function(){return e.getScaleY()},setX:function(e){if(t.parent){var r=t.parent.globalScale.x;t.matrix.setScaleX(e/r)}else t.matrix.setScaleX(e)},setY:function(e){if(t.parent){var r=t.parent.globalScale.y;t.matrix.setScaleY(e/r)}else t.matrix.setScaleY(e)}})},set:function(e){var r=this.parent;this.scale=r?(0,t.vec)(e.x/r.globalScale.x,e.y/r.globalScale.y):e}}]),c}();exports.TransformComponent=w;
},{"../../Algebra":"NGcQ","../../Math/matrix":"uPb3","../../Math/vector-view":"Nj7a","../Component":"r8EA"}],"oGoG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Body=void 0;var t=require("../Algebra"),e=require("./CollisionType"),o=require("../Physics"),i=require("../Events"),r=require("./Shape"),s=require("../EntityComponentSystem/Components/TransformComponent");function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function c(t,e,o){return e&&n(t.prototype,e),o&&n(t,o),t}var a=function(){function n(e){var o=e.actor,i=e.collider;if(l(this,n),this.oldPos=new t.Vector(0,0),this.vel=new t.Vector(0,0),this.oldVel=new t.Vector(0,0),this.acc=new t.Vector(0,0),this.oldAcc=t.Vector.Zero,this.torque=0,this.motion=10,this.oldRotation=0,this.oldScale=t.Vector.One,this.sx=0,this.sy=0,this.rx=0,this._geometryDirty=!1,this._totalMtv=t.Vector.Zero,!o&&!i)throw new Error("An actor or collider are required to create a body");this.actor=o,this.collider=!i&&o?this.useBoxCollider(o.width,o.height,o.anchor):i}return c(n,[{key:"id",get:function(){return this.actor?this.actor.id:-1}},{key:"clone",value:function(){return new n({actor:null,collider:this.collider.clone()})}},{key:"active",get:function(){return!!this.actor&&!this.actor.isKilled()}},{key:"center",get:function(){return this.pos}},{key:"collider",get:function(){return this._collider},set:function(t){t&&(this._collider=t,this._collider.body=this,this._wireColliderEventsToActor())}},{key:"transform",get:function(){return this.actor.get(s.TransformComponent)}},{key:"pos",get:function(){return this.transform.globalPos},set:function(t){this.transform.globalPos=t}},{key:"rotation",get:function(){return this.transform.globalRotation},set:function(t){this.transform.globalRotation=t}},{key:"scale",get:function(){return this.transform.globalScale},set:function(t){this.transform.globalScale=t}},{key:"addMtv",value:function(t){this._totalMtv.addEqual(t)}},{key:"applyMtv",value:function(){this.pos=this.pos.add(this._totalMtv),this._totalMtv.setTo(0,0)}},{key:"markCollisionShapeDirty",value:function(){this._geometryDirty=!0}},{key:"isColliderShapeDirty",get:function(){return this._geometryDirty}},{key:"captureOldTransform",value:function(){this.oldVel.setTo(this.vel.x,this.vel.y),this.oldPos.setTo(this.pos.x,this.pos.y),this.oldAcc.setTo(this.acc.x,this.acc.y),this.oldScale.setTo(this.scale.x,this.scale.y),this.oldRotation=this.rotation}},{key:"integrate",value:function(i){var r=i/1e3,s=this.acc.clone();this.collider.type===e.CollisionType.Active&&s.addEqual(o.Physics.acc),this.vel.addEqual(s.scale(r)),this.pos=this.pos.add(this.vel.scale(r)).add(s.scale(.5*r*r)),this.rx+=this.torque*(1/this.collider.inertia)*r,this.rotation+=this.rx*r,this.scale=(0,t.vec)(this.scale.x+this.sx*i/1e3,this.scale.y+this.sy*i/1e3),this.scale.equals(this.oldScale)||(this._geometryDirty=!0),this.collider.update(),this._geometryDirty=!1}},{key:"useBoxCollider",value:function(e,o){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.Vector.Half,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.Vector.Zero;return null==e&&(e=this.actor?this.actor.width:0),null==o&&(o=this.actor?this.actor.height:0),this.collider.shape=r.Shape.Box(e,o,i,s),this.collider}},{key:"usePolygonCollider",value:function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.Vector.Zero;return this.collider.shape=r.Shape.Polygon(e,!1,o),this.collider}},{key:"useCircleCollider",value:function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.Vector.Zero;return this.collider.shape=r.Shape.Circle(e,o),this.collider}},{key:"useEdgeCollider",value:function(t,e){return this.collider.shape=r.Shape.Edge(t,e),this.collider}},{key:"_wireColliderEventsToActor",value:function(){var t=this;this.collider.clear(),this.collider.on("precollision",function(e){t.actor&&t.actor.emit("precollision",new i.PreCollisionEvent(e.target.body.actor,e.other.body.actor,e.side,e.intersection))}),this.collider.on("postcollision",function(e){t.actor&&t.actor.emit("postcollision",new i.PostCollisionEvent(e.target.body.actor,e.other.body.actor,e.side,e.intersection))}),this.collider.on("collisionstart",function(e){t.actor&&t.actor.emit("collisionstart",new i.CollisionStartEvent(e.target.body.actor,e.other.body.actor,e.pair))}),this.collider.on("collisionend",function(e){t.actor&&t.actor.emit("collisionend",new i.CollisionEndEvent(e.target.body.actor,e.other.body.actor))})}}]),n}();exports.Body=a;
},{"../Algebra":"NGcQ","./CollisionType":"liCD","../Physics":"uSEN","../Events":"XySq","./Shape":"Mmyc","../EntityComponentSystem/Components/TransformComponent":"yq2E"}],"UgQh":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.line=e,exports.point=o,exports.vector=l,exports.roundRect=r,exports.circle=i;var t=require("../Drawing/Color");function e(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.Color.Red,l=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,n=arguments.length>5?arguments[5]:void 0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,v=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"butt";e.beginPath(),e.lineWidth=a,e.lineCap=v,e.strokeStyle=o.toString(),e.moveTo(l,r),e.lineTo(i,n),e.closePath(),e.stroke()}function o(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.Color.Red,l=arguments.length>2?arguments[2]:void 0;e.beginPath(),e.strokeStyle=o.toString(),e.arc(l.x,l.y,5,0,2*Math.PI),e.closePath(),e.stroke()}function l(t,e,o,l){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,i=e?e.toString():"blue",n=l.scale(r);t.beginPath(),t.strokeStyle=i,t.moveTo(o.x,o.y),t.lineTo(o.x+n.x,o.y+n.y),t.closePath(),t.stroke()}function r(e,o,l,r,i){var n,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:5,v=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t.Color.White,h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;if("number"==typeof a)n={tl:a,tr:a,br:a,bl:a};else{var g={tl:0,tr:0,br:0,bl:0};for(var s in g)if(g.hasOwnProperty(s)){var d=s;n[d]=a[d]||g[d]}}e.beginPath(),e.moveTo(o+n.tl,l),e.lineTo(o+r-n.tr,l),e.quadraticCurveTo(o+r,l,o+r,l+n.tr),e.lineTo(o+r,l+i-n.br),e.quadraticCurveTo(o+r,l+i,o+r-n.br,l+i),e.lineTo(o+n.bl,l+i),e.quadraticCurveTo(o,l+i,o,l+i-n.bl),e.lineTo(o,l+n.tl),e.quadraticCurveTo(o,l,o+n.tl,l),e.closePath(),h&&(e.fillStyle=h.toString(),e.fill()),v&&(e.strokeStyle=v.toString(),e.stroke())}function i(e,o,l,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:t.Color.White,n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;e.beginPath(),e.arc(o,l,r,0,2*Math.PI),e.closePath(),n&&(e.fillStyle=n.toString(),e.fill()),i&&(e.strokeStyle=i.toString(),e.stroke())}
},{"../Drawing/Color":"p7Gh"}],"NyBG":[function(require,module,exports) {
"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.CollisionGroup=void 0;var r=function(){function t(n,r,o){e(this,t),this._name=n,this._category=r,this._mask=o}return n(t,[{key:"name",get:function(){return this._name}},{key:"category",get:function(){return this._category}},{key:"mask",get:function(){return this._mask}},{key:"canCollide",value:function(e){return 0!=(this.category&e.mask)&&0!=(e.category&this.mask)}}]),t}();exports.CollisionGroup=r,r.All=new r("Collide with all groups",-1,-1);
},{}],"c7EN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EventDispatcher=void 0;var e=require("./Events");function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}var s=function(){function i(e){t(this,i),this._handlers={},this._wiredEventDispatchers=[],this._target=e}return r(i,[{key:"clear",value:function(){this._handlers={},this._wiredEventDispatchers=[]}},{key:"emit",value:function(t,i){if(t){t=t.toLowerCase();var r,s,n=this._target;i||(i=new e.GameEvent);try{i.target=n}catch(a){}if(this._handlers[t])for(r=0,s=this._handlers[t].length;r<s;r++)this._handlers[t][r].call(n,i);for(r=0,s=this._wiredEventDispatchers.length;r<s;r++)this._wiredEventDispatchers[r].emit(t,i)}}},{key:"on",value:function(t,i){t=t.toLowerCase(),this._handlers[t]||(this._handlers[t]=[]),this._handlers[t].push(i),"unsubscribe"!==t&&"subscribe"!==t&&this.emit("subscribe",new e.SubscribeEvent(t,i))}},{key:"off",value:function(t,i){t=t.toLowerCase();var r=this._handlers[t];if(r)if(i){var s=r.indexOf(i);this._handlers[t].splice(s,1)}else this._handlers[t].length=0;"unsubscribe"!==t&&"subscribe"!==t&&this.emit("unsubscribe",new e.UnsubscribeEvent(t,i))}},{key:"once",value:function(t,i){var r=this;this.on(t,function(s){var n=s||new e.GameEvent;try{n.target=n.target||r._target}catch(a){}r.off(t,i),i.call(n.target,n)})}},{key:"wire",value:function(e){e._wiredEventDispatchers.push(this)}},{key:"unwire",value:function(e){var t=e._wiredEventDispatchers.indexOf(this);t>-1&&e._wiredEventDispatchers.splice(t,1)}}]),i}();exports.EventDispatcher=s;
},{"./Events":"XySq"}],"zTU8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Pair=void 0;var e=require("./../Physics"),i=require("./../Drawing/Color"),o=r(require("../Util/DrawUtil")),t=require("./CollisionType");function n(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return n=function(){return e},e}function r(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var i=n();if(i&&i.has(e))return i.get(e);var o={},t=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var l=t?Object.getOwnPropertyDescriptor(e,r):null;l&&(l.get||l.set)?Object.defineProperty(o,r,l):o[r]=e[r]}return o.default=e,i&&i.set(e,o),o}function l(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function c(e,i){for(var o=0;o<i.length;o++){var t=i[o];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function a(e,i,o){return i&&c(e.prototype,i),o&&c(e,o),e}var s=function(){function n(e,i){l(this,n),this.colliderA=e,this.colliderB=i,this.id=null,this.collision=null,this.id=n.calculatePairHash(e,i)}return a(n,[{key:"canCollide",get:function(){var e=this.colliderA,i=this.colliderB;return n.canCollide(e,i)}},{key:"collide",value:function(){this.collision=this.colliderA.collide(this.colliderB)}},{key:"resolve",value:function(e){this.collision&&this.collision.resolve(e)}},{key:"debugDraw",value:function(t){this.collision&&(e.Physics.showContacts&&o.point(t,i.Color.Red,this.collision.point),e.Physics.showCollisionNormals&&o.vector(t,i.Color.Cyan,this.collision.point,this.collision.normal,30))}}],[{key:"canCollide",value:function(e,i){return!!e.group.canCollide(i.group)&&((e.type!==t.CollisionType.Fixed||i.type!==t.CollisionType.Fixed)&&(i.type!==t.CollisionType.PreventCollision&&e.type!==t.CollisionType.PreventCollision&&!(!e.active||!i.active)))}},{key:"calculatePairHash",value:function(e,i){return e.id<i.id?"#".concat(e.id,"+").concat(i.id):"#".concat(i.id,"+").concat(e.id)}}]),n}();exports.Pair=s;
},{"./../Physics":"uSEN","./../Drawing/Color":"p7Gh","../Util/DrawUtil":"UgQh","./CollisionType":"liCD"}],"KRUI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isCollider=y,exports.Collider=void 0;var e=require("../Drawing/Color"),t=l(require("../Util/DrawUtil")),i=require("../Algebra"),n=require("../Physics"),o=require("./BoundingBox"),s=require("./CollisionType"),r=require("./CollisionGroup"),u=require("../EventDispatcher"),a=require("./Pair");function h(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return h=function(){return e},e}function l(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=h();if(t&&t.has(e))return t.get(e);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var s=n?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=e[o]}return i.default=e,t&&t.set(e,i),i}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t,i){return t&&p(e.prototype,t),i&&p(e,i),e}function y(e){return e instanceof d}var d=function(){function h(e){var t=e.body,n=e.type,o=e.group,a=e.shape,l=e.offset,p=e.useShapeInertia,f=void 0===p||p;c(this,h),this._events=new u.EventDispatcher(this),this.type=s.CollisionType.PreventCollision,this.group=r.CollisionGroup.All,this.mass=1,this.inertia=1e3,this.friction=.99,this.bounciness=.2,t&&t.collider&&!a?this._shape=t.collider.shape:(this._shape=a,this.body=t),this.useShapeInertia=f,this._shape.collider=this,this.type=n||this.type,this.group=o||this.group,this.offset=l||i.Vector.Zero}return f(h,[{key:"clone",value:function(){return new h({body:null,type:this.type,shape:this._shape.clone(),group:this.group,offset:this.offset})}},{key:"id",get:function(){return this.body?this.body.id:-1}},{key:"shape",get:function(){return this._shape},set:function(e){this._shape=e,this._shape.collider=this,this.useShapeInertia&&(this.inertia=isNaN(this._shape.inertia)?this.inertia:this._shape.inertia)}},{key:"center",get:function(){return this.bounds.center}},{key:"active",get:function(){return this.body.active}},{key:"collide",value:function(e){return this.shape.collide(e.shape)}},{key:"getClosestLineBetween",value:function(e){return this.shape.getClosestLineBetween(e.shape)}},{key:"offset",get:function(){return this.shape.offset.clone()},set:function(e){this.shape.offset=e.clone()}},{key:"touching",value:function(e){var t=new a.Pair(this,e);return t.collide(),!!t.collision}},{key:"bounds",get:function(){return this.shape?this.shape.bounds:this.body?(new o.BoundingBox).translate(this.body.pos):new o.BoundingBox}},{key:"localBounds",get:function(){return this.shape?this.shape.localBounds:new o.BoundingBox}},{key:"update",value:function(){this.shape&&this.shape.recalc()}},{key:"emit",value:function(e,t){this._events.emit(e,t)}},{key:"on",value:function(e,t){this._events.on(e,t)}},{key:"off",value:function(e,t){this._events.off(e,t)}},{key:"once",value:function(e,t){this._events.once(e,t)}},{key:"clear",value:function(){this._events.clear()}},{key:"debugDraw",value:function(i){n.Physics.showMotionVectors&&(t.vector(i,e.Color.Yellow,this.body.pos,this.body.acc.add(n.Physics.acc)),t.vector(i,e.Color.Red,this.body.pos,this.body.vel),t.point(i,e.Color.Red,this.body.pos)),n.Physics.showBounds&&this.bounds.debugDraw(i,e.Color.Yellow),n.Physics.showArea&&this.shape.debugDraw(i,e.Color.Green)}}]),h}();exports.Collider=d;
},{"../Drawing/Color":"p7Gh","../Util/DrawUtil":"UgQh","../Algebra":"NGcQ","../Physics":"uSEN","./BoundingBox":"oyna","./CollisionType":"liCD","./CollisionGroup":"NyBG","../EventDispatcher":"c7EN","./Pair":"zTU8"}],"Tnas":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CollisionGroupManager=void 0;var e=require("./CollisionGroup");function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function n(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}var o=function(){function r(){t(this,r)}return n(r,null,[{key:"create",value:function(t,r){if(this._CURRENT_GROUP>this._MAX_GROUPS)throw new Error("Cannot have more than ".concat(this._MAX_GROUPS," collision groups"));if(this._GROUPS.get(t))throw new Error("Collision group ".concat(t," already exists"));var n=new e.CollisionGroup(t,this._CURRENT_BIT,void 0!==r?r:~this._CURRENT_BIT);return this._CURRENT_BIT=this._CURRENT_BIT<<1|0,this._CURRENT_GROUP++,this._GROUPS.set(t,n),n}},{key:"groups",get:function(){return Array.from(this._GROUPS.values())}},{key:"groupByName",value:function(e){return this._GROUPS.get(e)}},{key:"reset",value:function(){this._GROUPS=new Map,this._CURRENT_BIT=this._STARTING_BIT,this._CURRENT_GROUP=1}}]),r}();exports.CollisionGroupManager=o,o._STARTING_BIT=1,o._MAX_GROUPS=32,o._CURRENT_GROUP=1,o._CURRENT_BIT=o._STARTING_BIT,o._GROUPS=new Map;
},{"./CollisionGroup":"NyBG"}],"BGmr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DynamicTree=exports.TreeNode=void 0;var e=require("./../Physics"),t=require("./BoundingBox"),n=require("../Util/Log");function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function o(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}var h=function(){function e(n){i(this,e),this.parent=n,this.parent=n||null,this.body=null,this.bounds=new t.BoundingBox,this.left=null,this.right=null,this.height=0}return o(e,[{key:"isLeaf",value:function(){return!this.left&&!this.right}}]),e}();exports.TreeNode=h;var s=function(){function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new t.BoundingBox(-Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);i(this,r),this.worldBounds=e,this.root=null,this.nodes={}}return o(r,[{key:"_insert",value:function(e){if(null===this.root)return this.root=e,void(this.root.parent=null);for(var t=e.bounds,n=this.root;!n.isLeaf();){var i=n.left,r=n.right,o=n.bounds.getPerimeter(),s=n.bounds.combine(t).getPerimeter(),u=2*s,a=2*(s-o),l=0,d=t.combine(i.bounds),g=void 0;i.isLeaf()?l=d.getPerimeter()+a:(g=i.bounds.getPerimeter(),l=d.getPerimeter()-g+a);var f=0,b=t.combine(r.bounds);if(r.isLeaf()?f=b.getPerimeter()+a:(g=r.bounds.getPerimeter(),f=b.getPerimeter()-g+a),u<l&&u<f)break;n=l<f?i:r}var c=n.parent,p=new h(c);p.bounds=t.combine(n.bounds),p.height=n.height+1,null!==c?(c.left===n?c.left=p:c.right=p,p.left=n,p.right=e,n.parent=p,e.parent=p):(p.left=n,p.right=e,n.parent=p,e.parent=p,this.root=p);for(var m=e.parent;m;){if(!(m=this._balance(m)).left)throw new Error("Parent of current leaf cannot have a null left child"+m);if(!m.right)throw new Error("Parent of current leaf cannot have a null right child"+m);m.height=1+Math.max(m.left.height,m.right.height),m.bounds=m.left.bounds.combine(m.right.bounds),m=m.parent}}},{key:"_remove",value:function(e){if(e!==this.root){var t,n=e.parent,i=n.parent;if(t=n.left===e?n.right:n.left,i){i.left===n?i.left=t:i.right=t,t.parent=i;for(var r=i;r;)(r=this._balance(r)).bounds=r.left.bounds.combine(r.right.bounds),r.height=1+Math.max(r.left.height,r.right.height),r=r.parent}else this.root=t,t.parent=null}else this.root=null}},{key:"trackBody",value:function(e){var t=new h;t.body=e,t.bounds=e.collider.bounds,t.bounds.left-=2,t.bounds.top-=2,t.bounds.right+=2,t.bounds.bottom+=2,this.nodes[e.id]=t,this._insert(t)}},{key:"updateBody",value:function(t){var i=this.nodes[t.id];if(!i)return!1;var r=t.collider.bounds;if(!this.worldBounds.contains(r))return n.Logger.getInstance().warn("Collider with id "+t.id+" is outside the world bounds and will no longer be tracked for physics"),this.untrackBody(t),!1;if(i.bounds.contains(r))return!1;this._remove(i),r.left-=e.Physics.boundsPadding,r.top-=e.Physics.boundsPadding,r.right+=e.Physics.boundsPadding,r.bottom+=e.Physics.boundsPadding;var o=t.vel.x*e.Physics.dynamicTreeVelocityMultiplier,h=t.vel.y*e.Physics.dynamicTreeVelocityMultiplier;return o<0?r.left+=o:r.right+=o,h<0?r.top+=h:r.bottom+=h,i.bounds=r,this._insert(i),!0}},{key:"untrackBody",value:function(e){var t=this.nodes[e.collider.id];t&&(this._remove(t),this.nodes[e.collider.id]=null,delete this.nodes[e.collider.id])}},{key:"_balance",value:function(e){if(null===e)throw new Error("Cannot balance at null node");if(e.isLeaf()||e.height<2)return e;var t=e.left,n=e.right,i=e,r=t,o=n,h=t.left,s=t.right,u=n.left,a=n.right,l=o.height-r.height;if(l>1)return o.left=i,o.parent=i.parent,i.parent=o,o.parent?o.parent.left===i?o.parent.left=o:o.parent.right=o:this.root=o,u.height>a.height?(o.right=u,i.right=a,a.parent=i,i.bounds=r.bounds.combine(a.bounds),o.bounds=i.bounds.combine(u.bounds),i.height=1+Math.max(r.height,a.height),o.height=1+Math.max(i.height,u.height)):(o.right=a,i.right=u,u.parent=i,i.bounds=r.bounds.combine(u.bounds),o.bounds=i.bounds.combine(a.bounds),i.height=1+Math.max(r.height,u.height),o.height=1+Math.max(i.height,a.height)),o;if(l<-1){if(r.left=i,r.parent=i.parent,i.parent=r,r.parent)if(r.parent.left===i)r.parent.left=r;else{if(r.parent.right!==i)throw"Error rotating Dynamic Tree";r.parent.right=r}else this.root=r;return h.height>s.height?(r.right=h,i.left=s,s.parent=i,i.bounds=o.bounds.combine(s.bounds),r.bounds=i.bounds.combine(h.bounds),i.height=1+Math.max(o.height,s.height),r.height=1+Math.max(i.height,h.height)):(r.right=s,i.left=h,h.parent=i,i.bounds=o.bounds.combine(h.bounds),r.bounds=i.bounds.combine(s.bounds),i.height=1+Math.max(o.height,h.height),r.height=1+Math.max(i.height,s.height)),r}return e}},{key:"getHeight",value:function(){return null===this.root?0:this.root.height}},{key:"query",value:function(e,t){var n=e.collider.bounds;!function i(r){if(r&&r.bounds.intersect(n)){if(!r.isLeaf()||r.body===e)return i(r.left)||i(r.right);if(t.call(e,r.body))return!0}return!1}(this.root)}},{key:"rayCastQuery",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=arguments.length>2?arguments[2]:void 0;!function i(r){if(r&&r.bounds.rayCast(e,t)){if(!r.isLeaf())return i(r.left)||i(r.right);if(n.call(e,r.body))return!0}return!1}(this.root)}},{key:"getNodes",value:function(){return function e(t){return t?[t].concat(e(t.left),e(t.right)):[]}(this.root)}},{key:"debugDraw",value:function(e){!function t(n){n&&(n.isLeaf()?(e.lineWidth=1,e.strokeStyle="green"):(e.lineWidth=1,e.strokeStyle="white"),n.bounds.debugDraw(e),n.left&&t(n.left),n.right&&t(n.right))}(this.root)}}]),r}();exports.DynamicTree=s;
},{"./../Physics":"uSEN","./BoundingBox":"oyna","../Util/Log":"p1Gn"}],"O6gl":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DynamicTreeCollisionBroadphase=void 0;var i=require("./../Physics"),e=require("./DynamicTree"),r=require("./Pair"),n=require("../Algebra"),o=require("../Util/Log"),a=require("../Events"),t=require("./CollisionType");function l(i,e){var r;if("undefined"==typeof Symbol||null==i[Symbol.iterator]){if(Array.isArray(i)||(r=s(i))||e&&i&&"number"==typeof i.length){r&&(i=r);var n=0,o=function(){};return{s:o,n:function(){return n>=i.length?{done:!0}:{done:!1,value:i[n++]}},e:function(i){throw i},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,t=!0,l=!1;return{s:function(){r=i[Symbol.iterator]()},n:function(){var i=r.next();return t=i.done,i},e:function(i){l=!0,a=i},f:function(){try{t||null==r.return||r.return()}finally{if(l)throw a}}}}function s(i,e){if(i){if("string"==typeof i)return c(i,e);var r=Object.prototype.toString.call(i).slice(8,-1);return"Object"===r&&i.constructor&&(r=i.constructor.name),"Map"===r||"Set"===r?Array.from(i):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(i,e):void 0}}function c(i,e){(null==e||e>i.length)&&(e=i.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=i[r];return n}function u(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function d(i,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,n.key,n)}}function h(i,e,r){return e&&d(i.prototype,e),r&&d(i,r),i}var y=function(){function s(){u(this,s),this._dynamicCollisionTree=new e.DynamicTree,this._collisionHash={},this._collisionPairCache=[],this._lastFramePairs=[],this._lastFramePairsHash={}}return h(s,[{key:"track",value:function(i){i?this._dynamicCollisionTree.trackBody(i):o.Logger.getInstance().warn("Cannot track null physics body")}},{key:"untrack",value:function(i){i?this._dynamicCollisionTree.untrackBody(i):o.Logger.getInstance().warn("Cannot untrack a null physics body")}},{key:"_shouldGenerateCollisionPair",value:function(i,e){var n=r.Pair.calculatePairHash(i,e);return!this._collisionHash[n]&&r.Pair.canCollide(i,e)}},{key:"broadphase",value:function(e,o,a){var s,c=this,u=o/1e3,d=e.map(function(i){return i.collider}).filter(function(i){return i.active&&i.type!==t.CollisionType.PreventCollision});this._collisionPairCache=[],this._collisionHash={};for(var h=0,y=d.length;h<y;h++)s=d[h],this._dynamicCollisionTree.query(s.body,function(i){if(c._shouldGenerateCollisionPair(s,i.collider)){var e=new r.Pair(s,i.collider);c._collisionHash[e.id]=!0,c._collisionPairCache.push(e)}return!1});if(a&&(a.physics.pairs=this._collisionPairCache.length),i.Physics.checkForFastBodies){var f,v=l(d);try{var p=function(){var e=f.value;if(e.type!==t.CollisionType.Active)return"continue";var o=e.body.vel.size*u+.5*e.body.acc.size*u*u,l=Math.min(e.bounds.height,e.bounds.width);if(i.Physics.disableMinimumSpeedForFastBody||o>l/2){a&&a.physics.fastBodies++;var s,d=e.body.pos.sub(e.body.oldPos),h=e.shape.center,y=e.shape.getFurthestPoint(e.body.vel),v=y.sub(d),p=new n.Ray(v,e.body.vel);p.pos=p.pos.add(p.dir.scale(-2*i.Physics.surfaceEpsilon));var b=new n.Vector(1/0,1/0);if(c._dynamicCollisionTree.rayCastQuery(p,o+2*i.Physics.surfaceEpsilon,function(n){if(e.body!==n&&n.collider.shape&&r.Pair.canCollide(e,n.collider)){var a=n.collider.shape.rayCast(p,o+10*i.Physics.surfaceEpsilon);if(a){var t=a.sub(v);t.size<b.size&&(b=t,s=n)}}return!1}),s&&n.Vector.isValid(b)){var m=new r.Pair(e,s.collider);c._collisionHash[m.id]||(c._collisionHash[m.id]=!0,c._collisionPairCache.push(m));var C=h.sub(y);e.body.pos=v.add(C).add(b).add(p.dir.scale(2*i.Physics.surfaceEpsilon)),e.shape.recalc(),a&&a.physics.fastBodyCollisions++}}};for(v.s();!(f=v.n()).done;)p()}catch(b){v.e(b)}finally{v.f()}}return this._collisionPairCache}},{key:"narrowphase",value:function(i,e){for(var r=0;r<i.length;r++)i[r].collide(),e&&i[r].collision&&(e.physics.collisions++,e.physics.collidersHash[i[r].id]=i[r]);return i.filter(function(i){return i.collision})}},{key:"resolve",value:function(e,r,n){var o,a=l(e);try{for(a.s();!(o=a.n()).done;){var t=o.value;t.resolve(n),t.collision&&(t.colliderA.body.applyMtv(),t.colliderB.body.applyMtv(),t.colliderA.body.integrate(r*i.Physics.collisionShift),t.colliderB.body.integrate(r*i.Physics.collisionShift))}}catch(s){a.e(s)}finally{a.f()}return e.filter(function(i){return i.canCollide})}},{key:"runCollisionStartEnd",value:function(i){var e,r={},n=l(i);try{for(n.s();!(e=n.n()).done;){var o=e.value;if(r[o.id]=o,!this._lastFramePairsHash[o.id]){var t=o.colliderA,s=o.colliderB;t.emit("collisionstart",new a.CollisionStartEvent(t,s,o)),s.emit("collisionstart",new a.CollisionStartEvent(s,t,o))}}}catch(f){n.e(f)}finally{n.f()}var c,u=l(this._lastFramePairs);try{for(u.s();!(c=u.n()).done;){var d=c.value;if(!r[d.id]){var h=d.colliderA,y=d.colliderB;h.emit("collisionend",new a.CollisionEndEvent(h,y)),y.emit("collisionend",new a.CollisionEndEvent(y,h))}}}catch(f){u.e(f)}finally{u.f()}this._lastFramePairs=i,this._lastFramePairsHash=r}},{key:"update",value:function(i){for(var e=0,r=i.length,n=0;n<r;n++)this._dynamicCollisionTree.updateBody(i[n])&&e++;return e}},{key:"debugDraw",value:function(e){if(i.Physics.broadphaseDebug&&this._dynamicCollisionTree.debugDraw(e),i.Physics.showContacts||i.Physics.showCollisionNormals){var r,n=l(this._collisionPairCache);try{for(n.s();!(r=n.n()).done;){r.value.debugDraw(e)}}catch(o){n.e(o)}finally{n.f()}}}}]),s}();exports.DynamicTreeCollisionBroadphase=y;
},{"./../Physics":"uSEN","./DynamicTree":"BGmr","./Pair":"zTU8","../Algebra":"NGcQ","../Util/Log":"p1Gn","../Events":"XySq","./CollisionType":"liCD"}],"FNCP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});
},{}],"kKHB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./Body");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(r in exports&&exports[r]===e[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}}))});var r=require("./Collider");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===r[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return r[e]}}))});var t=require("./BoundingBox");Object.keys(t).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===t[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return t[e]}}))});var o=require("./Circle");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===o[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return o[e]}}))});var n=require("./CollisionContact");Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===n[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return n[e]}}))});var u=require("./CollisionJumpTable");Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===u[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return u[e]}}))});var i=require("./ClosestLineJumpTable");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===i[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return i[e]}}))});var s=require("./CollisionGroup");Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===s[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return s[e]}}))});var c=require("./CollisionGroupManager");Object.keys(c).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===c[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return c[e]}}))});var f=require("./DynamicTree");Object.keys(f).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===f[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return f[e]}}))});var a=require("./DynamicTreeCollisionBroadphase");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===a[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return a[e]}}))});var p=require("./Edge");Object.keys(p).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===p[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return p[e]}}))});var l=require("./CollisionShape");Object.keys(l).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===l[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return l[e]}}))});var d=require("./CollisionResolver");Object.keys(d).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===d[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return d[e]}}))});var b=require("./Physics");Object.keys(b).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===b[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return b[e]}}))});var x=require("./Pair");Object.keys(x).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===x[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return x[e]}}))});var y=require("./ConvexPolygon");Object.keys(y).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===y[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return y[e]}}))});var _=require("./Side");Object.keys(_).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===_[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return _[e]}}))});var j=require("./Shape");Object.keys(j).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===j[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return j[e]}}))});
},{"./Body":"oGoG","./Collider":"KRUI","./BoundingBox":"oyna","./Circle":"xS4a","./CollisionContact":"rA38","./CollisionJumpTable":"fXkm","./ClosestLineJumpTable":"j4ks","./CollisionGroup":"NyBG","./CollisionGroupManager":"Tnas","./DynamicTree":"BGmr","./DynamicTreeCollisionBroadphase":"O6gl","./Edge":"s26C","./CollisionShape":"FNCP","./CollisionResolver":"FNCP","./Physics":"FNCP","./Pair":"zTU8","./ConvexPolygon":"EI0S","./Side":"YM02","./Shape":"Mmyc"}],"yomt":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Screen=exports.Resolution=exports.DisplayMode=void 0;var i,t=require("./Algebra"),e=require("./Util/Log"),n=require("./Collision/Index"),s=require("./Util/Util");function o(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}function r(i,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,n.key,n)}}function a(i,t,e){return t&&r(i.prototype,t),e&&r(i,e),i}exports.DisplayMode=i,function(i){i.Fit="Fit",i.Fill="Fill",i.Fixed="Fixed",i.Position="Position",i.Container="Container"}(i||(exports.DisplayMode=i={}));var h=function(){function i(){o(this,i)}return a(i,null,[{key:"SVGA",get:function(){return{width:800,height:600}}},{key:"Standard",get:function(){return{width:1920,height:1080}}},{key:"Atari2600",get:function(){return{width:160,height:192}}},{key:"GameBoy",get:function(){return{width:160,height:144}}},{key:"GameBoyAdvance",get:function(){return{width:240,height:160}}},{key:"NintendoDS",get:function(){return{width:256,height:192}}},{key:"NES",get:function(){return{width:256,height:224}}},{key:"SNES",get:function(){return{width:256,height:244}}}]),i}();exports.Resolution=h;var l=function(){function r(t){var n,s,a,h=this;o(this,r),this._antialiasing=!0,this._resolutionStack=[],this._viewportStack=[],this._pixelRatioOverride=null,this._isFullScreen=!1,this._isDisposed=!1,this._logger=e.Logger.getInstance(),this._fullscreenChangeHandler=function(){h._isFullScreen=!h._isFullScreen,h._logger.debug("Fullscreen Change",h._isFullScreen)},this._pixelRatioChangeHandler=function(){h._logger.debug("Pixel Ratio Change",window.devicePixelRatio),h._devicePixelRatio=h._calculateDevicePixelRatio(),h.applyResolutionAndViewport()},this._windowResizeHandler=function(){var t=h.displayMode===i.Container?h.canvas.parentElement||document.body:window;h._logger.debug("View port resized"),h._setResolutionAndViewportByDisplayMode(t),h.applyResolutionAndViewport()},this._devicePixelRatio=this._calculateDevicePixelRatio(),this.viewport=t.viewport,this.resolution=null!==(n=t.resolution)&&void 0!==n?n:Object.assign({},this.viewport),this._displayMode=null!==(s=t.displayMode)&&void 0!==s?s:i.Fixed,this._canvas=t.canvas,this._ctx=t.context,this._antialiasing=null!==(a=t.antialiasing)&&void 0!==a?a:this._antialiasing,this._browser=t.browser,this._position=t.position,this._pixelRatioOverride=t.pixelRatio,this._applyDisplayMode(),this._mediaQueryList=this._browser.window.nativeComponent.matchMedia("(resolution: ".concat(window.devicePixelRatio,"dppx)")),this._mediaQueryList.addEventListener("change",this._pixelRatioChangeHandler),this._canvas.addEventListener("fullscreenchange",this._fullscreenChangeHandler)}return a(r,[{key:"dispose",value:function(){this._isDisposed||(this._isDisposed=!0,this._browser.window.off("resize",this._windowResizeHandler),this._mediaQueryList.removeEventListener("change",this._pixelRatioChangeHandler),this._canvas.removeEventListener("fullscreenchange",this._fullscreenChangeHandler))}},{key:"_calculateDevicePixelRatio",value:function(){return window.devicePixelRatio<1?1:window.devicePixelRatio||1}},{key:"pixelRatio",get:function(){return this._pixelRatioOverride?this._pixelRatioOverride:this._devicePixelRatio}},{key:"isHiDpi",get:function(){return 1!==this.pixelRatio}},{key:"displayMode",get:function(){return this._displayMode}},{key:"canvas",get:function(){return this._canvas}},{key:"resolution",get:function(){return this._resolution},set:function(i){this._resolution=i}},{key:"viewport",get:function(){return this._viewport?this._viewport:this._resolution},set:function(i){this._viewport=i}},{key:"aspectRatio",get:function(){return this._resolution.width/this._resolution.height}},{key:"scaledWidth",get:function(){return this._resolution.width*this.pixelRatio}},{key:"scaledHeight",get:function(){return this._resolution.height*this.pixelRatio}},{key:"setCurrentCamera",value:function(i){this._camera=i}},{key:"pushResolutionAndViewport",value:function(){this._resolutionStack.push(this.resolution),this._viewportStack.push(this.viewport),this.resolution=Object.assign({},this.resolution),this.viewport=Object.assign({},this.viewport)}},{key:"popResolutionAndViewport",value:function(){this.resolution=this._resolutionStack.pop(),this.viewport=this._viewportStack.pop()}},{key:"applyResolutionAndViewport",value:function(){this._canvas.width=this.scaledWidth,this._canvas.height=this.scaledHeight,this._antialiasing?this._canvas.style.imageRendering="auto":(this._canvas.style.imageRendering="pixelated",""===this._canvas.style.imageRendering&&(this._canvas.style.imageRendering="crisp-edges")),this._canvas.style.width=this.viewport.width+"px",this._canvas.style.height=this.viewport.height+"px",this._ctx.updateViewport(),this._ctx.resetTransform(),this._ctx.scale(this.pixelRatio,this.pixelRatio),this._ctx.smoothing=this._antialiasing}},{key:"antialiasing",get:function(){return this._antialiasing},set:function(i){this._antialiasing=i,this._ctx.smoothing=this._antialiasing}},{key:"isFullScreen",get:function(){return this._isFullScreen}},{key:"goFullScreen",value:function(){return this._canvas.requestFullscreen()}},{key:"exitFullScreen",value:function(){return document.exitFullscreen()}},{key:"pageToScreenCoordinates",value:function(i){var e=i.x,n=i.y;if(this._isFullScreen||(e-=(0,s.getPosition)(this._canvas).x,n-=(0,s.getPosition)(this._canvas).y),this._isFullScreen)if(window.innerWidth/this.aspectRatio<window.innerHeight){var o=window.innerWidth/this.aspectRatio;n=(n-(window.innerHeight-o)/2)/o*this.viewport.height,e=e/window.innerWidth*this.viewport.width}else{var r=window.innerHeight*this.aspectRatio;e=(e-(window.innerWidth-r)/2)/r*this.viewport.width,n=n/window.innerHeight*this.viewport.height}return e=e/this.viewport.width*this.resolution.width,n=n/this.viewport.height*this.resolution.height,new t.Vector(e,n)}},{key:"screenToPageCoordinates",value:function(i){var e=i.x,n=i.y;if(e=e/this.resolution.width*this.viewport.width,n=n/this.resolution.height*this.viewport.height,this._isFullScreen)if(window.innerWidth/this.aspectRatio<window.innerHeight){var o=window.innerWidth/this.aspectRatio,r=(window.innerHeight-o)/2;n=n/this.viewport.height*o+r,e=e/this.viewport.width*window.innerWidth}else{var a=window.innerHeight*this.aspectRatio,h=(window.innerWidth-a)/2;e=e/this.viewport.width*a+h,n=n/this.viewport.height*window.innerHeight}return this._isFullScreen||(e+=(0,s.getPosition)(this._canvas).x,n+=(0,s.getPosition)(this._canvas).y),new t.Vector(e,n)}},{key:"screenToWorldCoordinates",value:function(i){var e,n,s,o,r=i.x,a=i.y;return r=r/this.resolution.width*this.drawWidth,a=a/this.resolution.height*this.drawHeight,r-=this.halfDrawWidth,a-=this.halfDrawHeight,r+=null!==(n=null===(e=this._camera)||void 0===e?void 0:e.x)&&void 0!==n?n:0,a+=null!==(o=null===(s=this._camera)||void 0===s?void 0:s.y)&&void 0!==o?o:0,new t.Vector(r,a)}},{key:"worldToScreenCoordinates",value:function(i){var e,n,s,o,r=i.x,a=i.y;return r-=null!==(n=null===(e=this._camera)||void 0===e?void 0:e.x)&&void 0!==n?n:0,a-=null!==(o=null===(s=this._camera)||void 0===s?void 0:s.y)&&void 0!==o?o:0,r+=this.halfDrawWidth,a+=this.halfDrawHeight,r=r/this.drawWidth*this.resolution.width,a=a/this.drawHeight*this.resolution.height,new t.Vector(r,a)}},{key:"pageToWorldCoordinates",value:function(i){var t=this.pageToScreenCoordinates(i);return this.screenToWorldCoordinates(t)}},{key:"worldToPageCoordinates",value:function(i){var t=this.worldToScreenCoordinates(i);return this.screenToPageCoordinates(t)}},{key:"getWorldBounds",value:function(){var i=this.screenToWorldCoordinates(t.Vector.Zero).x,e=this.screenToWorldCoordinates(t.Vector.Zero).y,s=i+this.drawWidth,o=e+this.drawHeight;return new n.BoundingBox(i,e,s,o)}},{key:"canvasWidth",get:function(){return this.canvas.width}},{key:"halfCanvasWidth",get:function(){return this.canvas.width/2}},{key:"canvasHeight",get:function(){return this.canvas.height}},{key:"halfCanvasHeight",get:function(){return this.canvas.height/2}},{key:"drawWidth",get:function(){return this._camera?this.scaledWidth/this._camera.zoom/this.pixelRatio:this.scaledWidth/this.pixelRatio}},{key:"halfDrawWidth",get:function(){return this.drawWidth/2}},{key:"drawHeight",get:function(){return this._camera?this.scaledHeight/this._camera.zoom/this.pixelRatio:this.scaledHeight/this.pixelRatio}},{key:"halfDrawHeight",get:function(){return this.drawHeight/2}},{key:"_computeFit",value:function(){document.body.style.margin="0px",document.body.style.overflow="hidden";var i=this.aspectRatio,t=0,e=0;window.innerWidth/i<window.innerHeight?(t=window.innerWidth,e=window.innerWidth/i):(t=window.innerHeight*i,e=window.innerHeight),this.viewport={width:t,height:e}}},{key:"_applyDisplayMode",value:function(){if(this.displayMode===i.Fit||this.displayMode===i.Fill||this.displayMode===i.Container){var t=this.displayMode===i.Container?this.canvas.parentElement||document.body:window;this._setResolutionAndViewportByDisplayMode(t),this._browser.window.on("resize",this._windowResizeHandler)}else this.displayMode===i.Position&&this._initializeDisplayModePosition(this._position)}},{key:"_setResolutionAndViewportByDisplayMode",value:function(t){this.displayMode===i.Container&&(this.resolution={width:t.clientWidth,height:t.clientHeight},this.viewport=this.resolution),this.displayMode===i.Fill&&(document.body.style.margin="0px",document.body.style.overflow="hidden",this.resolution={width:t.innerWidth,height:t.innerHeight},this.viewport=this.resolution),this.displayMode===i.Fit&&this._computeFit()}},{key:"_initializeDisplayModePosition",value:function(i){if(!i)throw new Error("DisplayMode of Position was selected but no position option was given");if(this.canvas.style.display="block",this.canvas.style.position="absolute","string"==typeof i){var t=i.split(" ");switch(t[0]){case"top":this.canvas.style.top="0px";break;case"bottom":this.canvas.style.bottom="0px";break;case"middle":this.canvas.style.top="50%";var e=-this.halfDrawHeight;this.canvas.style.marginTop=e.toString();break;default:throw new Error("Invalid Position Given")}if(t[1])switch(t[1]){case"left":this.canvas.style.left="0px";break;case"right":this.canvas.style.right="0px";break;case"center":this.canvas.style.left="50%";var n=-this.halfDrawWidth;this.canvas.style.marginLeft=n.toString();break;default:throw new Error("Invalid Position Given")}}else i.top&&("number"==typeof i.top?this.canvas.style.top=i.top.toString()+"px":this.canvas.style.top=i.top),i.right&&("number"==typeof i.right?this.canvas.style.right=i.right.toString()+"px":this.canvas.style.right=i.right),i.bottom&&("number"==typeof i.bottom?this.canvas.style.bottom=i.bottom.toString()+"px":this.canvas.style.bottom=i.bottom),i.left&&("number"==typeof i.left?this.canvas.style.left=i.left.toString()+"px":this.canvas.style.left=i.left)}}]),r}();exports.Screen=l;
},{"./Algebra":"NGcQ","./Util/Log":"p1Gn","./Collision/Index":"kKHB","./Util/Util":"Kkda"}],"lN80":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Resource=void 0;var e=require("../Util/Log"),t=require("../EventDispatcher");function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}var o=function(){function n(a,o){var s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];r(this,n),this.path=a,this.responseType=o,this.bustCache=s,this.data=null,this.logger=e.Logger.getInstance(),this.events=new t.EventDispatcher(this)}return a(n,[{key:"isLoaded",value:function(){return null!==this.data}},{key:"_cacheBust",value:function(e){return/\?\w*=\w*/.test(e)?e+="&__="+Date.now():e+="?__="+Date.now(),e}},{key:"load",value:function(){var e=this;return new Promise(function(t,r){if(null!==e.data)return e.logger.debug("Already have data for resource",e.path),e.events.emit("complete",e.data),void t(e.data);var n=new XMLHttpRequest;n.open("GET",e.bustCache?e._cacheBust(e.path):e.path,!0),n.responseType=e.responseType,n.addEventListener("loadstart",function(t){return e.events.emit("loadstart",t)}),n.addEventListener("progress",function(t){return e.events.emit("progress",t)}),n.addEventListener("error",function(t){return e.events.emit("error",t)}),n.addEventListener("load",function(t){return e.events.emit("load",t)}),n.addEventListener("load",function(){if(0!==n.status&&200!==n.status)return e.logger.error("Failed to load resource ",e.path," server responded with error code",n.status),e.events.emit("error",n.response),void r(n.response);e.data=n.response,e.events.emit("complete",e.data),e.logger.debug("Completed loading resource",e.path),t(e.data)}),n.send()})}}]),n}();exports.Resource=o;
},{"../Util/Log":"p1Gn","../EventDispatcher":"c7EN"}],"OEQf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Fill=exports.Desaturate=exports.Saturate=exports.Darken=exports.Lighten=exports.Colorize=exports.Opacity=exports.Invert=exports.Grayscale=void 0;var e=require("../Util/Decorators"),t=require("./Color");function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,o){return t&&r(e.prototype,t),o&&r(e,o),e}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var n=function(e,t,o,r){var a,n=arguments.length,l=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(l=(n<3?a(l):n>3?a(t,o,l):a(t,o))||l);return n>3&&l&&Object.defineProperty(t,o,l),l},l=function(){function e(){o(this,e)}return a(e,[{key:"updatePixel",value:function(e,t,o){var r=4*(e+t*o.width),a=o.data,i=(a[r+0]+a[r+1]+a[r+2])/3;a[r+0]=i,a[r+1]=i,a[r+2]=i}}]),e}();exports.Grayscale=l,exports.Grayscale=l=n([(0,e.obsolete)({message:"Grayscale will be removed in v0.26.0"})],l);var s=function(){function e(){o(this,e)}return a(e,[{key:"updatePixel",value:function(e,t,o){var r=4*(e+t*o.width),a=o.data;a[r+0]=255-a[r+0],a[r+1]=255-a[r+1],a[r+2]=255-a[r+2]}}]),e}();exports.Invert=s,exports.Invert=s=n([(0,e.obsolete)({message:"Invert will be removed in v0.26.0"})],s);var u=function(){function e(t){o(this,e),this.opacity=t}return a(e,[{key:"updatePixel",value:function(e,t,o){var r=4*(e+t*o.width),a=o.data;0!==a[r+3]&&(a[r+3]=Math.round(this.opacity*a[r+3]))}}]),e}();exports.Opacity=u,exports.Opacity=u=n([(0,e.obsolete)({message:"Opacity will be removed in v0.26.0"})],u);var c=function(){function e(t){o(this,e),this.color=t}return a(e,[{key:"updatePixel",value:function(e,t,o){var r=4*(e+t*o.width),a=o.data;0!==a[r+3]&&(a[r+0]=(a[r+0]+this.color.r)/2,a[r+1]=(a[r+1]+this.color.g)/2,a[r+2]=(a[r+2]+this.color.b)/2)}}]),e}();exports.Colorize=c,exports.Colorize=c=n([(0,e.obsolete)({message:"Colorize will be removed in v0.26.0"})],c);var f=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;o(this,e),this.factor=t}return a(e,[{key:"updatePixel",value:function(e,o,r){var a=4*(e+o*r.width),i=r.data,n=t.Color.fromRGB(i[a+0],i[a+1],i[a+2],i[a+3]).lighten(this.factor);i[a+0]=n.r,i[a+1]=n.g,i[a+2]=n.b,i[a+3]=n.a}}]),e}();exports.Lighten=f,exports.Lighten=f=n([(0,e.obsolete)({message:"Lighten will be removed in v0.26.0"})],f);var v=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;o(this,e),this.factor=t}return a(e,[{key:"updatePixel",value:function(e,o,r){var a=4*(e+o*r.width),i=r.data,n=t.Color.fromRGB(i[a+0],i[a+1],i[a+2],i[a+3]).darken(this.factor);i[a+0]=n.r,i[a+1]=n.g,i[a+2]=n.b,i[a+3]=n.a}}]),e}();exports.Darken=v,exports.Darken=v=n([(0,e.obsolete)({message:"Darken will be removed v0.26.0"})],v);var p=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;o(this,e),this.factor=t}return a(e,[{key:"updatePixel",value:function(e,o,r){var a=4*(e+o*r.width),i=r.data,n=t.Color.fromRGB(i[a+0],i[a+1],i[a+2],i[a+3]).saturate(this.factor);i[a+0]=n.r,i[a+1]=n.g,i[a+2]=n.b,i[a+3]=n.a}}]),e}();exports.Saturate=p,exports.Saturate=p=n([(0,e.obsolete)({message:"Saturate will be removed in v0.26.0"})],p);var d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;o(this,e),this.factor=t}return a(e,[{key:"updatePixel",value:function(e,o,r){var a=4*(e+o*r.width),i=r.data,n=t.Color.fromRGB(i[a+0],i[a+1],i[a+2],i[a+3]).desaturate(this.factor);i[a+0]=n.r,i[a+1]=n.g,i[a+2]=n.b,i[a+3]=n.a}}]),e}();exports.Desaturate=d,exports.Desaturate=d=n([(0,e.obsolete)({message:"Desaturate will be removed in v0.26.0"})],d);var h=function(){function e(t){o(this,e),this.color=t}return a(e,[{key:"updatePixel",value:function(e,t,o){var r=4*(e+t*o.width),a=o.data;0!==a[r+3]&&(a[r+0]=this.color.r,a[r+1]=this.color.g,a[r+2]=this.color.b)}}]),e}();exports.Fill=h,exports.Fill=h=n([(0,e.obsolete)({message:"Fill will be removed in v0.26.0"})],h);
},{"../Util/Decorators":"kQDE","./Color":"p7Gh"}],"A4Kj":[function(require,module,exports) {
"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function r(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=a();return function(){var n,r=l(t);if(e){var o=l(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return f(this,n)}}function f(e,n){return!n||"object"!==t(n)&&"function"!=typeof n?i(e):n}function i(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(n){return function(u){o(i,n);var f=c(i);function i(){var n;e(this,i);for(var r=arguments.length,o=new Array(r),u=0;u<r;u++)o[u]=arguments[u];return n=f.call.apply(f,[this].concat(o)),1!==o.filter(function(t){return void 0!==t}).length||!o[0]||"object"!==t(o[0])||o[0]instanceof Array||n.assign(o[0]),n}return r(i,[{key:"assign",value:function(t){for(var e in t)"function"!=typeof this[e]&&(this[e]=t[e])}}]),i}()}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Configurable=s;
},{}],"PpGD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Sprite=exports.SpriteImpl=void 0;var t=c(require("./SpriteEffects")),e=require("./Color"),i=require("../Resources/Texture"),r=require("../Algebra"),n=require("../Util/Log"),a=require("../Util/Util"),s=require("../Configurable"),o=require("../Util/Decorators");function h(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return h=function(){return t},t}function c(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=h();if(e&&e.has(t))return e.get(t);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var a=r?Object.getOwnPropertyDescriptor(t,n):null;a&&(a.get||a.set)?Object.defineProperty(i,n,a):i[n]=t[n]}return i.default=t,e&&e.set(t,i),i}function l(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=g();return function(){var i,r=y(t);if(e){var n=y(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return d(this,i)}}function d(t,e){return!e||"object"!==_(e)&&"function"!=typeof e?p(t):e}function p(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function w(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function x(t,e,i){return e&&w(t.prototype,e),i&&w(t,i),t}function _(t){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var b=function(t,e,i,r){var n,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"===("undefined"==typeof Reflect?"undefined":_(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(s=(a<3?n(s):a>3?n(e,i,s):n(e,i))||s);return a>3&&s&&Object.defineProperty(e,i,s),s},m=function(t,e,i,r){return new(i||(i=Promise))(function(n,a){function s(t){try{h(r.next(t))}catch(e){a(e)}}function o(t){try{h(r.throw(t))}catch(e){a(e)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(s,o)}h((r=r.apply(t,e||[])).next())})},k=function(){function s(t,e,a,o,h){v(this,s),this.x=0,this.y=0,this.rotation=0,this.anchor=r.Vector.Half,this.offset=r.Vector.Zero,this.scale=r.Vector.One,this.drawAroundAnchor=!1,this.logger=n.Logger.getInstance(),this.flipVertical=!1,this.flipHorizontal=!1,this.effects=[],this.width=0,this.height=0,this._spriteCanvas=null,this._spriteCtx=null,this._pixelData=null,this._pixelsLoaded=!1,this._dirtyEffect=!0,this._opacity=1;var c=t;if(t&&!(t instanceof i.Texture)&&(e=0|t.x,a=0|t.y,o=0|t.width,h=0|t.height,!(c=t.image))){throw new Error("An image texture is required to construct a sprite")}this.x=e||0,this.y=a||0,this.texture=c,this._spriteCanvas=document.createElement("canvas"),this._spriteCanvas.width=o,this._spriteCanvas.height=h,this._spriteCtx=this._spriteCanvas.getContext("2d"),this._initPixelsFromTexture(),this.width=o,this.height=h}return x(s,[{key:"drawWidth",get:function(){return Math.abs(this.width*this.scale.x)}},{key:"drawHeight",get:function(){return Math.abs(this.height*this.scale.y)}},{key:"_initPixelsFromTexture",value:function(){return m(this,void 0,void 0,regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.texture.loaded;case 3:e=t.sent,this.width=this.width||e.naturalWidth,this.height=this.height||e.naturalHeight,this._spriteCanvas.width=this._spriteCanvas.width||e.naturalWidth,this._spriteCanvas.height=this._spriteCanvas.height||e.naturalHeight,this._loadPixels(),this._dirtyEffect=!0,t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),this.logger.error("Error loading texture ",this.texture.path,t.t0);case 15:case"end":return t.stop()}},t,this,[[0,12]])}))}},{key:"_loadPixels",value:function(){if(this.texture.isLoaded()&&!this._pixelsLoaded){var t=this.texture.image.naturalWidth||0,e=this.texture.image.naturalHeight||0;if(this.width>t&&this.logger.warn("The sprite width ".concat(this.width," exceeds the width \n                              ").concat(t," of the backing texture ").concat(this.texture.path)),this.width<=0||t<=0)throw new Error("The width of a sprite cannot be 0 or negative, sprite width: ".concat(this.width,", original width: ").concat(t));if(this.height>e&&this.logger.warn("The sprite height ".concat(this.height," exceeds the height \n                              ").concat(e," of the backing texture ").concat(this.texture.path)),this.height<=0||e<=0)throw new Error("The height of a sprite cannot be 0 or negative, sprite height: ".concat(this.height,", original height: ").concat(e));this._flushTexture(),this._pixelsLoaded=!0}}},{key:"_flushTexture",value:function(){var t=this.texture.image.naturalWidth||0,e=this.texture.image.naturalHeight||0;this._spriteCtx.clearRect(0,0,this.width,this.height),this._spriteCtx.drawImage(this.texture.image,(0,a.clamp)(this.x,0,t),(0,a.clamp)(this.y,0,e),(0,a.clamp)(this.width,0,t),(0,a.clamp)(this.height,0,e),0,0,this.width,this.height)}},{key:"opacity",value:function(t){this._opacity=t}},{key:"grayscale",value:function(){this.addEffect(new t.Grayscale)}},{key:"invert",value:function(){this.addEffect(new t.Invert)}},{key:"fill",value:function(e){this.addEffect(new t.Fill(e))}},{key:"colorize",value:function(e){this.addEffect(new t.Colorize(e))}},{key:"lighten",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;this.addEffect(new t.Lighten(e))}},{key:"darken",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;this.addEffect(new t.Darken(e))}},{key:"saturate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;this.addEffect(new t.Saturate(e))}},{key:"desaturate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;this.addEffect(new t.Desaturate(e))}},{key:"addEffect",value:function(t){this.effects.push(t),this.texture.isLoaded()&&this._pixelsLoaded?this._applyEffects():this._dirtyEffect=!0}},{key:"removeEffect",value:function(t){var e=-1;(e="number"==typeof t?t:this.effects.indexOf(t))<0||e>=this.effects.length||(this.effects.splice(e,1),this.texture.isLoaded()&&this._pixelsLoaded?this._applyEffects():this._dirtyEffect=!0)}},{key:"_applyEffects",value:function(){if(this._flushTexture(),this.effects.length>0){this._pixelData=this._spriteCtx.getImageData(0,0,this.width,this.height);for(var t=this.effects.length,e=0;e<t;e++)for(var i=0;i<this.height;i++)for(var r=0;r<this.width;r++)this.effects[e].updatePixel(r,i,this._pixelData);this._spriteCtx.clearRect(0,0,this.width,this.height),this._spriteCtx.putImageData(this._pixelData,0,0)}this._dirtyEffect=!1}},{key:"clearEffects",value:function(){this.effects.length=0,this._applyEffects()}},{key:"reset",value:function(){}},{key:"debugDraw",value:function(t,i,r){t.save(),t.translate(i,r),t.rotate(this.rotation);var n=this.drawWidth*this.anchor.x,a=this.drawHeight*this.anchor.y;t.strokeStyle=e.Color.Black.toString(),t.strokeRect(-n,-a,this.drawWidth,this.drawHeight),t.restore()}},{key:"draw",value:function(t,e,i){t instanceof CanvasRenderingContext2D?this._drawWithOptions({ctx:t,x:e,y:i}):this._drawWithOptions(t)}},{key:"_drawWithOptions",value:function(t){var e,i,r,n,a,s,o,h,c=Object.assign(Object.assign({},t),{rotation:null!==(e=t.rotation)&&void 0!==e?e:this.rotation,drawWidth:null!==(i=t.drawWidth)&&void 0!==i?i:this.width,drawHeight:null!==(r=t.drawHeight)&&void 0!==r?r:this.height,flipHorizontal:null!==(n=t.flipHorizontal)&&void 0!==n?n:this.flipHorizontal,flipVertical:null!==(a=t.flipVertical)&&void 0!==a?a:this.flipVertical,anchor:null!==(s=t.anchor)&&void 0!==s?s:this.anchor,offset:null!==(o=t.offset)&&void 0!==o?o:this.offset,opacity:null!==(h=t.opacity)&&void 0!==h?h:this._opacity}),l=c.ctx,f=c.x,u=c.y,d=c.rotation,p=c.drawWidth,g=c.drawHeight,y=c.anchor,v=c.offset,w=c.opacity,x=c.flipHorizontal,_=c.flipVertical;this._dirtyEffect&&this._applyEffects();var b=p*y.x+v.x,m=g*y.y+v.y,k=this.scale.x>0?1:-1,E=this.scale.y>0?1:-1;l.save(),l.translate(f,u),l.scale(Math.abs(this.scale.x),Math.abs(this.scale.y)),this.drawAroundAnchor&&l.translate(-b,-m),l.translate(b,m),l.rotate(d),l.scale(k,E),l.translate(-b,-m),x&&(l.translate(p,0),l.scale(-1,1)),_&&(l.translate(0,g),l.scale(1,-1));var O=l.globalAlpha;l.globalAlpha=null!=w?w:1,l.drawImage(this._spriteCanvas,0,0,this.width,this.height,0,0,this.width,this.height),l.globalAlpha=O,l.restore()}},{key:"clone",value:function(){var t=new E(this.texture,this.x,this.y,this.width,this.height);t.anchor=this.anchor.clone(),t.scale=this.scale.clone(),t.rotation=this.rotation,t.flipHorizontal=this.flipHorizontal,t.flipVertical=this.flipVertical;for(var e=this.effects.length,i=0;i<e;i++)t.addEffect(this.effects[i]);return t}}]),s}();exports.SpriteImpl=k;var E=function(t){l(i,(0,s.Configurable)(k));var e=u(i);function i(t,r,n,a,s){return v(this,i),e.call(this,t,r,n,a,s)}return i}();exports.Sprite=E,exports.Sprite=E=b([(0,o.obsolete)({message:"Label.clearTextShadow will be removed in v0.26.0",alternateMethod:"Use Label.font.shadow"})],E);
},{"./SpriteEffects":"OEQf","./Color":"p7Gh","../Resources/Texture":"HrNa","../Algebra":"NGcQ","../Util/Log":"p1Gn","../Util/Util":"Kkda","../Configurable":"A4Kj","../Util/Decorators":"kQDE"}],"HrNa":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Texture=void 0;var e=require("./Resource"),t=require("../Drawing/Sprite");function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}var a=function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function s(e){try{u(n.next(e))}catch(t){a(t)}}function o(e){try{u(n.throw(e))}catch(t){a(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,o)}u((n=n.apply(e,t||[])).next())})},s=function(){function n(i){var a=this,s=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];r(this,n),this.path=i,this.bustCache=s,this._sprite=null,this.loaded=new Promise(function(e){a._loadedResolve=e}),this._resource=new e.Resource(i,"blob",s),this._sprite=new t.Sprite(this,0,0,0,0)}return i(n,[{key:"image",get:function(){return this.data}},{key:"isLoaded",value:function(){return!!this.data}},{key:"load",value:function(){return a(this,void 0,void 0,regeneratorRuntime.mark(function e(){var r,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.path.includes("data:image/")){e.next=8;break}return e.next=4,this._resource.load();case 4:n=e.sent,r=URL.createObjectURL(n),e.next=9;break;case 8:r=this.path;case 9:return(i=new Image).src=r,e.next=13,i.decode();case 13:this.data=i,this.width=this._sprite.width=i.naturalWidth,this.height=this._sprite.height=i.naturalHeight,this._sprite=new t.Sprite(this,0,0,this.width,this.height),e.next=23;break;case 19:return e.prev=19,e.t0=e.catch(0),e.next=23,Promise.reject("Error loading texture");case 23:return this._loadedResolve(this.data),e.abrupt("return",this.data);case 25:case"end":return e.stop()}},e,this,[[0,19]])}))}},{key:"asSprite",value:function(){return this._sprite}}]),n}();exports.Texture=s;
},{"./Resource":"lN80","../Drawing/Sprite":"PpGD"}],"qSfQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Animation=exports.AnimationImpl=void 0;var t=a(require("./SpriteEffects")),e=require("../Algebra"),i=require("../Engine"),r=a(require("../Util/Util")),n=require("../Configurable"),o=require("../Util/Decorators");function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}function a(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var o=r?Object.getOwnPropertyDescriptor(t,n):null;o&&(o.get||o.set)?Object.defineProperty(i,n,o):i[n]=t[n]}return i.default=t,e&&e.set(t,i),i}function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=p();return function(){var i,r=d(t);if(e){var n=d(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return f(this,i)}}function f(t,e){return!e||"object"!==g(e)&&"function"!=typeof e?l(t):e}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function m(t,e,i){return e&&v(t.prototype,e),i&&v(t,i),t}function g(t){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var w=function(t,e,i,r){var n,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"===("undefined"==typeof Reflect?"undefined":g(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},b=function(){function n(t,r,o,s){y(this,n),this.sprites=[],this.currentFrame=0,this._timeLeftInFrame=0,this._idempotencyToken=-1,this.anchor=e.Vector.Zero,this.rotation=0,this.scale=e.Vector.One,this.loop=!0,this.freezeFrame=-1,this.flipVertical=!1,this.flipHorizontal=!1,this.drawWidth=0,this.drawHeight=0,this.width=0,this.height=0,this._opacity=1;var a=t;if(t&&!(t instanceof i.Engine)){var c=t;a=c.engine,r=c.sprites,o=c.speed,s=c.loop}this.sprites=r,this.speed=o,this._engine=a,this._timeLeftInFrame=this.speed,null!=s&&(this.loop=s),r&&r[0]&&(this.drawHeight=r[0]?r[0].drawHeight:0,this.drawWidth=r[0]?r[0].drawWidth:0,this.width=r[0]?r[0].width:0,this.height=r[0]?r[0].height:0,this.freezeFrame=r.length-1)}return m(n,[{key:"opacity",value:function(t){this._opacity=t}},{key:"grayscale",value:function(){this.addEffect(new t.Grayscale)}},{key:"invert",value:function(){this.addEffect(new t.Invert)}},{key:"fill",value:function(e){this.addEffect(new t.Fill(e))}},{key:"colorize",value:function(e){this.addEffect(new t.Colorize(e))}},{key:"lighten",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;this.addEffect(new t.Lighten(e))}},{key:"darken",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;this.addEffect(new t.Darken(e))}},{key:"saturate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;this.addEffect(new t.Saturate(e))}},{key:"desaturate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;this.addEffect(new t.Desaturate(e))}},{key:"addEffect",value:function(t){for(var e in this.sprites)this.sprites[e].addEffect(t)}},{key:"removeEffect",value:function(t){for(var e in this.sprites)this.sprites[e].removeEffect(t)}},{key:"clearEffects",value:function(){for(var t in this.sprites)this.sprites[t].clearEffects()}},{key:"_setAnchor",value:function(t){for(var e in this.sprites)this.sprites[e].anchor.setTo(t.x,t.y)}},{key:"_setRotation",value:function(t){for(var e in this.sprites)this.sprites[e].rotation=t}},{key:"_setScale",value:function(t){for(var e in this.sprites)this.sprites[e].scale=t}},{key:"reset",value:function(){this.currentFrame=0}},{key:"isDone",value:function(){return!this.loop&&this.currentFrame>=this.sprites.length}},{key:"tick",value:function(t,e){if(this._idempotencyToken!==e){this._idempotencyToken=e,this._timeLeftInFrame-=t,this._timeLeftInFrame<=0&&(this.currentFrame=this.loop?(this.currentFrame+1)%this.sprites.length:this.currentFrame+1,this._timeLeftInFrame=this.speed),this._updateValues();var i=this.sprites[this.currentFrame];i&&(this.width=i.width,this.height=i.height,this.drawWidth=i.drawWidth,this.drawHeight=i.drawHeight)}}},{key:"_updateValues",value:function(){this._setAnchor(this.anchor),this._setRotation(this.rotation),this._setScale(this.scale)}},{key:"skip",value:function(t){this.currentFrame=(this.currentFrame+t)%this.sprites.length}},{key:"draw",value:function(t,e,i){t instanceof CanvasRenderingContext2D?this._drawWithOptions({ctx:t,x:e,y:i}):this._drawWithOptions(t)}},{key:"_drawWithOptions",value:function(t){var e,i,n,o,s,a,c,h,u=Object.assign(Object.assign({},t),{rotation:null!==(e=t.rotation)&&void 0!==e?e:this.rotation,drawWidth:null!==(i=t.drawWidth)&&void 0!==i?i:this.drawWidth,drawHeight:null!==(n=t.drawHeight)&&void 0!==n?n:this.drawHeight,flipHorizontal:null!==(o=t.flipHorizontal)&&void 0!==o?o:this.flipHorizontal,flipVertical:null!==(s=t.flipVertical)&&void 0!==s?s:this.flipVertical,anchor:null!==(a=t.anchor)&&void 0!==a?a:this.anchor,opacity:null!==(c=t.opacity)&&void 0!==c?c:this._opacity});this._updateValues(),this.currentFrame<this.sprites.length&&(h=this.sprites[this.currentFrame]).draw(u),-1!==this.freezeFrame&&this.currentFrame>=this.sprites.length&&(h=this.sprites[r.clamp(this.freezeFrame,0,this.sprites.length-1)]).draw(u),h&&(this.drawWidth=h.drawWidth,this.drawHeight=h.drawHeight)}},{key:"play",value:function(t,e){this.reset(),this._engine.playAnimation(this,t,e)}}]),n}();exports.AnimationImpl=b;var _=function(t){c(i,(0,n.Configurable)(b));var e=u(i);function i(t,r,n,o){return y(this,i),e.call(this,t,r,n,o)}return i}();exports.Animation=_,exports.Animation=_=w([(0,o.obsolete)({message:"Animation will be removed in v0.26.0",alternateMethod:"Use Graphics.Animation"})],_);
},{"./SpriteEffects":"OEQf","../Algebra":"NGcQ","../Engine":"CIaB","../Util/Util":"Kkda","../Configurable":"A4Kj","../Util/Decorators":"kQDE"}],"DrJU":[function(require,module,exports) {
"use strict";var t;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RotationType=void 0,exports.RotationType=t,function(t){t[t.ShortestPath=0]="ShortestPath",t[t.LongestPath=1]="LongestPath",t[t.Clockwise=2]="Clockwise",t[t.CounterClockwise=3]="CounterClockwise"}(t||(exports.RotationType=t={}));
},{}],"gDdL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ActionQueue=exports.RepeatForever=exports.Repeat=exports.CallMethod=exports.Die=exports.Fade=exports.Blink=exports.Delay=exports.ScaleBy=exports.ScaleTo=exports.RotateBy=exports.RotateTo=exports.Meet=exports.Follow=exports.MoveBy=exports.MoveTo=exports.EaseTo=void 0;var t=require("./RotationType"),e=require("../Algebra"),s=require("../Util/Log"),i=a(require("../Util/Util")),o=require("../Util/Decorators");function h(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return h=function(){return t},t}function a(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=h();if(e&&e.has(t))return e.get(t);var s={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var a=i?Object.getOwnPropertyDescriptor(t,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=t[o]}return s.default=t,e&&e.set(t,s),s}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _(t,e,s){return e&&n(t.prototype,e),s&&n(t,s),t}function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var p=function(t,e,s,i){var o,h=arguments.length,a=h<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"===("undefined"==typeof Reflect?"undefined":c(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,s,i);else for(var r=t.length-1;r>=0;r--)(o=t[r])&&(a=(h<3?o(a):h>3?o(e,s,a):o(e,s))||a);return h>3&&a&&Object.defineProperty(e,s,a),a},l=function(){function t(s,i,o,h,a){r(this,t),this.actor=s,this.easingFcn=a,this._currentLerpTime=0,this._lerpDuration=1e3,this._lerpStart=new e.Vector(0,0),this._lerpEnd=new e.Vector(0,0),this._initialized=!1,this._stopped=!1,this._distance=0,this._lerpDuration=h,this._lerpEnd=new e.Vector(i,o)}return _(t,[{key:"_initialize",value:function(){this._lerpStart=new e.Vector(this.actor.pos.x,this.actor.pos.y),this._currentLerpTime=0,this._distance=this._lerpStart.distance(this._lerpEnd)}},{key:"update",value:function(t){this._initialized||(this._initialize(),this._initialized=!0),this._currentLerpTime+=t;var s=this.actor.pos.x,i=this.actor.pos.y;this._currentLerpTime<this._lerpDuration?(s=this._lerpEnd.x<this._lerpStart.x?this._lerpStart.x-(this.easingFcn(this._currentLerpTime,this._lerpEnd.x,this._lerpStart.x,this._lerpDuration)-this._lerpEnd.x):this.easingFcn(this._currentLerpTime,this._lerpStart.x,this._lerpEnd.x,this._lerpDuration),i=this._lerpEnd.y<this._lerpStart.y?this._lerpStart.y-(this.easingFcn(this._currentLerpTime,this._lerpEnd.y,this._lerpStart.y,this._lerpDuration)-this._lerpEnd.y):this.easingFcn(this._currentLerpTime,this._lerpStart.y,this._lerpEnd.y,this._lerpDuration),this.actor.vel=(0,e.vec)((s-this.actor.pos.x)/(t/1e3),(i-this.actor.pos.y)/(t/1e3))):(this.actor.pos=(0,e.vec)(this._lerpEnd.x,this._lerpEnd.y),this.actor.vel=e.Vector.Zero)}},{key:"isComplete",value:function(t){return this._stopped||new e.Vector(t.pos.x,t.pos.y).distance(this._lerpStart)>=this._distance}},{key:"reset",value:function(){this._initialized=!1}},{key:"stop",value:function(){this.actor.vel=(0,e.vec)(0,0),this._stopped=!0}}]),t}();exports.EaseTo=l;var u=function(){function t(s,i,o,h){r(this,t),this._started=!1,this._stopped=!1,this._actor=s,this._end=new e.Vector(i,o),this._speed=h}return _(t,[{key:"update",value:function(t){this._started||(this._started=!0,this._start=new e.Vector(this._actor.pos.x,this._actor.pos.y),this._distance=this._start.distance(this._end),this._dir=this._end.sub(this._start).normalize());var s=this._dir.scale(this._speed);this._actor.vel=(0,e.vec)(s.x,s.y),this.isComplete(this._actor)&&(this._actor.pos=(0,e.vec)(this._end.x,this._end.y),this._actor.vel=(0,e.vec)(0,0))}},{key:"isComplete",value:function(t){return this._stopped||new e.Vector(t.pos.x,t.pos.y).distance(this._start)>=this._distance}},{key:"stop",value:function(){this._actor.vel=(0,e.vec)(0,0),this._stopped=!0}},{key:"reset",value:function(){this._started=!1}}]),t}();exports.MoveTo=u;var d=function(){function t(i,o,h,a){if(r(this,t),this._started=!1,this._stopped=!1,this._actor=i,this._speed=a,this._offset=new e.Vector(o,h),a<=0)throw s.Logger.getInstance().error("Attempted to moveBy with speed less than or equal to zero : "+a),new Error("Speed must be greater than 0 pixels per second")}return _(t,[{key:"update",value:function(t){this._started||(this._started=!0,this._start=new e.Vector(this._actor.pos.x,this._actor.pos.y),this._end=this._start.add(this._offset),this._distance=this._offset.size,this._dir=this._end.sub(this._start).normalize()),this._actor.vel=this._dir.scale(this._speed),this.isComplete(this._actor)&&(this._actor.pos=(0,e.vec)(this._end.x,this._end.y),this._actor.vel=(0,e.vec)(0,0))}},{key:"isComplete",value:function(t){return this._stopped||t.pos.distance(this._start)>=this._distance}},{key:"stop",value:function(){this._actor.vel=(0,e.vec)(0,0),this._stopped=!0}},{key:"reset",value:function(){this._started=!1}}]),t}();exports.MoveBy=d;var y=function(){function t(s,i,o){r(this,t),this._started=!1,this._stopped=!1,this._actor=s,this._actorToFollow=i,this._current=new e.Vector(this._actor.pos.x,this._actor.pos.y),this._end=new e.Vector(i.pos.x,i.pos.y),this._maximumDistance=void 0!==o?o:this._current.distance(this._end),this._speed=0}return _(t,[{key:"update",value:function(t){this._started||(this._started=!0,this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize());var s=Math.sqrt(Math.pow(this._actorToFollow.vel.x,2)+Math.pow(this._actorToFollow.vel.y,2));if(0!==s&&(this._speed=s),this._current=(0,e.vec)(this._actor.pos.x,this._actor.pos.y),this._end=(0,e.vec)(this._actorToFollow.pos.x,this._actorToFollow.pos.y),this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize(),this._distanceBetween>=this._maximumDistance){var i=this._dir.scale(this._speed);this._actor.vel=(0,e.vec)(i.x,i.y)}else this._actor.vel=(0,e.vec)(0,0);this.isComplete()&&(this._actor.pos=(0,e.vec)(this._end.x,this._end.y),this._actor.vel=(0,e.vec)(0,0))}},{key:"stop",value:function(){this._actor.vel=(0,e.vec)(0,0),this._stopped=!0}},{key:"isComplete",value:function(){return this._stopped}},{key:"reset",value:function(){this._started=!1}}]),t}();exports.Follow=y;var v=function(){function t(s,i,o){r(this,t),this._started=!1,this._stopped=!1,this._speedWasSpecified=!1,this._actor=s,this._actorToMeet=i,this._current=new e.Vector(this._actor.pos.x,this._actor.pos.y),this._end=new e.Vector(i.pos.x,i.pos.y),this._speed=o||0,void 0!==o&&(this._speedWasSpecified=!0)}return _(t,[{key:"update",value:function(t){this._started||(this._started=!0,this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize());var s=Math.sqrt(Math.pow(this._actorToMeet.vel.x,2)+Math.pow(this._actorToMeet.vel.y,2));0===s||this._speedWasSpecified||(this._speed=s),this._current=(0,e.vec)(this._actor.pos.x,this._actor.pos.y),this._end=(0,e.vec)(this._actorToMeet.pos.x,this._actorToMeet.pos.y),this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize();var i=this._dir.scale(this._speed);this._actor.vel=(0,e.vec)(i.x,i.y),this.isComplete()&&(this._actor.pos=(0,e.vec)(this._end.x,this._end.y),this._actor.vel=(0,e.vec)(0,0))}},{key:"isComplete",value:function(){return this._stopped||this._distanceBetween<=1}},{key:"stop",value:function(){this._actor.vel=(0,e.vec)(0,0),this._stopped=!0}},{key:"reset",value:function(){this._started=!1}}]),t}();exports.Meet=v;var f=function(){function e(s,i,o,h){r(this,e),this._started=!1,this._stopped=!1,this._actor=s,this._end=i,this._speed=o,this._rotationType=h||t.RotationType.ShortestPath}return _(e,[{key:"update",value:function(e){if(!this._started){this._started=!0,this._start=this._actor.rotation,this._currentNonCannonAngle=this._actor.rotation;var s=Math.abs(this._end-this._start),o=i.TwoPI-s;switch(s>o?(this._shortDistance=o,this._longDistance=s):(this._shortDistance=s,this._longDistance=o),this._shortestPathIsPositive=(this._start-this._end+i.TwoPI)%i.TwoPI>=Math.PI,this._rotationType){case t.RotationType.ShortestPath:this._distance=this._shortDistance,this._shortestPathIsPositive?this._direction=1:this._direction=-1;break;case t.RotationType.LongestPath:this._distance=this._longDistance,this._shortestPathIsPositive?this._direction=-1:this._direction=1;break;case t.RotationType.Clockwise:this._direction=1,this._shortestPathIsPositive?this._distance=this._shortDistance:this._distance=this._longDistance;break;case t.RotationType.CounterClockwise:this._direction=-1,this._shortestPathIsPositive?this._distance=this._longDistance:this._distance=this._shortDistance}}this._actor.rx=this._direction*this._speed,this._currentNonCannonAngle+=this._direction*this._speed*(e/1e3),this.isComplete()&&(this._actor.rotation=this._end,this._actor.rx=0,this._stopped=!0)}},{key:"isComplete",value:function(){var t=Math.abs(this._currentNonCannonAngle-this._start);return this._stopped||t>=Math.abs(this._distance)}},{key:"stop",value:function(){this._actor.rx=0,this._stopped=!0}},{key:"reset",value:function(){this._started=!1}}]),e}();exports.RotateTo=f;var x=function(){function e(s,i,o,h){r(this,e),this._started=!1,this._stopped=!1,this._actor=s,this._speed=o,this._offset=i,this._rotationType=h||t.RotationType.ShortestPath}return _(e,[{key:"update",value:function(e){if(!this._started){this._started=!0,this._start=this._actor.rotation,this._currentNonCannonAngle=this._actor.rotation,this._end=this._start+this._offset;var s=Math.abs(this._end-this._start),o=i.TwoPI-s;switch(s>o?(this._shortDistance=o,this._longDistance=s):(this._shortDistance=s,this._longDistance=o),this._shortestPathIsPositive=(this._start-this._end+i.TwoPI)%i.TwoPI>=Math.PI,this._rotationType){case t.RotationType.ShortestPath:this._distance=this._shortDistance,this._shortestPathIsPositive?this._direction=1:this._direction=-1;break;case t.RotationType.LongestPath:this._distance=this._longDistance,this._shortestPathIsPositive?this._direction=-1:this._direction=1;break;case t.RotationType.Clockwise:this._direction=1,this._shortDistance>=0?this._distance=this._shortDistance:this._distance=this._longDistance;break;case t.RotationType.CounterClockwise:this._direction=-1,this._shortDistance<=0?this._distance=this._shortDistance:this._distance=this._longDistance}}this._actor.rx=this._direction*this._speed,this._currentNonCannonAngle+=this._direction*this._speed*(e/1e3),this.isComplete()&&(this._actor.rotation=this._end,this._actor.rx=0,this._stopped=!0)}},{key:"isComplete",value:function(){var t=Math.abs(this._currentNonCannonAngle-this._start);return this._stopped||t>=Math.abs(this._distance)}},{key:"stop",value:function(){this._actor.rx=0,this._stopped=!0}},{key:"reset",value:function(){this._started=!1}}]),e}();exports.RotateBy=x;var m=function(){function t(e,s,i,o,h){r(this,t),this._started=!1,this._stopped=!1,this._actor=e,this._endX=s,this._endY=i,this._speedX=o,this._speedY=h}return _(t,[{key:"update",value:function(t){if(this._started||(this._started=!0,this._startX=this._actor.scale.x,this._startY=this._actor.scale.y,this._distanceX=Math.abs(this._endX-this._startX),this._distanceY=Math.abs(this._endY-this._startY)),Math.abs(this._actor.scale.x-this._startX)>=this._distanceX)this._actor.sx=0;else{var s=this._endY<this._startY?-1:1;this._actor.sx=this._speedX*s}if(Math.abs(this._actor.scale.y-this._startY)>=this._distanceY)this._actor.sy=0;else{var i=this._endY<this._startY?-1:1;this._actor.sy=this._speedY*i}this.isComplete()&&(this._actor.scale=(0,e.vec)(this._endX,this._endY),this._actor.sx=0,this._actor.sy=0)}},{key:"isComplete",value:function(){return this._stopped||Math.abs(this._actor.scale.y-this._startX)>=this._distanceX&&Math.abs(this._actor.scale.y-this._startY)>=this._distanceY}},{key:"stop",value:function(){this._actor.sx=0,this._actor.sy=0,this._stopped=!0}},{key:"reset",value:function(){this._started=!1}}]),t}();exports.ScaleTo=m,exports.ScaleTo=m=p([(0,o.obsolete)({message:"ex.Action.ScaleTo will be removed in v0.25.0",alternateMethod:"Set width and hight directly"})],m);var k=function(){function t(s,i,o,h){r(this,t),this._started=!1,this._stopped=!1,this._actor=s,this._offset=new e.Vector(i,o),this._speedX=this._speedY=h}return _(t,[{key:"update",value:function(t){this._started||(this._started=!0,this._startScale=this._actor.scale.clone(),this._endScale=this._startScale.add(this._offset),this._distanceX=Math.abs(this._endScale.x-this._startScale.x),this._distanceY=Math.abs(this._endScale.y-this._startScale.y),this._directionX=this._endScale.x<this._startScale.x?-1:1,this._directionY=this._endScale.y<this._startScale.y?-1:1),this._actor.sx=this._speedX*this._directionX,this._actor.sy=this._speedY*this._directionY,this.isComplete()&&(this._actor.scale=this._endScale,this._actor.sx=0,this._actor.sy=0)}},{key:"isComplete",value:function(){return this._stopped||Math.abs(this._actor.scale.x-this._startScale.x)>=this._distanceX&&Math.abs(this._actor.scale.y-this._startScale.y)>=this._distanceY}},{key:"stop",value:function(){this._actor.sx=0,this._actor.sy=0,this._stopped=!0}},{key:"reset",value:function(){this._started=!1}}]),t}();exports.ScaleBy=k,exports.ScaleBy=k=p([(0,o.obsolete)({message:"ex.Action.ScaleBy will be removed in v0.25.0",alternateMethod:"Set width and hight directly"})],k);var b=function(){function t(e,s){r(this,t),this._elapsedTime=0,this._started=!1,this._stopped=!1,this._actor=e,this._delay=s}return _(t,[{key:"update",value:function(t){this._started||(this._started=!0),this.x=this._actor.pos.x,this.y=this._actor.pos.y,this._elapsedTime+=t}},{key:"isComplete",value:function(){return this._stopped||this._elapsedTime>=this._delay}},{key:"stop",value:function(){this._stopped=!0}},{key:"reset",value:function(){this._elapsedTime=0,this._started=!1}}]),t}();exports.Delay=b;var T=function(){function t(e,s,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;r(this,t),this._timeVisible=0,this._timeNotVisible=0,this._elapsedTime=0,this._totalTime=0,this._stopped=!1,this._started=!1,this._actor=e,this._timeVisible=s,this._timeNotVisible=i,this._duration=(s+i)*o}return _(t,[{key:"update",value:function(t){this._started||(this._started=!0),this._elapsedTime+=t,this._totalTime+=t,this._actor.visible&&this._elapsedTime>=this._timeVisible&&(this._actor.visible=!1,this._elapsedTime=0),!this._actor.visible&&this._elapsedTime>=this._timeNotVisible&&(this._actor.visible=!0,this._elapsedTime=0),this.isComplete()&&(this._actor.visible=!0)}},{key:"isComplete",value:function(){return this._stopped||this._totalTime>=this._duration}},{key:"stop",value:function(){this._actor.visible=!0,this._stopped=!0}},{key:"reset",value:function(){this._started=!1,this._elapsedTime=0,this._totalTime=0}}]),t}();exports.Blink=T;var w=function(){function t(e,s,i){r(this,t),this._multiplier=1,this._started=!1,this._stopped=!1,this._actor=e,this._endOpacity=s,this._speed=i}return _(t,[{key:"update",value:function(t){this._started||(this._started=!0,this._endOpacity<this._actor.opacity?this._multiplier=-1:this._multiplier=1),this._speed>0&&(this._actor.opacity+=this._multiplier*(Math.abs(this._actor.opacity-this._endOpacity)*t)/this._speed),this._speed-=t,this.isComplete()&&(this._actor.opacity=this._endOpacity),s.Logger.getInstance().debug("[Action fade] Actor opacity:",this._actor.opacity)}},{key:"isComplete",value:function(){return this._stopped||Math.abs(this._actor.opacity-this._endOpacity)<.05}},{key:"stop",value:function(){this._stopped=!0}},{key:"reset",value:function(){this._started=!1}}]),t}();exports.Fade=w;var g=function(){function t(e){r(this,t),this._stopped=!1,this._actor=e}return _(t,[{key:"update",value:function(t){this._actor.actionQueue.clearActions(),this._actor.kill(),this._stopped=!0}},{key:"isComplete",value:function(){return this._stopped}},{key:"stop",value:function(){}},{key:"reset",value:function(){}}]),t}();exports.Die=g;var S=function(){function t(e,s){r(this,t),this._method=null,this._actor=null,this._hasBeenCalled=!1,this._actor=e,this._method=s}return _(t,[{key:"update",value:function(t){this._method.call(this._actor),this._hasBeenCalled=!0}},{key:"isComplete",value:function(){return this._hasBeenCalled}},{key:"reset",value:function(){this._hasBeenCalled=!1}},{key:"stop",value:function(){this._hasBeenCalled=!0}}]),t}();exports.CallMethod=S;var C=function(){function t(e,s,i){r(this,t),this._stopped=!1,this._actor=e,this._actionQueue=new D(e),this._repeat=s,this._originalRepeat=s;for(var o=i.length,h=0;h<o;h++)i[h].reset(),this._actionQueue.add(i[h])}return _(t,[{key:"update",value:function(t){this.x=this._actor.pos.x,this.y=this._actor.pos.y,this._actionQueue.hasNext()||(this._actionQueue.reset(),this._repeat--),this._actionQueue.update(t)}},{key:"isComplete",value:function(){return this._stopped||this._repeat<=0}},{key:"stop",value:function(){this._stopped=!0}},{key:"reset",value:function(){this._repeat=this._originalRepeat}}]),t}();exports.Repeat=C;var M=function(){function t(e,s){r(this,t),this._stopped=!1,this._actor=e,this._actionQueue=new D(e);for(var i=s.length,o=0;o<i;o++)s[o].reset(),this._actionQueue.add(s[o])}return _(t,[{key:"update",value:function(t){this.x=this._actor.pos.x,this.y=this._actor.pos.y,this._stopped||(this._actionQueue.hasNext()||this._actionQueue.reset(),this._actionQueue.update(t))}},{key:"isComplete",value:function(){return this._stopped}},{key:"stop",value:function(){this._stopped=!0,this._actionQueue.clearActions()}},{key:"reset",value:function(){}}]),t}();exports.RepeatForever=M;var D=function(){function t(e){r(this,t),this._actions=[],this._completedActions=[],this._actor=e}return _(t,[{key:"add",value:function(t){this._actions.push(t)}},{key:"remove",value:function(t){var e=this._actions.indexOf(t);this._actions.splice(e,1)}},{key:"clearActions",value:function(){this._actions.length=0,this._completedActions.length=0,this._currentAction&&this._currentAction.stop()}},{key:"getActions",value:function(){return this._actions.concat(this._completedActions)}},{key:"hasNext",value:function(){return this._actions.length>0}},{key:"reset",value:function(){this._actions=this.getActions();for(var t=this._actions.length,e=0;e<t;e++)this._actions[e].reset();this._completedActions=[]}},{key:"update",value:function(t){this._actions.length>0&&(this._currentAction=this._actions[0],this._currentAction.update(t),this._currentAction.isComplete(this._actor)&&this._completedActions.push(this._actions.shift()))}}]),t}();exports.ActionQueue=D;
},{"./RotationType":"DrJU","../Algebra":"NGcQ","../Util/Log":"p1Gn","../Util/Util":"Kkda","../Util/Decorators":"kQDE"}],"LpjS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EasingFunctions=void 0;var e=require("../Algebra"),n=require("../Util/Decorators");function t(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function r(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,n,t){return n&&r(e.prototype,n),t&&r(e,t),e}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var u=function(e,n,t,r){var i,u=arguments.length,a=u<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,t):r;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,n,t,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(u<3?i(a):u>3?i(n,t,a):i(n,t))||a);return u>3&&a&&Object.defineProperty(n,t,a),a},a=function(){function n(){t(this,n)}return i(n,null,[{key:"CreateReversibleEasingFunction",value:function(e){return function(n,t,r,i){return r<t?t-(e(n,r,t,i)-r):e(n,t,r,i)}}},{key:"CreateReversableEasingFunction",value:function(e){return n.CreateReversibleEasingFunction(e)}},{key:"CreateVectorEasingFunction",value:function(n){return function(t,r,i,o){return new e.Vector(n(t,r.x,i.x,o),n(t,r.y,i.y,o))}}}]),n}();exports.EasingFunctions=a,a.Linear=a.CreateReversibleEasingFunction(function(e,n,t,r){return(t-=n)*e/r+n}),a.EaseInQuad=a.CreateReversibleEasingFunction(function(e,n,t,r){return(t-=n)*(e/=r)*e+n}),a.EaseOutQuad=a.CreateReversibleEasingFunction(function(e,n,t,r){return-(t-=n)*(e/=r)*(e-2)+n}),a.EaseInOutQuad=a.CreateReversibleEasingFunction(function(e,n,t,r){return t-=n,(e/=r/2)<1?t/2*e*e+n:-t/2*(--e*(e-2)-1)+n}),a.EaseInCubic=a.CreateReversibleEasingFunction(function(e,n,t,r){return(t-=n)*(e/=r)*e*e+n}),a.EaseOutCubic=a.CreateReversibleEasingFunction(function(e,n,t,r){return e/=r,(t-=n)*(--e*e*e+1)+n}),a.EaseInOutCubic=a.CreateReversibleEasingFunction(function(e,n,t,r){return t-=n,(e/=r/2)<1?t/2*e*e*e+n:t/2*((e-=2)*e*e+2)+n}),u([(0,n.obsolete)({message:"Alias for incorrect spelling used in older versions, will be removed in v0.25.0",alternateMethod:"CreateReversibleEasingFunction"})],a,"CreateReversableEasingFunction",null);
},{"../Algebra":"NGcQ","../Util/Decorators":"kQDE"}],"vA04":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ActionContext=void 0;var e=s(require("./Action")),t=require("../Util/EasingFunctions");function u(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return u=function(){return e},e}function s(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=u();if(t&&t.has(e))return t.get(e);var s={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var i=r?Object.getOwnPropertyDescriptor(e,n):null;i&&(i.get||i.set)?Object.defineProperty(s,n,i):s[n]=e[n]}return s.default=e,t&&t.set(e,s),s}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var u=0;u<t.length;u++){var s=t[u];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function i(e,t,u){return t&&n(e.prototype,t),u&&n(e,u),e}var o=function(){function u(){r(this,u),this._actors=[],this._queues=[],null!==arguments&&(this._actors=Array.prototype.slice.call(arguments,0),this._queues=this._actors.map(function(e){return e.actionQueue}))}return i(u,[{key:"clearActions",value:function(){for(var e=this._queues.length,t=0;t<e;t++)this._queues[t].clearActions()}},{key:"addActorToContext",value:function(e){this._actors.push(e),this._queues.push(e.actionQueue)}},{key:"removeActorFromContext",value:function(e){var t=this._actors.indexOf(e);t>-1&&(this._actors.splice(t,1),this._queues.splice(t,1))}},{key:"easeTo",value:function(u,s,r){for(var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.EasingFunctions.Linear,i=this._queues.length,o=0;o<i;o++)this._queues[o].add(new e.EaseTo(this._actors[o],u,s,r,n));return this}},{key:"moveTo",value:function(t,u,s){for(var r=this._queues.length,n=0;n<r;n++)this._queues[n].add(new e.MoveTo(this._actors[n],t,u,s));return this}},{key:"moveBy",value:function(t,u,s){for(var r=this._queues.length,n=0;n<r;n++)this._queues[n].add(new e.MoveBy(this._actors[n],t,u,s));return this}},{key:"rotateTo",value:function(t,u,s){for(var r=this._queues.length,n=0;n<r;n++)this._queues[n].add(new e.RotateTo(this._actors[n],t,u,s));return this}},{key:"rotateBy",value:function(t,u,s){for(var r=this._queues.length,n=0;n<r;n++)this._queues[n].add(new e.RotateBy(this._actors[n],t,u,s));return this}},{key:"scaleTo",value:function(t,u,s,r){for(var n=this._queues.length,i=0;i<n;i++)this._queues[i].add(new e.ScaleTo(this._actors[i],t,u,s,r));return this}},{key:"scaleBy",value:function(t,u,s){for(var r=this._queues.length,n=0;n<r;n++)this._queues[n].add(new e.ScaleBy(this._actors[n],t,u,s));return this}},{key:"blink",value:function(t,u){for(var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=this._queues.length,n=0;n<r;n++)this._queues[n].add(new e.Blink(this._actors[n],t,u,s));return this}},{key:"fade",value:function(t,u){for(var s=this._queues.length,r=0;r<s;r++)this._queues[r].add(new e.Fade(this._actors[r],t,u));return this}},{key:"delay",value:function(t){for(var u=this._queues.length,s=0;s<u;s++)this._queues[s].add(new e.Delay(this._actors[s],t));return this}},{key:"die",value:function(){for(var t=this._queues.length,u=0;u<t;u++)this._queues[u].add(new e.Die(this._actors[u]));return this}},{key:"callMethod",value:function(t){for(var u=this._queues.length,s=0;s<u;s++)this._queues[s].add(new e.CallMethod(this._actors[s],t));return this}},{key:"repeat",value:function(t){if(!t)return this.repeatForever(),this;for(var u=this._queues.length,s=0;s<u;s++)this._queues[s].add(new e.Repeat(this._actors[s],t,this._actors[s].actionQueue.getActions()));return this}},{key:"repeatForever",value:function(){for(var t=this._queues.length,u=0;u<t;u++)this._queues[u].add(new e.RepeatForever(this._actors[u],this._actors[u].actionQueue.getActions()));return this}},{key:"follow",value:function(t,u){for(var s=this._queues.length,r=0;r<s;r++)void 0===u?this._queues[r].add(new e.Follow(this._actors[r],t)):this._queues[r].add(new e.Follow(this._actors[r],t,u));return this}},{key:"meet",value:function(t,u){for(var s=this._queues.length,r=0;r<s;r++)void 0===u?this._queues[r].add(new e.Meet(this._actors[r],t)):this._queues[r].add(new e.Meet(this._actors[r],t,u));return this}},{key:"asPromise",value:function(){var t=this,u=this._queues.map(function(u,s){return new Promise(function(r){u.add(new e.CallMethod(t._actors[s],function(){r()}))})});return Promise.all(u)}}]),u}();exports.ActionContext=o;
},{"./Action":"gDdL","../Util/EasingFunctions":"LpjS"}],"G2LY":[function(require,module,exports) {
"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.CapturePointer=void 0;var r=function(){function t(){e(this,t)}return n(t,[{key:"update",value:function(e,t){e.enableCapturePointer&&(e.isKilled()||t.input.pointers.checkAndUpdateActorUnderPointer(e))}}]),t}();exports.CapturePointer=r;
},{}],"nIlm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CullingBox=void 0;var t=require("../Algebra"),i=require("../Drawing/Color");function o(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function e(t,i){for(var o=0;o<i.length;o++){var e=i[o];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function r(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}var n=function(){function e(){o(this,e),this._topLeft=new t.Vector(0,0),this._topRight=new t.Vector(0,0),this._bottomLeft=new t.Vector(0,0),this._bottomRight=new t.Vector(0,0)}return r(e,[{key:"isSpriteOffScreen",value:function(i,o){var e=i.currentDrawing.drawWidth,r=i.currentDrawing.drawHeight,n=i.rotation,h=i.center,s=i.getGlobalPos();this._topLeft=(0,t.vec)(s.x-e/2,s.y-r/2),this._topLeft=this._topLeft.rotate(n,h),this._topRight=(0,t.vec)(s.x+e/2,s.y-r/2),this._topRight=this._topRight.rotate(n,h),this._bottomLeft=(0,t.vec)(s.x-e/2,s.y+r/2),this._bottomLeft=this._bottomLeft.rotate(n,h),this._bottomRight=(0,t.vec)(s.x+e/2,s.y+r/2),this._bottomRight=this._bottomRight.rotate(n,h);var a=o.worldToScreenCoordinates(this._topLeft),l=o.worldToScreenCoordinates(this._topRight),_=o.worldToScreenCoordinates(this._bottomLeft),c=o.worldToScreenCoordinates(this._bottomRight);this._xCoords=[],this._yCoords=[],this._xCoords.push(a.x,l.x,_.x,c.x),this._yCoords.push(a.y,l.y,_.y,c.y),this._xMin=Math.min.apply(null,this._xCoords),this._yMin=Math.min.apply(null,this._yCoords),this._xMax=Math.max.apply(null,this._xCoords),this._yMax=Math.max.apply(null,this._yCoords);var x=o.screenToWorldCoordinates(new t.Vector(this._xMin,this._yMin)),y=o.screenToWorldCoordinates(new t.Vector(this._xMax,this._yMax));this._xMinWorld=x.x,this._yMinWorld=x.y,this._xMaxWorld=y.x,this._yMaxWorld=y.y;var d=[new t.Vector(this._xMin,this._yMin),new t.Vector(this._xMax,this._yMin),new t.Vector(this._xMin,this._yMax),new t.Vector(this._xMax,this._yMax)];if(d[0].x<0&&d[1].x>o.canvas.clientWidth&&(d[0].y>0||d[2].y<o.canvas.clientHeight))return!1;if(d[0].y<0&&d[2].y>o.canvas.clientHeight&&(d[1].x>0||d[0].x<o.canvas.clientWidth))return!1;for(var f=0;f<d.length;f++)if(d[f].x>0&&d[f].y>0&&d[f].x<o.canvas.clientWidth&&d[f].y<o.canvas.clientHeight)return!1;return!0}},{key:"debugDraw",value:function(t){t.beginPath(),t.strokeStyle=i.Color.White.toString(),t.rect(this._xMinWorld,this._yMinWorld,this._xMaxWorld-this._xMinWorld,this._yMaxWorld-this._yMinWorld),t.stroke(),t.fillStyle=i.Color.Red.toString(),t.beginPath(),t.arc(this._topLeft.x,this._topLeft.y,5,0,2*Math.PI),t.closePath(),t.fill(),t.fillStyle=i.Color.Green.toString(),t.beginPath(),t.arc(this._topRight.x,this._topRight.y,5,0,2*Math.PI),t.closePath(),t.fill(),t.fillStyle=i.Color.Blue.toString(),t.beginPath(),t.arc(this._bottomLeft.x,this._bottomLeft.y,5,0,2*Math.PI),t.closePath(),t.fill(),t.fillStyle=i.Color.Magenta.toString(),t.beginPath(),t.arc(this._bottomRight.x,this._bottomRight.y,5,0,2*Math.PI),t.closePath(),t.fill()}}]),e}();exports.CullingBox=n;
},{"../Algebra":"NGcQ","../Drawing/Color":"p7Gh"}],"IhB0":[function(require,module,exports) {
"use strict";function e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function r(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function n(e,n,t){return n&&r(e.prototype,n),t&&r(e,t),e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Observable=void 0;var t=function(){function r(){e(this,r),this.observers=[]}return n(r,[{key:"register",value:function(e){this.observers.push(e)}},{key:"unregister",value:function(e){var r=this.observers.indexOf(e);-1!==r&&this.observers.splice(r,1)}},{key:"notifyAll",value:function(e){this.observers.forEach(function(r){return r.notify(e)})}},{key:"clear",value:function(){this.observers.length=0}}]),r}();exports.Observable=t;
},{}],"yTUi":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Class=void 0;var e=require("./EventDispatcher");function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function i(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}var r=function(){function n(){t(this,n),this.eventDispatcher=new e.EventDispatcher(this)}return i(n,[{key:"on",value:function(e,t){this.eventDispatcher.on(e,t)}},{key:"off",value:function(e,t){this.eventDispatcher.off(e,t)}},{key:"emit",value:function(e,t){this.eventDispatcher.emit(e,t)}},{key:"once",value:function(e,t){this.eventDispatcher.once(e,t)}}]),n}();exports.Class=r;
},{"./EventDispatcher":"c7EN"}],"UY9q":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isAddedComponent=k,exports.isRemovedComponent=T,exports.Entity=exports.RemovedComponent=exports.AddedComponent=void 0;var e=require("./Component"),t=require("../Util/Observable"),n=require("../Class"),o=require("../Events"),r=require("..");function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=s(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw i}}}}function s(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function l(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function p(e,t,n){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=f(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function f(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e){var t=_();return function(){var n,o=g(e);if(t){var r=g(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return v(this,n)}}function v(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?m(e):t}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var C=function e(t){b(this,e),this.data=t,this.type="Component Added"};function k(e){return!!e&&"Component Added"===e.type}exports.AddedComponent=C;var w=function e(t){b(this,e),this.data=t,this.type="Component Removed"};function T(e){return!!e&&"Component Removed"===e.type}exports.RemovedComponent=w;var A=function(i){h(u,n.Class);var s=y(u);function u(e){var n;if(b(this,u),(n=s.call(this)).id=u._ID++,n.active=!0,n._componentsToRemove=[],n._componentTypeToInstance=new Map,n._componentStringToInstance=new Map,n._tagsMemo=[],n._typesMemo=[],n.componentAdded$=new t.Observable,n.componentRemoved$=new t.Observable,n._parent=null,n.childrenAdded$=new t.Observable,n.childrenRemoved$=new t.Observable,n._children=[],n._isInitialized=!1,e){var o,r=a(e);try{for(r.s();!(o=r.n()).done;){var i=o.value;n.addComponent(i)}}catch(c){r.e(c)}finally{r.f()}}return n}return l(u,[{key:"kill",value:function(){this.active=!1}},{key:"isKilled",value:function(){return!this.active}},{key:"tags",get:function(){return this._tagsMemo}},{key:"hasTag",value:function(e){return this.tags.includes(e)}},{key:"addTag",value:function(t){return this.addComponent(new e.TagComponent(t))}},{key:"types",get:function(){return this._typesMemo}},{key:"_rebuildMemos",value:function(){this._tagsMemo=Array.from(this._componentStringToInstance.values()).filter(function(t){return t instanceof e.TagComponent}).map(function(e){return e.type}),this._typesMemo=Array.from(this._componentStringToInstance.keys())}},{key:"getComponents",value:function(){return Array.from(this._componentStringToInstance.values())}},{key:"_notifyAddComponent",value:function(e){this._rebuildMemos();var t=new C({component:e,entity:this});this.componentAdded$.notifyAll(t)}},{key:"_notifyRemoveComponent",value:function(e){var t=new w({component:e,entity:this});this.componentRemoved$.notifyAll(t),this._rebuildMemos()}},{key:"parent",get:function(){return this._parent}},{key:"children",get:function(){return this._children}},{key:"unparent",value:function(){this._parent&&(this._parent.removeChild(this),this._parent=null)}},{key:"addChild",value:function(e){if(null!==e.parent)throw new Error("Entity already has a parent, cannot add without unparenting");if(this.getAncestors().includes(e))throw new Error("Cycle detected, cannot add entity");return this._children.push(e),e._parent=this,this.childrenAdded$.notifyAll(e),this}},{key:"removeChild",value:function(e){return e.parent===this&&(r.Util.removeItemFromArray(e,this._children),e._parent=null,this.childrenRemoved$.notifyAll(e)),this}},{key:"removeAllChildren",value:function(){var e=this;return this.children.forEach(function(t){e.removeChild(t)}),this}},{key:"getAncestors",value:function(){for(var e=[this],t=this.parent;t;)e.push(t),t=t.parent;return e.reverse()}},{key:"getDescendants",value:function(){for(var e=[this],t=[this];t.length>0;){var n=t.pop();t=t.concat(n.children),e=e.concat(n.children)}return e}},{key:"clone",value:function(){var e,t=new u,n=a(this.types);try{for(n.s();!(e=n.n()).done;){var o=e.value;t.addComponent(this.get(o).clone())}}catch(c){n.e(c)}finally{n.f()}var r,i=a(this.children);try{for(i.s();!(r=i.n()).done;){var s=r.value;t.addChild(s.clone())}}catch(c){i.e(c)}finally{i.f()}return t}},{key:"addTemplate",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=a(e.getComponents());try{for(o.s();!(t=o.n()).done;){var r=t.value;this.addComponent(r.clone(),n)}}catch(c){o.e(c)}finally{o.f()}var i,s=a(e.children);try{for(s.s();!(i=s.n()).done;){var u=i.value;this.addChild(u.clone().addTemplate(u))}}catch(c){s.e(c)}finally{s.f()}return this}},{key:"addComponent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.has(e.type)){if(!t)return this;this.removeComponent(e)}if(e.dependencies&&e.dependencies.length){var n,o=a(e.dependencies);try{for(o.s();!(n=o.n()).done;){var r=n.value;this.addComponent(new r)}}catch(s){o.e(s)}finally{o.f()}}e.owner=this;var i=e.constructor;return this._componentTypeToInstance.set(i,e),this._componentStringToInstance.set(e.type,e),e.onAdd&&e.onAdd(this),this._notifyAddComponent(e),this}},{key:"removeComponent",value:function(t){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?"string"==typeof t?this._removeComponentByType(t):t instanceof e.Component&&this._removeComponentByType(t.type):this._componentsToRemove.push(t),this}},{key:"_removeComponentByType",value:function(e){if(this.has(e)){var t=this.get(e);t.owner=null,t.onRemove&&t.onRemove(this);var n=t.constructor;this._componentTypeToInstance.delete(n),this._componentStringToInstance.delete(t.type),this._notifyRemoveComponent(t)}}},{key:"processComponentRemoval",value:function(){var e,t=a(this._componentsToRemove);try{for(t.s();!(e=t.n()).done;){var n=e.value,o="string"==typeof n?n:n.type;this._removeComponentByType(o)}}catch(r){t.e(r)}finally{t.f()}this._componentsToRemove.length=0}},{key:"has",value:function(e){return"string"==typeof e?this._componentStringToInstance.has(e):this._componentTypeToInstance.has(e)}},{key:"get",value:function(e){return"string"==typeof e?this._componentStringToInstance.get(e):this._componentTypeToInstance.get(e)}},{key:"isInitialized",get:function(){return this._isInitialized}},{key:"_initialize",value:function(e){this.isInitialized||(this.onInitialize(e),p(g(u.prototype),"emit",this).call(this,"initialize",new o.InitializeEvent(e,this)),this._isInitialized=!0)}},{key:"_preupdate",value:function(e,t){this.emit("preupdate",new o.PreUpdateEvent(e,t,this)),this.onPreUpdate(e,t)}},{key:"_postupdate",value:function(e,t){this.emit("postupdate",new o.PostUpdateEvent(e,t,this)),this.onPostUpdate(e,t)}},{key:"onInitialize",value:function(e){}},{key:"onPreUpdate",value:function(e,t){}},{key:"onPostUpdate",value:function(e,t){}},{key:"update",value:function(e,t){this._initialize(e),this._preupdate(e,t);var n,o=a(this.children);try{for(o.s();!(n=o.n()).done;){n.value.update(e,t)}}catch(r){o.e(r)}finally{o.f()}this._postupdate(e,t)}}]),u}();exports.Entity=A,A._ID=0;
},{"./Component":"r8EA","../Util/Observable":"IhB0","../Class":"yTUi","../Events":"XySq","..":"A6Lr"}],"mHCe":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EntityManager=void 0;var e=require("./Entity"),t=require("..");function n(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=r(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,d=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return u=e.done,e},e:function(e){d=!0,a=e},f:function(){try{u||null==n.return||n.return()}finally{if(d)throw a}}}}function r(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}var d=function(){function r(e){o(this,r),this._world=e,this.entities=[],this._entityIndex={}}return u(r,[{key:"notify",value:function(t){(0,e.isAddedComponent)(t)&&this._world.queryManager.addEntity(t.data.entity),(0,e.isRemovedComponent)(t)&&this._world.queryManager.removeComponent(t.data.entity,t.data.component)}},{key:"addEntity",value:function(e){var t=this;e&&!this._entityIndex[e.id]&&(this._entityIndex[e.id]=e,this.entities.push(e),this._world.queryManager.addEntity(e),e.componentAdded$.register(this),e.componentRemoved$.register(this),e.children.forEach(function(e){return t.addEntity(e)}),e.childrenAdded$.register({notify:function(e){t.addEntity(e)}}),e.childrenRemoved$.register({notify:function(e){t.removeEntity(e)}}))}},{key:"removeEntity",value:function(n){var r=this,i=0;i=n instanceof e.Entity?n.id:n;var o=this._entityIndex[i];delete this._entityIndex[i],o&&(t.Util.removeItemFromArray(o,this.entities),this._world.queryManager.removeEntity(o),o.componentAdded$.unregister(this),o.componentRemoved$.unregister(this),o.children.forEach(function(e){return r.removeEntity(e)}),o.childrenAdded$.clear(),o.childrenRemoved$.clear())}},{key:"processComponentRemovals",value:function(){var e,t=n(this.entities);try{for(t.s();!(e=t.n()).done;){e.value.processComponentRemoval()}}catch(r){t.e(r)}finally{t.f()}}},{key:"getById",value:function(e){return this._entityIndex[e]}},{key:"clear",value:function(){var e,t=n(this.entities);try{for(t.s();!(e=t.n()).done;){var r=e.value;this.removeEntity(r)}}catch(i){t.e(i)}finally{t.f()}}}]),r}();exports.EntityManager=d;
},{"./Entity":"UY9q","..":"A6Lr"}],"DauX":[function(require,module,exports) {
"use strict";function r(r){return o(r)||n(r)||e(r)||t()}function t(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function e(r,t){if(r){if("string"==typeof r)return i(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);return"Object"===e&&r.constructor&&(e=r.constructor.name),"Map"===e||"Set"===e?Array.from(r):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?i(r,t):void 0}}function n(r){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(r))return Array.from(r)}function o(r){if(Array.isArray(r))return i(r)}function i(r,t){(null==t||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}Object.defineProperty(exports,"__esModule",{value:!0}),exports.buildTypeKey=void 0;var a=function(t){return r(t).sort(function(r,t){return r.localeCompare(t)}).join("+")};exports.buildTypeKey=a;
},{}],"wTMU":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function n(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}var r;Object.defineProperty(exports,"__esModule",{value:!0}),exports.isAddedSystemEntity=s,exports.isRemoveSystemEntity=a,exports.RemovedEntity=exports.AddedEntity=exports.System=exports.SystemType=void 0,exports.SystemType=r,function(t){t.Update="update",t.Draw="draw"}(r||(exports.SystemType=r={}));var i=function(){function e(){t(this,e),this.priority=0}return n(e,[{key:"notify",value:function(t){}}]),e}();exports.System=i;var o=function e(n){t(this,e),this.data=n,this.type="Entity Added"};function s(t){return!!t&&"Entity Added"===t.type}exports.AddedEntity=o;var y=function e(n){t(this,e),this.data=n,this.type="Entity Removed"};function a(t){return!!t&&"Entity Removed"===t.type}exports.RemovedEntity=y;
},{}],"oZtQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Query=void 0;var t=require("./Entity"),e=require("./Util"),n=require("../Util/Observable"),r=require(".."),o=require("./System");function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=c(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,f=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return u=t.done,t},e:function(t){f=!0,i=t},f:function(){try{u||null==n.return||n.return()}finally{if(f)throw i}}}}function c(t,e){if(t){if("string"==typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(t,e):void 0}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}function y(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=m();return function(){var n,r=d(t);if(e){var o=d(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return v(this,n)}}function v(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?b(t):e}function b(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function m(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var _=function(i){y(f,n.Observable);var c=h(f);function f(t){var e;return a(this,f),(e=c.call(this))._entities=[],t[0]instanceof Function?e.types=t.map(function(t){return(new t).type}):e.types=t,e}return l(f,[{key:"key",get:function(){return this._key?this._key:this._key=(0,e.buildTypeKey)(this.types)}},{key:"getEntities",value:function(t){return t&&this._entities.sort(t),this._entities}},{key:"addEntity",value:function(t){!r.Util.contains(this._entities,t)&&this.matches(t)&&(this._entities.push(t),this.notifyAll(new o.AddedEntity(t)))}},{key:"removeEntity",value:function(t){r.Util.removeItemFromArray(t,this._entities)&&this.notifyAll(new o.RemovedEntity(t))}},{key:"clear",value:function(){this._entities.length=0;var t,e=u(this.observers);try{for(e.s();!(t=e.n()).done;){var n=t.value;this.unregister(n)}}catch(r){e.e(r)}finally{e.f()}}},{key:"matches",value:function(e){var n=[];n=e instanceof t.Entity?e.types:e;var r,o=!0,i=u(this.types);try{for(i.s();!(r=i.n()).done;){var c=r.value;if(o=o&&n.indexOf(c)>-1,!o)return!1}}catch(f){i.e(f)}finally{i.f()}return o}},{key:"contain",value:function(t){return this.types.indexOf(t)>-1}}]),f}();exports.Query=_;
},{"./Entity":"UY9q","./Util":"DauX","../Util/Observable":"IhB0","..":"A6Lr","./System":"wTMU"}],"xNCA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.QueryManager=void 0;var e=require("./Util"),r=require("./Query");function t(e,r){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=n(e))||r&&e&&"number"==typeof e.length){t&&(e=t);var i=0,u=function(){};return{s:u,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:u}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==t.return||t.return()}finally{if(s)throw o}}}}function n(e,r){if(e){if("string"==typeof e)return i(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?i(e,r):void 0}}function i(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function u(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function o(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,r,t){return r&&o(e.prototype,r),t&&o(e,t),e}var s=function(){function n(e){u(this,n),this._world=e,this._queries={}}return a(n,[{key:"_addQuery",value:function(r){this._queries[(0,e.buildTypeKey)(r.types)]=r;var n,i=t(this._world.entityManager.entities);try{for(i.s();!(n=i.n()).done;){var u=n.value;r.addEntity(u)}}catch(o){i.e(o)}finally{i.f()}}},{key:"maybeRemoveQuery",value:function(r){0===r.observers.length&&(r.clear(),delete this._queries[(0,e.buildTypeKey)(r.types)])}},{key:"addEntity",value:function(e){for(var r in this._queries)this._queries[r]&&this._queries[r].addEntity(e)}},{key:"removeComponent",value:function(e,r){for(var t in this._queries)this._queries[t].contain(r.type)&&this._queries[t].removeEntity(e)}},{key:"removeEntity",value:function(e){for(var r in this._queries)this._queries[r].removeEntity(e)}},{key:"createQuery",value:function(e){var t=this.getQuery(e);if(t)return t;var n=new r.Query(e);return this._addQuery(n),n}},{key:"getQuery",value:function(r){var t=(0,e.buildTypeKey)(r);return this._queries[t]?this._queries[t]:null}}]),n}();exports.QueryManager=s;
},{"./Util":"DauX","./Query":"oZtQ"}],"nwG3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SystemManager=void 0;var e=require("..");function t(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=r(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,u=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw i}}}}function r(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e}var s=function(){function r(e){a(this,r),this._world=e,this.systems=[]}return i(r,[{key:"addSystem",value:function(e){if(!e.types||0===e.types.length)throw new Error("Attempted to add a System without any types");var t=this._world.queryManager.createQuery(e.types);this.systems.push(e),this.systems.sort(function(e,t){return e.priority-t.priority}),t.register(e),e.initialize&&e.initialize(this._world.context)}},{key:"removeSystem",value:function(t){e.Util.removeItemFromArray(t,this.systems);var r=this._world.queryManager.getQuery(t.types);r&&(r.unregister(t),this._world.queryManager.maybeRemoveQuery(r))}},{key:"updateSystems",value:function(r,n,a){var o,i=this.systems.filter(function(e){return e.systemType===r}),s=t(i);try{for(s.s();!(o=s.n()).done;){var u=o.value;u.preupdate&&u.preupdate(n,a)}}catch(g){s.e(g)}finally{s.f()}var y,l=t(i);try{for(l.s();!(y=l.n()).done;){var f=y.value,c=this._world.queryManager.getQuery(f.types).getEntities(f.sort);if(n instanceof e.Scene){var v,p=t(c);try{for(p.s();!(v=p.n()).done;){v.value._initialize(null==n?void 0:n.engine)}}catch(g){p.e(g)}finally{p.f()}}f.update(c,a)}}catch(g){l.e(g)}finally{l.f()}var d,m=t(i);try{for(m.s();!(d=m.n()).done;){var h=d.value;h.postupdate&&h.postupdate(n,a)}}catch(g){m.e(g)}finally{m.f()}}},{key:"clear",value:function(){var e,r=t(this.systems);try{for(r.s();!(e=r.n()).done;){var n=e.value;this.removeSystem(n)}}catch(a){r.e(a)}finally{r.f()}}}]),r}();exports.SystemManager=s;
},{"..":"A6Lr"}],"OWLL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.World=void 0;var e=require("./Entity"),t=require("./EntityManager"),n=require("./QueryManager"),a=require("./System"),r=require("./SystemManager");function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function o(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}var y=function(){function s(e){i(this,s),this.context=e,this.queryManager=new n.QueryManager(this),this.entityManager=new t.EntityManager(this),this.systemManager=new r.SystemManager(this)}return o(s,[{key:"update",value:function(e,t){this.systemManager.updateSystems(e,this.context,t),this.entityManager.processComponentRemovals()}},{key:"add",value:function(t){t instanceof e.Entity&&this.entityManager.addEntity(t),t instanceof a.System&&this.systemManager.addSystem(t)}},{key:"remove",value:function(t){t instanceof e.Entity&&this.entityManager.removeEntity(t),t instanceof a.System&&this.systemManager.removeSystem(t)}},{key:"clearEntities",value:function(){this.entityManager.clear()}},{key:"clearSystems",value:function(){this.systemManager.clear()}}]),s}();exports.World=y;
},{"./Entity":"UY9q","./EntityManager":"mHCe","./QueryManager":"xNCA","./System":"wTMU","./SystemManager":"nwG3"}],"sOyH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./Component");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(r in exports&&exports[r]===e[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}}))});var r=require("./Entity");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===r[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return r[e]}}))});var t=require("./EntityManager");Object.keys(t).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===t[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return t[e]}}))});var n=require("./Query");Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===n[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return n[e]}}))});var o=require("./QueryManager");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===o[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return o[e]}}))});var u=require("./System");Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===u[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return u[e]}}))});var s=require("./SystemManager");Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===s[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return s[e]}}))});var i=require("./World");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===i[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return i[e]}}))});var c=require("./Components/TransformComponent");Object.keys(c).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===c[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return c[e]}}))});
},{"./Component":"r8EA","./Entity":"UY9q","./EntityManager":"mHCe","./Query":"oZtQ","./QueryManager":"xNCA","./System":"wTMU","./SystemManager":"nwG3","./World":"OWLL","./Components/TransformComponent":"yq2E"}],"mlEX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OffscreenCulling=void 0;var e=require("./../Util/CullingBox"),n=require("../Events"),r=require("../EntityComponentSystem");function t(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function i(e,n){for(var r=0;r<n.length;r++){var t=n[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function o(e,n,r){return n&&i(e.prototype,n),r&&i(e,r),e}var c=function(){function i(){t(this,i),this.cullingBox=new e.CullingBox}return o(i,[{key:"update",value:function(e,t){var i=e.eventDispatcher,o=!0;null!=e.currentDrawing&&(o=this.cullingBox.isSpriteOffScreen(e,t));var c=!1;t&&t.currentScene&&t.currentScene.camera&&t.currentScene.camera.viewport&&!e.parent&&(c=!t.currentScene.camera.viewport.intersect(e.body.collider.bounds)),e.isOffScreen?c&&o||(i.emit("enterviewport",new n.EnterViewPortEvent(e)),e.removeComponent("offscreen")):c&&o&&(i.emit("exitviewport",new n.ExitViewPortEvent(e)),e.addComponent(new r.TagComponent("offscreen")))}}]),i}();exports.OffscreenCulling=c;
},{"./../Util/CullingBox":"nIlm","../Events":"XySq","../EntityComponentSystem":"sOyH"}],"Bb5D":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TileMapCollisionDetection=void 0;var e=require("../Collision/Side"),i=require("../Events"),n=require("../Collision/CollisionType"),o=require("../Collision/Index");function r(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function t(e,i){for(var n=0;n<i.length;n++){var o=i[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function l(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}var s=function(){function t(){r(this,t)}return l(t,[{key:"update",value:function(r,t){var l=r.eventDispatcher;if(r.body.collider.type!==n.CollisionType.PreventCollision&&t.currentScene&&t.currentScene.tileMaps)for(var s=0;s<t.currentScene.tileMaps.length;s++)for(var c=t.currentScene.tileMaps[s],a=void 0,u=e.Side.None,p=2;(a=c.collides(r))&&!(p--<0);)u=o.BoundingBox.getSideFromIntersection(a),l.emit("precollision",new i.PreCollisionEvent(r,null,u,a)),r.body.collider.type===n.CollisionType.Active&&(r.pos=r.pos.add(a),l.emit("postcollision",new i.PostCollisionEvent(r,null,u,a)))}}]),t}();exports.TileMapCollisionDetection=s;
},{"../Collision/Side":"YM02","../Events":"XySq","../Collision/CollisionType":"liCD","../Collision/Index":"kKHB"}],"CPmg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./CapturePointer");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(r in exports&&exports[r]===e[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}}))});var r=require("./OffscreenCulling");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===r[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return r[e]}}))});var t=require("./TileMapCollisionDetection");Object.keys(t).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===t[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return t[e]}}))});
},{"./CapturePointer":"G2LY","./OffscreenCulling":"mlEX","./TileMapCollisionDetection":"Bb5D"}],"UzNB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CanvasDrawComponent=void 0;var t=require("../EntityComponentSystem");function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=i();return function(){var n,o=a(t);if(e){var r=a(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return u(this,n)}}function u(t,n){return!n||"object"!==e(n)&&"function"!=typeof n?f(t):n}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var s=function(e){o(u,t.Component);var r=c(u);function u(t){var e,o;return n(this,u),(e=r.call(this)).draw=t,e.type="canvas",e.draw=null!==(o=e.draw)&&void 0!==o?o:function(){},e}return u}();exports.CanvasDrawComponent=s;
},{"../EntityComponentSystem":"sOyH"}],"OZee":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Graphic=void 0;var i=require("../Algebra"),t=require("../Collision/BoundingBox");function e(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}function s(i,t){for(var e=0;e<t.length;e++){var s=t[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(i,s.key,s)}}function o(i,t,e){return t&&s(i.prototype,t),e&&s(i,e),i}var a=function(){function s(t){var o,a,n,l,r,h;e(this,s),this.id=s._ID++,this.showDebug=!1,this.flipHorizontal=!1,this.flipVertical=!1,this.rotation=0,this.opacity=1,this.scale=i.Vector.One,this.origin=null,this._width=0,this._height=0,t&&(this.origin=null!==(o=t.origin)&&void 0!==o?o:this.origin,this.flipHorizontal=null!==(a=t.flipHorizontal)&&void 0!==a?a:this.flipHorizontal,this.flipVertical=null!==(n=t.flipVertical)&&void 0!==n?n:this.flipVertical,this.rotation=null!==(l=t.rotation)&&void 0!==l?l:this.rotation,this.opacity=null!==(r=t.opacity)&&void 0!==r?r:this.opacity,this.scale=null!==(h=t.scale)&&void 0!==h?h:this.scale)}return o(s,[{key:"cloneGraphicOptions",value:function(){return{origin:this.origin?this.origin.clone():null,flipHorizontal:this.flipHorizontal,flipVertical:this.flipVertical,rotation:this.rotation,opacity:this.opacity,scale:this.scale?this.scale.clone():null}}},{key:"width",get:function(){return Math.abs(this._width*this.scale.x)},set:function(i){this._width=i}},{key:"height",get:function(){return Math.abs(this._height*this.scale.y)},set:function(i){this._height=i}},{key:"localBounds",get:function(){return t.BoundingBox.fromDimension(this.width,this.height,i.Vector.Zero)}},{key:"draw",value:function(i,t,e){this._preDraw(i,t,e),this._drawImage(i,0,0),this._postDraw(i)}},{key:"_preDraw",value:function(i,t,e){i.save(),i.translate(t,e),i.scale(this.scale.x,this.scale.y),this._rotate(i),this._flip(i),i.opacity=i.opacity*this.opacity}},{key:"_rotate",value:function(t){var e,s=this.scale.x>0?1:-1,o=this.scale.y>0?1:-1,a=null!==(e=this.origin)&&void 0!==e?e:(0,i.vec)(this.width/2,this.height/2);t.translate(a.x,a.y),t.rotate(this.rotation),t.scale(s,o),t.translate(-a.x,-a.y)}},{key:"_flip",value:function(i){this.flipHorizontal&&(i.translate(this.width/this.scale.x,0),i.scale(-1,1)),this.flipVertical&&(i.translate(0,this.height/this.scale.y),i.scale(1,-1))}},{key:"_postDraw",value:function(i){this.showDebug&&i.debug.drawRect(0,0,this.width,this.height),i.restore()}}]),s}();exports.Graphic=a,a._ID=0;
},{"../Algebra":"NGcQ","../Collision/BoundingBox":"oyna"}],"zu78":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Animation=exports.AnimationStrategy=void 0;var t,e=require("./Graphic"),r=require("../Util/Util"),n=require("../EventDispatcher");function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return e&&s(t.prototype,e),r&&s(t,r),t}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=m();return function(){var r,n=p(t);if(e){var i=p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f(this,r)}}function f(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?l(t):e}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function m(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}exports.AnimationStrategy=t,function(t){t.End="end",t.Loop="loop",t.PingPong="pingpong",t.Freeze="freeze"}(t||(exports.AnimationStrategy=t={}));var y=function(i){u(c,e.Graphic);var s=h(c);function c(e){var r,i,a;return o(this,c),(r=s.call(this,e)).events=new n.EventDispatcher(l(r)),r.frames=[],r.strategy=t.Loop,r.frameDuration=100,r.timeScale=1,r._idempotencyToken=-1,r._firstTick=!0,r._currentFrame=0,r._timeLeftInFrame=0,r._direction=1,r._done=!1,r._playing=!0,r.frames=e.frames,r.strategy=null!==(i=e.strategy)&&void 0!==i?i:r.strategy,r.frameDuration=null!==(a=e.frameDuration)&&void 0!==a?a:r.frameDuration,r.goToFrame(0),r}return a(c,[{key:"clone",value:function(){return new c(Object.assign({frames:this.frames.map(function(t){return Object.assign({},t)}),frameDuration:this.frameDuration,strategy:this.strategy},this.cloneGraphicOptions()))}},{key:"currentFrame",get:function(){return this._currentFrame>=0&&this._currentFrame<this.frames.length?this.frames[this._currentFrame]:null}},{key:"isPlaying",get:function(){return this._playing}},{key:"play",value:function(){this._playing=!0}},{key:"pause",value:function(){this._playing=!1,this._firstTick=!0}},{key:"reset",value:function(){this._done=!1,this._firstTick=!0,this._currentFrame=0}},{key:"canFinish",get:function(){switch(this.strategy){case t.End:case t.Freeze:return!0;default:return!1}}},{key:"done",get:function(){return this._done}},{key:"goToFrame",value:function(t){var e,r;this._currentFrame=t,this._timeLeftInFrame=this.frameDuration;var n=this.frames[this._currentFrame];n&&!this._done&&(this._timeLeftInFrame=(null==n?void 0:n.duration)||this.frameDuration,this.width=null===(e=n.graphic)||void 0===e?void 0:e.width,this.height=null===(r=n.graphic)||void 0===r?void 0:r.height,this.events.emit("frame",n))}},{key:"_nextFrame",value:function(){var e=this._currentFrame;if(this._done)return e;var n=-1;switch(this.strategy){case t.Loop:0===(n=(e+1)%this.frames.length)&&this.events.emit("loop",this);break;case t.End:(n=e+1)>=this.frames.length&&(this._done=!0,this._currentFrame=this.frames.length,this.events.emit("end",this));break;case t.Freeze:(n=(0,r.clamp)(e+1,0,this.frames.length-1))>=this.frames.length-1&&(this._done=!0,this.events.emit("end",this));break;case t.PingPong:e+this._direction>=this.frames.length&&(this._direction=-1,this.events.emit("loop",this)),e+this._direction<0&&(this._direction=1,this.events.emit("loop",this)),n=e+this._direction%this.frames.length}return n}},{key:"tick",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._idempotencyToken!==e&&(this._idempotencyToken=e,this._playing&&(this._firstTick&&(this._firstTick=!1,this.events.emit("frame",this.currentFrame)),this._timeLeftInFrame-=t*this.timeScale,this._timeLeftInFrame<=0&&this.goToFrame(this._nextFrame()),this._updateDimensions()))}},{key:"_updateDimensions",value:function(){var t,e;this.currentFrame&&(this.width=null===(t=this.currentFrame.graphic)||void 0===t?void 0:t.width,this.height=null===(e=this.currentFrame.graphic)||void 0===e?void 0:e.height)}},{key:"_drawImage",value:function(t,e,r){this.currentFrame&&this.currentFrame.graphic.draw(t,e,r)}}],[{key:"fromSpriteSheet",value:function(e,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.Loop;return new c({frames:e.sprites.filter(function(t,e){return r.indexOf(e)>-1}).map(function(t){return{graphic:t,duration:n}}),strategy:i})}}]),c}();exports.Animation=y;
},{"./Graphic":"OZee","../Util/Util":"Kkda","../EventDispatcher":"c7EN"}],"SRl6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GraphicsGroup=void 0;var t=require("./Graphic"),e=require("./Animation"),r=require("../Collision/Index");function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=u(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return a=t.done,t},e:function(t){c=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw i}}}}function i(t){return f(t)||c(t)||u(t)||a()}function a(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(t,e){if(t){if("string"==typeof t)return l(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(t,e):void 0}}function c(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function f(t){if(Array.isArray(t))return l(t)}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function y(t,e,r){return e&&p(t.prototype,e),r&&p(t,r),t}function h(t,e,r){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=m(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(r):o.value}})(t,e,r||t)}function m(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_(t)););return t}function b(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}function v(t,e){return(v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function d(t){var e=O();return function(){var r,n=_(t);if(e){var o=_(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return g(this,r)}}function g(t,e){return!e||"object"!==n(e)&&"function"!=typeof e?w(t):e}function w(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function O(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function _(t){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var j=function(n){b(u,t.Graphic);var a=d(u);function u(t){var e;return s(this,u),(e=a.call(this,t)).members=[],e.members=t.members,e._updateDimensions(),e}return y(u,[{key:"clone",value:function(){return new u(Object.assign({members:i(this.members)},this.cloneGraphicOptions()))}},{key:"_updateDimensions",value:function(){var t,e=new r.BoundingBox,n=o(this.members);try{for(n.s();!(t=n.n()).done;){var i=t.value,a=i.graphic,u=i.pos;e=a.localBounds.translate(u).combine(e)}}catch(c){n.e(c)}finally{n.f()}return this.width=e.width,this.height=e.height,e}},{key:"localBounds",get:function(){var t,e=new r.BoundingBox,n=o(this.members);try{for(n.s();!(t=n.n()).done;){var i=t.value,a=i.graphic,u=i.pos;e=a.localBounds.translate(u).combine(e)}}catch(c){n.e(c)}finally{n.f()}return e}},{key:"_isAnimationOrGroup",value:function(t){return t instanceof e.Animation||t instanceof u}},{key:"tick",value:function(t,e){var r,n=o(this.members);try{for(n.s();!(r=n.n()).done;){var i=r.value.graphic;this._isAnimationOrGroup(i)&&i.tick(t,e)}}catch(a){n.e(a)}finally{n.f()}}},{key:"reset",value:function(){var t,e=o(this.members);try{for(e.s();!(t=e.n()).done;){var r=t.value.graphic;this._isAnimationOrGroup(r)&&r.reset()}}catch(n){e.e(n)}finally{e.f()}}},{key:"_preDraw",value:function(t,e,r){this._updateDimensions(),h(_(u.prototype),"_preDraw",this).call(this,t,e,r)}},{key:"_drawImage",value:function(t,e,r){var n,i=o(this.members);try{for(i.s();!(n=i.n()).done;){var a=n.value;t.save(),t.translate(e,r),a.graphic.draw(t,a.pos.x,a.pos.y),this.showDebug&&t.debug.drawRect(0,0,this.width,this.height),t.restore()}}catch(u){i.e(u)}finally{i.f()}}}]),u}();exports.GraphicsGroup=j;
},{"./Graphic":"OZee","./Animation":"zu78","../Collision/Index":"kKHB"}],"jeAN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GraphicsComponent=exports.GraphicsLayers=exports.GraphicsLayer=void 0;var t=require("../Algebra"),e=require("./Graphic"),r=require("./Animation"),n=require("./GraphicsGroup"),o=require("../Util/Log"),i=require("../Collision/Index"),a=require("../EntityComponentSystem/Component");function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=u(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function u(t,e){if(t){if("string"==typeof t)return l(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(t,e):void 0}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function f(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function p(t){var e=d();return function(){var r,n=v(t);if(e){var o=v(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return y(this,r)}}function y(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?g(t):e}function g(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function v(t){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function m(t,e,r){return e&&b(t.prototype,e),r&&b(t,r),t}var w=function(){function r(t,e){_(this,r),this._options=t,this._graphics=e,this.graphics=[]}return m(r,[{key:"name",get:function(){return this._options.name}},{key:"hide",value:function(t){if(t){var r=null;r=t instanceof e.Graphic?t:this._graphics.getGraphic(t),this.graphics=this.graphics.filter(function(t){return t.graphic!==r})}else this.graphics.length=0}},{key:"show",value:function(t,r){var n;return r=Object.assign({offset:this._graphics.offset.clone(),anchor:this._graphics.anchor.clone()},r),t instanceof e.Graphic?n=this._graphics.copyGraphics?t.clone():t:(n=this._graphics.getGraphic(t))||o.Logger.getInstance().error("No such graphic added to component named ".concat(t,". These named graphics are available: "),this._graphics.getNames()),n?(this.graphics.push({graphic:n,options:r}),n):null}},{key:"use",value:function(t,e){return e=Object.assign({offset:this._graphics.offset.clone(),anchor:this._graphics.anchor.clone()},e),this.hide(),this.show(t,e)}},{key:"order",get:function(){return this._options.order},set:function(t){this._options.order=t}},{key:"offset",get:function(){var e;return null!==(e=this._options.offset)&&void 0!==e?e:t.Vector.Zero},set:function(t){this._options.offset=t}}]),r}();exports.GraphicsLayer=w;var k=function(){function t(e){_(this,t),this._component=e,this._layers=[],this._layerMap={},this.default=new w({name:"default",order:0},e),this._maybeAddLayer(this.default)}return m(t,[{key:"create",value:function(t){var e=new w(t,this._component);return this._maybeAddLayer(e)}},{key:"get",value:function(t){return t?this._getLayer(t):this._layers}},{key:"has",value:function(t){return t in this._layerMap}},{key:"_maybeAddLayer",value:function(t){return this._layerMap[t.name]?this._layerMap[t.name]:(this._layerMap[t.name]=t,this._layers.push(t),this._layers.sort(function(t,e){return t.order-e.order}),t)}},{key:"_getLayer",value:function(t){return this._layerMap[t]}}]),t}();exports.GraphicsLayers=k;var G=function(e){f(s,a.Component);var o=p(s);function s(e){var r;_(this,s),(r=o.call(this)).type="graphics",r._graphics={},r.visible=!0,r.opacity=1,r.offset=t.Vector.Zero,r.anchor=t.Vector.Half,r.copyGraphics=!1,r._bounds=null;var n=e=Object.assign({visible:r.visible},e),i=n.current,a=n.anchor,c=n.opacity,u=n.visible,l=n.graphics,f=n.offset,h=n.copyGraphics,p=n.onPreDraw,y=n.onPostDraw;return r._graphics=l||{},r.offset=null!=f?f:r.offset,r.opacity=null!=c?c:r.opacity,r.anchor=null!=a?a:r.anchor,r.copyGraphics=null!=h?h:r.copyGraphics,r.onPreDraw=null!=p?p:r.onPreDraw,r.onPostDraw=null!=y?y:r.onPostDraw,r.visible=!!u,r.layers=new k(g(r)),i&&r._graphics[i]&&r.show(r._graphics[i]),r}return m(s,[{key:"getGraphic",value:function(t){return this._graphics[t]}},{key:"getNames",value:function(){return Object.keys(this._graphics)}},{key:"current",get:function(){return this.layers.default.graphics}},{key:"graphics",get:function(){return this._graphics}},{key:"add",value:function(t,e){var r="default",n=null;return"string"==typeof t?(r=t,n=e):n=t,this._graphics[r]=this.copyGraphics?n.clone():n,"default"===r&&this.show("default"),n}},{key:"show",value:function(t,e){return this.layers.default.show(t,e)}},{key:"use",value:function(t,e){return this.layers.default.use(t,e)}},{key:"hide",value:function(t){this.layers.default.hide(t)}},{key:"_isAnimationOrGroup",value:function(t){return t instanceof r.Animation||t instanceof n.GraphicsGroup}},{key:"localBounds",get:function(){if(this._bounds)return this._bounds;var e,r=new i.BoundingBox,n=c(this.layers.get());try{for(n.s();!(e=n.n()).done;){var o,a=e.value,s=c(a.graphics);try{for(s.s();!(o=s.n()).done;){var u=o.value,l=u.graphic,f=u.options,h=f.offset,p=f.anchor,y=l.localBounds,g=-y.width*l.scale.x*p.x+h.x,d=-y.height*l.scale.y*p.y+h.y;r=null==l?void 0:l.localBounds.translate((0,t.vec)(g+a.offset.x,d+a.offset.y)).combine(r)}}catch(v){s.e(v)}finally{s.f()}}}catch(v){n.e(v)}finally{n.f()}return r},set:function(t){this._bounds=t}},{key:"update",value:function(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=c(this.layers.get());try{for(n.s();!(e=n.n()).done;){var o,i=c(e.value.graphics);try{for(i.s();!(o=i.n()).done;){var a=o.value.graphic;this._isAnimationOrGroup(a)&&(null==a||a.tick(t,r))}}catch(s){i.e(s)}finally{i.f()}}}catch(s){n.e(s)}finally{n.f()}}}]),s}();exports.GraphicsComponent=G;
},{"../Algebra":"NGcQ","./Graphic":"OZee","./Animation":"zu78","./GraphicsGroup":"SRl6","../Util/Log":"p1Gn","../Collision/Index":"kKHB","../EntityComponentSystem/Component":"r8EA"}],"MzmB":[function(require,module,exports) {
"use strict";function e(e){return 0==(e&e-1)}function r(e){--e;for(var r=1;r<32;r<<=1)e|=e>>r;return e+1}function o(o){return e(o)?o:r(o)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.isPowerOfTwo=e,exports.nextHighestPowerOfTwo=r,exports.ensurePowerOfTwo=o;
},{}],"cHV7":[function(require,module,exports) {
"use strict";function e(e,t){return e&&void 0===e.__isProxy?new Proxy(e,{set:function(e,r,n){return e[r]!==n&&(e[r]=n,"string"==typeof r&&"_"!==r[0]&&t(e)),!0},get:function(e,t){return"__isProxy"===t||e[t]}}):e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.watch=e;
},{}],"dce9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TextureLoader=void 0;var e=require("./webgl-util");function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var r=0;r<t.length;r++){var T=t[r];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(e,T.key,T)}}function T(e,t,T){return t&&r(e.prototype,t),T&&r(e,T),e}var n=function(){function r(){t(this,r)}return T(r,null,[{key:"registerContext",value:function(e){r._GL=e}},{key:"get",value:function(e){return r._TEXTURE_MAP.get(e)}},{key:"has",value:function(e){return r._TEXTURE_MAP.has(e)}},{key:"load",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],T=r._GL;if(!T)return null;var n=null;if(r.has(e)&&(n=r.get(e)),n){if(t){T.bindTexture(T.TEXTURE_2D,n);var a=r.toPowerOfTwoImage(e);T.texImage2D(T.TEXTURE_2D,0,T.RGBA,T.RGBA,T.UNSIGNED_BYTE,a)}return n}n=T.createTexture();var o=r.toPowerOfTwoImage(e);return T.bindTexture(T.TEXTURE_2D,n),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,T.CLAMP_TO_EDGE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,T.CLAMP_TO_EDGE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,T.NEAREST),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,T.NEAREST),T.texImage2D(T.TEXTURE_2D,0,T.RGBA,T.RGBA,T.UNSIGNED_BYTE,o),r._TEXTURE_MAP.set(e,n),n}},{key:"toPowerOfTwoImage",value:function(t){var T=r._POT_CANVAS,n=r._POT_CTX;return(0,e.isPowerOfTwo)(t.width)&&(0,e.isPowerOfTwo)(t.height)||(T.width=(0,e.ensurePowerOfTwo)(t.width),T.height=(0,e.ensurePowerOfTwo)(t.height),n.imageSmoothingEnabled=!1,n.clearRect(0,0,T.width,T.height),n.drawImage(t,0,0,t.width,t.height),t=T),t}}]),r}();exports.TextureLoader=n,n._POT_CANVAS=document.createElement("canvas"),n._POT_CTX=n._POT_CANVAS.getContext("2d"),n._TEXTURE_MAP=new Map;
},{"./webgl-util":"MzmB"}],"Syvu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Raster=void 0;var t=require("./Graphic"),i=require("../Drawing/Color"),e=require("./Context/webgl-util"),n=require("../Algebra"),o=require("../Collision/BoundingBox"),r=require("../Util/Watch"),s=require("./Context/texture-loader");function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function h(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function a(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,i,e){return i&&a(t.prototype,i),e&&a(t,e),t}function c(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&f(t,i)}function f(t,i){return(f=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function d(t){var i=y();return function(){var e,n=_(t);if(i){var o=_(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return p(this,e)}}function p(t,i){return!i||"object"!==l(i)&&"function"!=typeof i?g(t):i}function g(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function y(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function _(t){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var v=function(l){c(f,t.Graphic);var a=d(f);function f(t){var n,o,s,l,u,c,d,p;h(this,f),(n=a.call(this,t))._dirty=!0,n._smoothing=!1,n._color=(0,r.watch)(i.Color.Black,function(){return n.flagDirty()}),n._lineWidth=1,n._lineDash=[],n._padding=0,t&&(n.color=null!==(o=t.color)&&void 0!==o?o:i.Color.Black,n.strokeColor=null==t?void 0:t.strokeColor,n.smoothing=null!==(s=t.smoothing)&&void 0!==s?s:n.smoothing,n.lineWidth=null!==(l=t.lineWidth)&&void 0!==l?l:n.lineWidth,n.lineDash=null!==(u=t.lineDash)&&void 0!==u?u:n.lineDash,n.padding=null!==(c=t.padding)&&void 0!==c?c:n.padding),n._bitmap=document.createElement("canvas");var g=null!==(d=null==t?void 0:t.width)&&void 0!==d?d:n._bitmap.width,y=null!==(p=null==t?void 0:t.height)&&void 0!==p?p:n._bitmap.height;n._bitmap.width=(0,e.ensurePowerOfTwo)(g),n._bitmap.height=(0,e.ensurePowerOfTwo)(y);var _=n._bitmap.getContext("2d");if(!_)throw new Error("Browser does not support 2d canvas drawing, cannot create Raster graphic");return n._ctx=_,n}return u(f,[{key:"cloneRasterOptions",value:function(){return{color:this.color?this.color.clone():null,strokeColor:this.strokeColor?this.strokeColor.clone():null,smoothing:this.smoothing,lineWidth:this.lineWidth,lineDash:this.lineDash,padding:this.padding}}},{key:"dirty",get:function(){return this._dirty}},{key:"flagDirty",value:function(){this._dirty=!0}},{key:"width",get:function(){return this._bitmap.width},set:function(t){this._bitmap.width=t,this.flagDirty()}},{key:"height",get:function(){return this._bitmap.height},set:function(t){this._bitmap.height=t,this.flagDirty()}},{key:"localBounds",get:function(){return o.BoundingBox.fromDimension(this.width*this.scale.x,this.height*this.scale.y,n.Vector.Zero)}},{key:"smoothing",get:function(){return this._smoothing},set:function(t){this._smoothing=t,this.flagDirty()}},{key:"color",get:function(){return this._color},set:function(t){var i,e=this;(null===(i=this._color)||void 0===i?void 0:i.equal(t))||this.flagDirty(),this._color=(0,r.watch)(t,function(){return e.flagDirty()})}},{key:"strokeColor",get:function(){return this._strokeColor},set:function(t){var i,e=this;(null===(i=this._strokeColor)||void 0===i?void 0:i.equal(t))||this.flagDirty(),this._strokeColor=(0,r.watch)(t,function(){return e.flagDirty()})}},{key:"lineWidth",get:function(){return this._lineWidth},set:function(t){this._lineWidth=t,this.flagDirty()}},{key:"lineDash",get:function(){return this._lineDash},set:function(t){this._lineDash=t,this.flagDirty()}},{key:"padding",get:function(){return this._padding},set:function(t){this._padding=t,this.flagDirty()}},{key:"rasterize",value:function(){this._dirty=!1,this._ctx.clearRect(0,0,this.width,this.height),this._ctx.save(),this._applyRasterProperites(this._ctx),this.execute(this._ctx),this._ctx.restore(),s.TextureLoader.load(this._bitmap,!0)}},{key:"_applyRasterProperites",value:function(t){var i,e,n;this._bitmap.width=this._bitmap.width+2*this.padding,this._bitmap.height=this._bitmap.height+2*this.padding,t.translate(this.padding,this.padding),t.imageSmoothingEnabled=this.smoothing,t.lineWidth=this.lineWidth,t.setLineDash(null!==(i=this.lineDash)&&void 0!==i?i:t.getLineDash()),t.strokeStyle=null===(e=this.strokeColor)||void 0===e?void 0:e.toString(),t.fillStyle=null===(n=this.color)||void 0===n?void 0:n.toString()}},{key:"_drawImage",value:function(t,i,e){this._dirty&&this.rasterize(),t.drawImage(this._bitmap,i,e)}}]),f}();exports.Raster=v;
},{"./Graphic":"OZee","../Drawing/Color":"p7Gh","./Context/webgl-util":"MzmB","../Algebra":"NGcQ","../Collision/BoundingBox":"oyna","../Util/Watch":"cHV7","./Context/texture-loader":"dce9"}],"mSU3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Rectangle=void 0;var t=require("./Raster");function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=l();return function(){var n,r=a(t);if(e){var o=a(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return f(this,n)}}function f(t,n){return!n||"object"!==e(n)&&"function"!=typeof n?s(t):n}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(e){i(c,t.Raster);var r=u(c);function c(t){var e;return n(this,c),(e=r.call(this,t)).width=t.width,e.height=t.height,e.rasterize(),e}return o(c,[{key:"clone",value:function(){return new c(Object.assign(Object.assign({width:this.width,height:this.height},this.cloneGraphicOptions()),this.cloneRasterOptions()))}},{key:"execute",value:function(t){this.color&&t.fillRect(0,0,this.width,this.height),this.strokeColor&&t.strokeRect(0,0,this.width,this.height)}}]),c}();exports.Rectangle=h;
},{"./Raster":"Syvu"}],"vmFf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isActor=K,exports.Actor=exports.ActorImpl=void 0;var t=require("./Resources/Texture"),e=require("./Events"),n=require("./Drawing/Color"),r=require("./Drawing/Sprite"),o=require("./Drawing/Animation"),i=require("./Util/Log"),a=require("./Actions/ActionContext"),s=require("./Actions/Action"),l=require("./Algebra"),c=require("./Collision/Body"),u=require("./Configurable"),h=P(require("./Traits/Index")),f=require("./Collision/CollisionType"),d=require("./Util/Decorators"),p=require("./Collision/Collider"),g=require("./Collision/Shape"),y=require("./EntityComponentSystem/Entity"),v=require("./Drawing/CanvasDrawComponent"),b=require("./EntityComponentSystem/Components/TransformComponent"),w=require("./Graphics/GraphicsComponent"),m=require("./Graphics/Rectangle"),_=require("./Flags");function k(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return k=function(){return t},t}function P(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=k();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var i=r?Object.getOwnPropertyDescriptor(t,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=t[o]}return n.default=t,e&&e.set(t,n),n}function D(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=x(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,i=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function x(t,e){if(t){if("string"==typeof t)return C(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(t,e):void 0}}function C(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function S(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function A(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function O(t,e,n){return e&&A(t.prototype,e),n&&A(t,n),t}function E(t,e,n){return(E="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=T(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function T(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=H(t)););return t}function M(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&I(t,e)}function I(t,e){return(I=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function j(t){var e=R();return function(){var n,r=H(t);if(e){var o=H(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return q(this,n)}}function q(t,e){return!e||"object"!==U(e)&&"function"!=typeof e?G(t):e}function G(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function R(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function H(t){return(H=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function U(t){return(U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var z=function(t,e,n,r){var o,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===("undefined"==typeof Reflect?"undefined":U(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};function K(t){return t instanceof B}var L=function(u){M(k,y.Entity);var d=j(k);function k(t,e,n,r,o){var u,y;S(this,k),(u=d.call(this,[new b.TransformComponent,new w.GraphicsComponent,new v.CanvasDrawComponent(function(t,e){return u.draw(t,e)})]))._height=0,u._width=0,u.opacity=1,u.previousOpacity=1,u.logger=i.Logger.getInstance(),u.scene=null,u.frames={},u.currentDrawing=null,u._draggable=!1,u._dragging=!1,u._pointerDragStartHandler=function(){u._dragging=!0},u._pointerDragEndHandler=function(){u._dragging=!1},u._pointerDragMoveHandler=function(t){u._dragging&&(u.pos=t.pointer.lastWorldPos)},u._pointerDragLeaveHandler=function(t){u._dragging&&(u.pos=t.pointer.lastWorldPos)},u.traits=[],u.enableCapturePointer=!1,u.capturePointer={captureMoveEvents:!1,captureDragEvents:!1},u._isKilled=!1,u._capturePointerEvents=["pointerup","pointerdown","pointermove","pointerenter","pointerleave","pointerdragstart","pointerdragend","pointerdragmove","pointerdragenter","pointerdragleave"],u._captureMoveEvents=["pointermove","pointerenter","pointerleave","pointerdragmove","pointerdragenter","pointerdragleave"],u._captureDragEvents=["pointerdragstart","pointerdragend","pointerdragmove","pointerdragenter","pointerdragleave"],u.transform=u.get(b.TransformComponent),u.graphics=u.get(w.GraphicsComponent),u._initDefaults();var P=!0,D=f.CollisionType.Passive;if(t&&"object"===U(t)){var x=t;x.pos?(t=x.pos?x.pos.x:0,e=x.pos?x.pos.y:0):(t=x.x||0,e=x.y||0),n=x.width,r=x.height,o=x.color,x.body&&(P=!1,u.body=x.body),x.anchor&&(u.anchor=x.anchor),x.collisionType&&(D=x.collisionType)}return u._width=n||0,u._height=r||0,P&&(u.body=new c.Body({collider:new p.Collider({type:D,shape:g.Shape.Box(u._width,u._height,u.anchor)})})),u.pos=(0,l.vec)(null!==(y=t)&&void 0!==y?y:0,null!=e?e:0),o&&(u.color=o,u.opacity=o.a),o&&u.graphics.add(new m.Rectangle({color:o,width:u._width,height:u._height})),u.traits.push(new h.TileMapCollisionDetection),_.Flags.isEnabled(_.Legacy.LegacyDrawing)&&u.traits.push(new h.OffscreenCulling),u.traits.push(new h.CapturePointer),u.actionQueue=new s.ActionQueue(G(u)),u.actions=new a.ActionContext(G(u)),u}return O(k,[{key:"body",get:function(){return this._body},set:function(t){this._body=t,this._body.actor=this}},{key:"pos",get:function(){return this.body.pos},set:function(t){this.body.pos=t}},{key:"oldPos",get:function(){return this.body.oldPos},set:function(t){this.body.oldPos.setTo(t.x,t.y)}},{key:"vel",get:function(){return this.body.vel},set:function(t){this.body.vel.setTo(t.x,t.y)}},{key:"oldVel",get:function(){return this.body.oldVel},set:function(t){this.body.oldVel.setTo(t.x,t.y)}},{key:"acc",get:function(){return this.body.acc},set:function(t){this.body.acc.setTo(t.x,t.y)}},{key:"oldAcc",get:function(){return this.body.oldAcc},set:function(t){this.body.oldAcc.setTo(t.x,t.y)}},{key:"rotation",get:function(){return this.body.rotation},set:function(t){this.body.rotation=t}},{key:"rx",get:function(){return this.body.rx},set:function(t){this.body.rx=t}},{key:"scale",get:function(){return this.get(b.TransformComponent).scale},set:function(t){this.get(b.TransformComponent).scale=t}},{key:"oldScale",get:function(){return this.body.oldScale},set:function(t){this.body.oldScale=t}},{key:"sx",get:function(){return this.body.sx},set:function(t){this.body.sx=t}},{key:"sy",get:function(){return this.body.sy},set:function(t){this.body.sy=t}},{key:"isOffScreen",get:function(){return this.hasTag("offscreen")}},{key:"visible",get:function(){return this.graphics.visible},set:function(t){this.graphics.visible=t}},{key:"draggable",get:function(){return this._draggable},set:function(t){t&&(t&&!this._draggable?(this.on("pointerdragstart",this._pointerDragStartHandler),this.on("pointerdragend",this._pointerDragEndHandler),this.on("pointerdragmove",this._pointerDragMoveHandler),this.on("pointerdragleave",this._pointerDragLeaveHandler)):!t&&this._draggable&&(this.off("pointerdragstart",this._pointerDragStartHandler),this.off("pointerdragend",this._pointerDragEndHandler),this.off("pointerdragmove",this._pointerDragMoveHandler),this.off("pointerdragleave",this._pointerDragLeaveHandler)),this._draggable=t)}},{key:"color",get:function(){return this._color},set:function(t){this._color=t.clone()}},{key:"onInitialize",value:function(t){}},{key:"_initialize",value:function(t){E(H(k.prototype),"_initialize",this).call(this,t);var e,n=D(this.children);try{for(n.s();!(e=n.n()).done;){e.value._initialize(t)}}catch(r){n.e(r)}finally{n.f()}}},{key:"_initDefaults",value:function(){this.anchor=B.defaults.anchor.clone()}},{key:"_checkForPointerOptIn",value:function(t){if(t){var e=t.toLowerCase();-1!==this._capturePointerEvents.indexOf(e)&&(this.enableCapturePointer=!0,-1!==this._captureMoveEvents.indexOf(e)&&(this.capturePointer.captureMoveEvents=!0),-1!==this._captureDragEvents.indexOf(e)&&(this.capturePointer.captureDragEvents=!0))}}},{key:"on",value:function(t,e){this._checkForPointerOptIn(t),E(H(k.prototype),"on",this).call(this,t,e)}},{key:"once",value:function(t,e){this._checkForPointerOptIn(t),E(H(k.prototype),"once",this).call(this,t,e)}},{key:"off",value:function(t,e){E(H(k.prototype),"off",this).call(this,t,e)}},{key:"_prekill",value:function(t){E(H(k.prototype),"emit",this).call(this,"prekill",new e.PreKillEvent(this)),this.onPreKill(t)}},{key:"onPreKill",value:function(t){}},{key:"_postkill",value:function(t){E(H(k.prototype),"emit",this).call(this,"postkill",new e.PostKillEvent(this)),this.onPostKill(t)}},{key:"onPostKill",value:function(t){}},{key:"kill",value:function(){this.scene?(this._prekill(this.scene),this.emit("kill",new e.KillEvent(this)),this._isKilled=!0,this.scene.remove(this),this._postkill(this.scene)):this.logger.warn("Cannot kill actor, it was never added to the Scene")}},{key:"unkill",value:function(){this._isKilled=!1}},{key:"isKilled",value:function(){return this._isKilled}},{key:"setDrawing",value:function(t){t=t.toString(),this.currentDrawing!==this.frames[t]&&(null!=this.frames[t]?(this.frames[t].reset(),this.currentDrawing=this.frames[t]):i.Logger.getInstance().error("the specified drawing key ".concat(t," does not exist"))),this.currentDrawing&&this.currentDrawing instanceof o.Animation&&this.currentDrawing.tick(0)}},{key:"addDrawing",value:function(){2===arguments.length?(this.frames[arguments[0]]=arguments[1],this.currentDrawing||(this.currentDrawing=arguments[1])):(arguments[0]instanceof r.Sprite&&this.addDrawing("default",arguments[0]),arguments[0]instanceof t.Texture&&this.addDrawing("default",arguments[0].asSprite()))}},{key:"z",get:function(){return this.getZIndex()},set:function(t){this.setZIndex(t)}},{key:"getZIndex",value:function(){return this.get(b.TransformComponent).z}},{key:"setZIndex",value:function(t){this.get(b.TransformComponent).z=t}},{key:"center",get:function(){return new l.Vector(this.pos.x+this.width/2-this.anchor.x*this.width,this.pos.y+this.height/2-this.anchor.y*this.height)}},{key:"width",get:function(){return this._width*this.getGlobalScale().x},set:function(t){this._width=t/this.scale.x,this.body.collider.shape=g.Shape.Box(this._width,this._height,this.anchor),this.body.markCollisionShapeDirty()}},{key:"height",get:function(){return this._height*this.getGlobalScale().y},set:function(t){this._height=t/this.scale.y,this.body.collider.shape=g.Shape.Box(this._width,this._height,this.anchor),this.body.markCollisionShapeDirty()}},{key:"getGlobalRotation",value:function(){return this.get(b.TransformComponent).globalRotation}},{key:"getGlobalPos",value:function(){return this.get(b.TransformComponent).globalPos}},{key:"getGlobalScale",value:function(){return this.get(b.TransformComponent).globalScale}},{key:"contains",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.getGlobalPos().sub(this.pos),o=this.body.collider.bounds.translate(r).contains(new l.Vector(t,e));return n?o||this.children.some(function(n){return n.contains(t,e,!0)}):o}},{key:"within",value:function(t,e){return this.body.collider.shape.getClosestLineBetween(t.body.collider.shape).getLength()<=e}},{key:"update",value:function(t,e){this._initialize(t),this._preupdate(t,e);var n=this.currentDrawing;n&&n instanceof o.Animation&&n.tick(e,t.stats.currFrame.id),this.actionQueue.update(e),this.color&&(this.color.a=this.opacity),0===this.opacity&&(this.visible=!1),this.body.captureOldTransform(),this.body.integrate(e);var r,i=D(this.traits);try{for(i.s();!(r=i.n()).done;){r.value.update(this,t,e)}}catch(a){i.e(a)}finally{i.f()}this._postupdate(t,e)}},{key:"onPreUpdate",value:function(t,e){}},{key:"onPostUpdate",value:function(t,e){}},{key:"_preupdate",value:function(t,n){this.emit("preupdate",new e.PreUpdateEvent(t,n,this)),this.onPreUpdate(t,n)}},{key:"_postupdate",value:function(t,n){this.emit("postupdate",new e.PreUpdateEvent(t,n,this)),this.onPostUpdate(t,n)}},{key:"draw",value:function(t,e){if(t.save(),t.translate(-this._width*this.anchor.x,-this._height*this.anchor.y),this._predraw(t,e),this.currentDrawing){var n=this.currentDrawing,r=(this._width-n.drawWidth)*this.anchor.x,o=(this._height-n.drawHeight)*this.anchor.y;this.currentDrawing.draw({ctx:t,x:r,y:o,opacity:this.opacity})}else this.color&&this.body&&this.body.collider&&this.body.collider.shape&&this.body.collider.shape.draw(t,this.color,new l.Vector(0,0));t.restore(),this._postdraw(t,e)}},{key:"onPreDraw",value:function(t,e){}},{key:"onPostDraw",value:function(t,e){}},{key:"_predraw",value:function(t,n){this.emit("predraw",new e.PreDrawEvent(t,n,this)),this.onPreDraw(t,n)}},{key:"_postdraw",value:function(t,n){this.emit("postdraw",new e.PreDrawEvent(t,n,this)),this.onPostDraw(t,n)}},{key:"debugDraw",value:function(t){this.emit("predebugdraw",new e.PreDebugDrawEvent(t,this)),this.body.collider.debugDraw(t);var r=this.body.collider.localBounds.translate(this.getGlobalPos());r.debugDraw(t),t.fillText("id: "+this.id,r.left+3,r.top+10),t.fillStyle=n.Color.Yellow.toString(),t.beginPath(),t.arc(this.getGlobalPos().x,this.getGlobalPos().y,3,0,2*Math.PI),t.closePath(),t.fill();for(var o=0;o<this.traits.length;o++)this.traits[o]instanceof h.OffscreenCulling&&this.traits[o].cullingBox.debugDraw(t);t.strokeStyle=n.Color.Yellow.toString(),t.beginPath();var i=Math.min(this.width,this.height);t.arc(this.getGlobalPos().x,this.getGlobalPos().y,i,0,2*Math.PI),t.closePath(),t.stroke();var a={"0 Pi":0,"Pi/2":Math.PI/2,Pi:Math.PI,"3/2 Pi":3*Math.PI/2},s=t.font;for(var l in a)t.fillStyle=n.Color.Yellow.toString(),t.font="14px",t.textAlign="center",t.fillText(l,this.getGlobalPos().x+Math.cos(a[l])*(i+10),this.getGlobalPos().y+Math.sin(a[l])*(i+10));t.font=s,this.emit("postdebugdraw",new e.PostDebugDrawEvent(t,this))}}]),k}();exports.ActorImpl=L,L.defaults={anchor:l.Vector.Half},z([(0,d.obsolete)({message:"ex.Actor.sx will be removed in v0.25.0",alternateMethod:"Set width and height directly in constructor"})],L.prototype,"sx",null),z([(0,d.obsolete)({message:"ex.Actor.sy will be removed in v0.25.0",alternateMethod:"Set width and height directly in constructor"})],L.prototype,"sy",null),z([(0,d.obsolete)({message:"Actor.visible will be removed in v0.26.0",alternateMethod:"Use Actor.graphics.visible"})],L.prototype,"visible",null),z([(0,d.obsolete)({message:"Actor.setDrawing will be removed in v0.26.0",alternateMethod:"Use Actor.graphics.show() or Actor.graphics.swap()"})],L.prototype,"setDrawing",null),z([(0,d.obsolete)({message:"Actor.addDrawing will be removed in v0.26.0",alternateMethod:"Use Actor.graphics.add()"})],L.prototype,"addDrawing",null),z([(0,d.obsolete)({message:"Actor.getZIndex will be removed in v0.26.0",alternateMethod:"Use Actor.transform.z or Actor.z"})],L.prototype,"getZIndex",null),z([(0,d.obsolete)({message:"Actor.setZIndex will be removed in v0.26.0",alternateMethod:"Use Actor.transform.z or Actor.z"})],L.prototype,"setZIndex",null);var B=function(t){M(n,(0,u.Configurable)(L));var e=j(n);function n(t,r,o,i,a){return S(this,n),e.call(this,t,r,o,i,a)}return n}();exports.Actor=B;
},{"./Resources/Texture":"HrNa","./Events":"XySq","./Drawing/Color":"p7Gh","./Drawing/Sprite":"PpGD","./Drawing/Animation":"qSfQ","./Util/Log":"p1Gn","./Actions/ActionContext":"vA04","./Actions/Action":"gDdL","./Algebra":"NGcQ","./Collision/Body":"oGoG","./Configurable":"A4Kj","./Traits/Index":"CPmg","./Collision/CollisionType":"liCD","./Util/Decorators":"kQDE","./Collision/Collider":"KRUI","./Collision/Shape":"Mmyc","./EntityComponentSystem/Entity":"UY9q","./Drawing/CanvasDrawComponent":"UzNB","./EntityComponentSystem/Components/TransformComponent":"yq2E","./Graphics/GraphicsComponent":"jeAN","./Graphics/Rectangle":"mSU3","./Flags":"JzY1"}],"hSwP":[function(require,module,exports) {
"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function n(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.AudioContextFactory=void 0;var o=function(){function t(){e(this,t)}return n(t,null,[{key:"create",value:function(){return this._INSTANCE||(window.AudioContext||window.webkitAudioContext)&&(this._INSTANCE=new AudioContext),this._INSTANCE}}]),t}();exports.AudioContextFactory=o,o._INSTANCE=null;
},{}],"KQch":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.WebAudio=void 0;var e=require("../Resources/Sound/AudioContext"),t=require("./Log");function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function u(e){return!!e.playbackState}var a=function(){function r(){n(this,r)}return o(r,null,[{key:"unlock",value:function(){return new Promise(function(n,o){if(r._UNLOCKED||!e.AudioContextFactory.create())return n(!0);var a=setTimeout(function(){t.Logger.getInstance().warn("Excalibur was unable to unlock the audio context, audio probably will not play in this browser."),n(!1)},200),i=e.AudioContextFactory.create();i.resume().then(function(){var e=i.createBuffer(1,1,22050),t=i.createBufferSource(),o=!1;t.buffer=e,t.connect(i.destination),t.onended=function(){return o=!0},t.start(0),setTimeout(function(){u(t)?t.playbackState!==t.PLAYING_STATE&&t.playbackState!==t.FINISHED_STATE||(r._UNLOCKED=!0):(i.currentTime>0||o)&&(r._UNLOCKED=!0)},0),clearTimeout(a),n(!0)},function(){o()})})}},{key:"isUnlocked",value:function(){return this._UNLOCKED}}]),r}();exports.WebAudio=a,a._UNLOCKED=!1;
},{"../Resources/Sound/AudioContext":"hSwP","./Log":"p1Gn"}],"r7m0":[function(require,module,exports) {
module.exports="/ludum-48/Loader.logo.647a87f4.png";
},{}],"R3Xd":[function(require,module,exports) {

},{}],"wtst":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Canvas=void 0;var t=require("./Raster");function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function r(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=a();return function(){var n,o=l(t);if(e){var r=l(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return f(this,n)}}function f(t,n){return!n||"object"!==e(n)&&"function"!=typeof n?s(t):n}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(e){i(c,t.Raster);var o=u(c);function c(t){var e;return n(this,c),(e=o.call(this,t))._options=t,e}return r(c,[{key:"ctx",get:function(){return this._ctx}},{key:"clone",value:function(){return new c(Object.assign(Object.assign(Object.assign({},this._options),this.cloneGraphicOptions()),this.cloneRasterOptions()))}},{key:"execute",value:function(t){var e,n;(null===(e=this._options)||void 0===e?void 0:e.draw)&&(null===(n=this._options)||void 0===n||n.draw(t)),this._options.cache||this.flagDirty()}}]),c}();exports.Canvas=p;
},{"./Raster":"Syvu"}],"jUb1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Loader=void 0;var t=require("./Drawing/Color"),e=require("./Util/WebAudio"),n=require("./Class"),o=c(require("./Util/DrawUtil")),i=l(require("./Loader.logo.png")),r=l(require("./Loader.css")),u=require("./Graphics/Canvas"),a=require("./Util/Util");function l(t){return t&&t.__esModule?t:{default:t}}function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}function c(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var r=o?Object.getOwnPropertyDescriptor(t,i):null;r&&(r.get||r.set)?Object.defineProperty(n,i,r):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function f(t,e,n){return e&&p(t.prototype,e),n&&p(t,n),t}function d(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_(t,e)}function _(t,e){return(_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function g(t){var e=v();return function(){var n,o=b(t);if(e){var i=b(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return m(this,n)}}function m(t,e){return!e||"object"!==h(e)&&"function"!=typeof e?B(t):e}function B(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function v(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function b(t){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var E=function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function u(t){try{l(o.next(t))}catch(e){r(e)}}function a(t){try{l(o.throw(t))}catch(e){r(e)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(u,a)}l((o=o.apply(t,e||[])).next())})},w=function(l){d(c,n.Class);var s=g(c);function c(e){var n;return y(this,c),(n=s.call(this)).canvas=new u.Canvas({smoothing:!0,draw:n.draw.bind(B(n))}),n._resourceList=[],n._index=0,n._playButtonShown=!1,n._resourceCount=0,n._numLoaded=0,n._progressCounts={},n._totalCounts={},n.logo=i.default,n.logoWidth=468,n.logoHeight=118,n.loadingBarColor=t.Color.White,n.backgroundColor="#176BAA",n.suppressPlayButton=!1,n._playButtonStyles=r.default.toString(),n.playButtonText="Play game",n.startButtonFactory=function(){var t=document.getElementById("excalibur-play");return t||(t=document.createElement("button")),t.id="excalibur-play",t.textContent=n.playButtonText,t.style.display="none",t},e&&n.addResources(e),n}return f(c,[{key:"_image",get:function(){return this._imageElement||(this._imageElement=new Image,this._imageElement.src=this.logo),this._imageElement}},{key:"playButtonRootElement",get:function(){return this._playButtonRootElement}},{key:"playButtonElement",get:function(){return this._playButtonElement}},{key:"_playButton",get:function(){var t=document.getElementById("excalibur-play-root");return t&&(this._playButtonRootElement=t),this._playButtonRootElement||(this._playButtonRootElement=document.createElement("div"),this._playButtonRootElement.id="excalibur-play-root",this._playButtonRootElement.style.position="absolute",document.body.appendChild(this._playButtonRootElement)),this._styleBlock||(this._styleBlock=document.createElement("style"),this._styleBlock.textContent=this._playButtonStyles,document.head.appendChild(this._styleBlock)),this._playButtonElement||(this._playButtonElement=this.startButtonFactory(),this._playButtonRootElement.appendChild(this._playButtonElement)),this._playButtonElement}},{key:"wireEngine",value:function(t){this._engine=t,this.canvas.width=this._engine.canvas.width,this.canvas.height=this._engine.canvas.height}},{key:"addResource",value:function(t){var e=this._index++;this._resourceList.push(t),this._progressCounts[e]=0,this._totalCounts[e]=1,this._resourceCount++}},{key:"addResources",value:function(t){for(var e=0,n=t.length;e<n;e++)this.addResource(t[e])}},{key:"isLoaded",value:function(){return this._numLoaded===this._resourceCount}},{key:"showPlayButton",value:function(){var t=this;return this.suppressPlayButton?Promise.resolve():(this._playButtonShown=!0,this._playButton.style.display="block",document.body.addEventListener("keyup",function(e){"Enter"===e.key&&t._playButton.click()}),new Promise(function(e){t._playButton.addEventListener("click",function(){return e()}),t._playButton.addEventListener("touchend",function(){return e()}),t._playButton.addEventListener("pointerup",function(){return e()})}))}},{key:"hidePlayButton",value:function(){this._playButtonShown=!1,this._playButton.style.display="none"}},{key:"dispose",value:function(){this._playButtonRootElement.parentElement&&(this._playButtonRootElement.removeChild(this._playButtonElement),document.body.removeChild(this._playButtonRootElement),document.head.removeChild(this._styleBlock),this._playButtonRootElement=null,this._playButtonElement=null,this._styleBlock=null)}},{key:"update",value:function(t,e){}},{key:"load",value:function(){return E(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(this._resourceList.map(function(t){return t.load().finally(function(){n._numLoaded++})}));case 2:return t.next=4,(0,a.delay)(200);case 4:return t.next=6,this.showPlayButton();case 6:return t.next=8,e.WebAudio.unlock();case 8:return this.hidePlayButton(),t.abrupt("return",this.data=this._resourceList);case 10:case"end":return t.stop()}},t,this)}))}},{key:"markResourceComplete",value:function(){this._numLoaded++}},{key:"progress",get:function(){return this._resourceCount>0?(0,a.clamp)(this._numLoaded,0,this._resourceCount)/this._resourceCount:1}},{key:"draw",value:function(t){var e=this._engine.canvasHeight/this._engine.pixelRatio,n=this._engine.canvasWidth/this._engine.pixelRatio;if(this._playButtonRootElement){var i=this._engine.canvas.offsetLeft,r=this._engine.canvas.offsetTop,u=this._playButton.clientWidth,a=this._playButton.clientHeight;this.playButtonPosition?(this._playButtonRootElement.style.left="".concat(this.playButtonPosition.x,"px"),this._playButtonRootElement.style.top="".concat(this.playButtonPosition.y,"px")):(this._playButtonRootElement.style.left="".concat(i+n/2-u/2,"px"),this._playButtonRootElement.style.top="".concat(r+e/2-a/2+100,"px"))}t.fillStyle=this.backgroundColor,t.fillRect(0,0,n,e);var l=e/2,s=Math.min(this.logoWidth,.75*n),c=n/2-s/2;this.logoPosition&&(c=this.logoPosition.x,l=this.logoPosition.y);var h=Math.floor(s*(this.logoHeight/this.logoWidth)),y=this._engine.getAntialiasing();if(this._engine.setAntialiasing(!0),this.logoPosition?t.drawImage(this._image,0,0,this.logoWidth,this.logoHeight,c,l,s,h):t.drawImage(this._image,0,0,this.logoWidth,this.logoHeight,c,l-h-20,s,h),this.suppressPlayButton||!this._playButtonShown){var p=c,f=l;this.loadingBarPosition&&(p=this.loadingBarPosition.x,f=this.loadingBarPosition.y),t.lineWidth=2,o.roundRect(t,p,f,s,20,10,this.loadingBarColor);var d=s*this.progress-10;o.roundRect(t,p+5,f+5,d>10?d:10,10,5,null,this.loadingBarColor),this._engine.setAntialiasing(y)}else this._engine.setAntialiasing(y)}}]),c}();exports.Loader=w;
},{"./Drawing/Color":"p7Gh","./Util/WebAudio":"KQch","./Class":"yTUi","./Util/DrawUtil":"UgQh","./Loader.logo.png":"r7m0","./Loader.css":"R3Xd","./Graphics/Canvas":"wtst","./Util/Util":"Kkda"}],"OWe5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Detector=void 0;var e=require("./Log");function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function n(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}var o={webgl:"WebGL",webaudio:"WebAudio",gamepadapi:"Gamepad API"},a=function(){function r(){t(this,r),this._features=null,this.failedTests=[],this._criticalTests={canvasSupport:function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))},arrayBufferSupport:function(){var e=new XMLHttpRequest;e.open("GET","/");try{e.responseType="arraybuffer"}catch(t){return!1}return"arraybuffer"===e.responseType},dataUrlSupport:function(){return 0===document.createElement("canvas").toDataURL("image/png").indexOf("data:image/png")},objectUrlSupport:function(){return"URL"in window&&"revokeObjectURL"in URL&&"createObjectURL"in URL},rgbaSupport:function(){var e=document.createElement("a").style;return e.cssText="background-color:rgba(150,255,150,.5)",(""+e.backgroundColor).indexOf("rgba")>-1}},this._warningTest={webAudioSupport:function(){return!!(window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext||window.oAudioContext)},webglSupport:function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("webgl"))}},this._features=this._loadBrowserFeatures()}return n(r,[{key:"getBrowserFeatures",value:function(){return null===this._features&&(this._features=this._loadBrowserFeatures()),this._features}},{key:"logBrowserFeatures",value:function(){for(var e="%cSUPPORTED BROWSER FEATURES\n==========================%c\n",t=["font-weight: bold; color: navy","font-weight: normal; color: inherit"],r=this.getBrowserFeatures(),n=0,a=Object.keys(o);n<a.length;n++){var i=a[n];r[i]?(e+="(%c✓%c)",t.push("font-weight: bold; color: green"),t.push("font-weight: normal; color: inherit")):(e+="(%c✗%c)",t.push("font-weight: bold; color: red"),t.push("font-weight: normal; color: inherit")),e+=" "+o[i]+"\n"}t.unshift(e),console.log.apply(console,t)}},{key:"_loadBrowserFeatures",value:function(){var e=this;return{canvas:e._criticalTests.canvasSupport(),arraybuffer:e._criticalTests.arrayBufferSupport(),dataurl:e._criticalTests.dataUrlSupport(),objecturl:e._criticalTests.objectUrlSupport(),rgba:e._criticalTests.rgbaSupport(),webaudio:e._warningTest.webAudioSupport(),webgl:e._warningTest.webglSupport(),gamepadapi:!!navigator.getGamepads}}},{key:"test",value:function(){var t=!1;for(var r in this._criticalTests)this._criticalTests[r].call(this)||(this.failedTests.push(r),e.Logger.getInstance().error("Critical browser feature missing, Excalibur requires:",r),t=!0);if(t)return!1;for(var n in this._warningTest)this._warningTest[n]()||e.Logger.getInstance().warn("Warning browser feature missing, Excalibur will have reduced performance:",n);return!0}}]),r}();exports.Detector=a;
},{"./Log":"p1Gn"}],"PDm1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ScreenElement=void 0;var e=require("./Algebra"),t=require("./Actor"),r=u(require("./Traits/Index")),n=require("./Collision/CollisionType"),o=require("./Collision/Shape"),i=require("./EntityComponentSystem/Components/TransformComponent");function c(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}function u(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=c();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=n?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(r,o,i):r[o]=e[o]}return r.default=e,t&&t.set(e,r),r}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e}function s(e,t,r){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=y(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function y(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=m(e)););return e}function b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e){var t=g();return function(){var r,n=m(e);if(t){var o=m(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return d(this,r)}}function d(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?O(e):t}function O(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var P=function(c){b(a,t.Actor);var u=v(a);function a(t,c,p,s){var y;return f(this,a),(y="object"!==l(t)?u.call(this,t,c,p,s):u.call(this,t)).get(i.TransformComponent).coordPlane=i.CoordPlane.Screen,y.traits=[],y.traits.push(new r.CapturePointer),y.anchor=e.Vector.Zero,y.body.collider.type=n.CollisionType.PreventCollision,y.body.collider.shape=o.Shape.Box(y.width,y.height,y.anchor),y.enableCapturePointer=!0,d(y)}return p(a,[{key:"_initialize",value:function(e){this._engine=e,s(m(a.prototype),"_initialize",this).call(this,e)}},{key:"contains",value:function(t,r){if(!(arguments.length>2&&void 0!==arguments[2])||arguments[2])return s(m(a.prototype),"contains",this).call(this,t,r);var n=this._engine.worldToScreenCoordinates(new e.Vector(t,r));return s(m(a.prototype),"contains",this).call(this,n.x,n.y)}}]),a}();exports.ScreenElement=P;
},{"./Algebra":"NGcQ","./Actor":"vmFf","./Traits/Index":"CPmg","./Collision/CollisionType":"liCD","./Collision/Shape":"Mmyc","./EntityComponentSystem/Components/TransformComponent":"yq2E"}],"y7ZJ":[function(require,module,exports) {
"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function i(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Timer=void 0;var s=function(){function t(i,s,a,n){if(e(this,t),this.id=0,this.interval=10,this.repeats=!1,this.maxNumberOfRepeats=-1,this._elapsedTime=0,this._totalTimeAlive=0,this._paused=!1,this._numberOfTicks=0,this.complete=!1,this.scene=null,"function"!=typeof i){var r=i;i=r.fcn,s=r.interval,a=r.repeats,n=r.numberOfRepeats}if(n&&n>=0&&(this.maxNumberOfRepeats=n,!a))throw new Error("repeats must be set to true if numberOfRepeats is set");this.id=t.id++,this.interval=s||this.interval,this.repeats=a||this.repeats,this._callbacks=[],i&&this.on(i)}return i(t,[{key:"on",value:function(e){this._callbacks.push(e)}},{key:"off",value:function(e){var t=this._callbacks.indexOf(e);this._callbacks.splice(t,1)}},{key:"update",value:function(e){var t=this;this._paused||(this._totalTimeAlive+=e,this._elapsedTime+=e,this.maxNumberOfRepeats>-1&&this._numberOfTicks>=this.maxNumberOfRepeats&&(this.complete=!0),!this.complete&&this._elapsedTime>=this.interval&&(this._callbacks.forEach(function(e){e.call(t)}),this._numberOfTicks++,this.repeats?this._elapsedTime=0:this.complete=!0))}},{key:"reset",value:function(e,t){if(e&&e>=0&&(this.interval=e),this.maxNumberOfRepeats&&this.maxNumberOfRepeats>=0&&(this.maxNumberOfRepeats=t,!this.repeats))throw new Error("repeats must be set to true if numberOfRepeats is set");this.complete=!1,this._elapsedTime=0,this._numberOfTicks=0}},{key:"timesRepeated",get:function(){return this._numberOfTicks}},{key:"getTimeRunning",value:function(){return this._totalTimeAlive}},{key:"pause",value:function(){this._paused=!0}},{key:"unpause",value:function(){this._paused=!1}},{key:"cancel",value:function(){this.scene&&this.scene.cancelTimer(this)}}]),t}();exports.Timer=s,s.id=0;
},{}],"zFIV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ImageSource=void 0;var e=require("../Resources/Resource"),t=require("./Sprite");function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}var i=function(e,t,r,n){return new(r||(r=Promise))(function(a,i){function o(e){try{c(n.next(e))}catch(t){i(t)}}function u(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,u)}c((n=n.apply(e,t||[])).next())})},o=function(){function n(t){var a=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];r(this,n),this.path=t,this.data=new Image,this._resource=new e.Resource(t,"blob",i),this.ready=new Promise(function(e){a._loadedResolve=e})}return a(n,[{key:"width",get:function(){return this.image.naturalWidth}},{key:"height",get:function(){return this.image.naturalHeight}},{key:"isLoaded",value:function(){return!!this.data.src}},{key:"image",get:function(){return this.data}},{key:"load",value:function(){return i(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isLoaded()){e.next=2;break}return e.abrupt("return",this.data);case 2:if(e.prev=2,this.path.includes("data:image/")){e.next=10;break}return e.next=6,this._resource.load();case 6:r=e.sent,t=URL.createObjectURL(r),e.next=11;break;case 10:t=this.path;case 11:return(n=new Image).src=t,e.next=15,n.decode();case 15:this.data=n,e.next=22;break;case 18:return e.prev=18,e.t0=e.catch(2),e.next=22,Promise.reject("Error loading texture");case 22:return this._loadedResolve(this.data),e.abrupt("return",this.data);case 24:case"end":return e.stop()}},e,this,[[2,18]])}))}},{key:"toSprite",value:function(){return t.Sprite.from(this)}},{key:"unload",value:function(){this.data=new Image}}],[{key:"fromLegacyTexture",value:function(e){var t=new n(e.path);return e.isLoaded()?t.data=e.data:e.loaded.then(function(){t.data=e.data}),t}}]),n}();exports.ImageSource=o;
},{"../Resources/Resource":"lN80","./Sprite":"tEFe"}],"tEFe":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Sprite=void 0;var e=require("./Graphic"),t=require("./ImageSource"),i=require("../Drawing/Sprite"),r=require("../Resources/Texture");function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,i){return t&&u(e.prototype,t),i&&u(e,i),e}function c(e,t,i){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var r=a(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(i):o.value}})(e,t,i||e)}function a(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=y(e)););return e}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=w();return function(){var i,r=y(e);if(t){var o=y(this).constructor;i=Reflect.construct(r,arguments,o)}else i=r.apply(this,arguments);return p(this,i)}}function p(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?d(e):t}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=function(o){h(a,e.Graphic);var u=l(a);function a(e){var t,i,r;return n(this,a),(t=u.call(this,e)).image=e.image,t.sourceView=null!==(i=e.sourceView)&&void 0!==i?i:{x:0,y:0,width:0,height:0},t.destSize=null!==(r=e.destSize)&&void 0!==r?r:{width:0,height:0},t._updateSpriteDimensions(),t.image.ready.then(function(){t._updateSpriteDimensions()}),t}return s(a,[{key:"_updateSpriteDimensions",value:function(){var e,t,i,r,o,n,u=this.image,s=u.width,c=u.height;this.sourceView.width=(null===(e=this.sourceView)||void 0===e?void 0:e.width)||s,this.sourceView.height=(null===(t=this.sourceView)||void 0===t?void 0:t.height)||c,this.destSize.width=(null===(i=this.destSize)||void 0===i?void 0:i.width)||(null===(r=this.sourceView)||void 0===r?void 0:r.width)||s,this.destSize.height=(null===(o=this.destSize)||void 0===o?void 0:o.height)||(null===(n=this.sourceView)||void 0===n?void 0:n.height)||c,this.width=Math.ceil(this.destSize.width),this.height=Math.ceil(this.destSize.height)}},{key:"_preDraw",value:function(e,t,i){this.image.isLoaded()&&this._updateSpriteDimensions(),c(y(a.prototype),"_preDraw",this).call(this,e,t,i)}},{key:"_drawImage",value:function(e,t,i){this.image.isLoaded()&&(this._updateSpriteDimensions(),e.drawImage(this.image.image,this.sourceView.x,this.sourceView.y,this.sourceView.width,this.sourceView.height,t,i,this.destSize.width,this.destSize.height))}},{key:"clone",value:function(){return new a(Object.assign({image:this.image,sourceView:Object.assign({},this.sourceView),destSize:Object.assign({},this.destSize)},this.cloneGraphicOptions()))}}],[{key:"from",value:function(e){return new a({image:e})}},{key:"fromLegacySprite",value:function(e){var i=e.texture;return new a({image:t.ImageSource.fromLegacyTexture(i),sourceView:{x:e.x,y:e.y,width:e.width,height:e.height}})}},{key:"toLegacySprite",value:function(e){var t=e.image,o=new r.Texture(t.path);return o.data=t.image,new i.Sprite(o,e.sourceView.x,e.sourceView.y,e.sourceView.width,e.sourceView.height)}}]),a}();exports.Sprite=g;
},{"./Graphic":"OZee","./ImageSource":"zFIV","../Drawing/Sprite":"PpGD","../Resources/Texture":"HrNa"}],"hmKU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SpriteSheet=void 0;var e=require("./Sprite");function r(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function t(e,r){for(var t=0;t<r.length;t++){var i=r[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function i(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}var n=function(){function t(e){r(this,t),this.sprites=[];var i=e.sprites;this.sprites=i}return i(t,null,[{key:"fromLegacySpriteSheet",value:function(r){return new t({sprites:r.sprites.map(function(r){return e.Sprite.fromLegacySprite(r)})})}},{key:"fromGrid",value:function(r){var i,n=[];r.spacing=null!==(i=r.spacing)&&void 0!==i?i:{};for(var s=r.image,a=r.grid,o=a.rows,u=a.columns,p=a.spriteWidth,c=a.spriteHeight,f=r.spacing,l=f.originOffset,g=f.margin,h=Object.assign({x:0,y:0},l),v=Object.assign({x:0,y:0},g),y=0;y<u;y++)for(var d=0;d<o;d++)n[y+d*u]=new e.Sprite({image:s,sourceView:{x:y*p+v.x*y+h.x,y:d*c+v.y*d+h.y,width:p,height:c},destSize:{height:c,width:p}});return new t({sprites:n})}}]),t}();exports.SpriteSheet=n;
},{"./Sprite":"tEFe"}],"pzaP":[function(require,module,exports) {
"use strict";function e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function n(e,n){for(var r=0;r<n.length;r++){var t=n[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function r(e,r,t){return r&&n(e.prototype,r),t&&n(e,t),e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.GraphicsDiagnostics=void 0;var t=function(){function n(){e(this,n)}return r(n,null,[{key:"clear",value:function(){n.DrawCallCount=0,n.DrawnImagesCount=0}}]),n}();exports.GraphicsDiagnostics=t,t.DrawCallCount=0,t.DrawnImagesCount=0;
},{}],"Jytr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GraphicsSystem=void 0;var t=require("../Actor"),e=require("./GraphicsComponent"),r=require("../Algebra"),n=require("../Drawing/Color"),o=require("../EntityComponentSystem/Components/TransformComponent"),i=require("../EntityComponentSystem"),a=require("./GraphicsDiagnostics"),s=require("../Events");function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=l(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function l(t,e){if(t){if("string"==typeof t)return f(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(t,e):void 0}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function y(t,e,r){return e&&h(t.prototype,e),r&&h(t,r),t}function g(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}function v(t,e){return(v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function m(t){var e=C();return function(){var r,n=b(t);if(e){var o=b(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return d(this,r)}}function d(t,e){return!e||"object"!==c(e)&&"function"!=typeof e?_(t):e}function _(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function C(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function b(t){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var w=function(c){g(f,i.System);var l=m(f);function f(){var t;return p(this,f),(t=l.apply(this,arguments)).types=["transform","graphics"],t.systemType=i.SystemType.Draw,t.priority=0,t._token=0,t}return y(f,[{key:"initialize",value:function(t){this._graphicsContext=t.engine.graphicsContext,this._camera=t.camera,this._engine=t.engine}},{key:"sort",value:function(t,e){return t.get(o.TransformComponent).z-e.get(o.TransformComponent).z}},{key:"update",value:function(t,r){var n,c,l;this._clearScreen(),this._token++;var f,p=u(t);try{for(p.s();!(f=p.n()).done;){var h=f.value;c=h.get(o.TransformComponent),l=h.get(e.GraphicsComponent);var y=this._isOffscreen(c,l);y&&!h.hasTag("offscreen")&&(h.eventDispatcher.emit("exitviewport",new s.ExitViewPortEvent(h)),h.addComponent(new i.TagComponent("offscreen"))),!y&&h.hasTag("offscreen")&&(h.eventDispatcher.emit("enterviewport",new s.EnterViewPortEvent(h)),h.removeComponent("offscreen")),y||(this._pushCameraTransform(c),this._graphicsContext.save(),l.onPreDraw&&l.onPreDraw(this._graphicsContext,r),l.update(r,this._token),this._applyTransform(h),this._graphicsPositionDebugDraw(),this._graphicsContext.opacity=l.opacity*(null!==(n=h.opacity)&&void 0!==n?n:1),this._drawGraphicsComponent(l),l.onPostDraw&&l.onPostDraw(this._graphicsContext,r),this._graphicsContext.restore(),this._graphicsBoundsDebugDraw(h,c,l),this._popCameraTransform(c))}}catch(g){p.e(g)}finally{p.f()}this._graphicsContext.flush(),this._engine.stats.currFrame.graphics.drawnImages=a.GraphicsDiagnostics.DrawnImagesCount,this._engine.stats.currFrame.graphics.drawCalls=a.GraphicsDiagnostics.DrawCallCount}},{key:"_clearScreen",value:function(){this._graphicsContext.clear()}},{key:"_isOffscreen",value:function(t,e){return t.coordPlane===o.CoordPlane.World&&!this._camera.viewport.intersect(e.localBounds.transform(t.getGlobalMatrix()))}},{key:"_drawGraphicsComponent",value:function(t){var e,o;if(t.visible){var i,a=u(t.layers.get());try{for(a.s();!(i=a.n()).done;){var s,c=i.value,l=u(c.graphics);try{for(l.s();!(s=l.n()).done;){var f=s.value,p=f.graphic,h=f.options,y=h.offset,g=h.anchor,v=-p.width*g.x+y.x,m=-p.height*g.y+y.y;null==p||p.draw(this._graphicsContext,v+c.offset.x,m+c.offset.y),(null===(e=this._engine)||void 0===e?void 0:e.isDebug)&&(null==p||p.localBounds.translate((0,r.vec)(v+c.offset.x,m+c.offset.y)).draw(this._graphicsContext,n.Color.Red))}}catch(d){l.e(d)}finally{l.f()}}}catch(d){a.e(d)}finally{a.f()}(null===(o=this._engine)||void 0===o?void 0:o.isDebug)&&t.localBounds.draw(this._graphicsContext,n.Color.Red)}}},{key:"_applyTransform",value:function(t){var e,r=u(t.getAncestors());try{for(r.s();!(e=r.n()).done;){var n=e.value,i=null==n?void 0:n.get(o.TransformComponent);i&&(this._graphicsContext.translate(i.pos.x,i.pos.y),this._graphicsContext.scale(i.scale.x,i.scale.y),this._graphicsContext.rotate(i.rotation))}}catch(a){r.e(a)}finally{r.f()}}},{key:"_pushCameraTransform",value:function(t){t.coordPlane===o.CoordPlane.World&&(this._graphicsContext.save(),this._camera&&this._camera.draw(this._graphicsContext))}},{key:"_popCameraTransform",value:function(t){t.coordPlane===o.CoordPlane.World&&this._graphicsContext.restore()}},{key:"_graphicsPositionDebugDraw",value:function(){var t;(null===(t=this._engine)||void 0===t?void 0:t.isDebug)&&this._graphicsContext.debug.drawPoint(r.Vector.Zero,{color:n.Color.Yellow,size:5})}},{key:"_graphicsBoundsDebugDraw",value:function(e,r,n){var o;(null===(o=this._engine)||void 0===o?void 0:o.isDebug)&&((0,t.isActor)(e)&&e.body.collider.localBounds.translate(e.getGlobalPos()).draw(this._graphicsContext))}}]),f}();exports.GraphicsSystem=w;
},{"../Actor":"vmFf","./GraphicsComponent":"jeAN","../Algebra":"NGcQ","../Drawing/Color":"p7Gh","../EntityComponentSystem/Components/TransformComponent":"yq2E","../EntityComponentSystem":"sOyH","./GraphicsDiagnostics":"pzaP","../Events":"XySq"}],"vFQJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Circle=void 0;var t=require("./Raster");function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=f();return function(){var r,n=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return s(this,r)}}function s(t,r){return!r||"object"!==e(r)&&"function"!=typeof r?a(t):r}function a(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(e){i(u,t.Raster);var n=c(u);function u(t){var e;return r(this,u),(e=n.call(this,t))._radius=0,e.radius=t.radius,e.rasterize(),e}return o(u,[{key:"radius",get:function(){return this._radius},set:function(t){this._radius=t,this.width=2*this._radius,this.height=2*this._radius,this.flagDirty()}},{key:"clone",value:function(){return new u(Object.assign(Object.assign({radius:this.radius},this.cloneGraphicOptions()),this.cloneRasterOptions()))}},{key:"execute",value:function(t){this.radius>0&&(t.beginPath(),t.arc(this.radius,this.radius,this.radius,0,2*Math.PI),this.color&&t.fill(),this.strokeColor&&t.stroke())}}]),u}();exports.Circle=p;
},{"./Raster":"Syvu"}],"jxBF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Polygon=void 0;var t=require("../Algebra"),e=require("./Raster");function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function i(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=l();return function(){var n,o=p(t);if(e){var r=p(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return f(this,n)}}function f(t,e){return!e||"object"!==n(e)&&"function"!=typeof e?a(t):e}function a(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(n){u(c,e.Raster);var r=s(c);function c(t){var e;return o(this,c),(e=r.call(this,t)).points=t.points,e.rasterize(),e}return i(c,[{key:"points",get:function(){return this._points},set:function(t){this._points=t;var e=this.minPoint;this.width=this._points.reduce(function(t,e){return Math.max(e.x,t)},0)-e.x,this.height=this._points.reduce(function(t,e){return Math.max(e.y,t)},0)-e.y,this.flagDirty()}},{key:"minPoint",get:function(){var e=this._points.reduce(function(t,e){return Math.min(e.x,t)},1/0),n=this._points.reduce(function(t,e){return Math.min(e.y,t)},1/0);return(0,t.vec)(e,n)}},{key:"clone",value:function(){return new c(Object.assign(Object.assign({points:this.points.map(function(t){return t.clone()})},this.cloneGraphicOptions()),this.cloneRasterOptions()))}},{key:"execute",value:function(t){if(this.points&&this.points.length){t.beginPath();var e=this.minPoint.negate(),n=this.points[0].add(e);t.moveTo(n.x,n.y),this.points.forEach(function(n){t.lineTo(n.x+e.x,n.y+e.y)}),t.lineTo(n.x,n.y),t.closePath(),this.color&&t.fill(),this.strokeColor&&t.stroke()}}}]),c}();exports.Polygon=h;
},{"../Algebra":"NGcQ","./Raster":"Syvu"}],"gyMF":[function(require,module,exports) {
"use strict";var t,e,o,i,n;Object.defineProperty(exports,"__esModule",{value:!0}),exports.Direction=exports.FontStyle=exports.BaseAlign=exports.TextAlign=exports.FontUnit=void 0,exports.FontUnit=t,function(t){t.Em="em",t.Rem="rem",t.Px="px",t.Pt="pt",t.Percent="%"}(t||(exports.FontUnit=t={})),exports.TextAlign=e,function(t){t.Left="left",t.Right="right",t.Center="center",t.Start="start",t.End="end"}(e||(exports.TextAlign=e={})),exports.BaseAlign=o,function(t){t.Top="top",t.Hanging="hanging",t.Middle="middle",t.Alphabetic="alphabetic",t.Ideographic="ideographic",t.Bottom="bottom"}(o||(exports.BaseAlign=o={})),exports.FontStyle=i,function(t){t.Normal="normal",t.Italic="italic",t.Oblique="oblique"}(i||(exports.FontStyle=i={})),exports.Direction=n,function(t){t.LeftToRight="ltr",t.RightToLeft="rtl"}(n||(exports.Direction=n={}));
},{}],"IhtB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Font=void 0;var t=require("../Collision/Index"),i=require("../Drawing/Color"),e=require("../Util/DrawUtil"),n=require("./FontCommon"),o=require("./Raster");function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function a(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(t,i,e){return i&&a(t.prototype,i),e&&a(t,e),t}function h(t,i,e){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,i,e){var n=u(t,i);if(n){var o=Object.getOwnPropertyDescriptor(n,i);return o.get?o.get.call(e):o.value}})(t,i,e||t)}function u(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_(t)););return t}function c(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&d(t,i)}function d(t,i){return(d=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function f(t){var i=p();return function(){var e,n=_(t);if(i){var o=_(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return y(this,e)}}function y(t,i){return!i||"object"!==s(i)&&"function"!=typeof i?g(t):i}function g(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function _(t){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var b=function(s){c(u,o.Raster);var a=f(u);function u(){var i,e,o,s,l,h,c,d,f,y,g,p,_,b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r(this,u),(i=a.call(this,b)).quality=2,i.family="sans-serif",i.style=n.FontStyle.Normal,i.bold=!1,i.unit=n.FontUnit.Px,i.textAlign=n.TextAlign.Left,i.baseAlign=n.BaseAlign.Alphabetic,i.direction=n.Direction.LeftToRight,i.size=10,i.shadow=null,i._textBounds=new t.BoundingBox,i._textWidth=0,i._textHeight=0,i.family=null!==(e=null==b?void 0:b.family)&&void 0!==e?e:i.family,i.style=null!==(o=null==b?void 0:b.style)&&void 0!==o?o:i.style,i.bold=null!==(s=null==b?void 0:b.bold)&&void 0!==s?s:i.bold,i.size=null!==(l=null==b?void 0:b.size)&&void 0!==l?l:i.size,i.unit=null!==(h=null==b?void 0:b.unit)&&void 0!==h?h:i.unit,i.textAlign=null!==(c=null==b?void 0:b.textAlign)&&void 0!==c?c:i.textAlign,i.baseAlign=null!==(d=null==b?void 0:b.baseAlign)&&void 0!==d?d:i.baseAlign,i.direction=null!==(f=null==b?void 0:b.direction)&&void 0!==f?f:i.direction,i.quality=null!==(y=null==b?void 0:b.quality)&&void 0!==y?y:i.quality,(null==b?void 0:b.shadow)&&(i.shadow={},i.shadow.blur=null!==(g=b.shadow.blur)&&void 0!==g?g:i.shadow.blur,i.shadow.offset=null!==(p=b.shadow.offset)&&void 0!==p?p:i.shadow.offset,i.shadow.color=null!==(_=b.shadow.color)&&void 0!==_?_:i.shadow.color),i.flagDirty(),i}return l(u,[{key:"clone",value:function(){return new u(Object.assign(Object.assign(Object.assign({},this.cloneGraphicOptions()),this.cloneRasterOptions()),{size:this.size,unit:this.unit,family:this.family,style:this.style,bold:this.bold,textAlign:this.textAlign,baseAlign:this.baseAlign,direction:this.direction,shadow:this.shadow?{blur:this.shadow.blur,offset:this.shadow.offset,color:this.shadow.color}:null}))}},{key:"fontString",get:function(){return"".concat(this.style," ").concat(this.bold?"bold":""," ").concat(this.size).concat(this.unit," ").concat(this.family)}},{key:"width",get:function(){return this._textWidth},set:function(t){this._textWidth=t}},{key:"height",get:function(){return this._textHeight},set:function(t){this._textHeight=t}},{key:"_rasterWidth",get:function(){return this._bitmap.width}},{key:"_rasterHeight",get:function(){return this._bitmap.height}},{key:"_halfRasterWidth",get:function(){return Math.floor(this._bitmap.width/2)}},{key:"_halfRasterHeight",get:function(){return Math.floor(this._bitmap.height/2)}},{key:"localBounds",get:function(){return this._textBounds}},{key:"_drawImage",value:function(t,i,e){this.dirty&&this.rasterize(),t.drawImage(this._bitmap,0,0,this._rasterWidth,this._rasterHeight,i-this._rasterWidth/this.quality/2,e-this._rasterHeight/this.quality/2,this._rasterWidth/this.quality,this._rasterHeight/this.quality)}},{key:"_rotate",value:function(t){var i,e=null!==(i=this.origin)&&void 0!==i?i:this._textBounds.center;t.translate(e.x,e.y),t.rotate(this.rotation),t.translate(-e.x,-e.y)}},{key:"_flip",value:function(t){this.flipHorizontal&&(t.translate(this._textBounds.width/this.scale.x,0),t.scale(-1,1)),this.flipVertical&&(t.translate(0,-this._textBounds.height/2/this.scale.y),t.scale(1,-1))}},{key:"updateText",value:function(t){this._text!==t&&(this._text=t,this._updateDimensions(),this.flagDirty())}},{key:"_updateDimensions",value:function(){if(this._text){this._applyFont(this._ctx);var i=this._ctx.measureText(this._text);this._textWidth=Math.abs(i.actualBoundingBoxLeft)+Math.abs(i.actualBoundingBoxRight),this._textHeight=Math.abs(i.actualBoundingBoxAscent)+Math.abs(i.actualBoundingBoxDescent),this._bitmap.width=2*(this._textWidth+2*this.padding)*this.quality,this._bitmap.height=2*(this._textHeight+2*this.padding)*this.quality;this._textBounds=new t.BoundingBox({left:0-Math.abs(i.actualBoundingBoxLeft)-this.padding,top:0-Math.abs(i.actualBoundingBoxAscent)-this.padding,bottom:0+Math.abs(i.actualBoundingBoxDescent)+this.padding,right:0+Math.abs(i.actualBoundingBoxRight)+this.padding})}}},{key:"_preDraw",value:function(t,i,e){this.dirty&&this._updateDimensions(),h(_(u.prototype),"_preDraw",this).call(this,t,i,e)}},{key:"_postDraw",value:function(t){this.showDebug&&t.debug.drawRect(-this._halfRasterWidth,-this._halfRasterHeight,this._rasterWidth,this._rasterHeight),t.restore()}},{key:"_applyFont",value:function(t){t.translate(this.padding+this._halfRasterWidth,this.padding+this._halfRasterHeight),t.scale(this.quality,this.quality),t.textAlign=this.textAlign,t.textBaseline=this.baseAlign,t.font=this.fontString,t.direction=this.direction,this.shadow&&(t.shadowColor=this.shadow.color.toString(),t.shadowBlur=this.shadow.blur,t.shadowOffsetX=this.shadow.offset.x,t.shadowOffsetY=this.shadow.offset.y)}},{key:"execute",value:function(t){this._text&&(this._applyRasterProperites(t),this._applyFont(t),this.color&&t.fillText(this._text,0,0),this.strokeColor&&t.strokeText(this._text,0,0),this.showDebug&&((0,e.line)(t,i.Color.Red,-this._halfRasterWidth,0,this._halfRasterWidth,0,2),(0,e.line)(t,i.Color.Red,0,-this._halfRasterHeight,0,this._halfRasterHeight,2)))}},{key:"render",value:function(t,i,e,n){this.updateText(i),this.draw(t,e,n)}}]),u}();exports.Font=b;
},{"../Collision/Index":"kKHB","../Drawing/Color":"p7Gh","../Util/DrawUtil":"UgQh","./FontCommon":"gyMF","./Raster":"Syvu"}],"fKxy":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Text=void 0;var t=require("./Graphic"),n=require("../Drawing/Color"),o=require("./Font"),e=require("../Util/Watch");function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function c(t,n){for(var o=0;o<n.length;o++){var e=n[o];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function f(t,n,o){return n&&c(t.prototype,n),o&&c(t,o),t}function u(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&l(t,n)}function l(t,n){return(l=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function s(t){var n=p();return function(){var o,e=y(t);if(n){var r=y(this).constructor;o=Reflect.construct(e,arguments,r)}else o=e.apply(this,arguments);return a(this,o)}}function a(t,n){return!n||"object"!==r(n)&&"function"!=typeof n?h(t):n}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var b=function(r){u(l,t.Graphic);var c=s(l);function l(t){var n,e,r;return i(this,l),(n=c.call(this,t))._text="",n.font=null!==(e=t.font)&&void 0!==e?e:new o.Font,n.color=null!==(r=t.color)&&void 0!==r?r:n.color,n.text=t.text,n}return f(l,[{key:"clone",value:function(){return new l({text:this.text.slice(),color:this.color.clone(),font:this.font.clone()})}},{key:"text",get:function(){return this._text},set:function(t){this._text=t,this.font instanceof o.Font&&this.font.updateText(t)}},{key:"color",get:function(){return this.font instanceof o.Font?this.font.color:n.Color.Black},set:function(t){this.font instanceof o.Font&&(this.font.color=t)}},{key:"font",get:function(){return this._font},set:function(t){t instanceof o.Font?this._font=(0,e.watch)(t,function(t){return t.flagDirty()}):this._font=t}},{key:"width",get:function(){return this.font.width}},{key:"height",get:function(){return this.font.height}},{key:"localBounds",get:function(){return this.font.localBounds}},{key:"_rotate",value:function(t){}},{key:"_flip",value:function(t){}},{key:"_drawImage",value:function(t,n,e){this.font instanceof o.Font&&(this.font.color=this.color),this.font.flipHorizontal=this.flipHorizontal,this.font.flipVertical=this.flipVertical,this.font.scale=this.scale,this.font.rotation=this.rotation,this.font.origin=this.origin,this.font.opacity=this.opacity,this.font.render(t,this._text,n,e)}}]),l}();exports.Text=b;
},{"./Graphic":"OZee","../Drawing/Color":"p7Gh","./Font":"IhtB","../Util/Watch":"cHV7"}],"aKKQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SpriteFont=void 0;var t=require("../Util/Log"),e=require("./Graphic"),r=require("./Sprite"),n=require("./SpriteSheet");function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=a(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return s=t.done,t},e:function(t){c=!0,o=t},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw o}}}}function a(t,e){if(t){if("string"==typeof t)return s(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(t,e):void 0}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function f(t,e,r){return e&&u(t.prototype,e),r&&u(t,r),t}function l(t,e,r){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=p(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function p(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=w(t)););return t}function h(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&y(t,e)}function y(t,e){return(y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function v(t){var e=b();return function(){var r,n=w(t);if(e){var i=w(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d(this,r)}}function d(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?g(t):e}function g(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function b(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function w(t){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var S=function(i){h(s,e.Graphic);var a=v(s);function s(e){var r;c(this,s),(r=a.call(this,e))._text="",r._dirty=!0,r.alphabet="",r.shadow=null,r.caseInsensitive=!1,r.spacing=0,r._logger=t.Logger.getInstance(),r._sprites=[];var n=e.alphabet,i=e.spriteSheet,o=e.caseInsensitive,u=e.spacing,f=e.shadow;return r.alphabet=n,r.spriteSheet=i,r.caseInsensitive=null!=o?o:r.caseInsensitive,r.spacing=null!=u?u:r.spacing,r.shadow=null!=f?f:r.shadow,r.spriteSheet.sprites[0].image.ready.then(function(){r._updateDimensions()}),r}return f(s,[{key:"_getCharacterSprites",value:function(t){if(!this._dirty)return this._sprites;for(var e=[],r=this.caseInsensitive?t.toLocaleLowerCase():t,n=this.caseInsensitive?this.alphabet.toLocaleLowerCase():this.alphabet,i=0;i<r.length;i++){var o=r[i],a=n.indexOf(o);-1===a&&(a=0,this._logger.warn("SpriteFont - Cannot find letter '".concat(o,"' in configured alphabet '").concat(n,"'")));var s=this.spriteSheet.sprites[a];s?e.push(s):this._logger.warn("SpriteFont - Cannot find sprite for '".concat(o,"' at index '").concat(a,"' in configured SpriteSheet"))}return this._dirty=!1,this._sprites=e}},{key:"_updateDimensions",value:function(){var t,e=0,r=0,n=o(this._getCharacterSprites(this._text));try{for(n.s();!(t=n.n()).done;){var i=t.value;e+=i.width+this.spacing,r=Math.max(r,i.height)}}catch(a){n.e(a)}finally{n.f()}this.width=e,this.height=r}},{key:"_preDraw",value:function(t,e,r){this._updateDimensions(),l(w(s.prototype),"_preDraw",this).call(this,t,e,r)}},{key:"_drawImage",value:function(t,e,r){var n,i=0,a=o(this._getCharacterSprites(this._text));try{for(a.s();!(n=a.n()).done;){var s=n.value;s.draw(t,e+i,r),i+=s.width+this.spacing}}catch(c){a.e(c)}finally{a.f()}}},{key:"render",value:function(t,e,r,n){this._text!==e&&(this._dirty=!0,this._text=e),this.shadow&&(t.save(),t.translate(this.shadow.offset.x,this.shadow.offset.y),this.draw(t,r,n),t.restore()),this.draw(t,r,n)}},{key:"clone",value:function(){return new s({alphabet:this.alphabet,spriteSheet:this.spriteSheet,spacing:this.spacing})}}],[{key:"fromLegacySpriteFont",value:function(t){var e=t.sprites.map(r.Sprite.fromLegacySprite);return new s({alphabet:t.alphabet,spacing:0,caseInsensitive:t.caseInsensitive,spriteSheet:new n.SpriteSheet({sprites:e})})}}]),s}();exports.SpriteFont=S;
},{"../Util/Log":"p1Gn","./Graphic":"OZee","./Sprite":"tEFe","./SpriteSheet":"hmKU"}],"rOBo":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function n(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.StateStack=void 0;var r=function(){function e(){t(this,e),this._states=[],this._currentState=this._getDefaultState()}return n(e,[{key:"_getDefaultState",value:function(){return{opacity:1}}},{key:"_cloneState",value:function(){return{opacity:this._currentState.opacity}}},{key:"save",value:function(){this._states.push(this._currentState),this._currentState=this._cloneState()}},{key:"restore",value:function(){this._currentState=this._states.pop()}},{key:"current",get:function(){return this._currentState}}]),e}();exports.StateStack=r;
},{}],"bjvb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ExcaliburGraphicsContext2DCanvas=void 0;var t=require("../../Drawing/Color"),e=require("./state-stack"),i=require("../GraphicsDiagnostics");function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function o(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}var a=function(){function e(t){s(this,e),this._ex=t}return o(e,[{key:"drawRect",value:function(t,e,i,s){this._ex.__ctx.save(),this._ex.__ctx.strokeStyle="red",this._ex.__ctx.strokeRect(this._ex.snapToPixel?~~t:t,this._ex.snapToPixel?~~e:e,this._ex.snapToPixel?~~i:i,this._ex.snapToPixel?~~s:s),this._ex.__ctx.restore()}},{key:"drawLine",value:function(e,i){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{color:t.Color.Black};this._ex.__ctx.save(),this._ex.__ctx.beginPath(),this._ex.__ctx.strokeStyle=s.color.toString(),this._ex.__ctx.moveTo(this._ex.snapToPixel?~~e.x:e.x,this._ex.snapToPixel?~~e.y:e.y),this._ex.__ctx.lineTo(this._ex.snapToPixel?~~i.x:i.x,this._ex.snapToPixel?~~i.y:i.y),this._ex.__ctx.lineWidth=2,this._ex.__ctx.stroke(),this._ex.__ctx.closePath(),this._ex.__ctx.restore()}},{key:"drawPoint",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{color:t.Color.Black,size:5};this._ex.__ctx.save(),this._ex.__ctx.beginPath(),this._ex.__ctx.fillStyle=i.color.toString(),this._ex.__ctx.arc(this._ex.snapToPixel?~~e.x:e.x,this._ex.snapToPixel?~~e.y:e.y,i.size,0,2*Math.PI),this._ex.__ctx.fill(),this._ex.__ctx.closePath(),this._ex.__ctx.restore()}}]),e}(),r=function(){function n(i){s(this,n),this.backgroundColor=t.Color.ExcaliburBlue,this._state=new e.StateStack,this.snapToPixel=!0,this.debug=new a(this);var o=i.canvasElement,r=i.enableTransparency,c=i.snapToPixel,_=i.smoothing,h=i.backgroundColor;this.__ctx=o.getContext("2d",{alpha:null==r||r}),this.backgroundColor=null!=h?h:this.backgroundColor,this.snapToPixel=null!=c?c:this.snapToPixel,this.smoothing=null!=_?_:this.smoothing}return o(n,[{key:"width",get:function(){return this.__ctx.canvas.width}},{key:"height",get:function(){return this.__ctx.canvas.height}},{key:"opacity",get:function(){return this._state.current.opacity},set:function(t){this._state.current.opacity=t}},{key:"smoothing",get:function(){return this.__ctx.imageSmoothingEnabled},set:function(t){this.__ctx.imageSmoothingEnabled=t}},{key:"resetTransform",value:function(){this.__ctx.resetTransform()}},{key:"updateViewport",value:function(){}},{key:"drawImage",value:function(t,e,s,n,o,a,r,c,_){var h=this;this.__ctx.globalAlpha=this.opacity;var l=[t,e,s,n,o,a,r,c,_].filter(function(t){return void 0!==t}).map(function(t){return"number"==typeof t&&h.snapToPixel?~~t:t});this.__ctx.drawImage.apply(this.__ctx,l),i.GraphicsDiagnostics.DrawCallCount++,i.GraphicsDiagnostics.DrawnImagesCount=1}},{key:"save",value:function(){this.__ctx.save()}},{key:"restore",value:function(){this.__ctx.restore()}},{key:"translate",value:function(t,e){this.__ctx.translate(this.snapToPixel?~~t:t,this.snapToPixel?~~e:e)}},{key:"rotate",value:function(t){this.__ctx.rotate(t)}},{key:"scale",value:function(t,e){this.__ctx.scale(t,e)}},{key:"clear",value:function(){this.__ctx.clearRect(0,0,this.width,this.height),this.__ctx.fillStyle=this.backgroundColor.toString(),this.__ctx.fillRect(0,0,this.width,this.height),i.GraphicsDiagnostics.clear()}},{key:"flush",value:function(){}}]),n}();exports.ExcaliburGraphicsContext2DCanvas=r;
},{"../../Drawing/Color":"p7Gh","./state-stack":"rOBo","../GraphicsDiagnostics":"pzaP"}],"lRBE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TransformStack=void 0;var r=require("../../Math/matrix");function t(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function n(r,t){for(var n=0;n<t.length;n++){var e=t[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(r,e.key,e)}}function e(r,t,e){return t&&n(r.prototype,t),e&&n(r,e),r}var a=function(){function n(){t(this,n),this._transforms=[],this._currentTransform=r.Matrix.identity()}return e(n,[{key:"save",value:function(){this._transforms.push(this._currentTransform),this._currentTransform=this._currentTransform.clone()}},{key:"restore",value:function(){this._currentTransform=this._transforms.pop()}},{key:"translate",value:function(r,t){return this._currentTransform.translate(r,t)}},{key:"rotate",value:function(r){return this._currentTransform.rotate(r)}},{key:"scale",value:function(r,t){return this._currentTransform.scale(r,t)}},{key:"current",get:function(){return this._currentTransform},set:function(r){this._currentTransform=r}}]),n}();exports.TransformStack=a;
},{"../../Math/matrix":"uPb3"}],"EFHz":[function(require,module,exports) {
"use strict";function t(t,e){var a;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(a=r(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,l=!1;return{s:function(){a=t[Symbol.iterator]()},n:function(){var t=a.next();return u=t.done,t},e:function(t){l=!0,i=t},f:function(){try{u||null==a.return||a.return()}finally{if(l)throw i}}}}function r(t,r){if(t){if("string"==typeof t)return e(t,r);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?e(t,r):void 0}}function e(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,a=new Array(r);e<r;e++)a[e]=t[e];return a}function a(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function n(t,r){for(var e=0;e<r.length;e++){var a=r[e];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function o(t,r,e){return r&&n(t.prototype,r),e&&n(t,e),t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Shader=void 0;var i=function(){function r(t,e,n){a(this,r),this._gl=t,this._vertexSource=e,this._fragmentSource=n,this.program=null,this.uniforms={},this.attributes={},this.layout=[],this.compile(t)}return o(r,[{key:"_createProgram",value:function(t,r,e){var a=t.createProgram();if(null===a)throw Error("Could not create graphics shader program");if(t.attachShader(a,r),t.attachShader(a,e),t.linkProgram(a),!t.getProgramParameter(a,t.LINK_STATUS))throw Error("Could not link the program: [".concat(t.getProgramInfoLog(a),"]"));return a}},{key:"_compileShader",value:function(t,r,e){var a=t.createShader(e);if(null===a)throw Error("Could not build shader: [".concat(r,"]"));if(t.shaderSource(a,r),t.compileShader(a),!t.getShaderParameter(a,t.COMPILE_STATUS))throw Error("Could not compile shader [".concat(t.getShaderInfoLog(a),"]"));return a}},{key:"compile",value:function(t){var r=this._compileShader(t,this._vertexSource,t.VERTEX_SHADER),e=this._compileShader(t,this._fragmentSource,t.FRAGMENT_SHADER),a=this._createProgram(t,r,e);return this.program=a}},{key:"addUniformMatrix",value:function(t,r){if(!r)throw Error("Shader Uniform Matrix '".concat(t,"' was set to null or undefined"));var e=this._gl;this.uniforms[t]={name:t,type:"matrix",location:e.getUniformLocation(this.program,t),data:r}}},{key:"addUniformIntegerArray",value:function(t,r){if(!r)throw Error("Shader Uniform Integery Array '".concat(t,"' was set to null or undefined"));var e=this._gl;this.uniforms[t]={name:t,type:"numbers",location:e.getUniformLocation(this.program,t),data:r}}},{key:"addAttribute",value:function(t,r,e){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=this._gl.getAttribLocation(this.program,t);this.attributes[t]={name:t,size:r,glType:e,normalized:a,location:n},this.layout.push(this.attributes[t])}},{key:"vertexAttributeSize",get:function(){var r,e=0,a=t(this.layout);try{for(a.s();!(r=a.n()).done;){e+=r.value.size}}catch(n){a.e(n)}finally{a.f()}return e}},{key:"totalVertexSizeBytes",get:function(){var r,e=0,a=t(this.layout);try{for(a.s();!(r=a.n()).done;){var n=r.value,o=1;switch(n.glType){case this._gl.FLOAT:o=4;break;default:o=1}e+=o*n.size}}catch(i){a.e(i)}finally{a.f()}return e}},{key:"getAttributeSize",value:function(t){var r=1;switch(this.attributes[t].glType){case this._gl.FLOAT:r=4;break;default:r=1}return r*this.attributes[t].size}},{key:"use",value:function(){var r=this._gl;r.useProgram(this.program);var e,a=0,n=t(this.layout);try{for(n.s();!(e=n.n()).done;){var o=e.value;r.vertexAttribPointer(o.location,o.size,o.glType,o.normalized,this.totalVertexSizeBytes,a),r.enableVertexAttribArray(o.location),a+=this.getAttributeSize(o.name)}}catch(l){n.e(l)}finally{n.f()}for(var i in this.uniforms){var u=this.uniforms[i];switch(u.type){case"matrix":r.uniformMatrix4fv(u.location,!1,u.data);break;case"numbers":r.uniform1iv(u.location,u.data)}}}}]),r}();exports.Shader=i;
},{}],"TKQZ":[function(require,module,exports) {
module.exports="#define GLSLIFY 1\nattribute vec4 a_position;\nattribute vec4 a_color;\n\nvarying lowp vec4 v_color;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n   // Set the vertex position using the ortho transform matrix\n   gl_Position = u_matrix * a_position;\n\n   // Passthrough the color\n   v_color = a_color;\n}";
},{}],"Jdmc":[function(require,module,exports) {
module.exports="precision mediump float;\n#define GLSLIFY 1\n\n// Color\nvarying lowp vec4 v_color;\n\nvoid main() {\n  gl_FragColor = v_color;\n}";
},{}],"UdiZ":[function(require,module,exports) {
"use strict";function e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function n(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function t(e,t,o){return t&&n(e.prototype,t),o&&n(e,o),e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.BatchCommand=void 0;var o=function(){function n(t){e(this,n),this.max=t,this._pool=void 0,this.commands=[]}return t(n,[{key:"isFull",value:function(){return this.commands.length>=this.max}},{key:"canAdd",value:function(){return!this.isFull()}},{key:"add",value:function(e){this.commands.push(e)}},{key:"dispose",value:function(){return this.commands.length=0,this}}]),n}();exports.BatchCommand=o;
},{}],"SXsA":[function(require,module,exports) {
"use strict";function t(t){return o(t)||n(t)||r(t)||e()}function e(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function r(t,e){if(t){if("string"==typeof t)return i(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(t,e):void 0}}function n(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function o(t){if(Array.isArray(t))return i(t)}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(t,e,r){return e&&a(t.prototype,e),r&&a(t,r),t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Pool=void 0;var c=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;s(this,e),this.builder=t,this.recycler=r,this.maxObjects=n,this.totalAllocations=0,this.index=0,this.objects=[]}return l(e,[{key:"using",value:function(e){var r=e(this);return r?this.done.apply(this,t(r)):this.done()}},{key:"borrow",value:function(t){t(this.get()),this.index--}},{key:"get",value:function(){if(this.index===this.maxObjects)throw new Error("Max pooled objects reached, possible memory leak?");for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];if(this.objects[this.index])return this.recycler.apply(this,[this.objects[this.index++]].concat(e));this.totalAllocations++;var n=this.objects[this.index++]=this.builder.apply(this,e);return n._pool=this,n}},{key:"done",value:function(){this.index=0;for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];for(var n=0,o=e;n<o.length;n++){var i=o[n],s=this.objects.indexOf(i);this.objects[s]=this.builder(),this.objects[s]._pool=this,this.totalAllocations++,i._pool=void 0}return e}}]),e}();exports.Pool=c;
},{}],"SXwe":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BatchRenderer=void 0;var t=require("./batch"),e=require("../GraphicsDiagnostics"),r=require("../../Util/Pool");function n(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=i(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,h=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return s=t.done,t},e:function(t){h=!0,o=t},f:function(){try{s||null==r.return||r.return()}finally{if(h)throw o}}}}function i(t,e){if(t){if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(t,e):void 0}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function h(t,e,r){return e&&s(t.prototype,e),r&&s(t,r),t}var c=function(){function i(e){var n,a,s,h=this;o(this,i),this.priority=0,this._buffer=null,this._maxCommandsPerBatch=2e3,this._batches=[],this._gl=e.gl;var c=e.command;this._verticesPerCommand=null!==(n=null==e?void 0:e.verticesPerCommand)&&void 0!==n?n:1,this._maxCommandsPerBatch=null!==(a=null==e?void 0:e.maxCommandsPerBatch)&&void 0!==a?a:this._maxCommandsPerBatch;var u=null!==(s=null==e?void 0:e.batchFactory)&&void 0!==s?s:function(){return new t.BatchCommand(h._maxCommandsPerBatch)};this.commands=new r.Pool(function(){return new c},function(t){return t.dispose()},this._maxCommandsPerBatch),this._batchPool=new r.Pool(u,function(t){return t.dispose()},100)}return h(i,[{key:"init",value:function(){var t=this._gl;this.shader=this.buildShader(t),this._vertices=new Float32Array(this.shader.vertexAttributeSize*this._verticesPerCommand*this._maxCommandsPerBatch),this._buffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this._buffer),t.bufferData(t.ARRAY_BUFFER,this._vertices,t.DYNAMIC_DRAW)}},{key:"vertexSize",get:function(){return this.shader.vertexAttributeSize}},{key:"addCommand",value:function(t){0===this._batches.length&&this._batches.push(this._batchPool.get());var e=this._batches[this._batches.length-1];if(e.canAdd())e.add(t);else{var r=this._batchPool.get();r.add(t),this._batches.push(r)}}},{key:"render",value:function(){var t=this._gl;t.bindBuffer(t.ARRAY_BUFFER,this._buffer),this.shader.use();var r,i=0,a=0,o=n(this._batches);try{for(o.s();!(r=o.n()).done;){var s=r.value,h=this.buildBatchVertices(this._vertices,s);t.bufferSubData(t.ARRAY_BUFFER,0,this._vertices),this.renderBatch(t,s,h),a+=s.commands.length,i++}}catch(c){o.e(c)}finally{o.f()}this.commands.done(),this._batchPool.done(),this._batches.length=0,e.GraphicsDiagnostics.DrawCallCount+=i,e.GraphicsDiagnostics.DrawnImagesCount+=a}}]),i}();exports.BatchRenderer=c;
},{"./batch":"UdiZ","../GraphicsDiagnostics":"pzaP","../../Util/Pool":"SXsA"}],"JJQU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LineRenderer=exports.DrawLine=void 0;var t=require("../../Algebra"),r=require("../../Drawing/Color"),e=require("./shader"),n=u(require("./shaders/line-vertex.glsl")),o=u(require("./shaders/line-fragment.glsl")),i=require("./renderer");function u(t){return t&&t.__esModule?t:{default:t}}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,r){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=l(t))||r&&t&&"number"==typeof t.length){e&&(t=e);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,a=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return u=t.done,t},e:function(t){a=!0,i=t},f:function(){try{u||null==e.return||e.return()}finally{if(a)throw i}}}}function l(t,r){if(t){if("string"==typeof t)return f(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?f(t,r):void 0}}function f(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function s(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&y(t,r)}function y(t,r){return(y=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function d(t){var r=b();return function(){var e,n=m(t);if(r){var o=m(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return h(this,e)}}function h(t,r){return!r||"object"!==a(r)&&"function"!=typeof r?p(t):r}function p(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function b(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function m(t){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function v(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function g(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function x(t,r,e){return r&&g(t.prototype,r),e&&g(t,e),t}var _=function(){function e(){v(this,e),this.color=r.Color.Black,this.start=t.Vector.Zero,this.end=t.Vector.Zero}return x(e,[{key:"dispose",value:function(){return this.color.r=0,this.color.g=0,this.color.b=0,this.color.a=1,this.start.setTo(0,0),this.end.setTo(0,0),this}}]),e}();exports.DrawLine=_;var w=function(t){s(u,i.BatchRenderer);var r=d(u);function u(t,e){var n;return v(this,u),(n=r.call(this,{gl:t,command:_,verticesPerCommand:2}))._contextInfo=e,n.init(),n}return x(u,[{key:"buildShader",value:function(t){var r=new e.Shader(t,n.default,o.default);return r.addAttribute("a_position",2,t.FLOAT),r.addAttribute("a_color",4,t.FLOAT),r.addUniformMatrix("u_matrix",this._contextInfo.matrix.data),r}},{key:"addLine",value:function(t,r,e){var n=this.commands.get();n.start=this._contextInfo.transform.current.multv(t),n.end=this._contextInfo.transform.current.multv(r),n.color=e,n.color.a=n.color.a*this._contextInfo.state.current.opacity,this.addCommand(n)}},{key:"buildBatchVertices",value:function(t,r){var e,n=0,o=c(r.commands);try{for(o.s();!(e=o.n()).done;){var i=e.value;t[n++]=i.start.x,t[n++]=i.start.y,t[n++]=i.color.r/255,t[n++]=i.color.g/255,t[n++]=i.color.b/255,t[n++]=i.color.a,t[n++]=i.end.x,t[n++]=i.end.y,t[n++]=i.color.r/255,t[n++]=i.color.g/255,t[n++]=i.color.b/255,t[n++]=i.color.a}}catch(u){o.e(u)}finally{o.f()}return n/this.vertexSize}},{key:"renderBatch",value:function(t,r,e){t.drawArrays(t.LINES,0,e)}}]),u}();exports.LineRenderer=w;
},{"../../Algebra":"NGcQ","../../Drawing/Color":"p7Gh","./shader":"EFHz","./shaders/line-vertex.glsl":"TKQZ","./shaders/line-fragment.glsl":"Jdmc","./renderer":"SXwe"}],"wsWb":[function(require,module,exports) {
module.exports="#define GLSLIFY 1\nattribute vec4 a_position;\n\n// Opacity \nattribute float a_opacity;\nvarying float v_opacity;\n\n// UV coordinate\nattribute vec2 a_texcoord;\nvarying vec2 v_texcoord;\n\n// Texture number\nattribute lowp float a_textureIndex;\nvarying lowp float v_textureIndex;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n   // Set the vertex position using the ortho transform matrix\n   gl_Position = u_matrix * a_position;\n\n   // Pass through the Opacity to the fragment shader\n   v_opacity = a_opacity;\n   // Pass through the UV coord to the fragment shader\n   v_texcoord = a_texcoord;\n   // Pass through the texture number to the fragment shader\n   v_textureIndex = a_textureIndex;\n}";
},{}],"uNX2":[function(require,module,exports) {
module.exports="precision mediump float;\n#define GLSLIFY 1\n\n// UV coord\nvarying vec2 v_texcoord;\n\n// Texture index\nvarying lowp float v_textureIndex;\n\n// Opacity\nvarying float v_opacity;\n\nuniform sampler2D u_textures[%%count%%];\n\nvoid main() {\n   // In order to support the most efficient sprite batching, we have multiple\n   // textures loaded into the gpu (usually 8) this picker logic skips over textures\n   // that do not apply to a particular sprite.\n\n   // Error color\n   vec4 color = vec4(1.0, 0.0, 0.0, 1.0);\n\n   // Always at least 1 texture at 0\n   if (v_textureIndex <= .5) {\n      gl_FragColor = texture2D(u_textures[0], v_texcoord);\n      gl_FragColor.w = gl_FragColor.w * v_opacity;\n      %%texture_picker%%\n   } else {\n      gl_FragColor = color;\n   }\n}";
},{}],"I7ok":[function(require,module,exports) {
"use strict";function t(t,e){var s;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(s=i(t))||e&&t&&"number"==typeof t.length){s&&(t=s);var h=0,n=function(){};return{s:n,n:function(){return h>=t.length?{done:!0}:{done:!1,value:t[h++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r=!0,a=!1;return{s:function(){s=t[Symbol.iterator]()},n:function(){var t=s.next();return r=t.done,t},e:function(t){a=!0,o=t},f:function(){try{r||null==s.return||s.return()}finally{if(a)throw o}}}}function i(t,i){if(t){if("string"==typeof t)return e(t,i);var s=Object.prototype.toString.call(t).slice(8,-1);return"Object"===s&&t.constructor&&(s=t.constructor.name),"Map"===s||"Set"===s?Array.from(t):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?e(t,i):void 0}}function e(t,i){(null==i||i>t.length)&&(i=t.length);for(var e=0,s=new Array(i);e<i;e++)s[e]=t[e];return s}function s(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function h(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function n(t,i,e){return i&&h(t.prototype,i),e&&h(t,e),t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.DrawDebugRectCommand=exports.DrawRectCommand=exports.DrawImageCommand=void 0;var o=function(){function i(t,e,h,n,o,r,a,d,u){s(this,i),this._pool=void 0,this.snapToPixel=!0,this.opacity=1,this.width=0,this.height=0,this.dest=[0,0],this.view=[0,0,0,0],this._geom=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],this.init(t,e,h,n,o,r,a,d,u)}return n(i,[{key:"init",value:function(i,e,s,h,n,o,r,a,d){this.image=i,this.width=(null==i?void 0:i.width)||h||0,this.height=(null==i?void 0:i.height)||n||0,this.view=[0,0,null!=h?h:null==i?void 0:i.width,null!=n?n:null==i?void 0:i.height],this.dest=[e,s],void 0!==o&&void 0!==r&&void 0!==a&&void 0!==d&&(this.view=[e,s,null!=h?h:null==i?void 0:i.width,null!=n?n:null==i?void 0:i.height],this.dest=[o,r],this.width=a,this.height=d);var u=0;if(this._geom[u++]=[this.dest[0],this.dest[1]],this._geom[u++]=[this.dest[0],this.dest[1]+this.height],this._geom[u++]=[this.dest[0]+this.width,this.dest[1]],this._geom[u++]=[this.dest[0]+this.width,this.dest[1]],this._geom[u++]=[this.dest[0],this.dest[1]+this.height],this._geom[u++]=[this.dest[0]+this.width,this.dest[1]+this.height],this.snapToPixel){var l,g=t(this._geom);try{for(g.s();!(l=g.n()).done;){var m=l.value;m[0]=~~m[0],m[1]=~~m[1]}}catch(f){g.e(f)}finally{g.f()}}return this}},{key:"dispose",value:function(){this.image=null,this.width=0,this.height=0,this.view=[0,0,0,0],this.dest=[0,0];var t=0;return this._geom[t++]=[this.dest[0],this.dest[1]],this._geom[t++]=[this.dest[0],this.dest[1]+this.height],this._geom[t++]=[this.dest[0]+this.width,this.dest[1]],this._geom[t++]=[this.dest[0]+this.width,this.dest[1]],this._geom[t++]=[this.dest[0],this.dest[1]+this.height],this._geom[t++]=[this.dest[0]+this.width,this.dest[1]+this.height],this}},{key:"applyTransform",value:function(t,i){if(t)for(var e=0;e<this._geom.length;e++)this._geom[e]=t.multv(this._geom[e]),this.snapToPixel&&(this._geom[e]=[~~this._geom[e][0],~~this._geom[e][1]]);this.opacity=i}},{key:"geometry",get:function(){return this._geom}}]),i}();exports.DrawImageCommand=o;var r=function t(i,e,h,n){s(this,t),this.dest=[0,0],this.width=0,this.height=0,this.dest=[i,e],this.width=h,this.height=n};exports.DrawRectCommand=r;var a=function t(i,e){s(this,t),this.bounds=i,this.color=e};exports.DrawDebugRectCommand=a;
},{}],"MSY4":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ImageRenderer=exports.BatchImage=void 0;var e=require("./shader"),t=c(require("./shaders/image-vertex.glsl")),r=c(require("./shaders/image-fragment.glsl")),n=require("./batch"),o=require("./draw-image-command"),a=require("./webgl-util"),i=require("./renderer"),u=require("./texture-loader");function c(e){return e&&e.__esModule?e:{default:e}}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=d(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){u=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw a}}}}function f(e){return h(e)||y(e)||d(e)||m()}function m(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(e,t){if(e){if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}function y(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function h(e){if(Array.isArray(e))return p(e)}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function v(e,t,r){return t&&x(e.prototype,t),r&&x(e,r),e}function b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function T(e){var t=I();return function(){var r,n=S(e);if(t){var o=S(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return w(this,r)}}function w(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?A(e):t}function A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function I(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var O=function(e){b(r,n.BatchCommand);var t=T(r);function r(e,n){var o;return g(this,r),(o=t.call(this,e)).maxDraws=e,o.maxTextures=n,o.textures=[],o.commands=[],o._graphicMap={},o}return v(r,[{key:"isFull",value:function(){return this.commands.length>=this.maxDraws||this.textures.length>=this.maxTextures}},{key:"canAdd",value:function(){return!(this.commands.length>=this.maxDraws)&&this.textures.length<this.maxTextures}},{key:"_isCommandFull",value:function(){return this.commands.length>=this.maxDraws}},{key:"_isTextureFull",value:function(){return this.textures.length>=this.maxTextures}},{key:"_wouldAddTexture",value:function(e){return!this._graphicMap[e.image.id]}},{key:"maybeAdd",value:function(e){return(!this._isCommandFull()&&!this._isTextureFull()||!this._wouldAddTexture(e))&&(this.add(e),!0)}},{key:"add",value:function(e){var t=u.TextureLoader.load(e.image);-1===this.textures.indexOf(t)&&this.textures.push(t),this.commands.push(e)}},{key:"bindTextures",value:function(e){for(var t=0;t<this.maxTextures;t++)e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,this.textures[t]||this.textures[0])}},{key:"getBatchTextureId",value:function(e){return e.image?this.textures.indexOf(u.TextureLoader.get(e.image)):-1}},{key:"dispose",value:function(){return this.clear(),this}},{key:"clear",value:function(){this.commands.length=0,this.textures.length=0,this._graphicMap={}}}]),r}();exports.BatchImage=O;var k=function(n){b(s,i.BatchRenderer);var c=T(s);function s(e,t){var r;return g(this,s),(r=c.call(this,{gl:e,command:o.DrawImageCommand,verticesPerCommand:6,maxCommandsPerBatch:2e3,batchFactory:function(){return new O(2e3,e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS))}}))._contextInfo=t,u.TextureLoader.registerContext(e),r.init(),r}return v(s,[{key:"buildShader",value:function(n){var o=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),a=new e.Shader(n,t.default,this._transformFragmentSource(r.default,o));return a.addAttribute("a_position",3,n.FLOAT),a.addAttribute("a_texcoord",2,n.FLOAT),a.addAttribute("a_textureIndex",1,n.FLOAT),a.addAttribute("a_opacity",1,n.FLOAT),a.addUniformMatrix("u_matrix",this._contextInfo.matrix.data),a.addUniformIntegerArray("u_textures",f(Array(o)).map(function(e,t){return t})),a}},{key:"_transformFragmentSource",value:function(e,t){for(var r=e.replace("%%count%%",t.toString()),n="",o=0;o<t;o++)n+="   } else if (v_textureIndex <= ".concat(o,".5) {\n\n                gl_FragColor = texture2D(u_textures[").concat(o,"], v_texcoord);\n\n                gl_FragColor.w = gl_FragColor.w * v_opacity;\n");return r=r.replace("%%texture_picker%%",n)}},{key:"addImage",value:function(e,t,r,n,o,a,i,u,c){var s=this.commands.get().init(e,t,r,n,o,a,i,u,c);s.applyTransform(this._contextInfo.transform.current,this._contextInfo.state.current.opacity),this.addCommand(s)}},{key:"renderBatch",value:function(e,t,r){t.bindTextures(e),e.drawArrays(e.TRIANGLES,0,r)}},{key:"buildBatchVertices",value:function(e,t){var r,n=0,o=0,i=0,u=0,c=0,s=0,f=0,m=0,d=l(t.commands);try{for(d.s();!(r=d.n()).done;){var y=r.value;o=y.view[0],i=y.view[1],u=y.view[2],c=y.view[3],s=(0,a.ensurePowerOfTwo)(y.image.width||y.width),f=(0,a.ensurePowerOfTwo)(y.image.height||y.height),m=t.getBatchTextureId(y);var h=o/s,p=i/f,g=(o+u)/s,x=(i+c)/f;e[n++]=y.geometry[0][0],e[n++]=y.geometry[0][1],e[n++]=0,e[n++]=h,e[n++]=p,e[n++]=m,e[n++]=y.opacity,e[n++]=y.geometry[1][0],e[n++]=y.geometry[1][1],e[n++]=0,e[n++]=h,e[n++]=x,e[n++]=m,e[n++]=y.opacity,e[n++]=y.geometry[2][0],e[n++]=y.geometry[2][1],e[n++]=0,e[n++]=g,e[n++]=p,e[n++]=m,e[n++]=y.opacity,e[n++]=y.geometry[3][0],e[n++]=y.geometry[3][1],e[n++]=0,e[n++]=g,e[n++]=p,e[n++]=m,e[n++]=y.opacity,e[n++]=y.geometry[4][0],e[n++]=y.geometry[4][1],e[n++]=0,e[n++]=h,e[n++]=x,e[n++]=m,e[n++]=y.opacity,e[n++]=y.geometry[5][0],e[n++]=y.geometry[5][1],e[n++]=0,e[n++]=g,e[n++]=x,e[n++]=m,e[n++]=y.opacity}}catch(v){d.e(v)}finally{d.f()}return n/this.vertexSize}}]),s}();exports.ImageRenderer=k;
},{"./shader":"EFHz","./shaders/image-vertex.glsl":"wsWb","./shaders/image-fragment.glsl":"uNX2","./batch":"UdiZ","./draw-image-command":"I7ok","./webgl-util":"MzmB","./renderer":"SXwe","./texture-loader":"dce9"}],"bkS3":[function(require,module,exports) {
module.exports="#define GLSLIFY 1\nattribute vec4 a_position;\nattribute vec4 a_color;\nattribute float a_size;\nvarying lowp vec4 v_color;\nuniform mat4 u_matrix;\n\nvoid main() {\n  gl_Position = u_matrix * a_position;\n  gl_PointSize = a_size * 2.0;\n  v_color = a_color;\n}";
},{}],"CZ9H":[function(require,module,exports) {
module.exports="#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\n\nprecision mediump float;\n#define GLSLIFY 1\nvarying lowp vec4 v_color;\n\nvoid main() {\n  float r = 0.0, delta = 0.0, alpha = 1.0;\n  vec2 cxy = 2.0 * gl_PointCoord - 1.0;\n  r = dot(cxy, cxy);\n  \n#ifdef GL_OES_standard_derivatives\n  delta = fwidth(r);\n  alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\n#else\n  if (r > 1.0) {\n    discard;\n  }\n#endif\n  gl_FragColor = vec4(v_color.rgb, v_color.a * alpha);\n}";
},{}],"jKUs":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PointRenderer=exports.DrawPoint=void 0;var t=require("./shader"),r=a(require("./shaders/point-vertex.glsl")),e=a(require("./shaders/point-fragment.glsl")),n=require("../../Algebra"),o=require("../../Drawing/Color"),i=require("./renderer");function a(t){return t&&t.__esModule?t:{default:t}}function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,r){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=f(t))||r&&t&&"number"==typeof t.length){e&&(t=e);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw i}}}}function f(t,r){if(t){if("string"==typeof t)return l(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?l(t,r):void 0}}function l(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function s(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&y(t,r)}function y(t,r){return(y=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function d(t){var r=b();return function(){var e,n=m(t);if(r){var o=m(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return p(this,e)}}function p(t,r){return!r||"object"!==u(r)&&"function"!=typeof r?h(t):r}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function b(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function m(t){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function v(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function g(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _(t,r,e){return r&&g(t.prototype,r),e&&g(t,e),t}var x=function(){function t(){v(this,t),this.point=n.Vector.Zero,this.color=o.Color.Black,this.size=1}return _(t,[{key:"dispose",value:function(){return this.point.setTo(0,0),this.color.r=0,this.color.g=0,this.color.b=0,this.color.a=1,this.size=1,this}}]),t}();exports.DrawPoint=x;var O=function(n){s(a,i.BatchRenderer);var o=d(a);function a(t,r){var e;return v(this,a),(e=o.call(this,{gl:t,command:x,verticesPerCommand:1}))._contextInfo=r,e.init(),e}return _(a,[{key:"buildShader",value:function(n){n.getExtension("OES_standard_derivatives");var o=new t.Shader(n,r.default,e.default);return o.addAttribute("a_position",2,n.FLOAT),o.addAttribute("a_color",4,n.FLOAT),o.addAttribute("a_size",1,n.FLOAT),o.addUniformMatrix("u_matrix",this._contextInfo.matrix.data),o}},{key:"addPoint",value:function(t,r,e){var n=this.commands.get();n.point=this._contextInfo.transform.current.multv(t),n.color.r=r.r,n.color.g=r.g,n.color.b=r.b,n.color.a=r.a*this._contextInfo.state.current.opacity,n.size=e*Math.max(this._contextInfo.transform.current.getScaleX(),this._contextInfo.transform.current.getScaleY()),this.addCommand(n)}},{key:"buildBatchVertices",value:function(t,r){var e,n=0,o=c(r.commands);try{for(o.s();!(e=o.n()).done;){var i=e.value;t[n++]=i.point.x,t[n++]=i.point.y,t[n++]=i.color.r/255,t[n++]=i.color.g/255,t[n++]=i.color.b/255,t[n++]=i.color.a,t[n++]=i.size}}catch(a){o.e(a)}finally{o.f()}return n/this.vertexSize}},{key:"renderBatch",value:function(t,r,e){t.drawArrays(t.POINTS,0,e)}}]),a}();exports.PointRenderer=O;
},{"./shader":"EFHz","./shaders/point-vertex.glsl":"bkS3","./shaders/point-fragment.glsl":"CZ9H","../../Algebra":"NGcQ","../../Drawing/Color":"p7Gh","./renderer":"SXwe"}],"xRtj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ExcaliburGraphicsContextWebGL=void 0;var e=require("../../Math/matrix"),t=require("./transform-stack"),r=require("../../Algebra"),i=require("../../Drawing/Color"),a=require("./state-stack"),n=require("../../Util/Log"),o=require("./line-renderer"),s=require("./image-renderer"),h=require("./point-renderer"),c=require("../Canvas"),l=require("../GraphicsDiagnostics");function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function d(e,t,r){return t&&_(e.prototype,t),r&&_(e,r),e}var g=function(){function e(t){u(this,e),this._webglCtx=t}return d(e,[{key:"drawRect",value:function(e,t,a,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{color:i.Color.Black};this.drawLine((0,r.vec)(e,t),(0,r.vec)(e+a,t),Object.assign({},o)),this.drawLine((0,r.vec)(e+a,t),(0,r.vec)(e+a,t+n),Object.assign({},o)),this.drawLine((0,r.vec)(e+a,t+n),(0,r.vec)(e,t+n),Object.assign({},o)),this.drawLine((0,r.vec)(e,t+n),(0,r.vec)(e,t),Object.assign({},o))}},{key:"drawLine",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{color:i.Color.Black};this._webglCtx.__lineRenderer.addLine(e,t,r.color)}},{key:"drawPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{color:i.Color.Black,size:5};this._webglCtx.__pointRenderer.addPoint(e,t.color,t.size)}}]),e}(),v=function(){function r(e){u(this,r),this._transform=new t.TransformStack,this._state=new a.StateStack,this.snapToPixel=!0,this.smoothing=!1,this.backgroundColor=i.Color.ExcaliburBlue,this.debug=new g(this);var n=e.canvasElement,o=e.enableTransparency,s=e.smoothing,h=e.snapToPixel,c=e.backgroundColor;this.__gl=n.getContext("webgl",{antialias:null!=s?s:this.smoothing,premultipliedAlpha:!1,alpha:null==o||o,depth:!0,powerPreference:"high-performance"}),this.snapToPixel=null!=h?h:this.snapToPixel,this.smoothing=null!=s?s:this.smoothing,this.backgroundColor=null!=c?c:this.backgroundColor,this._init()}return d(r,[{key:"opacity",get:function(){return this._state.current.opacity},set:function(e){this._state.current.opacity=e}},{key:"width",get:function(){return this.__gl.canvas.width}},{key:"height",get:function(){return this.__gl.canvas.height}},{key:"_init",value:function(){var t=this.__gl;this._ortho=e.Matrix.ortho(0,t.canvas.width,t.canvas.height,0,400,-400),t.viewport(0,0,t.canvas.width,t.canvas.height),t.clearColor(this.backgroundColor.r/255,this.backgroundColor.g/255,this.backgroundColor.b/255,this.backgroundColor.a),t.clear(t.COLOR_BUFFER_BIT),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),this.__pointRenderer=new h.PointRenderer(t,{matrix:this._ortho,transform:this._transform,state:this._state}),this.__lineRenderer=new o.LineRenderer(t,{matrix:this._ortho,transform:this._transform,state:this._state}),this.__imageRenderer=new s.ImageRenderer(t,{matrix:this._ortho,transform:this._transform,state:this._state}),this._canvas=new c.Canvas({width:t.canvas.width,height:t.canvas.height}),this.__ctx=this._canvas.ctx}},{key:"resetTransform",value:function(){this._transform.current=e.Matrix.identity()}},{key:"updateViewport",value:function(){var t=this.__gl;this._ortho=this._ortho=e.Matrix.ortho(0,t.canvas.width,t.canvas.height,0,400,-400),this.__pointRenderer.shader.addUniformMatrix("u_matrix",this._ortho.data),this.__lineRenderer.shader.addUniformMatrix("u_matrix",this._ortho.data),this.__imageRenderer.shader.addUniformMatrix("u_matrix",this._ortho.data),this._canvas.width=t.canvas.width,this._canvas.height=t.canvas.height}},{key:"drawImage",value:function(e,t,r,i,a,o,s,h,c){if(!e)return n.Logger.getInstance().warn("Cannot draw a null or undefined image"),void(console.trace&&console.trace());this.__imageRenderer.addImage(e,t,r,i,a,o,s,h,c)}},{key:"save",value:function(){this._transform.save(),this._state.save()}},{key:"restore",value:function(){this._transform.restore(),this._state.restore()}},{key:"translate",value:function(e,t){this._transform.translate(this.snapToPixel?~~e:e,this.snapToPixel?~~t:t)}},{key:"rotate",value:function(e){this._transform.rotate(e)}},{key:"scale",value:function(e,t){this._transform.scale(e,t)}},{key:"transform",value:function(e){this._transform.current=e}},{key:"clear",value:function(){var e=this.__gl;e.clearColor(this.backgroundColor.r/255,this.backgroundColor.g/255,this.backgroundColor.b/255,this.backgroundColor.a),e.clear(e.COLOR_BUFFER_BIT),l.GraphicsDiagnostics.clear()}},{key:"flush",value:function(){var e=this.__gl;e.viewport(0,0,e.canvas.width,e.canvas.height),this.__imageRenderer.render(),this.__lineRenderer.render(),this.__pointRenderer.render()}}]),r}();exports.ExcaliburGraphicsContextWebGL=v;
},{"../../Math/matrix":"uPb3","./transform-stack":"lRBE","../../Algebra":"NGcQ","../../Drawing/Color":"p7Gh","./state-stack":"rOBo","../../Util/Log":"p1Gn","./line-renderer":"JJQU","./image-renderer":"MSY4","./point-renderer":"jKUs","../Canvas":"wtst","../GraphicsDiagnostics":"pzaP"}],"qIYM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./Graphic");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(r in exports&&exports[r]===e[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}}))});var r=require("./Sprite");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===r[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return r[e]}}))});var t=require("./SpriteSheet");Object.keys(t).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===t[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return t[e]}}))});var o=require("./GraphicsGroup");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===o[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return o[e]}}))});var n=require("./ImageSource");Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===n[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return n[e]}}))});var u=require("./Animation");Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===u[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return u[e]}}))});var i=require("./GraphicsComponent");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===i[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return i[e]}}))});var c=require("./GraphicsSystem");Object.keys(c).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===c[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return c[e]}}))});var s=require("./Raster");Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===s[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return s[e]}}))});var f=require("./Circle");Object.keys(f).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===f[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return f[e]}}))});var a=require("./Rectangle");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===a[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return a[e]}}))});var p=require("./Polygon");Object.keys(p).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===p[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return p[e]}}))});var x=require("./Text");Object.keys(x).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===x[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return x[e]}}))});var l=require("./FontCommon");Object.keys(l).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===l[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return l[e]}}))});var b=require("./Font");Object.keys(b).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===b[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return b[e]}}))});var d=require("./SpriteFont");Object.keys(d).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===d[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return d[e]}}))});var y=require("./Canvas");Object.keys(y).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===y[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return y[e]}}))});var _=require("./Context/ExcaliburGraphicsContext");Object.keys(_).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===_[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return _[e]}}))});var j=require("./Context/ExcaliburGraphicsContext2DCanvas");Object.keys(j).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===j[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return j[e]}}))});var O=require("./Context/ExcaliburGraphicsContextWebGL");Object.keys(O).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===O[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return O[e]}}))});
},{"./Graphic":"OZee","./Sprite":"tEFe","./SpriteSheet":"hmKU","./GraphicsGroup":"SRl6","./ImageSource":"zFIV","./Animation":"zu78","./GraphicsComponent":"jeAN","./GraphicsSystem":"Jytr","./Raster":"Syvu","./Circle":"vFQJ","./Rectangle":"mSU3","./Polygon":"jxBF","./Text":"fKxy","./FontCommon":"gyMF","./Font":"IhtB","./SpriteFont":"aKKQ","./Canvas":"wtst","./Context/ExcaliburGraphicsContext":"FNCP","./Context/ExcaliburGraphicsContext2DCanvas":"bjvb","./Context/ExcaliburGraphicsContextWebGL":"xRtj"}],"yps7":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Polygon=void 0;var t=require("../Algebra"),e=require("../Util/Decorators");function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function n(t,e,i){return e&&o(t.prototype,e),i&&o(t,i),t}function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var l=function(t,e,i,o){var n,l=arguments.length,a=l<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(l<3?n(a):l>3?n(e,i,a):n(e,i))||a);return l>3&&a&&Object.defineProperty(e,i,a),a},a=function(){function e(o){i(this,e),this.lineWidth=5,this.filled=!1,this._points=[],this.anchor=t.Vector.Zero,this.offset=t.Vector.Zero,this.rotation=0,this.scale=t.Vector.One,this.opacity=1,this._points=o;var n=this._points.reduce(function(t,e){return Math.min(t,e.x)},0),r=this._points.reduce(function(t,e){return Math.max(t,e.x)},0);this.drawWidth=r-n;var l=this._points.reduce(function(t,e){return Math.min(t,e.y)},0),a=this._points.reduce(function(t,e){return Math.max(t,e.y)},0);this.drawHeight=a-l,this.height=this.drawHeight,this.width=this.drawWidth}return n(e,[{key:"addEffect",value:function(){}},{key:"removeEffect",value:function(){}},{key:"clearEffects",value:function(){}},{key:"reset",value:function(){}},{key:"draw",value:function(t,e,i){t instanceof CanvasRenderingContext2D?this._drawWithOptions({ctx:t,x:e,y:i}):this._drawWithOptions(t)}},{key:"_drawWithOptions",value:function(t){var e,i,o,n,r,l,a,s,h=Object.assign(Object.assign({},t),{rotation:null!==(e=t.rotation)&&void 0!==e?e:this.rotation,drawWidth:null!==(i=t.drawWidth)&&void 0!==i?i:this.drawWidth,drawHeight:null!==(o=t.drawHeight)&&void 0!==o?o:this.drawHeight,flipHorizontal:null!==(n=t.flipHorizontal)&&void 0!==n?n:this.flipHorizontal,flipVertical:null!==(r=t.flipVertical)&&void 0!==r?r:this.flipVertical,anchor:null!==(l=t.anchor)&&void 0!==l?l:this.anchor,offset:null!==(a=t.offset)&&void 0!==a?a:this.offset,opacity:null!==(s=t.opacity)&&void 0!==s?s:this.opacity}),c=h.ctx,f=h.x,u=h.y,d=h.rotation,p=h.drawWidth,y=h.drawHeight,v=h.anchor,g=h.offset,b=h.opacity,w=h.flipHorizontal,x=h.flipVertical,m=p*v.x+g.x+f,_=y*v.y+g.y+u;c.save(),c.translate(m,_),c.scale(this.scale.x,this.scale.y),c.rotate(d),c.beginPath(),c.lineWidth=this.lineWidth;var W=this._points[0];c.moveTo(W.x,W.y);for(var O=0,P=this._points.length;O<P;O++)c.lineTo(this._points[O].x,this._points[O].y);c.lineTo(W.x,W.y),c.closePath(),this.filled&&(c.fillStyle=this.fillColor.toString(),c.fill()),c.strokeStyle=this.lineColor.toString(),w&&(c.translate(p,0),c.scale(-1,1)),x&&(c.translate(0,y),c.scale(1,-1));var H=c.globalAlpha;c.globalAlpha=null!=b?b:1,c.stroke(),c.globalAlpha=H,c.restore()}}]),e}();exports.Polygon=a,exports.Polygon=a=l([(0,e.obsolete)({message:"Polygon will be removed in v0.26.0",alternateMethod:"Use Graphics.Polygon"})],a);
},{"../Algebra":"NGcQ","../Util/Decorators":"kQDE"}],"ikZV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SpriteFont=exports.SpriteSheet=void 0;var t=require("./Sprite"),e=require("./Animation"),i=require("./Color"),r=l(require("./SpriteEffects")),n=require("../Resources/Texture"),o=require("../Util/Log"),s=require("../Graphics/FontCommon"),a=require("../Util/Decorators"),c=require("../Algebra");function h(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return h=function(){return t},t}function l(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=h();if(e&&e.has(t))return e.get(t);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var o=r?Object.getOwnPropertyDescriptor(t,n):null;o&&(o.get||o.set)?Object.defineProperty(i,n,o):i[n]=t[n]}return i.default=t,e&&e.set(t,i),i}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=y();return function(){var i,r=w(t);if(e){var n=w(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return g(this,i)}}function g(t,e){return!e||"object"!==R(e)&&"function"!=typeof e?d(t):e}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function y(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function w(t){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function m(t){return x(t)||v(t)||S(t)||_()}function _(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function S(t,e){if(t){if("string"==typeof t)return b(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?b(t,e):void 0}}function v(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function x(t){if(Array.isArray(t))return b(t)}function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=new Array(e);i<e;i++)r[i]=t[i];return r}function A(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function O(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function k(t,e,i){return e&&O(t.prototype,e),i&&O(t,i),t}function R(t){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var j=function(t,e,i,r){var n,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"===("undefined"==typeof Reflect?"undefined":R(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},T=function(){function i(e,r,o,s,a,c){A(this,i),this._sprites=[],this._image=null,this._columns=0,this._rows=0,this._spWidth=0,this._spHeight=0,this._spacing=0;var h=!1;if(e instanceof Array?this._sprites=e:(!e||e instanceof n.Texture?(this._image=e,this._columns=r,this._rows=o,this._spWidth=s,this._spHeight=a,this._spacing=c||0):(this._columns=e.columns,this._rows=e.rows,this._spWidth=e.spWidth,this._spHeight=e.spHeight,this._image=e.image,this._spacing=e.spacing||0),this._sprites=new Array(this._columns*this._rows),h=!0),this.image instanceof n.Texture){var l=!1,u=!1;if(this.image.isLoaded()){if(l=this.spWidth*this.columns>this.image.image.naturalWidth,u=this.spHeight*this.rows>this.image.image.naturalHeight,l)throw new RangeError("SpriteSheet specified is wider, "+"".concat(this.columns," cols x ").concat(this.spWidth," pixels > ").concat(this.image.image.naturalWidth," ")+"pixels than image width");if(u)throw new RangeError("SpriteSheet specified is taller, "+"".concat(this.rows," rows x ").concat(this.spHeight," pixels > ").concat(this.image.image.naturalHeight," ")+"pixels than image height")}}if(h)for(var p=this.getSpacingDimensions(),f=0;f<this.rows;f++)for(var g=0;g<this.columns;g++)this._sprites[g+f*this.columns]=new t.Sprite(this.image,g*this.spWidth+p.margin*g+p.left,f*this.spHeight+p.margin*f+p.top,this.spWidth,this.spHeight)}return k(i,[{key:"spacing",get:function(){return this._spacing}},{key:"sprites",get:function(){return m(this._sprites)}},{key:"image",get:function(){return this._image}},{key:"columns",get:function(){return this._columns}},{key:"rows",get:function(){return this._rows}},{key:"spWidth",get:function(){return this._spWidth}},{key:"spHeight",get:function(){return this._spHeight}},{key:"getSpacingDimensions",value:function(){var t,e,i;return"number"==typeof this.spacing?{left:this.spacing,top:this.spacing,margin:this.spacing}:{left:null!==(t=this.spacing.left)&&void 0!==t?t:0,top:null!==(e=this.spacing.top)&&void 0!==e?e:0,margin:null!==(i=this.spacing.margin)&&void 0!==i?i:0}}},{key:"getAnimationByIndices",value:function(t,i,r){var n=this,o=i.map(function(t){return n.sprites[t]});return o=o.map(function(t){return t.clone()}),new e.Animation(t,o,r)}},{key:"getAnimationBetween",value:function(t,i,r,n){var o=this.sprites.slice(i,r);return o=o.map(function(t){return t.clone()}),new e.Animation(t,o,n)}},{key:"getAnimationForAll",value:function(t,i){var r=this.sprites.map(function(t){return t.clone()});return new e.Animation(t,r,i)}},{key:"getSprite",value:function(t){if(t>=0&&t<this.sprites.length)return this.sprites[t];throw new Error("Invalid index: "+t)}},{key:"getAnimationByCoords",value:function(i,r,n){for(var o=0,s=0,a=new Array(r.length),c=0;c<r.length;c++){var h=r[c];h.image=h.image||this.image,o=Math.max(o,h.drawWidth),s=Math.max(s,h.drawHeight),a[c]=new t.Sprite(h)}var l=new e.Animation(i,a,n);return l.drawWidth=o,l.drawHeight=s,l}}]),i}();exports.SpriteSheet=T;var W=function(t){u(a,T);var e=f(a);function a(t,r,o,s,c,h,l,u){var p;return A(this,a),(p=e.call(this,t instanceof n.Texture?{image:t,spWidth:h,spHeight:l,rows:c,columns:s,spacing:u||0}:t))._currentColor=i.Color.Black,p._currentOpacity=1,p._spriteRecord={},p._textShadowOn=!1,p._textShadowDirty=!0,p._textShadowColor=i.Color.Black,p._textShadowSprites={},p._shadowOffsetX=5,p._shadowOffsetY=5,!t||t instanceof n.Texture||(r=t.alphabet,o=t.caseInsensitive),p.alphabet=r,p.caseInsensitive=o,p._spriteRecord=p.getTextSprites(),p}return k(a,[{key:"getTextSprites",value:function(){for(var t={},e=0;e<this.alphabet.length;e++){var i=this.alphabet[e];this.caseInsensitive&&(i=i.toLowerCase()),t[i]=this.sprites[e].clone()}return t}},{key:"setTextShadow",value:function(t,e,i){for(var r in this._textShadowOn=!0,this._shadowOffsetX=t,this._shadowOffsetY=e,this._textShadowColor=i.clone(),this._textShadowDirty=!0,this._spriteRecord)this._textShadowSprites[r]=this._spriteRecord[r].clone()}},{key:"useTextShadow",value:function(t){this._textShadowOn=t,t&&this.setTextShadow(5,5,this._textShadowColor)}},{key:"draw",value:function(t,e,i,n,a){if(a=this._parseOptions(a),this._currentColor.toString()!==a.color.toString()||this._currentOpacity!==a.opacity)for(var h in this._currentOpacity=a.opacity,this._currentColor=a.color,this._spriteRecord)this._spriteRecord[h].clearEffects(),this._spriteRecord[h].fill(a.color),this._spriteRecord[h].opacity(a.opacity);if(this._textShadowOn&&this._textShadowDirty&&this._textShadowColor){for(var l in this._textShadowSprites)this._textShadowSprites[l].clearEffects(),this._textShadowSprites[l].addEffect(new r.Fill(this._textShadowColor.clone()));this._textShadowDirty=!1}var u=this.sprites[0],p=u.height,f=a.fontSize/p,g=e.length*u.width*f+e.length*a.letterSpacing,d=i;a.textAlign===s.TextAlign.Left||a.textAlign===s.TextAlign.Start?d=i:a.textAlign===s.TextAlign.Right||a.textAlign===s.TextAlign.End?d=i-g:a.textAlign===s.TextAlign.Center&&(d=i-g/2);var y=n-p*f;a.baseAlign===s.BaseAlign.Top||a.baseAlign===s.BaseAlign.Hanging?y=n:a.baseAlign===s.BaseAlign.Ideographic||a.baseAlign===s.BaseAlign.Bottom||a.baseAlign===s.BaseAlign.Alphabetic?y=n-p*f:a.baseAlign===s.BaseAlign.Middle&&(y=n-p*f/2);for(var w=0;w<e.length;w++){var m=e[w];this.caseInsensitive&&(m=m.toLowerCase());try{this._textShadowOn&&(this._textShadowSprites[m].drawAroundAnchor=!1,this._textShadowSprites[m].scale=(0,c.vec)(f,f),this._textShadowSprites[m].draw(t,d+this._shadowOffsetX,y+this._shadowOffsetY));var _=this._spriteRecord[m];_.drawAroundAnchor=!1,_.scale=(0,c.vec)(f,f),_.draw(t,d,y),d+=_.drawWidth+a.letterSpacing}catch(S){o.Logger.getInstance().error("SpriteFont Error drawing char ".concat(m))}}}},{key:"_parseOptions",value:function(t){return{fontSize:t.fontSize||10,letterSpacing:t.letterSpacing||0,color:t.color||i.Color.Black,textAlign:void 0===R(t.textAlign)?s.TextAlign.Left:t.textAlign,baseAlign:void 0===R(t.baseAlign)?s.BaseAlign.Bottom:t.baseAlign,maxWidth:t.maxWidth||-1,opacity:t.opacity||0}}}]),a}();exports.SpriteFont=W,exports.SpriteFont=W=j([(0,a.obsolete)({message:"SpriteSheet will be removed in v0.26.0",alternateMethod:"Use Graphics.SpriteSheet"})],W);
},{"./Sprite":"PpGD","./Animation":"qSfQ","./Color":"p7Gh","./SpriteEffects":"OEQf","../Resources/Texture":"HrNa","../Util/Log":"p1Gn","../Graphics/FontCommon":"gyMF","../Util/Decorators":"kQDE","../Algebra":"NGcQ"}],"Um1p":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CanvasDrawingSystem=void 0;var t=require("../EntityComponentSystem"),e=require("./CanvasDrawComponent"),r=require("../EntityComponentSystem/Components/TransformComponent"),n=require("../Graphics/GraphicsDiagnostics");function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=i(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return s=t.done,t},e:function(t){c=!0,a=t},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}function i(t,e){if(t){if("string"==typeof t)return s(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(t,e):void 0}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function f(t,e,r){return e&&u(t.prototype,e),r&&u(t,r),t}function l(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function p(t){var e=_();return function(){var r,n=v(t);if(e){var o=v(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return y(this,r)}}function y(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?m(t):e}function m(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function v(t){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var g=function(o){l(s,t.System);var i=p(s);function s(){var e;return c(this,s),(e=i.apply(this,arguments)).types=["transform","canvas"],e.systemType=t.SystemType.Draw,e.priority=-1,e}return f(s,[{key:"initialize",value:function(t){this._ctx=t.engine.ctx,this._engine=t.engine,this._camera=t.camera}},{key:"sort",value:function(t,e){return t.get(r.TransformComponent).z-e.get(r.TransformComponent).z}},{key:"update",value:function(t,o){var a,i;this._clearScreen();for(var s=t.length,c=0;c<s;c++)t[c].visible&&!t[c].isOffScreen&&(a=t[c].get(r.TransformComponent),i=t[c].get(e.CanvasDrawComponent),this._ctx.save(),this._pushCameraTransform(a),this._ctx.save(),this._applyTransform(t[c]),i.draw(this._ctx,o),this._ctx.restore(),this._popCameraTransform(a),this._ctx.restore()),this._engine.isDebug&&(this._ctx.save(),this._pushCameraTransform(a),this._ctx.strokeStyle="yellow",t[c].debugDraw(this._ctx),this._popCameraTransform(a),this._ctx.restore());this._engine.isDebug&&(this._ctx.save(),this._camera.draw(this._ctx),this._camera.debugDraw(this._ctx),this._ctx.restore()),this._engine.stats.currFrame.graphics.drawnImages=n.GraphicsDiagnostics.DrawnImagesCount,this._engine.stats.currFrame.graphics.drawCalls=n.GraphicsDiagnostics.DrawCallCount}},{key:"_applyTransform",value:function(t){var e,n=a(t.getAncestors());try{for(n.s();!(e=n.n()).done;){var o=e.value,i=null==o?void 0:o.get(r.TransformComponent);i&&(this._ctx.translate(i.pos.x,i.pos.y),this._ctx.rotate(i.rotation),this._ctx.scale(i.scale.x,i.scale.y))}}catch(s){n.e(s)}finally{n.f()}}},{key:"_clearScreen",value:function(){this._ctx.clearRect(0,0,this._ctx.canvas.width,this._ctx.canvas.height),this._ctx.fillStyle=this._engine.backgroundColor.toString(),this._ctx.fillRect(0,0,this._ctx.canvas.width,this._ctx.canvas.height)}},{key:"_pushCameraTransform",value:function(t){t.coordPlane===r.CoordPlane.World&&(this._ctx.save(),this._camera&&this._camera.draw(this._ctx))}},{key:"_popCameraTransform",value:function(t){t.coordPlane===r.CoordPlane.World&&this._ctx.restore()}}]),s}();exports.CanvasDrawingSystem=g;
},{"../EntityComponentSystem":"sOyH","./CanvasDrawComponent":"UzNB","../EntityComponentSystem/Components/TransformComponent":"yq2E","../Graphics/GraphicsDiagnostics":"pzaP"}],"vS88":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={Animation:!0,Sprite:!0,SpriteSheet:!0,SpriteFont:!0,Effects:!0};Object.defineProperty(exports,"Animation",{enumerable:!0,get:function(){return t.Animation}}),Object.defineProperty(exports,"Sprite",{enumerable:!0,get:function(){return o.Sprite}}),Object.defineProperty(exports,"SpriteSheet",{enumerable:!0,get:function(){return i.SpriteSheet}}),Object.defineProperty(exports,"SpriteFont",{enumerable:!0,get:function(){return i.SpriteFont}}),exports.Effects=void 0;var t=require("./Animation"),r=require("./Color");Object.keys(r).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===r[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return r[t]}}))});var n=require("./Polygon");Object.keys(n).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===n[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return n[t]}}))});var o=require("./Sprite"),i=require("./SpriteSheet"),p=require("./CanvasDrawComponent");Object.keys(p).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===p[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return p[t]}}))});var u=require("./CanvasDrawingSystem");Object.keys(u).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===u[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return u[t]}}))});var c=f(require("./SpriteEffects"));function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}function f(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=n?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(r,o,i):r[o]=e[o]}return r.default=e,t&&t.set(e,r),r}exports.Effects=c;
},{"./Animation":"qSfQ","./Color":"p7Gh","./Polygon":"yps7","./Sprite":"PpGD","./SpriteSheet":"ikZV","./CanvasDrawComponent":"UzNB","./CanvasDrawingSystem":"Um1p","./SpriteEffects":"OEQf"}],"QP5n":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Cell=exports.CellImpl=exports.TileMap=exports.TileMapImpl=void 0;var t=require("./Collision/BoundingBox"),e=require("./Drawing/Color"),r=require("./Algebra"),n=require("./Util/Log"),i=p(require("./Events")),o=require("./Configurable"),s=require("./EntityComponentSystem/Entity"),l=require("./EntityComponentSystem/Components/TransformComponent"),a=p(require("./Graphics")),c=require("./Drawing/Index"),h=require("./Util/Util"),u=require("./Util/Decorators");function f(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return f=function(){return t},t}function p(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=f();if(e&&e.has(t))return e.get(t);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=n?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=t[i]}return r.default=t,e&&e.set(t,r),r}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function v(t,e,r){return e&&y(t.prototype,e),r&&y(t,r),t}function g(t,e,r){return(g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=m(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function m(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=M(t)););return t}function S(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&b(t,e)}function b(t,e){return(b=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function w(t){var e=C();return function(){var r,n=M(t);if(e){var i=M(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _(this,r)}}function _(t,e){return!e||"object"!==k(e)&&"function"!=typeof e?x(t):e}function x(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function C(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function M(t){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function k(t){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var O=function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"===("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s},P=function(o){S(u,s.Entity);var h=w(u);function u(e,r,i,o,s,f){var p;if(d(this,u),(p=h.call(this,[new l.TransformComponent,new a.GraphicsComponent({onPostDraw:function(t,e){return p.draw(t,e)}}),new c.CanvasDrawComponent(function(t,e){return p.draw(t,e)})]))._collidingX=-1,p._collidingY=-1,p._onScreenXStart=0,p._onScreenXEnd=9999,p._onScreenYStart=0,p._onScreenYEnd=9999,p._spriteSheets={},p._legacySpriteMap=new Map,p.logger=n.Logger.getInstance(),p.data=[],p.visible=!0,p.isOffscreen=!1,e&&"object"===k(e)){var y=e;e=y.x,r=y.y,i=y.cellWidth,o=y.cellHeight,s=y.rows,f=y.cols}p.x=e,p.y=r,p.cellWidth=i,p.cellHeight=o,p.rows=s,p.cols=f,p.data=new Array(s*f);for(var v=function(t){for(var n=function(n){var s;s=new R(t*i+e,n*o+r,i,o,t+n*f),p.data[t+n*f]=s},l=0;l<s;l++)n(l)},g=0;g<f;g++)v(g);return p._transform=p.get(l.TransformComponent),p.get(a.GraphicsComponent).localBounds=new t.BoundingBox({left:0,top:0,right:p.cols*p.cellWidth,bottom:p.rows*p.cellHeight}),p}return v(u,[{key:"x",get:function(){var t;return null!==(t=this._transform.pos.x)&&void 0!==t?t:0},set:function(t){var e;(null===(e=this._transform)||void 0===e?void 0:e.pos)&&(this.get(l.TransformComponent).pos=(0,r.vec)(t,this.y))}},{key:"y",get:function(){var t,e;return null!==(e=null===(t=this._transform)||void 0===t?void 0:t.pos.y)&&void 0!==e?e:0},set:function(t){var e;(null===(e=this._transform)||void 0===e?void 0:e.pos)&&(this._transform.pos=(0,r.vec)(this.x,t))}},{key:"z",get:function(){var t;return null!==(t=this._transform.z)&&void 0!==t?t:0},set:function(t){var e;(null===(e=this._transform)||void 0===e?void 0:e.z)&&(this._transform.z=t)}},{key:"rotation",get:function(){var t,e;return null!==(e=null===(t=this._transform)||void 0===t?void 0:t.rotation)&&void 0!==e?e:0},set:function(t){var e;(null===(e=this._transform)||void 0===e?void 0:e.rotation)&&(this._transform.rotation=t)}},{key:"scale",get:function(){var t,e;return null!==(e=null===(t=this._transform)||void 0===t?void 0:t.scale)&&void 0!==e?e:r.Vector.One},set:function(t){var e;(null===(e=this._transform)||void 0===e?void 0:e.scale)&&(this._transform.scale=t)}},{key:"pos",get:function(){return this._transform.pos},set:function(t){this._transform.pos=t}},{key:"on",value:function(t,e){g(M(u.prototype),"on",this).call(this,t,e)}},{key:"_initialize",value:function(t){g(M(u.prototype),"_initialize",this).call(this,t)}},{key:"registerSpriteSheet",value:function(t,e){e instanceof a.SpriteSheet?this._spriteSheets[t]=e:this._spriteSheets[t]=a.SpriteSheet.fromLegacySpriteSheet(e)}},{key:"collides",value:function(t){var e=t.pos.x+t.width,n=t.pos.y+t.height,i=t.body.collider.bounds,o=[];if(t.width<=0||t.height<=0)return null;for(var s=i.left;s<=e;s+=Math.min(t.width/2,this.cellWidth/2))for(var l=i.top;l<=n;l+=Math.min(t.height/2,this.cellHeight/2)){var a=this.getCellByPoint(s,l);if(a&&a.solid){var c=i.intersect(a.bounds),h=t.center.sub(a.center);c&&c.dot(h)>0&&o.push(c)}}return 0===o.length?null:o.reduce(function(t,e){var n=t.x,i=t.y;return Math.abs(t.x)<Math.abs(e.x)&&(n=e.x),Math.abs(t.y)<Math.abs(e.y)&&(i=e.y),new r.Vector(n,i)})}},{key:"getCellByIndex",value:function(t){return this.data[t]}},{key:"getCell",value:function(t,e){return t<0||e<0||t>=this.cols||e>=this.rows?null:this.data[t+e*this.cols]}},{key:"getCellByPoint",value:function(t,e){t=Math.floor((t-this.x)/this.cellWidth),e=Math.floor((e-this.y)/this.cellHeight);var r=this.getCell(t,e);return t>=0&&e>=0&&t<this.cols&&e<this.rows&&r?r:null}},{key:"onPreUpdate",value:function(t,e){}},{key:"onPostUpdate",value:function(t,e){}},{key:"update",value:function(t,e){this.onPreUpdate(t,e),this.emit("preupdate",new i.PreUpdateEvent(t,e,this));var n=t.getWorldBounds(),o=(0,r.vec)(n.left,n.top),s=(0,r.vec)(n.right,n.bottom);this._onScreenXStart=Math.max(Math.floor((o.x-this.x)/this.cellWidth)-2,0),this._onScreenYStart=Math.max(Math.floor((o.y-this.y)/this.cellHeight)-2,0),this._onScreenXEnd=Math.max(Math.floor((s.x-this.x)/this.cellWidth)+2,0),this._onScreenYEnd=Math.max(Math.floor((s.y-this.y)/this.cellHeight)+2,0),this._transform.pos=(0,r.vec)(this.x,this.y),this.onPostUpdate(t,e),this.emit("postupdate",new i.PostUpdateEvent(t,e,this))}},{key:"draw",value:function(t,e){this.emit("predraw",new i.PreDrawEvent(t,e,this));for(var r,n,o,s=this._onScreenXStart,l=Math.min(this._onScreenXEnd,this.cols),c=this._onScreenYStart,h=Math.min(this._onScreenYEnd,this.rows);s<l;s++){for(;c<h;c++)for(n=0,o=(r=this.getCell(s,c).sprites).length;n<o;n++){var u=r[n];u&&(t instanceof CanvasRenderingContext2D?(this._legacySpriteMap.has(u)||this._legacySpriteMap.set(u,a.Sprite.toLegacySprite(u)),this._legacySpriteMap.get(u).draw(t,s*this.cellWidth,c*this.cellHeight)):u.draw(t,s*this.cellWidth,c*this.cellHeight))}c=this._onScreenYStart}this.emit("postdraw",new i.PostDrawEvent(t,e,this))}},{key:"debugDraw",value:function(t){var r=this.cols*this.cellWidth,n=this.rows*this.cellHeight;t.save(),t.strokeStyle=e.Color.Red.toString();for(var i=0;i<this.cols+1;i++)t.beginPath(),t.moveTo(this.x+i*this.cellWidth,this.y),t.lineTo(this.x+i*this.cellWidth,this.y+n),t.stroke();for(var o=0;o<this.rows+1;o++)t.beginPath(),t.moveTo(this.x,this.y+o*this.cellHeight),t.lineTo(this.x+r,this.y+o*this.cellHeight),t.stroke();var s=e.Color.Red;s.a=.3,this.data.filter(function(t){return t.solid}).forEach(function(e){t.fillStyle=s.toString(),t.fillRect(e.x,e.y,e.width,e.height)}),this._collidingY>-1&&this._collidingX>-1&&(t.fillStyle=e.Color.Cyan.toString(),t.fillRect(this.x+this._collidingX*this.cellWidth,this.y+this._collidingY*this.cellHeight,this.cellWidth,this.cellHeight)),t.restore()}}]),u}();exports.TileMapImpl=P,O([(0,u.obsolete)({message:"No longer used, will be removed in v0.26.0"})],P.prototype,"registerSpriteSheet",null);var j=function(t){S(r,(0,o.Configurable)(P));var e=w(r);function r(t,n,i,o,s,l){return d(this,r),e.call(this,t,n,i,o,s,l)}return r}();exports.TileMap=j;var E=function(e){S(i,s.Entity);var n=w(i);function i(e,r,o,s,l){var a,c=arguments.length>5&&void 0!==arguments[5]&&arguments[5],h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[];if(d(this,i),(a=n.call(this)).solid=!1,a.sprites=[],e&&"object"===k(e)){var u=e;e=u.x,r=u.y,o=u.width,s=u.height,l=u.index,c=u.solid,h=u.sprites}return a.x=e,a.y=r,a.width=o,a.height=s,a.index=l,a.solid=c,a.sprites=h,a._bounds=new t.BoundingBox(a.x,a.y,a.x+a.width,a.y+a.height),a}return v(i,[{key:"bounds",get:function(){return this._bounds}},{key:"center",get:function(){return new r.Vector(this.x+this.width/2,this.y+this.height/2)}},{key:"pushSprite",value:function(t){this.addSprite(t)}},{key:"addSprite",value:function(t){t instanceof c.Sprite?this.sprites.push(a.Sprite.fromLegacySprite(t)):this.sprites.push(t)}},{key:"removeSprite",value:function(t){(0,h.removeItemFromArray)(t,this.sprites)}},{key:"clearSprites",value:function(){this.sprites.length=0}}]),i}();exports.CellImpl=E,O([(0,u.obsolete)({message:"Will be removed in v0.26.0",alternateMethod:"addSprite"})],E.prototype,"pushSprite",null);var R=function(t){S(r,(0,o.Configurable)(E));var e=w(r);function r(t,n,i,o,s,l,a){return d(this,r),e.call(this,t,n,i,o,s,l,a)}return r}();exports.Cell=R;
},{"./Collision/BoundingBox":"oyna","./Drawing/Color":"p7Gh","./Algebra":"NGcQ","./Util/Log":"p1Gn","./Events":"XySq","./Configurable":"A4Kj","./EntityComponentSystem/Entity":"UY9q","./EntityComponentSystem/Components/TransformComponent":"yq2E","./Graphics":"qIYM","./Drawing/Index":"vS88","./Util/Util":"Kkda","./Util/Decorators":"kQDE"}],"pAjs":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Camera=exports.LimitCameraBoundsStrategy=exports.RadiusAroundActorStrategy=exports.ElasticToActorStrategy=exports.LockCameraToActorAxisStrategy=exports.LockCameraToActorStrategy=exports.Axis=exports.StrategyContainer=void 0;var t=require("./Util/EasingFunctions"),e=require("./Algebra"),i=require("./Util/Util"),n=require("./Events"),r=require("./Class"),o=require("./Collision/BoundingBox"),a=require("./Util/Log");function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function h(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=u(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==i.return||i.return()}finally{if(s)throw o}}}}function u(t,e){if(t){if("string"==typeof t)return c(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?c(t,e):void 0}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function l(t,e,i){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=f(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(i):r.value}})(t,e,i||t)}function f(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=v(t)););return t}function p(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}function g(t,e){return(g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function y(t){var e=m();return function(){var i,n=v(t);if(e){var r=v(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return _(this,i)}}function _(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?d(t):e}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function m(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function v(t){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function k(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function S(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function w(t,e,i){return e&&S(t.prototype,e),i&&S(t,i),t}var x,b=function(){function t(e){k(this,t),this.camera=e}return w(t,[{key:"lockToActor",value:function(t){this.camera.addStrategy(new z(t))}},{key:"lockToActorAxis",value:function(t,e){this.camera.addStrategy(new E(t,e))}},{key:"elasticToActor",value:function(t,e,i){this.camera.addStrategy(new P(t,e,i))}},{key:"radiusAroundActor",value:function(t,e){this.camera.addStrategy(new A(t,e))}},{key:"limitCameraBounds",value:function(t){this.camera.addStrategy(new D(t))}}]),t}();exports.StrategyContainer=b,exports.Axis=x,function(t){t[t.X=0]="X",t[t.Y=1]="Y"}(x||(exports.Axis=x={}));var z=function t(e){k(this,t),this.target=e,this.action=function(t,e,i,n){return t.center}};exports.LockCameraToActorStrategy=z;var E=function t(i,n){var r=this;k(this,t),this.target=i,this.axis=n,this.action=function(t,i,n,o){var a=t.center,s=i.getFocus();return r.axis===x.X?new e.Vector(a.x,s.y):new e.Vector(s.x,a.y)}};exports.LockCameraToActorAxisStrategy=E;var P=function t(e,i,n){var r=this;k(this,t),this.target=e,this.cameraElasticity=i,this.cameraFriction=n,this.action=function(t,e,i,n){var o=t.center,a=e.getFocus(),s=e.vel.clone(),h=o.sub(a).scale(r.cameraElasticity),u=(s=s.add(h)).scale(-1).scale(r.cameraFriction);return s=s.add(u),a=a.add(s)}};exports.ElasticToActorStrategy=P;var A=function t(e,i){var n=this;k(this,t),this.target=e,this.radius=i,this.action=function(t,e,i,r){var o=t.center,a=e.getFocus(),s=o.sub(a),h=s.size;if(h>=n.radius){var u=h-n.radius;return a.add(s.normalize().scale(u))}return a}};exports.RadiusAroundActorStrategy=A;var D=function t(i){var n=this;k(this,t),this.target=i,this.boundSizeChecked=!1,this.action=function(t,i,r,o){var s=i.getFocus();n.boundSizeChecked||((t.bottom-t.top<r.drawHeight||t.right-t.left<r.drawWidth)&&a.Logger.getInstance().warn("Camera bounds should not be smaller than the engine viewport"),n.boundSizeChecked=!0);var h=s.x,u=s.y;return s.x<t.left+r.halfDrawWidth?h=t.left+r.halfDrawWidth:s.x>t.right-r.halfDrawWidth&&(h=t.right-r.halfDrawWidth),s.y<t.top+r.halfDrawHeight?u=t.top+r.halfDrawHeight:s.y>t.bottom-r.halfDrawHeight&&(u=t.bottom-r.halfDrawHeight),(0,e.vec)(h,u)}};exports.LimitCameraBoundsStrategy=D;var T=function(a){p(u,r.Class);var s=y(u);function u(){var i;return k(this,u),(i=s.apply(this,arguments))._cameraStrategies=[],i.strategy=new b(d(i)),i._z=1,i.dz=0,i.az=0,i.rotation=0,i.rx=0,i.pos=e.Vector.Zero,i.vel=e.Vector.Zero,i.acc=e.Vector.Zero,i._cameraMoving=!1,i._currentLerpTime=0,i._lerpDuration=1e3,i._lerpStart=null,i._lerpEnd=null,i._isShaking=!1,i._shakeMagnitudeX=0,i._shakeMagnitudeY=0,i._shakeDuration=0,i._elapsedShakeTime=0,i._xShake=0,i._yShake=0,i._isZooming=!1,i._zoomStart=1,i._zoomEnd=1,i._currentZoomTime=0,i._zoomDuration=0,i._zoomEasing=t.EasingFunctions.EaseInOutCubic,i._easing=t.EasingFunctions.EaseInOutCubic,i._halfWidth=0,i._halfHeight=0,i._viewport=null,i._isInitialized=!1,i}return w(u,[{key:"zoom",get:function(){return this._z},set:function(t){this._z=t,this._engine&&(this._halfWidth=this._engine.halfDrawWidth,this._halfHeight=this._engine.halfDrawHeight)}},{key:"angularVelocity",get:function(){return this.rx},set:function(t){this.rx=t}},{key:"x",get:function(){return this.pos.x},set:function(t){this._follow||this._cameraMoving||(this.pos=(0,e.vec)(t,this.pos.y))}},{key:"y",get:function(){return this.pos.y},set:function(t){this._follow||this._cameraMoving||(this.pos=(0,e.vec)(this.pos.x,t))}},{key:"dx",get:function(){return this.vel.x},set:function(t){this.vel=(0,e.vec)(t,this.vel.y)}},{key:"dy",get:function(){return this.vel.y},set:function(t){this.vel=(0,e.vec)(this.vel.x,t)}},{key:"ax",get:function(){return this.acc.x},set:function(t){this.acc=(0,e.vec)(t,this.acc.y)}},{key:"ay",get:function(){return this.acc.y},set:function(t){this.acc=(0,e.vec)(this.acc.x,t)}},{key:"getFocus",value:function(){return this.pos}},{key:"move",value:function(e,i){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.EasingFunctions.EaseInOutCubic;if("function"!=typeof r)throw"Please specify an EasingFunction";return this._follow?Promise.reject(e):(this._lerpPromise&&this._lerpResolve&&this._lerpResolve(e),this._lerpPromise=new Promise(function(t){n._lerpResolve=t}),this._lerpStart=this.getFocus().clone(),this._lerpDuration=i,this._lerpEnd=e,this._currentLerpTime=0,this._cameraMoving=!0,this._easing=r,this._lerpPromise)}},{key:"shake",value:function(t,e,i){this._isShaking=!0,this._shakeMagnitudeX=t,this._shakeMagnitudeY=e,this._shakeDuration=i}},{key:"zoomOverTime",value:function(e){var i=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.EasingFunctions.EaseInOutCubic;return this._zoomPromise=new Promise(function(t){i._zoomResolve=t}),n?(this._isZooming=!0,this._zoomEasing=r,this._currentZoomTime=0,this._zoomDuration=n,this._zoomStart=this.zoom,this._zoomEnd=e,this._zoomPromise):(this._isZooming=!1,this.zoom=e,Promise.resolve(!0))}},{key:"viewport",get:function(){return this._viewport?this._viewport:new o.BoundingBox(0,0,0,0)}},{key:"addStrategy",value:function(t){this._cameraStrategies.push(t)}},{key:"removeStrategy",value:function(t){(0,i.removeItemFromArray)(t,this._cameraStrategies)}},{key:"clearAllStrategies",value:function(){this._cameraStrategies.length=0}},{key:"_preupdate",value:function(t,e){this.emit("preupdate",new n.PreUpdateEvent(t,e,this)),this.onPreUpdate(t,e)}},{key:"onPreUpdate",value:function(t,e){}},{key:"_postupdate",value:function(t,e){this.emit("postupdate",new n.PostUpdateEvent(t,e,this)),this.onPostUpdate(t,e)}},{key:"onPostUpdate",value:function(t,e){}},{key:"isInitialized",get:function(){return this._isInitialized}},{key:"_initialize",value:function(t){this.isInitialized||(this.onInitialize(t),l(v(u.prototype),"emit",this).call(this,"initialize",new n.InitializeEvent(t,this)),this._isInitialized=!0,this._engine=t,this._halfWidth=this._engine.halfDrawWidth,this._halfHeight=this._engine.halfDrawHeight)}},{key:"onInitialize",value:function(t){}},{key:"on",value:function(t,e){l(v(u.prototype),"on",this).call(this,t,e)}},{key:"off",value:function(t,e){l(v(u.prototype),"off",this).call(this,t,e)}},{key:"once",value:function(t,e){l(v(u.prototype),"once",this).call(this,t,e)}},{key:"update",value:function(e,i){if(this._initialize(e),this._preupdate(e,i),this.pos=this.pos.add(this.vel.scale(i/1e3)),this.zoom+=this.dz*i/1e3,this.vel=this.vel.add(this.acc.scale(i/1e3)),this.dz+=this.az*i/1e3,this.rotation+=this.angularVelocity*i/1e3,this._isZooming)if(this._currentZoomTime<this._zoomDuration){var n=(0,this._zoomEasing)(this._currentZoomTime,this._zoomStart,this._zoomEnd,this._zoomDuration);this.zoom=n,this._currentZoomTime+=i}else this._isZooming=!1,this.zoom=this._zoomEnd,this._currentZoomTime=0,this._zoomResolve(!0);if(this._cameraMoving)if(this._currentLerpTime<this._lerpDuration){var r=t.EasingFunctions.CreateVectorEasingFunction(this._easing)(this._currentLerpTime,this._lerpStart,this._lerpEnd,this._lerpDuration);this.pos=r,this._currentLerpTime+=i}else{this.pos=this._lerpEnd;var a=this._lerpEnd.clone();this._lerpStart=null,this._lerpEnd=null,this._currentLerpTime=0,this._cameraMoving=!1,this._lerpResolve(a)}this._isDoneShaking()?(this._isShaking=!1,this._elapsedShakeTime=0,this._shakeMagnitudeX=0,this._shakeMagnitudeY=0,this._shakeDuration=0,this._xShake=0,this._yShake=0):(this._elapsedShakeTime+=i,this._xShake=1+(Math.random()*this._shakeMagnitudeX|0),this._yShake=1+(Math.random()*this._shakeMagnitudeY|0));var s,u=h(this._cameraStrategies);try{for(u.s();!(s=u.n()).done;){var c=s.value;this.pos=c.action.call(c,c.target,this,e,i)}}catch(l){u.e(l)}finally{u.f()}this._viewport=new o.BoundingBox(this.x-this._halfWidth,this.y-this._halfHeight,this.x+this._halfWidth,this.y+this._halfHeight),this._postupdate(e,i)}},{key:"draw",value:function(t){var e=0,i=0;t instanceof CanvasRenderingContext2D?(e=t.canvas.width,i=t.canvas.height):(e=t.width,i=t.height);var n=this.getFocus(),r=this._engine?this._engine.pixelRatio:1,o=this.zoom,a=e/o/r,s=i/o/r;t.scale(o,o),t.translate(-n.x+a/2+this._xShake,-n.y+s/2+this._yShake)}},{key:"debugDraw",value:function(t){var e=this.getFocus();t.fillStyle="red",t.strokeStyle="white",t.lineWidth=3,t.beginPath(),t.arc(e.x,e.y,15,0,2*Math.PI),t.closePath(),t.stroke(),t.beginPath(),t.arc(e.x,e.y,5,0,2*Math.PI),t.closePath(),t.stroke(),t.beginPath(),t.setLineDash([5,15]),t.lineWidth=5,t.strokeStyle="white",t.strokeRect(this.viewport.left,this.viewport.top,this.viewport.width,this.viewport.height),t.closePath()}},{key:"_isDoneShaking",value:function(){return!this._isShaking||this._elapsedShakeTime>=this._shakeDuration}}]),u}();exports.Camera=T;
},{"./Util/EasingFunctions":"LpjS","./Algebra":"NGcQ","./Util/Util":"Kkda","./Events":"XySq","./Class":"yTUi","./Collision/BoundingBox":"oyna","./Util/Log":"p1Gn"}],"rRqb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Label=exports.LabelImpl=void 0;var e=require("./Drawing/Color"),t=require("./Configurable"),n=require("./Algebra"),o=require("./Graphics/Text"),r=require("./Util/Decorators"),i=require("./Graphics"),l=require("./Graphics/Font"),a=require("./Drawing/Index"),s=require("./EntityComponentSystem"),u=require("./Actor");function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function p(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function b(e,t,n){return(b="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=h(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function h(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=x(e)););return e}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(e){var t=w();return function(){var n,o=x(e);if(t){var r=x(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return v(this,n)}}function v(e,t){return!t||"object"!==S(t)&&"function"!=typeof t?m(e):t}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var _=function(e,t,n,o){var r,i=arguments.length,l=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===("undefined"==typeof Reflect?"undefined":S(Reflect))&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(l=(i<3?r(l):i>3?r(t,n,l):r(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l},L=function(t){y(c,u.Actor);var r=g(c);function c(t,u,p,b,h){var y,d,g,v;f(this,c),(y=r.call(this)).font=new l.Font,y._text=new o.Text({text:"",font:y.font}),y.letterSpacing=0,y.caseInsensitive=!0;var m="",w=n.Vector.Zero;t&&"object"===S(t)?(b=t.fontFamily,h=t.spriteFont,m=t.text,w=null!==(d=t.pos)&&void 0!==d?d:(0,n.vec)(null!==(g=t.x)&&void 0!==g?g:0,null!==(v=t.y)&&void 0!==v?v:0)):(m=t,w=(0,n.vec)(null!=u?u:0,null!=p?p:0)),y.addComponent(new s.TransformComponent),y.get(s.TransformComponent).pos=w,y.addComponent(new a.CanvasDrawComponent(function(e,t){return y.draw(e,t)})),y.addComponent(new i.GraphicsComponent);var x=y.get(i.GraphicsComponent);return x.anchor=n.Vector.Zero,x.use(y._text),y.text=m||"",y.color=e.Color.Black,b&&(y.font.family=b),h&&(y.spriteFont=h),y}return p(c,[{key:"text",get:function(){return this._text.text},set:function(e){this._text.text=e}},{key:"color",get:function(){return this._text.color},set:function(e){this._text.color=e}},{key:"bold",get:function(){return this.font.bold},set:function(e){this.font.bold=e}},{key:"fontFamily",get:function(){return this.font.family},set:function(e){this.font.family=e}},{key:"fontSize",get:function(){return this.font.size},set:function(e){this.font.size=e}},{key:"fontStyle",get:function(){return this.font.style},set:function(e){this.font.style=e}},{key:"fontUnit",get:function(){return this.font.unit},set:function(e){this.font.unit=e}},{key:"textAlign",get:function(){return this.font.textAlign},set:function(e){this.font.textAlign=e}},{key:"baseAlign",get:function(){return this.font.baseAlign},set:function(e){this.font.baseAlign=e}},{key:"spriteFont",get:function(){return this._legacySpriteFont},set:function(e){this._legacySpriteFont=e,e&&(this._spriteFont=i.SpriteFont.fromLegacySpriteFont(e),this._text.font=this._spriteFont)}},{key:"_initialize",value:function(e){b(x(c.prototype),"_initialize",this).call(this,e),this._graphicsContext=e.graphicsContext}},{key:"getTextWidth",value:function(){return this._text.width}},{key:"setTextShadow",value:function(e,t,o){this.font.shadow={offset:(0,n.vec)(e,t),blur:2,color:o}}},{key:"useTextShadow",value:function(e){this.spriteFont&&this.spriteFont.useTextShadow(e)}},{key:"clearTextShadow",value:function(){this.font.shadow=null}},{key:"draw",value:function(e,t){var n=this._graphicsContext;this._text.draw(n,0,0)}}]),c}();exports.LabelImpl=L,_([(0,r.obsolete)({message:"Label.bold will be removed in v0.26.0",alternateMethod:"Use Label.font.bold"})],L.prototype,"bold",null),_([(0,r.obsolete)({message:"Label.fontFamily will be removed in v0.26.0",alternateMethod:"Use Label.font.family"})],L.prototype,"fontFamily",null),_([(0,r.obsolete)({message:"Label.fontSize will be removed in v0.26.0",alternateMethod:"Use Label.font.size"})],L.prototype,"fontSize",null),_([(0,r.obsolete)({message:"Label.fontStyle will be removed in v0.26.0",alternateMethod:"Use Lable.font.style"})],L.prototype,"fontStyle",null),_([(0,r.obsolete)({message:"Label.fontUnit will be removed in v0.26.0",alternateMethod:"Use Label.font.unit"})],L.prototype,"fontUnit",null),_([(0,r.obsolete)({message:"Label.textAlign will be removed in v0.26.0",alternateMethod:"Use Label.font.textAlign"})],L.prototype,"textAlign",null),_([(0,r.obsolete)({message:"Label.baseAlign will be removed in v0.26.0",alternateMethod:"Use Label.font.baseAlign"})],L.prototype,"baseAlign",null),_([(0,r.obsolete)()],L.prototype,"spriteFont",null),_([(0,r.obsolete)({message:"Label.setTextShadow will be removed in v0.26.0",alternateMethod:"Use Label.font.shadow"})],L.prototype,"setTextShadow",null),_([(0,r.obsolete)({message:"Label.useTextShadow will be removed in v0.26.0",alternateMethod:"Use Label.font.shadow"})],L.prototype,"useTextShadow",null),_([(0,r.obsolete)({message:"Label.clearTextShadow will be removed in v0.26.0",alternateMethod:"Use Label.font.shadow"})],L.prototype,"clearTextShadow",null);var O=function(e){y(o,(0,t.Configurable)(L));var n=g(o);function o(e,t,r,i,l){return f(this,o),n.call(this,e,t,r,i,l)}return o}();exports.Label=O;
},{"./Drawing/Color":"p7Gh","./Configurable":"A4Kj","./Algebra":"NGcQ","./Graphics/Text":"fKxy","./Util/Decorators":"kQDE","./Graphics":"qIYM","./Graphics/Font":"IhtB","./Drawing/Index":"vS88","./EntityComponentSystem":"sOyH","./Actor":"vmFf"}],"NgAR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Trigger=void 0;var t=require("./Drawing/Color"),e=require("./Actions/Action"),r=require("./EventDispatcher"),n=require("./Actor"),o=require("./Algebra"),i=require("./Events"),c=f(require("./Util/Util")),u=require("./Collision/CollisionType");function l(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return l=function(){return t},t}function f(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=l();if(e&&e.has(t))return e.get(t);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var i=n?Object.getOwnPropertyDescriptor(t,o):null;i&&(i.get||i.set)?Object.defineProperty(r,o,i):r[o]=t[o]}return r.default=t,e&&e.set(t,r),r}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function y(t,e,r){return e&&p(t.prototype,e),r&&p(t,r),t}function h(t,e,r){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=b(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(r):o.value}})(t,e,r||t)}function b(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=j(t)););return t}function g(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}function v(t,e){return(v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function d(t){var e=_();return function(){var r,n=j(t);if(e){var o=j(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return w(this,r)}}function w(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?O(t):e}function O(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function j(t){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var P={pos:o.Vector.Zero,width:10,height:10,visible:!1,action:function(){},filter:function(){return!0},repeat:-1},m=function(o){g(f,n.Actor);var l=d(f);function f(t){var o;return s(this,f),(o=l.call(this,t.pos.x,t.pos.y,t.width,t.height)).action=function(){},o.filter=function(){return!0},o.repeat=-1,t=c.extend({},P,t),o.filter=t.filter||o.filter,o.repeat=t.repeat||o.repeat,o.action=t.action||o.action,t.target&&(o.target=t.target),o.visible=t.visible,o.body.collider.type=u.CollisionType.Passive,o.eventDispatcher=new r.EventDispatcher(O(o)),o.actionQueue=new e.ActionQueue(O(o)),o.on("collisionstart",function(t){(0,n.isActor)(t.other)&&o.filter(t.other)&&(o.emit("enter",new i.EnterTriggerEvent(O(o),t.other)),o._dispatchAction(),0===o.repeat&&o.kill())}),o.on("collisionend",function(t){(0,n.isActor)(t.other)&&o.filter(t.other)&&o.emit("exit",new i.ExitTriggerEvent(O(o),t.other))}),o}return y(f,[{key:"target",get:function(){return this._target},set:function(t){this._target=t,this.filter=function(e){return e===t}}},{key:"_initialize",value:function(t){h(j(f.prototype),"_initialize",this).call(this,t)}},{key:"_dispatchAction",value:function(){this.action.call(this),this.repeat--}},{key:"debugDraw",value:function(e){h(j(f.prototype),"debugDraw",this).call(this,e),e.save(),e.translate(this.pos.x,this.pos.y);var r=this.body.collider.bounds,n=this.getGlobalPos();r.left=r.left-n.x,r.right=r.right-n.x,r.top=r.top-n.y,r.bottom=r.bottom-n.y,e.fillStyle=t.Color.Violet.toString(),e.strokeStyle=t.Color.Violet.toString(),e.fillText("Trigger",10,10),r.debugDraw(e),e.restore()}}]),f}();exports.Trigger=m;
},{"./Drawing/Color":"p7Gh","./Actions/Action":"gDdL","./EventDispatcher":"c7EN","./Actor":"vmFf","./Algebra":"NGcQ","./Events":"XySq","./Util/Util":"Kkda","./Collision/CollisionType":"liCD"}],"UUno":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isVanillaActor=t,exports.isScreenElement=i;var e=require("../ScreenElement"),r=require("../Label"),n=require("../Trigger");function t(t){return!(t instanceof e.ScreenElement||t instanceof n.Trigger||t instanceof r.Label)}function i(r){return r instanceof e.ScreenElement}
},{"../ScreenElement":"PDm1","../Label":"rRqb","../Trigger":"NgAR"}],"xS6v":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Scene=void 0;var e=require("./ScreenElement"),t=require("./Physics"),r=require("./Events"),n=require("./Util/Log"),i=require("./Timer"),o=require("./Collision/DynamicTreeCollisionBroadphase"),a=require("./TileMap"),s=require("./Camera"),l=require("./Actor"),u=require("./Class"),c=w(require("./Util/Util")),f=w(require("./Util/Actors")),h=require("./Trigger"),d=require("./EntityComponentSystem/System"),p=require("./Util/Decorators"),y=require("./EntityComponentSystem/World"),v=require("./Graphics/GraphicsSystem"),m=require("./Drawing/CanvasDrawingSystem"),g=require("./Flags");function b(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return b=function(){return e},e}function w(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=b();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=n?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=e[i]}return r.default=e,t&&t.set(e,r),r}function _(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=k(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function k(e,t){if(e){if("string"==typeof e)return S(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?S(e,t):void 0}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function P(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function O(e,t,r){return t&&D(e.prototype,t),r&&D(e,r),e}function E(e,t,r){return(E="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=T(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function T(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=U(e)););return e}function M(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&j(e,t)}function j(e,t){return(j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function q(e){var t=C();return function(){var r,n=U(e);if(t){var i=U(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return x(this,r)}}function x(e,t){return!t||"object"!==Q(t)&&"function"!=typeof t?A(e):t}function A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function U(e){return(U=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Q(e){return(Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var R=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":Q(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},z=function(p){M(w,u.Class);var b=q(w);function w(e){var t;return P(this,w),(t=b.call(this)).actors=[],t.world=new y.World(A(t)),t._bodies=[],t.triggers=[],t.tileMaps=[],t._isInitialized=!1,t._broadphase=new o.DynamicTreeCollisionBroadphase,t._killQueue=[],t._triggerKillQueue=[],t._timers=[],t._cancelQueue=[],t._logger=n.Logger.getInstance(),t.camera=new s.Camera,e&&(t.engine=e,t.camera.x=t.engine.halfDrawWidth,t.camera.y=t.engine.halfDrawHeight),t}return O(w,[{key:"screenElements",get:function(){return this.actors.filter(function(t){return t instanceof e.ScreenElement})}},{key:"on",value:function(e,t){E(U(w.prototype),"on",this).call(this,e,t)}},{key:"once",value:function(e,t){E(U(w.prototype),"once",this).call(this,e,t)}},{key:"off",value:function(e,t){E(U(w.prototype),"off",this).call(this,e,t)}},{key:"onInitialize",value:function(e){}},{key:"onActivate",value:function(e,t){}},{key:"onDeactivate",value:function(e,t){}},{key:"onPreUpdate",value:function(e,t){}},{key:"onPostUpdate",value:function(e,t){}},{key:"onPreDraw",value:function(e,t){}},{key:"onPostDraw",value:function(e,t){}},{key:"_initializeChildren",value:function(){var e,t=_(this.actors);try{for(t.s();!(e=t.n()).done;){e.value._initialize(this.engine)}}catch(r){t.e(r)}finally{t.f()}}},{key:"isInitialized",get:function(){return this._isInitialized}},{key:"_initialize",value:function(e){this.isInitialized||(this.engine=e,this.camera&&(this.camera.x=e.halfDrawWidth,this.camera.y=e.halfDrawHeight),g.Flags.isEnabled(g.Legacy.LegacyDrawing)?this.world.add(new m.CanvasDrawingSystem):this.world.add(new v.GraphicsSystem),this.onInitialize.call(this,e),this._initializeChildren(),this._logger.debug("Scene.onInitialize",this,e),this.eventDispatcher.emit("initialize",new r.InitializeEvent(e,this)),this._isInitialized=!0)}},{key:"_activate",value:function(e,t){this._logger.debug("Scene.onActivate",this),this.onActivate(e,t)}},{key:"_deactivate",value:function(e,t){this._logger.debug("Scene.onDeactivate",this),this.onDeactivate(e,t)}},{key:"_preupdate",value:function(e,t){this.emit("preupdate",new r.PreUpdateEvent(e,t,this)),this.onPreUpdate(e,t)}},{key:"_postupdate",value:function(e,t){this.emit("postupdate",new r.PostUpdateEvent(e,t,this)),this.onPostUpdate(e,t)}},{key:"_predraw",value:function(e,t){this.emit("predraw",new r.PreDrawEvent(e,t,this)),this.onPreDraw(e,t)}},{key:"_postdraw",value:function(e,t){this.emit("postdraw",new r.PostDrawEvent(e,t,this)),this.onPostDraw(e,t)}},{key:"update",value:function(e,r){var n,i;for(this._preupdate(e,r),this.world.update(d.SystemType.Update,r),this.camera&&this.camera.update(e,r),n=0,i=this._cancelQueue.length;n<i;n++)this.removeTimer(this._cancelQueue[n]);this._cancelQueue.length=0;var o,a=_(this._timers);try{for(a.s();!(o=a.n()).done;){o.value.update(r)}}catch(m){a.e(m)}finally{a.f()}var s,l=_(this.world.entityManager.entities);try{for(l.s();!(s=l.n()).done;){s.value.update(e,r)}}catch(m){l.e(m)}finally{l.f()}for(n=0,i=this.actors.length;n<i;n++)this._bodies[n]=this.actors[n].body;if(this._collectActorStats(e),e.input.pointers.dispatchPointerEvents(),this._broadphase&&t.Physics.enabled){var u=Date.now();this._broadphase.update(this._bodies,r);for(var c=this._broadphase.broadphase(this._bodies,r,e.stats.currFrame),f=Date.now(),h=Date.now(),p=t.Physics.collisionPasses,y=r/p;p>0;)c=this._broadphase.narrowphase(c,e.stats.currFrame),c=this._broadphase.resolve(c,y,t.Physics.collisionResolutionStrategy),this._broadphase.runCollisionStartEnd(c),p--;var v=Date.now();e.stats.currFrame.physics.broadphase=f-u,e.stats.currFrame.physics.narrowphase=v-h}e.stats.currFrame.actors.killed=this._killQueue.length+this._triggerKillQueue.length,this._processKillQueue(this._killQueue,this.actors),this._processKillQueue(this._triggerKillQueue,this.triggers),this._postupdate(e,r)}},{key:"_processKillQueue",value:function(e,t){var r,n,i=this,o=_(e);try{for(o.s();!(n=o.n()).done;){var a=n.value;a.isKilled()&&(r=t.indexOf(a))>-1&&(t.splice(r,1),this.world.remove(a),a.children.forEach(function(e){return i.world.remove(e)}))}}catch(s){o.e(s)}finally{o.f()}e.length=0}},{key:"draw",value:function(e,t){this._predraw(e,t),this.world.update(d.SystemType.Draw,t),this._postdraw(e,t)}},{key:"debugDraw",value:function(e){this.emit("predebugdraw",new r.PreDebugDrawEvent(e,this)),this._broadphase.debugDraw(e,20),this.emit("postdebugdraw",new r.PostDebugDrawEvent(e,this))}},{key:"contains",value:function(e){return this.actors.indexOf(e)>-1}},{key:"add",value:function(e){var t=this;this.world.add(e),e instanceof l.Actor&&e.unkill(),e instanceof l.Actor?c.contains(this.actors,e)||(this._broadphase.track(e.body),e.scene=this,e instanceof h.Trigger?this.triggers.push(e):this.actors.push(e),e.children.forEach(function(e){return t.add(e)}),e.childrenAdded$.register({notify:function(e){t.add(e)}}),e.childrenRemoved$.register({notify:function(e){t.remove(e)}})):e instanceof i.Timer?c.contains(this._timers,e)||this.addTimer(e):e instanceof a.TileMap&&(c.contains(this.tileMaps,e)||this.addTileMap(e))}},{key:"remove",value:function(e){if(this.world.remove(e),e instanceof l.Actor){if(!c.contains(this.actors,e))return;this._broadphase.untrack(e.body),e instanceof h.Trigger?this._triggerKillQueue.push(e):(e.isKilled()||e.kill(),this._killQueue.push(e))}e instanceof i.Timer&&this.removeTimer(e),e instanceof a.TileMap&&this.removeTileMap(e)}},{key:"addScreenElement",value:function(e){this.add(e)}},{key:"removeScreenElement",value:function(e){this.remove(e)}},{key:"addTileMap",value:function(e){this.tileMaps.push(e),this.world.add(e)}},{key:"removeTileMap",value:function(e){var t=this.tileMaps.indexOf(e);t>-1&&(this.tileMaps.splice(t,1),this.world.remove(e))}},{key:"addTimer",value:function(e){return this._timers.push(e),e.scene=this,e}},{key:"removeTimer",value:function(e){var t=this._timers.indexOf(e);return-1!==t&&this._timers.splice(t,1),e}},{key:"cancelTimer",value:function(e){return this._cancelQueue.push(e),e}},{key:"isTimerActive",value:function(e){return this._timers.indexOf(e)>-1&&!e.complete}},{key:"isCurrentScene",value:function(){return!!this.engine&&this.engine.currentScene===this}},{key:"_collectActorStats",value:function(e){var t,r=_(this.screenElements);try{for(r.s();!(t=r.n()).done;){t.value;e.stats.currFrame.actors.ui++}}catch(u){r.e(u)}finally{r.f()}var n,i=_(this.actors);try{for(i.s();!(n=i.n()).done;){var o=n.value;e.stats.currFrame.actors.alive++;var a,s=_(o.children);try{for(s.s();!(a=s.n()).done;){var l=a.value;f.isScreenElement(l)?e.stats.currFrame.actors.ui++:e.stats.currFrame.actors.alive++}}catch(u){s.e(u)}finally{s.f()}}}catch(u){i.e(u)}finally{i.f()}}}]),w}();exports.Scene=z,R([(0,p.obsolete)({message:"Will be removed in excalibur v0.26.0",alternateMethod:"ScreenElements now are normal actors with a Transform Coordinate Plane of Screen"})],z.prototype,"screenElements",null),R([(0,p.obsolete)({message:"Will be removed in excalibur v0.26.0",alternateMethod:"Use Scene.add"})],z.prototype,"addScreenElement",null),R([(0,p.obsolete)({message:"Will be removed in excalibur v0.26.0",alternateMethod:"Use Scene.remove"})],z.prototype,"removeScreenElement",null),R([(0,p.obsolete)({message:"Will be removed in excalibur v0.26.0",alternateMethod:"Use Scene.add"})],z.prototype,"addTileMap",null),R([(0,p.obsolete)({message:"Will be removed in excalibur v0.26.0",alternateMethod:"Use Scene.remove"})],z.prototype,"removeTileMap",null);
},{"./ScreenElement":"PDm1","./Physics":"uSEN","./Events":"XySq","./Util/Log":"p1Gn","./Timer":"y7ZJ","./Collision/DynamicTreeCollisionBroadphase":"O6gl","./TileMap":"QP5n","./Camera":"pAjs","./Actor":"vmFf","./Class":"yTUi","./Util/Util":"Kkda","./Util/Actors":"UUno","./Trigger":"NgAR","./EntityComponentSystem/System":"wTMU","./Util/Decorators":"kQDE","./EntityComponentSystem/World":"OWLL","./Graphics/GraphicsSystem":"Jytr","./Drawing/CanvasDrawingSystem":"Um1p","./Flags":"JzY1"}],"cjjJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ColorBlindCorrector=exports.ColorBlindness=void 0;var t,e=require("./../Util/Log");function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function a(t,e,r){return e&&i(t.prototype,e),r&&i(t,r),t}exports.ColorBlindness=t,function(t){t[t.Protanope=0]="Protanope",t[t.Deuteranope=1]="Deuteranope",t[t.Tritanope=2]="Tritanope"}(t||(exports.ColorBlindness=t={}));var o=function(){function i(a){var o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.Protanope;r(this,i),this.engine=a,this.simulate=o,this.colorMode=s,this._vertexShader="attribute vec2 a_position;attribute vec2 a_texCoord;uniform vec2 u_resolution;varying vec2 v_texCoord;void main() {vec2 zeroToOne = a_position / u_resolution;vec2 zeroToTwo = zeroToOne * 2.0;vec2 clipSpace = zeroToTwo - 1.0;gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);v_texCoord = a_texCoord;}",this._fragmentShader="precision mediump float;uniform sampler2D u_image;varying vec2 v_texCoord;void main() {vec4 o =  texture2D(u_image, v_texCoord);float L = (17.8824 * o.r) + (43.5161 * o.g) + (4.11935 * o.b);float M = (3.45565 * o.r) + (27.1554 * o.g) + (3.86714 * o.b);float S = (0.0299566 * o.r) + (0.184309 * o.g) + (1.46709 * o.b);//MODE CODE//vec4 error;error.r = (0.0809444479 * l) + (-0.130504409 * m) + (0.116721066 * s);error.g = (-0.0102485335 * l) + (0.0540193266 * m) + (-0.113614708 * s);error.b = (-0.000365296938 * l) + (-0.00412161469 * m) + (0.693511405 * s);error.a = 1.0;vec4 diff = o - error;vec4 correction;correction.r = 0.0;correction.g =  (diff.r * 0.7) + (diff.g * 1.0);correction.b =  (diff.r * 0.7) + (diff.b * 1.0);correction = o + correction;correction.a = o.a;//SIMULATE//}",this._internalCanvas=document.createElement("canvas"),this._internalCanvas.width=a.drawWidth,this._internalCanvas.height=a.drawHeight,this._gl=this._internalCanvas.getContext("webgl",{preserveDrawingBuffer:!0}),this._program=this._gl.createProgram();var l=this._getShader("Fragment",this._getFragmentShaderByMode(s)),_=this._getShader("Vertex",this._vertexShader);this._gl.attachShader(this._program,_),this._gl.attachShader(this._program,l),this._gl.linkProgram(this._program),this._gl.getProgramParameter(this._program,this._gl.LINK_STATUS)||e.Logger.getInstance().error("Unable to link shader program!"),this._gl.useProgram(this._program)}return a(i,[{key:"_getFragmentShaderByMode",value:function(e){var r="";return e===t.Protanope?r="float l = 0.0 * L + 2.02344 * M + -2.52581 * S;float m = 0.0 * L + 1.0 * M + 0.0 * S;float s = 0.0 * L + 0.0 * M + 1.0 * S;":e===t.Deuteranope?r="float l = 1.0 * L + 0.0 * M + 0.0 * S;float m = 0.494207 * L + 0.0 * M + 1.24827 * S;float s = 0.0 * L + 0.0 * M + 1.0 * S;":e===t.Tritanope&&(r="float l = 1.0 * L + 0.0 * M + 0.0 * S;float m = 0.0 * L + 1.0 * M + 0.0 * S;float s = -0.395913 * L + 0.801109 * M + 0.0 * S;"),this.simulate?this._fragmentShader=this._fragmentShader.replace("//SIMULATE//","gl_FragColor = error.rgba;"):this._fragmentShader=this._fragmentShader.replace("//SIMULATE//","gl_FragColor = correction.rgba;"),this._fragmentShader.replace("//MODE CODE//",r)}},{key:"_setRectangle",value:function(t,e,r,i){var a=t,o=t+r,s=e,l=e+i;this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array([a,s,o,s,a,l,a,l,o,s,o,l]),this._gl.STATIC_DRAW)}},{key:"_getShader",value:function(t,r){var i;return"Fragment"===t?i=this._gl.createShader(this._gl.FRAGMENT_SHADER):"Vertex"===t?i=this._gl.createShader(this._gl.VERTEX_SHADER):e.Logger.getInstance().error("Error unknown shader type",t),this._gl.shaderSource(i,r),this._gl.compileShader(i),this._gl.getShaderParameter(i,this._gl.COMPILE_STATUS)?i:(e.Logger.getInstance().error("Unable to compile shader!",this._gl.getShaderInfoLog(i)),null)}},{key:"process",value:function(t,e){var r=this._gl.getAttribLocation(this._program,"a_position"),i=this._gl.getAttribLocation(this._program,"a_texCoord"),a=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,a),this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),this._gl.STATIC_DRAW),this._gl.enableVertexAttribArray(i),this._gl.vertexAttribPointer(i,2,this._gl.FLOAT,!1,0,0);var o=this._gl.createTexture();this._gl.bindTexture(this._gl.TEXTURE_2D,o),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,1),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,this._gl.RGBA,this._gl.UNSIGNED_BYTE,t);var s=this._gl.getUniformLocation(this._program,"u_resolution");this._gl.uniform2f(s,this._internalCanvas.width,this._internalCanvas.height);var l=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,l),this._gl.enableVertexAttribArray(r),this._gl.vertexAttribPointer(r,2,this._gl.FLOAT,!1,0,0),this._setRectangle(0,0,t.width,t.height),this._gl.drawArrays(this._gl.TRIANGLES,0,6);var _=new Uint8Array(t.width*t.height*4);this._gl.readPixels(0,0,t.width,t.height,this._gl.RGBA,this._gl.UNSIGNED_BYTE,_),t.data.set(_),e.putImageData(t,0,0)}}]),i}();exports.ColorBlindCorrector=o;
},{"./../Util/Log":"p1Gn"}],"mhi9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./ColorBlindCorrector");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(r in exports&&exports[r]===e[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}}))});var r=require("./PostProcessor");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===r[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return r[e]}}))});
},{"./ColorBlindCorrector":"cjjJ","./PostProcessor":"FNCP"}],"Y6e3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ColorBlindFlags=void 0;var e=require("./PostProcessing/Index");function n(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function r(e,n){for(var r=0;r<n.length;r++){var o=n[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function o(e,n,o){return n&&r(e.prototype,n),o&&r(e,o),e}var t=function(){function r(e){n(this,r),this._engine=e}return o(r,[{key:"correct",value:function(n){this._engine.postProcessors.push(new e.ColorBlindCorrector(this._engine,!1,n))}},{key:"simulate",value:function(n){this._engine.postProcessors.push(new e.ColorBlindCorrector(this._engine,!0,n))}}]),r}();exports.ColorBlindFlags=t;
},{"./PostProcessing/Index":"mhi9"}],"haDW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PhysicsStats=exports.FrameStats=exports.Debug=void 0;var t=require("./DebugFlags");function s(t,s){for(var i=0;i<s.length;i++){var e=s[i];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function i(t,i,e){return i&&s(t.prototype,i),e&&s(t,e),t}function e(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}var a=function s(i){e(this,s),this.stats={currFrame:new r,prevFrame:new r},this._engine=i,this.colorBlindMode=new t.ColorBlindFlags(this._engine)};exports.Debug=a;var r=function(){function t(){e(this,t),this._id=0,this._delta=0,this._fps=0,this._actorStats={alive:0,killed:0,ui:0,get remaining(){return this.alive-this.killed},get total(){return this.remaining+this.ui}},this._durationStats={update:0,draw:0,get total(){return this.update+this.draw}},this._physicsStats=new n,this._graphicsStats={drawCalls:0,drawnImages:0}}return i(t,[{key:"reset",value:function(t){t?(this.id=t.id,this.delta=t.delta,this.fps=t.fps,this.actors.alive=t.actors.alive,this.actors.killed=t.actors.killed,this.actors.ui=t.actors.ui,this.duration.update=t.duration.update,this.duration.draw=t.duration.draw,this._physicsStats.reset(t.physics),this.graphics.drawCalls=t.graphics.drawCalls,this.graphics.drawnImages=t.graphics.drawnImages):(this.id=this.delta=this.fps=0,this.actors.alive=this.actors.killed=this.actors.ui=0,this.duration.update=this.duration.draw=0,this._physicsStats.reset(),this.graphics.drawnImages=this.graphics.drawCalls=0)}},{key:"clone",value:function(){var s=new t;return s.reset(this),s}},{key:"id",get:function(){return this._id},set:function(t){this._id=t}},{key:"delta",get:function(){return this._delta},set:function(t){this._delta=t}},{key:"fps",get:function(){return this._fps},set:function(t){this._fps=t}},{key:"actors",get:function(){return this._actorStats}},{key:"duration",get:function(){return this._durationStats}},{key:"physics",get:function(){return this._physicsStats}},{key:"graphics",get:function(){return this._graphicsStats}}]),t}();exports.FrameStats=r;var n=function(){function t(){e(this,t),this._pairs=0,this._collisions=0,this._collidersHash={},this._fastBodies=0,this._fastBodyCollisions=0,this._broadphase=0,this._narrowphase=0}return i(t,[{key:"reset",value:function(t){t?(this.pairs=t.pairs,this.collisions=t.collisions,this.collidersHash=t.collidersHash,this.fastBodies=t.fastBodies,this.fastBodyCollisions=t.fastBodyCollisions,this.broadphase=t.broadphase,this.narrowphase=t.narrowphase):(this.pairs=this.collisions=this.fastBodies=0,this.fastBodyCollisions=this.broadphase=this.narrowphase=0,this.collidersHash={})}},{key:"clone",value:function(){var s=new t;return s.reset(this),s}},{key:"pairs",get:function(){return this._pairs},set:function(t){this._pairs=t}},{key:"collisions",get:function(){return this._collisions},set:function(t){this._collisions=t}},{key:"collidersHash",get:function(){return this._collidersHash},set:function(t){this._collidersHash=t}},{key:"fastBodies",get:function(){return this._fastBodies},set:function(t){this._fastBodies=t}},{key:"fastBodyCollisions",get:function(){return this._fastBodyCollisions},set:function(t){this._fastBodyCollisions=t}},{key:"broadphase",get:function(){return this._broadphase},set:function(t){this._broadphase=t}},{key:"narrowphase",get:function(){return this._narrowphase},set:function(t){this._narrowphase=t}}]),t}();exports.PhysicsStats=n;
},{"./DebugFlags":"Y6e3"}],"LjC7":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Axes=exports.Buttons=exports.Gamepad=exports.Gamepads=void 0;var t=require("./../Class"),e=require("../Events");function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function o(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),t}function r(t,e,n){return(r="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=s(t,e);if(i){var a=Object.getOwnPropertyDescriptor(i,e);return a.get?a.get.call(n):a.value}})(t,e,n||t)}function s(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=d(t)););return t}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=h();return function(){var n,i=d(t);if(e){var a=d(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return p(this,n)}}function p(t,e){return!e||"object"!==n(e)&&"function"!=typeof e?l(t):e}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var v=function(a){u(c,t.Class);var s=f(c);function c(){var t;return i(this,c),(t=s.call(this)).enabled=!1,t.supported=!!navigator.getGamepads,t._gamePadTimeStamps=[0,0,0,0],t._oldPads=[],t._pads=[],t._initSuccess=!1,t._navigator=navigator,t._minimumConfiguration=null,t}return o(c,[{key:"init",value:function(){this.supported&&(this._initSuccess||(this._oldPads=this._clonePads(this._navigator.getGamepads()),this._oldPads.length&&this._oldPads[0]&&(this._initSuccess=!0)))}},{key:"setMinimumGamepadConfiguration",value:function(t){this._enableAndUpdate(),this._minimumConfiguration=t}},{key:"_enableAndUpdate",value:function(){this.enabled||(this.enabled=!0,this.update())}},{key:"_isGamepadValid",value:function(t){if(!this._minimumConfiguration)return!0;if(!t)return!1;var e=t.axes.filter(function(t){return void 0!==n(t)}).length,i=t.buttons.filter(function(t){return void 0!==n(t)}).length;return e>=this._minimumConfiguration.axis&&i>=this._minimumConfiguration.buttons&&t.connected}},{key:"on",value:function(t,e){this._enableAndUpdate(),r(d(c.prototype),"on",this).call(this,t,e)}},{key:"off",value:function(t,e){this._enableAndUpdate(),r(d(c.prototype),"off",this).call(this,t,e)}},{key:"update",value:function(){if(this.enabled&&this.supported){this.init();for(var t=this._navigator.getGamepads(),n=0;n<t.length;n++)if(t[n]){if(!this.at(n).connected&&this._isGamepadValid(t[n])&&this.eventDispatcher.emit("connect",new e.GamepadConnectEvent(n,this.at(n))),this.at(n).connected=!0,!t[n].timestamp||t[n].timestamp!==this._gamePadTimeStamps[n]){this._gamePadTimeStamps[n]=t[n].timestamp,this.at(n).navigatorGamepad=t[n];var i=void 0,a=void 0,o=void 0,r=void 0,s=void 0;for(i in m)"number"==typeof(a=m[i])&&t[n].buttons[a]&&(s=t[n].buttons[a].value)!==this._oldPads[n].getButton(a)&&(t[n].buttons[a].pressed?(this.at(n).updateButton(a,s),this.at(n).eventDispatcher.emit("button",new e.GamepadButtonEvent(a,s,this.at(n)))):this.at(n).updateButton(a,0));for(o in g)"number"==typeof(r=g[o])&&(s=t[n].axes[r])!==this._oldPads[n].getAxes(r)&&(this.at(n).updateAxes(r,s),this.at(n).eventDispatcher.emit("axis",new e.GamepadAxisEvent(r,s,this.at(n))));this._oldPads[n]=this._clonePad(t[n])}}else{var u=this.at(n);u.connected&&this.eventDispatcher.emit("disconnect",new e.GamepadDisconnectEvent(n,u)),u.connected=!1}}}},{key:"at",value:function(t){if(this._enableAndUpdate(),t>=this._pads.length)for(var e=this._pads.length-1,n=t;e<n;e++)this._pads.push(new _),this._oldPads.push(new _);return this._pads[t]}},{key:"getValidGamepads",value:function(){this._enableAndUpdate();for(var t=[],e=0;e<this._pads.length;e++)this._isGamepadValid(this.at(e).navigatorGamepad)&&this.at(e).connected&&t.push(this.at(e));return t}},{key:"count",value:function(){return this._pads.filter(function(t){return t.connected}).length}},{key:"_clonePads",value:function(t){for(var e=[],n=0,i=t.length;n<i;n++)e.push(this._clonePad(t[n]));return e}},{key:"_clonePad",value:function(t){var e,n,i=new _;if(!t)return i;for(e=0,n=t.buttons.length;e<n;e++)t.buttons[e]&&i.updateButton(e,t.buttons[e].value);for(e=0,n=t.axes.length;e<n;e++)i.updateAxes(e,t.axes[e]);return i}}]),c}();exports.Gamepads=v,v.MinAxisMoveThreshold=.05;var m,g,_=function(e){u(a,t.Class);var n=f(a);function a(){var t;i(this,a),(t=n.call(this)).connected=!1,t._buttons=new Array(16),t._axes=new Array(4);for(var e=0;e<t._buttons.length;e++)t._buttons[e]=0;for(var o=0;o<t._axes.length;o++)t._axes[o]=0;return t}return o(a,[{key:"isButtonPressed",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this._buttons[t]>=e}},{key:"getButton",value:function(t){return this._buttons[t]}},{key:"getAxes",value:function(t){var e=this._axes[t];return Math.abs(e)<v.MinAxisMoveThreshold?0:e}},{key:"updateButton",value:function(t,e){this._buttons[t]=e}},{key:"updateAxes",value:function(t,e){this._axes[t]=e}}]),a}();exports.Gamepad=_,exports.Buttons=m,function(t){t[t.Face1=0]="Face1",t[t.Face2=1]="Face2",t[t.Face3=2]="Face3",t[t.Face4=3]="Face4",t[t.LeftBumper=4]="LeftBumper",t[t.RightBumper=5]="RightBumper",t[t.LeftTrigger=6]="LeftTrigger",t[t.RightTrigger=7]="RightTrigger",t[t.Select=8]="Select",t[t.Start=9]="Start",t[t.LeftStick=10]="LeftStick",t[t.RightStick=11]="RightStick",t[t.DpadUp=12]="DpadUp",t[t.DpadDown=13]="DpadDown",t[t.DpadLeft=14]="DpadLeft",t[t.DpadRight=15]="DpadRight"}(m||(exports.Buttons=m={})),exports.Axes=g,function(t){t[t.LeftStickX=0]="LeftStickX",t[t.LeftStickY=1]="LeftStickY",t[t.RightStickX=2]="RightStickX",t[t.RightStickY=3]="RightStickY"}(g||(exports.Axes=g={}));
},{"./../Class":"yTUi","../Events":"XySq"}],"MOJH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Pointer=exports.PointerScope=exports.PointerType=void 0;var t,e,r=require("../Algebra"),n=require("../Class"),o=c(require("../Util/Actors")),i=require("../Util/Util");function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}function c(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var i=n?Object.getOwnPropertyDescriptor(t,o):null;i&&(i.get||i.set)?Object.defineProperty(r,o,i):r[o]=t[o]}return r.default=t,e&&e.set(t,r),r}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t){return y(t)||p(t)||f(t)||l()}function l(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function f(t,e){if(t){if("string"==typeof t)return h(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(t,e):void 0}}function p(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function y(t){if(Array.isArray(t))return h(t)}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function P(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _(t,e,r){return e&&d(t.prototype,e),r&&d(t,r),t}function w(t,e,r){return(w="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=v(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(r):o.value}})(t,e,r||t)}function v(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=A(t)););return t}function g(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&b(t,e)}function b(t,e){return(b=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function m(t){var e=D();return function(){var r,n=A(t);if(e){var o=A(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return O(this,r)}}function O(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?U(t):e}function U(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function D(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function A(t){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}exports.PointerType=t,function(t){t.Touch="Touch",t.Mouse="Mouse",t.Pen="Pen",t.Unknown="Unknown"}(t||(exports.PointerType=t={})),exports.PointerScope=e,function(t){t.Canvas="Canvas",t.Document="Document"}(e||(exports.PointerScope=e={}));var k=function(t){g(s,n.Class);var e=m(s);function s(){var t;return P(this,s),(t=e.call(this)).id=s._MAX_ID++,t._isDown=!1,t._wasDown=!1,t._actorsUnderPointer={length:0},t._actors=[],t._actorsLastFrame=[],t._actorsNoLongerUnderPointer=[],t.lastPagePos=null,t.lastScreenPos=null,t.lastWorldPos=null,t.dragTarget=null,t.on("move",t._onPointerMove),t.on("down",t._onPointerDown),t.on("up",t._onPointerUp),t}return _(s,[{key:"isDragging",get:function(){return this._isDown}},{key:"isDragStart",get:function(){return!this._wasDown&&this._isDown}},{key:"isDragEnd",get:function(){return this._wasDown&&!this._isDown}},{key:"hasActorsUnderPointer",get:function(){return!!this._actorsUnderPointer.length}},{key:"on",value:function(t,e){w(A(s.prototype),"on",this).call(this,t,e)}},{key:"once",value:function(t,e){w(A(s.prototype),"once",this).call(this,t,e)}},{key:"off",value:function(t,e){w(A(s.prototype),"off",this).call(this,t,e)}},{key:"update",value:function(){this._wasDown&&!this._isDown?this._wasDown=!1:!this._wasDown&&this._isDown&&(this._wasDown=!0),this._actorsLastFrame=u(this._actors),this._actorsNoLongerUnderPointer=[]}},{key:"addActorUnderPointer",value:function(t){this.isActorAliveUnderPointer(t)||(this._actorsUnderPointer[t.id]=t,this._actorsUnderPointer.length+=1,this._actors.push(t)),this._actors.sort(function(t,e){return t.z===e.z?t.id-e.id:t.z-e.z})}},{key:"removeActorUnderPointer",value:function(t){this.isActorAliveUnderPointer(t)&&(delete this._actorsUnderPointer[t.id],this._actorsUnderPointer.length-=1,(0,i.removeItemFromArray)(t,this._actors),this._actorsNoLongerUnderPointer.push(t))}},{key:"getActorsUnderPointer",value:function(){return this._actors}},{key:"getActorsUnderPointerLastFrame",value:function(){return this._actorsLastFrame}},{key:"getActorsForEvents",value:function(){return this._actors.concat(this._actorsLastFrame).filter(function(t,e,r){return r.indexOf(t)===e})}},{key:"checkActorUnderPointer",value:function(t){return!!this.lastWorldPos&&t.contains(this.lastWorldPos.x,this.lastWorldPos.y,!o.isScreenElement(t))}},{key:"wasActorUnderPointer",value:function(t){return this._actorsLastFrame.indexOf(t)>-1}},{key:"isActorAliveUnderPointer",value:function(t){return!(t.isKilled()||!t.scene||!this._actorsUnderPointer.hasOwnProperty(t.id.toString()))}},{key:"_onPointerMove",value:function(t){this.lastPagePos=new r.Vector(t.pagePos.x,t.pagePos.y),this.lastScreenPos=new r.Vector(t.screenPos.x,t.screenPos.y),this.lastWorldPos=new r.Vector(t.worldPos.x,t.worldPos.y)}},{key:"_onPointerDown",value:function(t){this.lastPagePos=new r.Vector(t.pagePos.x,t.pagePos.y),this.lastScreenPos=new r.Vector(t.screenPos.x,t.screenPos.y),this.lastWorldPos=new r.Vector(t.worldPos.x,t.worldPos.y),this._isDown=!0}},{key:"_onPointerUp",value:function(t){this._isDown=!1,this.dragTarget=null}}]),s}();exports.Pointer=k,k._MAX_ID=0;
},{"../Algebra":"NGcQ","../Class":"yTUi","../Util/Actors":"UUno","../Util/Util":"Kkda"}],"LGsV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createPointerEventByName=w,exports.WheelEvent=exports.PointerCancelEvent=exports.PointerLeaveEvent=exports.PointerEnterEvent=exports.PointerMoveEvent=exports.PointerDownEvent=exports.PointerUpEvent=exports.PointerDragEvent=exports.PointerEventFactory=exports.PointerEvent=exports.WheelDeltaMode=exports.PointerButton=exports.NativePointerButton=void 0;var t,e,n,r=require("../Events");function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),t}function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function p(t){var e=l();return function(){var n,r=h(t);if(e){var o=h(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return v(this,n)}}function v(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?f(t):e}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}exports.NativePointerButton=t,function(t){t[t.NoButton=-1]="NoButton",t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right",t[t.Unknown=3]="Unknown"}(t||(exports.NativePointerButton=t={})),exports.PointerButton=e,function(t){t.Left="Left",t.Middle="Middle",t.Right="Right",t.Unknown="Unknown",t.NoButton="NoButton"}(e||(exports.PointerButton=e={})),exports.WheelDeltaMode=n,function(t){t.Pixel="Pixel",t.Line="Line",t.Page="Page"}(n||(exports.WheelDeltaMode=n={}));var y=function(t){c(n,r.GameEvent);var e=p(n);function n(t,r,o,a,u,c){var s;return i(this,n),(s=e.call(this)).coordinates=t,s.pointer=r,s.index=o,s.pointerType=a,s.button=u,s.ev=c,s}return u(n,[{key:"name",get:function(){return this._name}},{key:"worldPos",get:function(){return this.coordinates.worldPos.clone()}},{key:"pagePos",get:function(){return this.coordinates.pagePos.clone()}},{key:"screenPos",get:function(){return this.coordinates.screenPos.clone()}},{key:"pos",get:function(){return this.coordinates.worldPos.clone()}},{key:"propagate",value:function(t){this.doAction(t),this.bubbles&&t.parent&&this.propagate(t.parent)}},{key:"doAction",value:function(t){t&&(this._onActionStart(t),t.emit(this._name,this),this._onActionEnd(t))}},{key:"_onActionStart",value:function(t){}},{key:"_onActionEnd",value:function(t){}}]),n}();exports.PointerEvent=y;var d=function(){function t(e){i(this,t),this._pointerEventType=e}return u(t,[{key:"create",value:function(t,e,n,r,o,i){return new this._pointerEventType(t,e,n,r,o,i)}}]),t}();exports.PointerEventFactory=d;var P=function(t){c(n,y);var e=p(n);function n(){return i(this,n),e.apply(this,arguments)}return n}();exports.PointerDragEvent=P;var g=function(t){c(n,y);var e=p(n);function n(){var t;return i(this,n),(t=e.apply(this,arguments))._name="pointerup",t}return u(n,[{key:"_onActionEnd",value:function(t){this.pointer.isDragEnd&&t.capturePointer.captureDragEvents&&t.eventDispatcher.emit("pointerdragend",this)}}]),n}();exports.PointerUpEvent=g;var E=function(t){c(n,y);var e=p(n);function n(){var t;return i(this,n),(t=e.apply(this,arguments))._name="pointerdown",t}return u(n,[{key:"_onActionEnd",value:function(t){this.pointer.isDragStart&&t.capturePointer.captureDragEvents&&t.eventDispatcher.emit("pointerdragstart",this)}}]),n}();exports.PointerDownEvent=E;var x=function(t){c(n,y);var e=p(n);function n(){var t;return i(this,n),(t=e.apply(this,arguments))._name="pointermove",t}return u(n,[{key:"propagate",value:function(t){this.pointer.isActorAliveUnderPointer(t)&&(this.doAction(t),this.bubbles&&t.parent&&this.propagate(t.parent))}},{key:"_onActionStart",value:function(t){t.capturePointer.captureMoveEvents&&this.pointer.isDragging&&t.capturePointer.captureDragEvents&&t.eventDispatcher.emit("pointerdragmove",this)}}]),n}();exports.PointerMoveEvent=x;var b=function(t){c(n,y);var e=p(n);function n(){var t;return i(this,n),(t=e.apply(this,arguments))._name="pointerenter",t}return u(n,[{key:"_onActionStart",value:function(t){t.capturePointer.captureMoveEvents}},{key:"_onActionEnd",value:function(t){this.pointer.isDragging&&t.capturePointer.captureDragEvents&&t.eventDispatcher.emit("pointerdragenter",this)}}]),n}();exports.PointerEnterEvent=b;var m=function(t){c(n,y);var e=p(n);function n(){var t;return i(this,n),(t=e.apply(this,arguments))._name="pointerleave",t}return u(n,[{key:"_onActionStart",value:function(t){t.capturePointer.captureMoveEvents}},{key:"_onActionEnd",value:function(t){this.pointer.isDragging&&t.capturePointer.captureDragEvents&&t.eventDispatcher.emit("pointerdragleave",this)}}]),n}();exports.PointerLeaveEvent=m;var _=function(t){c(n,y);var e=p(n);function n(){var t;return i(this,n),(t=e.apply(this,arguments))._name="pointercancel",t}return n}();exports.PointerCancelEvent=_;var k=function(t){c(n,r.GameEvent);var e=p(n);function n(t,r,o,a,u,c,s,p,v,f,l,h){var y;return i(this,n),(y=e.call(this)).x=t,y.y=r,y.pageX=o,y.pageY=a,y.screenX=u,y.screenY=c,y.index=s,y.deltaX=p,y.deltaY=v,y.deltaZ=f,y.deltaMode=l,y.ev=h,y}return n}();function w(t,e,n,r,o,i,a){var u;switch(t){case"up":u=new d(g);break;case"down":u=new d(E);break;case"move":u=new d(x);break;case"cancel":u=new d(_);break;case"enter":u=new d(b);break;case"leave":u=new d(m)}return u.create(e,n,r,o,i,a)}exports.WheelEvent=k;
},{"../Events":"XySq"}],"P0Od":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Pointers=void 0;var e=require("../Class"),t=require("../Engine"),n=require("./Pointer"),r=require("./PointerEvents"),o=l(require("../Util/Util")),i=require("../Algebra"),a=require("../Traits/CapturePointer");function s(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}function l(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=s();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=h(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function h(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),e}function _(e,t,n){return(_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=y(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function y(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=M(e)););return e}function P(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=m();return function(){var n,r=M(e);if(t){var o=M(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return w(this,n)}}function w(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?E(e):t}function E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function M(e){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var T=-.025,k=function(s){P(u,e.Class);var l=b(u);function u(e){var t;return v(this,u),(t=l.call(this))._pointerDown=[],t._pointerUp=[],t._pointerMove=[],t._pointerCancel=[],t._wheel=[],t._pointers=[],t._activePointers=[],t._engine=e,t._pointers.push(new n.Pointer),t._activePointers=[-1],t.primary=t._pointers[0],t}return f(u,[{key:"on",value:function(e,t){_(M(u.prototype),"on",this).call(this,e,t)}},{key:"init",value:function(e){(e=e||this._engine.canvas).addEventListener("touchstart",this._handleTouchEvent("down",this._pointerDown)),e.addEventListener("touchend",this._handleTouchEvent("up",this._pointerUp)),e.addEventListener("touchmove",this._handleTouchEvent("move",this._pointerMove)),e.addEventListener("touchcancel",this._handleTouchEvent("cancel",this._pointerCancel)),window.PointerEvent?(this._engine.canvas.style.touchAction="none",e.addEventListener("pointerdown",this._handlePointerEvent("down",this._pointerDown)),e.addEventListener("pointerup",this._handlePointerEvent("up",this._pointerUp)),e.addEventListener("pointermove",this._handlePointerEvent("move",this._pointerMove)),e.addEventListener("pointercancel",this._handlePointerEvent("cancel",this._pointerCancel))):window.MSPointerEvent?(this._engine.canvas.style.msTouchAction="none",e.addEventListener("MSPointerDown",this._handlePointerEvent("down",this._pointerDown)),e.addEventListener("MSPointerUp",this._handlePointerEvent("up",this._pointerUp)),e.addEventListener("MSPointerMove",this._handlePointerEvent("move",this._pointerMove)),e.addEventListener("MSPointerCancel",this._handlePointerEvent("cancel",this._pointerCancel))):(e.addEventListener("mousedown",this._handleMouseEvent("down",this._pointerDown)),e.addEventListener("mouseup",this._handleMouseEvent("up",this._pointerUp)),e.addEventListener("mousemove",this._handleMouseEvent("move",this._pointerMove)));var n={passive:!(this._engine.pageScrollPreventionMode===t.ScrollPreventionMode.All||this._engine.pageScrollPreventionMode===t.ScrollPreventionMode.Canvas)};"onwheel"in document.createElement("div")?e.addEventListener("wheel",this._handleWheelEvent("wheel",this._wheel),n):void 0!==document.onmousewheel?e.addEventListener("mousewheel",this._handleWheelEvent("wheel",this._wheel),n):e.addEventListener("MozMousePixelScroll",this._handleWheelEvent("wheel",this._wheel),n)}},{key:"triggerEvent",value:function(e,t){var n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.NativePointerButton.Left,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse",l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=0,h=0;t instanceof i.GlobalCoordinates?(u=t.pagePos.x,h=t.pagePos.y,n=t):(u=t.x,h=t.y,n=new i.GlobalCoordinates(t.clone(),t.clone(),t.clone()));var p={pageX:u,pageY:h,pointerId:l,pointerType:s,button:o,preventDefault:function(){}};switch(e){case"move":this._handlePointerEvent(e,this._pointerMove,n)(p);break;case"down":this._handlePointerEvent(e,this._pointerDown,n)(p);break;case"up":this._handlePointerEvent(e,this._pointerUp,n)(p);break;case"cancel":this._handlePointerEvent(e,this._pointerCancel,n)(p)}var v,d=c(this._engine.currentScene.actors);try{for(d.s();!(v=d.n()).done;){var f=v.value,_=f.traits.filter(function(e){return e instanceof a.CapturePointer})[0];_&&_.update(f,this._engine,1)}}catch(y){d.e(y)}finally{d.f()}this.dispatchPointerEvents(),this.update()}},{key:"update",value:function(){this._pointerUp.length=0,this._pointerDown.length=0,this._pointerMove.length=0,this._pointerCancel.length=0,this._wheel.length=0;for(var e=0;e<this._pointers.length;e++)this._pointers[e].update()}},{key:"at",value:function(e){if(e>=this._pointers.length)for(var t=this._pointers.length-1,r=e;t<r;t++)this._pointers.push(new n.Pointer),this._activePointers.push(-1);return this._pointers[e]}},{key:"count",value:function(){return this._pointers.length}},{key:"checkAndUpdateActorUnderPointer",value:function(e){var t,n=c(this._pointers);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.checkActorUnderPointer(e)?r.addActorUnderPointer(e):r.removeActorUnderPointer(e)}}catch(o){n.e(o)}finally{n.f()}}},{key:"_dispatchWithBubble",value:function(e){var t,n=c(e);try{for(n.s();!(t=n.n()).done;){var r,o=t.value,i=c(o.pointer.getActorsForEvents());try{for(i.s();!(r=i.n()).done;){var a=r.value;if(o.propagate(a),!o.bubbles)break}}catch(s){i.e(s)}finally{i.f()}}}catch(s){n.e(s)}finally{n.f()}}},{key:"_dispatchPointerLeaveEvents",value:function(){var e,t={},n=[],o=c(this._pointerMove);try{for(o.s();!(e=o.n()).done;){var a,s=e.value,l=c(s.pointer.getActorsForEvents());try{for(l.s();!(a=l.n()).done;){var u=a.value;if(!t[s.pointer.id+"+"+u.id]&&s.pointer.wasActorUnderPointer(u)&&!s.pointer.isActorAliveUnderPointer(u)){t[s.pointer.id+"+"+u.id]=s;var h=(0,r.createPointerEventByName)("leave",new i.GlobalCoordinates(s.worldPos,s.pagePos,s.screenPos),s.pointer,s.index,s.pointerType,s.button,s.ev);h.propagate(u),n.push(h)}}}catch(p){l.e(p)}finally{l.f()}}}catch(p){o.e(p)}finally{o.f()}return n}},{key:"_dispatchPointerEnterEvents",value:function(){var e,t={},n=[],o=c(this._pointerMove);try{for(o.s();!(e=o.n()).done;){var a,s=e.value,l=c(s.pointer.getActorsForEvents());try{for(l.s();!(a=l.n()).done;){var u=a.value;if(!t[s.pointer.id]&&!s.pointer.wasActorUnderPointer(u)&&s.pointer.isActorAliveUnderPointer(u)){t[s.pointer.id]=s;var h=(0,r.createPointerEventByName)("enter",new i.GlobalCoordinates(s.worldPos,s.pagePos,s.screenPos),s.pointer,s.index,s.pointerType,s.button,s.ev);h.propagate(u),n.push(h),s.pointer.isDragging&&(s.pointer.dragTarget=u)}}}catch(p){l.e(p)}finally{l.f()}}}catch(p){o.e(p)}finally{o.f()}return n}},{key:"dispatchPointerEvents",value:function(){this._dispatchWithBubble(this._pointerDown),this._dispatchWithBubble(this._pointerUp),this._dispatchWithBubble(this._pointerMove),this._dispatchPointerLeaveEvents(),this._dispatchPointerEnterEvents(),this._dispatchWithBubble(this._pointerCancel);var e,t=c(this._wheel);try{for(t.s();!(e=t.n()).done;){var n,r=e.value,o=c(this._pointers[r.index].getActorsUnderPointer());try{for(o.s();!(n=o.n()).done;){var i=n.value;if(this._propagateWheelPointerEvent(i,r),!r.bubbles)break}}catch(a){o.e(a)}finally{o.f()}}}catch(a){t.e(a)}finally{t.f()}}},{key:"_propagateWheelPointerEvent",value:function(e,t){e.emit("pointerwheel",t),t.bubbles&&e.parent&&this._propagateWheelPointerEvent(e.parent,t)}},{key:"_handleMouseEvent",value:function(e,t){var o=this;return function(a){a.preventDefault();var s=o.at(0),l=i.GlobalCoordinates.fromPagePosition(a.pageX,a.pageY,o._engine),u=(0,r.createPointerEventByName)(e,l,s,0,n.PointerType.Mouse,o._nativeButtonToPointerButton(a.button),a);t.push(u),s.eventDispatcher.emit(e,u)}}},{key:"_handleTouchEvent",value:function(e,t){var o=this;return function(a){a.preventDefault();for(var s=0,l=a.changedTouches.length;s<l;s++){var u=o._pointers.length>1?o._getPointerIndex(a.changedTouches[s].identifier):0;if(-1!==u){var c=o.at(u),h=i.GlobalCoordinates.fromPagePosition(a.changedTouches[s].pageX,a.changedTouches[s].pageY,o._engine),p=(0,r.createPointerEventByName)(e,h,c,u,n.PointerType.Touch,r.PointerButton.Unknown,a);t.push(p),c.eventDispatcher.emit(e,p),o._pointers.length>1&&("up"===e?o._activePointers[u]=-1:"down"===e&&(o._activePointers[u]=a.changedTouches[s].identifier))}}}}},{key:"_handlePointerEvent",value:function(e,t,n){var o=this;return function(a){a.preventDefault();var s=o._pointers.length>1?o._getPointerIndex(a.pointerId):0;if(-1!==s){var l=o.at(s),u=n||i.GlobalCoordinates.fromPagePosition(a.pageX,a.pageY,o._engine),c=(0,r.createPointerEventByName)(e,u,l,s,o._stringToPointerType(a.pointerType),o._nativeButtonToPointerButton(a.button),a);t.push(c),l.eventDispatcher.emit(e,c),o._pointers.length>1&&("up"===e?o._activePointers[s]=-1:"down"===e&&(o._activePointers[s]=a.pointerId))}}}},{key:"_handleWheelEvent",value:function(e,n){var o=this;return function(a){(o._engine.pageScrollPreventionMode===t.ScrollPreventionMode.All||o._engine.pageScrollPreventionMode===t.ScrollPreventionMode.Canvas&&a.target===o._engine.canvas)&&a.preventDefault();var s=o._engine.screen.pageToScreenCoordinates((0,i.vec)(a.pageX,a.pageY)),l=o._engine.screen.screenToWorldCoordinates(s),u=a.deltaX||a.wheelDeltaX*T||0,c=a.deltaY||a.wheelDeltaY*T||a.wheelDelta*T||a.detail||0,h=a.deltaZ||0,p=r.WheelDeltaMode.Pixel;a.deltaMode&&(1===a.deltaMode?p=r.WheelDeltaMode.Line:2===a.deltaMode&&(p=r.WheelDeltaMode.Page));var v=new r.WheelEvent(l.x,l.y,a.pageX,a.pageY,s.x,s.y,0,u,c,h,p,a);n.push(v),o.at(0).eventDispatcher.emit(e,v)}}},{key:"_getPointerIndex",value:function(e){var t;if((t=this._activePointers.indexOf(e))>-1)return t;for(var n=0;n<this._activePointers.length;n++)if(-1===this._activePointers[n])return n;return-1}},{key:"_nativeButtonToPointerButton",value:function(e){switch(e){case r.NativePointerButton.NoButton:return r.PointerButton.NoButton;case r.NativePointerButton.Left:return r.PointerButton.Left;case r.NativePointerButton.Middle:return r.PointerButton.Middle;case r.NativePointerButton.Right:return r.PointerButton.Right;case r.NativePointerButton.Unknown:return r.PointerButton.Unknown;default:return o.fail(e)}}},{key:"_stringToPointerType",value:function(e){switch(e){case"touch":return n.PointerType.Touch;case"mouse":return n.PointerType.Mouse;case"pen":return n.PointerType.Pen;default:return n.PointerType.Unknown}}}]),u}();exports.Pointers=k;
},{"../Class":"yTUi","../Engine":"CIaB","./Pointer":"MOJH","./PointerEvents":"LGsV","../Util/Util":"Kkda","../Algebra":"NGcQ","../Traits/CapturePointer":"G2LY"}],"cTMu":[function(require,module,exports) {
var global = arguments[3];
var e=arguments[3];Object.defineProperty(exports,"__esModule",{value:!0}),exports.Keyboard=exports.KeyEvent=exports.Keys=void 0;var t,r=require("../Util/Log"),i=require("../Class"),n=u(require("../Events"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}function u(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var u=i?Object.getOwnPropertyDescriptor(e,n):null;u&&(u.get||u.set)?Object.defineProperty(r,n,u):r[n]=e[n]}return r.default=e,t&&t.set(e,r),r}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function c(e,t,r){return t&&y(e.prototype,t),r&&y(e,r),e}function p(e,t,r){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var i=s(e,t);if(i){var n=Object.getOwnPropertyDescriptor(i,t);return n.get?n.get.call(r):n.value}})(e,t,r||e)}function s(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function K(e){var t=N();return function(){var r,i=h(e);if(t){var n=h(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return m(this,r)}}function m(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?g(e):t}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function N(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}exports.Keys=t,function(e){e.Num0="Numpad0",e.Num1="Numpad1",e.Num2="Numpad2",e.Num3="Numpad3",e.Num4="Numpad4",e.Num5="Numpad5",e.Num6="Numpad6",e.Num7="Numpad7",e.Num8="Numpad8",e.Num9="Numpad9",e.NumAdd="NumpadAdd",e.NumSubtract="NumpadSubtract",e.NumMultiply="NumpadMultiply",e.NumDivide="NumpadDivide",e.NumDecimal="NumpadDecimal",e.Numpad0="Numpad0",e.Numpad1="Numpad1",e.Numpad2="Numpad2",e.Numpad3="Numpad3",e.Numpad4="Numpad4",e.Numpad5="Numpad5",e.Numpad6="Numpad6",e.Numpad7="Numpad7",e.Numpad8="Numpad8",e.Numpad9="Numpad9",e.NumpadAdd="NumpadAdd",e.NumpadSubtract="NumpadSubtract",e.NumpadMultiply="NumpadMultiply",e.NumpadDivide="NumpadDivide",e.NumpadDecimal="NumpadDecimal",e.NumLock="NumLock",e.ShiftLeft="ShiftLeft",e.ShiftRight="ShiftRight",e.AltLeft="AltLeft",e.AltRight="AltRight",e.Key0="Digit0",e.Key1="Digit1",e.Key2="Digit2",e.Key3="Digit3",e.Key4="Digit4",e.Key5="Digit5",e.Key6="Digit6",e.Key7="Digit7",e.Key8="Digit8",e.Key9="Digit9",e.Digit0="Digit0",e.Digit1="Digit1",e.Digit2="Digit2",e.Digit3="Digit3",e.Digit4="Digit4",e.Digit5="Digit5",e.Digit6="Digit6",e.Digit7="Digit7",e.Digit8="Digit8",e.Digit9="Digit9",e.A="KeyA",e.B="KeyB",e.C="KeyC",e.D="KeyD",e.E="KeyE",e.F="KeyF",e.G="KeyG",e.H="KeyH",e.I="KeyI",e.J="KeyJ",e.K="KeyK",e.L="KeyL",e.M="KeyM",e.N="KeyN",e.O="KeyO",e.P="KeyP",e.Q="KeyQ",e.R="KeyR",e.S="KeyS",e.T="KeyT",e.U="KeyU",e.V="KeyV",e.W="KeyW",e.X="KeyX",e.Y="KeyY",e.Z="KeyZ",e.KeyA="KeyA",e.KeyB="KeyB",e.KeyC="KeyC",e.KeyD="KeyD",e.KeyE="KeyE",e.KeyF="KeyF",e.KeyG="KeyG",e.KeyH="KeyH",e.KeyI="KeyI",e.KeyJ="KeyJ",e.KeyK="KeyK",e.KeyL="KeyL",e.KeyM="KeyM",e.KeyN="KeyN",e.KeyO="KeyO",e.KeyP="KeyP",e.KeyQ="KeyQ",e.KeyR="KeyR",e.KeyS="KeyS",e.KeyT="KeyT",e.KeyU="KeyU",e.KeyV="KeyV",e.KeyW="KeyW",e.KeyX="KeyX",e.KeyY="KeyY",e.KeyZ="KeyZ",e.Semicolon="Semicolon",e.Quote="Quote",e.Comma="Comma",e.Minus="Minus",e.Period="Period",e.Slash="Slash",e.Equal="Equal",e.BracketLeft="BracketLeft",e.Backslash="Backslash",e.BracketRight="BracketRight",e.Backquote="Backquote",e.Up="ArrowUp",e.Down="ArrowDown",e.Left="ArrowLeft",e.Right="ArrowRight",e.ArrowUp="ArrowUp",e.ArrowDown="ArrowDown",e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.Space="Space",e.Esc="Escape",e.Escape="Escape"}(t||(exports.Keys=t={}));var v=function(e){l(r,n.GameEvent);var t=K(r);function r(e,i,n){var o;return f(this,r),(o=t.call(this)).key=e,o.value=i,o.originalEvent=n,o}return r}();exports.KeyEvent=v;var D=function(e){l(n,i.Class);var t=K(n);function n(){var e;return f(this,n),(e=t.call(this))._keys=[],e._keysUp=[],e._keysDown=[],e}return c(n,[{key:"on",value:function(e,t){p(h(n.prototype),"on",this).call(this,e,t)}},{key:"init",value:function(e){var t=this;if(!e)try{var i=function(){};window.top.addEventListener("blur",i),window.top.removeEventListener("blur",i),e=window.top}catch(n){e=window,r.Logger.getInstance().warn("Failed to bind to keyboard events to top frame. If you are trying to embed Excalibur in a cross-origin iframe, keyboard events will not fire.")}e.addEventListener("blur",function(){t._keys.length=0}),e.addEventListener("keyup",function(e){var r=e.code,i=t._keys.indexOf(r);t._keys.splice(i,1),t._keysUp.push(r);var n=new v(r,e.key,e);t.eventDispatcher.emit("up",n),t.eventDispatcher.emit("release",n)}),e.addEventListener("keydown",function(e){var r=e.code;if(-1===t._keys.indexOf(r)){t._keys.push(r),t._keysDown.push(r);var i=new v(r,e.key,e);t.eventDispatcher.emit("down",i),t.eventDispatcher.emit("press",i)}})}},{key:"update",value:function(){this._keysDown.length=0,this._keysUp.length=0;for(var e=0;e<this._keys.length;e++)this.eventDispatcher.emit("hold",new v(this._keys[e]))}},{key:"getKeys",value:function(){return this._keys}},{key:"wasPressed",value:function(e){return this._keysDown.indexOf(e)>-1}},{key:"isHeld",value:function(e){return this._keys.indexOf(e)>-1}},{key:"wasReleased",value:function(e){return this._keysUp.indexOf(e)>-1}}]),n}();exports.Keyboard=D;
},{"../Util/Log":"p1Gn","../Class":"yTUi","../Events":"XySq"}],"aiZ2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./Gamepad");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(r in exports&&exports[r]===e[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}}))});var r=require("./Pointer");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===r[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return r[e]}}))});var t=require("./Pointers");Object.keys(t).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===t[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return t[e]}}))});var n=require("./PointerEvents");Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===n[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return n[e]}}))});var o=require("./Keyboard");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===o[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return o[e]}}))});var u=require("./EngineInput");Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===u[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return u[e]}}))});
},{"./Gamepad":"LjC7","./Pointer":"MOJH","./Pointers":"P0Od","./PointerEvents":"LGsV","./Keyboard":"cTMu","./EngineInput":"FNCP"}],"ids7":[function(require,module,exports) {
"use strict";function e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function n(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function t(e,t,o){return t&&n(e.prototype,t),o&&n(e,o),e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.BrowserEvents=exports.BrowserComponent=void 0;var o=function(){function n(t){e(this,n),this.nativeComponent=t,this._paused=!1,this._nativeHandlers={}}return t(n,[{key:"on",value:function(e,n){this._nativeHandlers[e]&&this.off(e,this._nativeHandlers[e]),this._nativeHandlers[e]=this._decorate(n),this.nativeComponent.addEventListener(e,this._nativeHandlers[e])}},{key:"off",value:function(e,n){n||(n=this._nativeHandlers[e]),this.nativeComponent.removeEventListener(e,n),this._nativeHandlers[e]=null}},{key:"_decorate",value:function(e){var n=this;return function(t){n._paused||e(t)}}},{key:"pause",value:function(){this._paused=!0}},{key:"resume",value:function(){this._paused=!1}},{key:"clear",value:function(){for(var e in this._nativeHandlers)this.off(e)}}]),n}();exports.BrowserComponent=o;var i=function(){function n(t,i){e(this,n),this._windowGlobal=t,this._documentGlobal=i,this._windowComponent=new o(this._windowGlobal),this._documentComponent=new o(this._documentGlobal)}return t(n,[{key:"window",get:function(){return this._windowComponent}},{key:"document",get:function(){return this._documentComponent}},{key:"pause",value:function(){this.window.pause(),this.document.pause()}},{key:"resume",value:function(){this.window.resume(),this.document.resume()}},{key:"clear",value:function(){this.window.clear(),this.document.clear()}}]),n}();exports.BrowserEvents=i;
},{}],"CIaB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Engine=exports.ScrollPreventionMode=void 0;var e=require("./"),t=require("./Flags"),n=require("./Polyfill"),i=require("./Screen"),r=require("./Actor"),s=require("./Loader"),o=require("./Util/Detector"),a=require("./Events"),c=require("./Util/Log"),u=require("./Drawing/Color"),l=require("./Scene"),d=require("./Debug"),h=require("./Class"),p=m(require("./Input/Index")),f=require("./Util/Browser"),g=require("./Util/Decorators"),v=require("./Graphics");function y(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return y=function(){return e},e}function m(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=y();if(t&&t.has(e))return t.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var s=i?Object.getOwnPropertyDescriptor(e,r):null;s&&(s.get||s.set)?Object.defineProperty(n,r,s):n[r]=e[r]}return n.default=e,t&&t.set(e,n),n}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function w(e,t,n){return t&&b(e.prototype,t),n&&b(e,n),e}function k(e,t,n){return(k="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=S(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function S(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=I(e)););return e}function x(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&P(e,t)}function P(e,t){return(P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function E(e){var t=T();return function(){var n,i=I(e);if(t){var r=I(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return C(this,n)}}function C(e,t){return!t||"object"!==O(t)&&"function"!=typeof t?D(e):t}function D(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function T(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function I(e){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var F,M=function(e,t,n,i){var r,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":O(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,n,o):r(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o};(0,n.polyfill)(),exports.ScrollPreventionMode=F,function(e){e[e.None=0]="None",e[e.Canvas=1]="Canvas",e[e.All=2]="All"}(F||(exports.ScrollPreventionMode=F={}));var j=function(n){x(y,h.Class);var g=E(y);function y(n){var r,a,h,p;_(this,y),(r=g.call(this))._hasStarted=!1,r.postProcessors=[],r.scenes={},r._animations=[],r._suppressPlayButton=!1,r.pauseAudioWhenHidden=!0,r._isDebug=!1,r.debugColor=new u.Color(255,255,255),r.enableCanvasTransparency=!0,r.onFatalException=function(e){c.Logger.getInstance().fatal(e)},r._timescale=1,r._isLoading=!1,r._isInitialized=!1,n=Object.assign(Object.assign({},y._DEFAULT_ENGINE_OPTIONS),n),t.Flags.freeze(),r.browser=new f.BrowserEvents(window,document);var m=new o.Detector;if(!n.suppressMinimumBrowserFeatureDetection&&!(r._compatible=m.test())){var b=document.createElement("div");if(b.innerText="Sorry, your browser does not support all the features needed for Excalibur",document.body.appendChild(b),m.failedTests.forEach(function(e){var t=document.createElement("div");t.innerText="Browser feature missing "+e,document.body.appendChild(t)}),n.canvasElementId){var w=document.getElementById(n.canvasElementId);w&&w.parentElement.removeChild(w)}return C(r)}r._compatible=!0,console.log&&!n.suppressConsoleBootMessage&&(console.log("%cPowered by Excalibur.js (v".concat(e.EX_VERSION,")"),"background: #176BAA; color: white; border-radius: 5px; padding: 15px; font-size: 1.5em; line-height: 80px;"),console.log("\n      /| ________________\nO|===|* >________________>\n      \\|"),console.log("Visit","http://excaliburjs.com","for more information")),n.suppressPlayButton&&(r._suppressPlayButton=!0),r._logger=c.Logger.getInstance(),r._logger.defaultLevel===c.LogLevel.Debug&&m.logBrowserFeatures(),r._logger.debug("Building engine..."),r.canvasElementId=n.canvasElementId,n.canvasElementId?(r._logger.debug("Using Canvas element specified: "+n.canvasElementId),r.canvas=document.getElementById(n.canvasElementId)):n.canvasElement?(r._logger.debug("Using Canvas element specified:",n.canvasElement),r.canvas=n.canvasElement):(r._logger.debug("Using generated canvas element"),r.canvas=document.createElement("canvas"));var k=null!==(a=n.displayMode)&&void 0!==a?a:i.DisplayMode.Fixed;if(n.width&&n.height||n.viewport?(void 0===n.displayMode&&(k=i.DisplayMode.Fixed),r._logger.debug("Engine viewport is size "+n.width+" x "+n.height)):n.displayMode||(r._logger.debug("Engine viewport is fit"),k=i.DisplayMode.Fit),t.Flags.isEnabled(t.Experiments.WebGL)){var S=new v.ExcaliburGraphicsContextWebGL({canvasElement:r.canvas,enableTransparency:r.enableCanvasTransparency,smoothing:n.antialiasing,backgroundColor:n.backgroundColor,snapToPixel:n.snapToPixel});r.graphicsContext=S,r.ctx=S.__ctx}else{var x=new v.ExcaliburGraphicsContext2DCanvas({canvasElement:r.canvas,enableTransparency:r.enableCanvasTransparency,smoothing:n.antialiasing,backgroundColor:n.backgroundColor,snapToPixel:n.snapToPixel});r.graphicsContext=x,r.ctx=x.__ctx}return r.screen=new i.Screen({canvas:r.canvas,context:r.graphicsContext,antialiasing:null===(h=n.antialiasing)||void 0===h||h,browser:r.browser,viewport:null!==(p=n.viewport)&&void 0!==p?p:{width:n.width,height:n.height},resolution:n.resolution,displayMode:k,position:n.position,pixelRatio:n.suppressHiDPIScaling?1:null}),r.screen.applyResolutionAndViewport(),n.backgroundColor&&(r.backgroundColor=n.backgroundColor.clone()),r.enableCanvasTransparency=n.enableCanvasTransparency,r._loader=new s.Loader,r.debug=new d.Debug(D(r)),r._initialize(n),r.rootScene=r.currentScene=new l.Scene(D(r)),r.addScene("root",r.rootScene),r.goToScene("root"),r}return w(y,[{key:"canvasWidth",get:function(){return this.screen.canvasWidth}},{key:"halfCanvasWidth",get:function(){return this.screen.halfCanvasWidth}},{key:"canvasHeight",get:function(){return this.screen.canvasHeight}},{key:"halfCanvasHeight",get:function(){return this.screen.halfCanvasHeight}},{key:"drawWidth",get:function(){return this.screen.drawWidth}},{key:"halfDrawWidth",get:function(){return this.screen.halfDrawWidth}},{key:"drawHeight",get:function(){return this.screen.drawHeight}},{key:"halfDrawHeight",get:function(){return this.screen.halfDrawHeight}},{key:"isHiDpi",get:function(){return this.screen.isHiDpi}},{key:"stats",get:function(){return this.debug.stats}},{key:"isFullscreen",get:function(){return this.screen.isFullScreen}},{key:"displayMode",get:function(){return this.screen.displayMode}},{key:"pixelRatio",get:function(){return this.screen.pixelRatio}},{key:"isDebug",get:function(){return this._isDebug}},{key:"on",value:function(e,t){k(I(y.prototype),"on",this).call(this,e,t)}},{key:"once",value:function(e,t){k(I(y.prototype),"once",this).call(this,e,t)}},{key:"off",value:function(e,t){k(I(y.prototype),"off",this).call(this,e,t)}},{key:"getWorldBounds",value:function(){return this.screen.getWorldBounds()}},{key:"timescale",get:function(){return this._timescale},set:function(e){e<=0?c.Logger.getInstance().error("Cannot set engine.timescale to a value of 0 or less than 0."):this._timescale=e}},{key:"playAnimation",value:function(e,t,n){this._animations.push(new B(e,t,n))}},{key:"addTileMap",value:function(e){this.currentScene.addTileMap(e)}},{key:"removeTileMap",value:function(e){this.currentScene.removeTileMap(e)}},{key:"addTimer",value:function(e){return this.currentScene.addTimer(e)}},{key:"removeTimer",value:function(e){return this.currentScene.removeTimer(e)}},{key:"addScene",value:function(e,t){this.scenes[e]&&this._logger.warn("Scene",e,"already exists overwriting"),this.scenes[e]=t}},{key:"removeScene",value:function(e){if(e instanceof l.Scene)for(var t in this.scenes)this.scenes.hasOwnProperty(t)&&this.scenes[t]===e&&delete this.scenes[t];"string"==typeof e&&delete this.scenes[e]}},{key:"add",value:function(e){2===arguments.length&&this.addScene(arguments[0],arguments[1]),this.currentScene.add(e)}},{key:"remove",value:function(e){e instanceof r.Actor&&this.currentScene.remove(e),e instanceof l.Scene&&this.removeScene(e),"string"==typeof e&&this.removeScene(e)}},{key:"goToScene",value:function(e){if(this.scenes[e]){var t=this.currentScene,n=this.scenes[e];this._logger.debug("Going to scene:",e),this.currentScene.isInitialized&&(this.currentScene._deactivate.apply(this.currentScene,[t,n]),this.currentScene.eventDispatcher.emit("deactivate",new a.DeactivateEvent(n,this.currentScene))),this.currentScene=n,this.screen.setCurrentCamera(n.camera),this.currentScene._initialize(this),this.currentScene._activate.apply(this.currentScene,[t,n]),this.currentScene.eventDispatcher.emit("activate",new a.ActivateEvent(t,this.currentScene))}else this._logger.error("Scene",e,"does not exist!")}},{key:"screenToWorldCoordinates",value:function(e){return this.screen.screenToWorldCoordinates(e)}},{key:"worldToScreenCoordinates",value:function(e){return this.screen.worldToScreenCoordinates(e)}},{key:"_initialize",value:function(e){var t,n,i=this;this.pageScrollPreventionMode=e.scrollPreventionMode,this.input={keyboard:new p.Keyboard,pointers:new p.Pointers(this),gamepads:new p.Gamepads},this.input.keyboard.init(),this.input.pointers.init(e&&e.pointerScope===p.PointerScope.Document?document:this.canvas),this.input.gamepads.init(),void 0!==document.hidden?(t="hidden",n="visibilitychange"):"msHidden"in document?(t="msHidden",n="msvisibilitychange"):"webkitHidden"in document&&(t="webkitHidden",n="webkitvisibilitychange"),this.browser.document.on(n,function(){document[t]?(i.eventDispatcher.emit("hidden",new a.HiddenEvent(i)),i._logger.debug("Window hidden")):(i.eventDispatcher.emit("visible",new a.VisibleEvent(i)),i._logger.debug("Window visible"))}),this.canvasElementId||e.canvasElement||document.body.appendChild(this.canvas)}},{key:"onInitialize",value:function(e){}},{key:"setAntialiasing",value:function(e){this.screen.antialiasing=e}},{key:"getAntialiasing",value:function(){return this.screen.antialiasing}},{key:"isInitialized",get:function(){return this._isInitialized}},{key:"_overrideInitialize",value:function(e){this.isInitialized||(this.onInitialize(e),k(I(y.prototype),"emit",this).call(this,"initialize",new a.InitializeEvent(e,this)),this._isInitialized=!0)}},{key:"_update",value:function(e){if(this._isLoading)return this._loader.update(this,e),this.input.keyboard.update(),this.input.pointers.update(),void this.input.gamepads.update();this._overrideInitialize(this),this._preupdate(e),this.currentScene.update(this,e),this._animations=this._animations.filter(function(e){return!e.animation.isDone()}),this.input.keyboard.update(),this.input.pointers.update(),this.input.gamepads.update(),this._postupdate(e)}},{key:"_preupdate",value:function(e){this.emit("preupdate",new a.PreUpdateEvent(this,e,this)),this.onPreUpdate(this,e)}},{key:"onPreUpdate",value:function(e,t){}},{key:"_postupdate",value:function(e){this.emit("postupdate",new a.PostUpdateEvent(this,e,this)),this.onPostUpdate(this,e)}},{key:"onPostUpdate",value:function(e,t){}},{key:"_draw",value:function(e){var t=this.ctx;if(this._predraw(t,e),this._isLoading)return this._loader.canvas.draw(this.graphicsContext,0,0),void this.graphicsContext.flush();this.graphicsContext.backgroundColor=this.backgroundColor,this.currentScene.draw(this.ctx,e);for(var n=0,i=this._animations.length;n<i;n++)this._animations[n].animation.draw(t,this._animations[n].x,this._animations[n].y);if(this.isDebug){this.ctx.font="Consolas",this.ctx.fillStyle=this.debugColor.toString();for(var r=this.input.keyboard.getKeys(),s=0;s<r.length;s++)this.ctx.fillText(r[s].toString()+" : "+(p.Keys[r[s]]?p.Keys[r[s]]:"Not Mapped"),100,10*s+10);this.ctx.fillText("FPS:"+this.stats.currFrame.fps.toFixed(2).toString(),10,10)}for(var o=0;o<this.postProcessors.length;o++)this.postProcessors[o].process(this.ctx.getImageData(0,0,this.canvasWidth,this.canvasHeight),this.ctx);this._postdraw(t,e)}},{key:"_predraw",value:function(e,t){this.emit("predraw",new a.PreDrawEvent(e,t,this)),this.onPreDraw(e,t)}},{key:"onPreDraw",value:function(e,t){}},{key:"_postdraw",value:function(e,t){this.emit("postdraw",new a.PostDrawEvent(e,t,this)),this.onPostDraw(e,t)}},{key:"onPostDraw",value:function(e,t){}},{key:"showDebug",value:function(e){this._isDebug=e}},{key:"toggleDebug",value:function(){return this._isDebug=!this._isDebug,this._isDebug}},{key:"start",value:function(e){var t,n=this;return this._compatible?(this.screen.pushResolutionAndViewport(),this.screen.resolution=this.screen.viewport,this.screen.applyResolutionAndViewport(),this.graphicsContext.updateViewport(),e?(this._loader=e,this._loader.suppressPlayButton=this._suppressPlayButton||this._loader.suppressPlayButton,this._loader.wireEngine(this),t=this.load(this._loader)):t=Promise.resolve(),t.then(function(){n.screen.popResolutionAndViewport(),n.screen.applyResolutionAndViewport(),n.graphicsContext.updateViewport(),n.emit("start",new a.GameStartEvent(n))}),this._hasStarted||(this._hasStarted=!0,this._logger.debug("Starting game..."),this.browser.resume(),y.createMainLoop(this,window.requestAnimationFrame,Date.now)(),this._logger.debug("Game started")),t):Promise.reject("Excalibur is incompatible with your browser")}},{key:"stop",value:function(){this._hasStarted&&(this.emit("stop",new a.GameStopEvent(this)),this.browser.pause(),this._hasStarted=!1,this._logger.debug("Game stopped"))}},{key:"isPaused",value:function(){return!this._hasStarted}},{key:"screenshot",value:function(){var e=new Image,t=this.canvas.toDataURL("image/png");return e.src=t,e}},{key:"load",value:function(e){var t=this;return new Promise(function(n){t._isLoading=!0,e.load().then(function(){t._suppressPlayButton?setTimeout(function(){t._isLoading=!1,n()},500):(t._isLoading=!1,n())})})}}],[{key:"createMainLoop",value:function(e,t,n){var i=n();return function r(){if(e._hasStarted)try{e._requestId=t(r),e.emit("preframe",new a.PreFrameEvent(e,e.stats.prevFrame));var s=n(),o=Math.floor(s-i)||1;o>200&&(o=1);var c=o*e.timescale,u=e.stats.prevFrame.id+1;e.stats.currFrame.reset(),e.stats.currFrame.id=u,e.stats.currFrame.delta=c,e.stats.currFrame.fps=1/(c/1e3);var l=n();e._update(c);var d=n();e._draw(c);var h=n();e.stats.currFrame.duration.update=d-l,e.stats.currFrame.duration.draw=h-d,i=s,e.emit("postframe",new a.PostFrameEvent(e,e.stats.currFrame)),e.stats.prevFrame.reset(e.stats.currFrame)}catch(p){window.cancelAnimationFrame(e._requestId),e.stop(),e.onFatalException(p)}}}}]),y}();exports.Engine=j,j._DEFAULT_ENGINE_OPTIONS={width:0,height:0,enableCanvasTransparency:!0,canvasElementId:"",canvasElement:void 0,snapToPixel:!1,pointerScope:p.PointerScope.Document,suppressConsoleBootMessage:null,suppressMinimumBrowserFeatureDetection:null,suppressHiDPIScaling:null,suppressPlayButton:null,scrollPreventionMode:F.Canvas,backgroundColor:u.Color.fromHex("#2185d0")},M([(0,g.obsolete)({message:"Will be removed in excalibur v0.26.0",alternateMethod:"Use Actor.graphics"})],j.prototype,"playAnimation",null);var B=function e(t,n,i){_(this,e),this.animation=t,this.x=n,this.y=i};B=M([(0,g.obsolete)({message:"Will be removed in excalibur v0.26.0"})],B);
},{"./":"A6Lr","./Flags":"JzY1","./Polyfill":"oh18","./Screen":"yomt","./Actor":"vmFf","./Loader":"jUb1","./Util/Detector":"OWe5","./Events":"XySq","./Util/Log":"p1Gn","./Drawing/Color":"p7Gh","./Scene":"xS6v","./Debug":"haDW","./Class":"yTUi","./Input/Index":"aiZ2","./Util/Browser":"ids7","./Util/Decorators":"kQDE","./Graphics":"qIYM"}],"QGKl":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.NativeSoundProcessedEvent=exports.NativeSoundEvent=exports.MediaEvent=void 0;var t=require("../Events");function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function i(t){var e=s();return function(){var n,r=l(t);if(e){var o=l(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return a(this,n)}}function a(t,n){return!n||"object"!==e(n)&&"function"!=typeof n?f(t):n}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(e){u(c,t.GameEvent);var r=i(c);function c(t){var e,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"MediaEvent";return n(this,c),(e=r.call(this)).target=t,e._name=o,e}return o(c,[{key:"bubbles",get:function(){return!1},set:function(t){}},{key:"_path",get:function(){return null},set:function(t){}},{key:"stopPropagation",value:function(){}},{key:"action",value:function(){}},{key:"propagate",value:function(){}},{key:"layPath",value:function(t){}}]),c}();exports.MediaEvent=p;var v=function(t){u(r,p);var e=i(r);function r(t,o){var u;return n(this,r),(u=e.call(this,t,"NativeSoundEvent")).track=o,u}return r}();exports.NativeSoundEvent=v;var y=function(t){u(r,p);var e=i(r);function r(t,o){var u;return n(this,r),(u=e.call(this,t,"NativeSoundProcessedEvent"))._processedData=o,u.data=u._processedData,u}return r}();exports.NativeSoundProcessedEvent=y;
},{"../Events":"XySq"}],"pJ6L":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ParticleEmitter=exports.ParticleEmitterImpl=exports.Particle=exports.ParticleImpl=exports.EmitterType=void 0;var t,e=require("./Actor"),i=require("./Drawing/Color"),r=require("./Algebra"),o=m(require("./Util/Util")),n=m(require("./Util/DrawUtil")),a=m(require("./Traits/Index")),s=require("./Configurable"),l=require("./Math/Random"),c=require("./Collision/CollisionType"),p=require("./EntityComponentSystem/Components/TransformComponent"),u=require("./Graphics/GraphicsComponent"),h=require("./EntityComponentSystem/Entity"),f=require("."),y=require("./Drawing/Index");function d(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return d=function(){return t},t}function m(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=d();if(e&&e.has(t))return e.get(t);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var n=r?Object.getOwnPropertyDescriptor(t,o):null;n&&(n.get||n.set)?Object.defineProperty(i,o,n):i[o]=t[o]}return i.default=t,e&&e.set(t,i),i}function g(t){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function v(t,e,i){return(v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var r=C(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(i):o.value}})(t,e,i||t)}function C(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=E(t)););return t}function b(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function S(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function R(t,e,i){return e&&S(t.prototype,e),i&&S(t,i),t}function _(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&w(t,e)}function w(t,e){return(w=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function P(t){var e=O();return function(){var i,r=E(t);if(e){var o=E(this).constructor;i=Reflect.construct(r,arguments,o)}else i=r.apply(this,arguments);return z(this,i)}}function z(t,e){return!e||"object"!==g(e)&&"function"!=typeof e?x(t):e}function x(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function O(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function E(t){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}exports.EmitterType=t,function(t){t[t.Circle=0]="Circle",t[t.Rectangle=1]="Rectangle"}(t||(exports.EmitterType=t={}));var T=function(t){_(n,h.Entity);var e=P(n);function n(t,o,a,s,l,c,h,d,m,g){var v;b(this,n),(v=e.call(this)).position=new r.Vector(0,0),v.velocity=new r.Vector(0,0),v.acceleration=new r.Vector(0,0),v.particleRotationalVelocity=0,v.currentRotation=0,v.focus=null,v.focusAccel=0,v.opacity=1,v.beginColor=i.Color.White,v.endColor=i.Color.White,v.life=300,v.fadeFlag=!1,v._rRate=1,v._gRate=1,v._bRate=1,v._aRate=0,v._currentColor=i.Color.White,v.emitter=null,v.particleSize=5,v.particleSprite=null,v.sizeRate=0,v.elapsedMultiplier=0,v.visible=!0,v.isOffscreen=!1;var C=t;if(C&&!(t instanceof k)){var S=t;C=S.emitter,o=S.life,a=S.opacity,l=S.endColor,s=S.beginColor,c=S.position,h=S.velocity,d=S.acceleration,m=S.startSize,g=S.endSize}return v.emitter=C,v.life=o||v.life,v.opacity=a||v.opacity,v.endColor=l||v.endColor.clone(),v.beginColor=s||v.beginColor.clone(),v._currentColor=v.beginColor.clone(),v.position=(c||v.position).add(v.emitter.pos),v.velocity=h||v.velocity,v.acceleration=d||v.acceleration,v._rRate=(v.endColor.r-v.beginColor.r)/v.life,v._gRate=(v.endColor.g-v.beginColor.g)/v.life,v._bRate=(v.endColor.b-v.beginColor.b)/v.life,v._aRate=v.opacity/v.life,v.startSize=m||0,v.endSize=g||0,v.endSize>0&&v.startSize>0&&(v.sizeRate=(v.endSize-v.startSize)/v.life,v.particleSize=v.startSize),v.addComponent(v.transform=new p.TransformComponent),v.addComponent(new y.CanvasDrawComponent(function(t){return v.draw(t)})),v.addComponent(v.graphics=new u.GraphicsComponent),v.transform.pos=v.position,v.transform.rotation=v.currentRotation,v.transform.scale=(0,r.vec)(1,1),v.particleSprite?(v.graphics.opacity=v.opacity,v.graphics.use(f.Graphics.Sprite.fromLegacySprite(v.particleSprite))):v.graphics.onPostDraw=function(t){t.save(),v.graphics.opacity=v.opacity;var e=v._currentColor.clone();e.a=1,t.debug.drawPoint((0,r.vec)(0,0),{color:e,size:v.particleSize}),t.restore()},v}return R(n,[{key:"kill",value:function(){this.emitter.removeParticle(this)}},{key:"update",value:function(t,e){if(this.life=this.life-e,this.elapsedMultiplier=this.elapsedMultiplier+e,this.life<0&&this.kill(),this.fadeFlag&&(this.opacity=o.clamp(this._aRate*this.life,1e-4,1)),this.startSize>0&&this.endSize>0&&(this.particleSize=o.clamp(this.sizeRate*e+this.particleSize,Math.min(this.startSize,this.endSize),Math.max(this.startSize,this.endSize))),this._currentColor.r=o.clamp(this._currentColor.r+this._rRate*e,0,255),this._currentColor.g=o.clamp(this._currentColor.g+this._gRate*e,0,255),this._currentColor.b=o.clamp(this._currentColor.b+this._bRate*e,0,255),this._currentColor.a=o.clamp(this.opacity,1e-4,1),this.focus){var i=this.focus.sub(this.position).normalize().scale(this.focusAccel).scale(e/1e3);this.velocity=this.velocity.add(i)}else this.velocity=this.velocity.add(this.acceleration.scale(e/1e3));this.position=this.position.add(this.velocity.scale(e/1e3)),this.particleRotationalVelocity&&(this.currentRotation=(this.currentRotation+this.particleRotationalVelocity*e/1e3)%(2*Math.PI)),this.transform.pos=this.position,this.transform.rotation=this.currentRotation,this.transform.scale=(0,r.vec)(1,1),this.graphics.opacity=this.opacity}},{key:"draw",value:function(t){if(this.particleSprite)return this.particleSprite.opacity(this.opacity),void this.particleSprite.draw(t,0,0);t.save(),this._currentColor.a=o.clamp(this.opacity,1e-4,1),t.fillStyle=this._currentColor.toString(),t.beginPath(),t.arc(0,0,this.particleSize,0,2*Math.PI),t.fill(),t.closePath(),t.restore()}}]),n}();exports.ParticleImpl=T;var M=function(t){_(i,(0,s.Configurable)(T));var e=P(i);function i(t,r,o,n,a,s,l,c,p,u){return b(this,i),e.call(this,t,r,o,n,a,s,l,c,p,u)}return i}();exports.Particle=M;var V=function(s){_(u,e.Actor);var p=P(u);function u(e,o,n,s){var h;b(this,u),(h=p.call(this,"number"==typeof e?{pos:new r.Vector(e,o),width:n,height:s}:e)).numParticles=0,h.isEmitting=!0,h.particles=[],h.deadParticles=[],h.minVel=0,h.maxVel=0,h.acceleration=new r.Vector(0,0),h.minAngle=0,h.maxAngle=0,h.emitRate=1,h.particleLife=2e3,h.opacity=1,h.fadeFlag=!1,h.focus=null,h.focusAccel=1,h.startSize=null,h.endSize=null,h.minSize=5,h.maxSize=5,h.beginColor=i.Color.White,h.endColor=i.Color.White,h._og=null,h._sprite=null,h.emitterType=t.Rectangle,h.radius=0,h.particleRotationalVelocity=0,h.randomRotation=!1,h._particlesToEmit=0,h.body.collider.type=c.CollisionType.PreventCollision,h.random=new l.Random,h.removeComponent("canvas");for(var f=0;f<h.traits.length;f++)h.traits[f]instanceof a.OffscreenCulling&&h.traits.splice(f,1);return h}return R(u,[{key:"particleSprite",get:function(){return this._og},set:function(t){this._og=t,t&&(this._sprite=f.Graphics.Sprite.fromLegacySprite(t))}},{key:"removeParticle",value:function(t){this.deadParticles.push(t)}},{key:"emitParticles",value:function(t){for(var e,i=0;i<t;i++){var r=this._createParticle();this.particles.push(r),(null===(e=null==this?void 0:this.scene)||void 0===e?void 0:e.world)&&this.scene.world.add(r)}}},{key:"clearParticles",value:function(){this.particles.length=0}},{key:"_createParticle",value:function(){var e=0,i=0,n=o.randomInRange(this.minAngle,this.maxAngle,this.random),a=o.randomInRange(this.minVel,this.maxVel,this.random),s=this.startSize||o.randomInRange(this.minSize,this.maxSize,this.random),l=a*Math.cos(n),c=a*Math.sin(n);if(this.emitterType===t.Rectangle)e=o.randomInRange(0,this.width,this.random),i=o.randomInRange(0,this.height,this.random);else if(this.emitterType===t.Circle){var p=o.randomInRange(0,this.radius,this.random);e=p*Math.cos(n),i=p*Math.sin(n)}var u=new M(this,this.particleLife,this.opacity,this.beginColor,this.endColor,new r.Vector(e,i),new r.Vector(l,c),this.acceleration,this.startSize,this.endSize);return u.fadeFlag=this.fadeFlag,u.particleSize=s,this.particleSprite&&(u.particleSprite=this.particleSprite,u.graphics.opacity=this.opacity,u.graphics.use(this._sprite)),u.particleRotationalVelocity=this.particleRotationalVelocity,this.randomRotation&&(u.currentRotation=o.randomInRange(0,2*Math.PI,this.random)),this.focus&&(u.focus=this.focus.add(new r.Vector(this.pos.x,this.pos.y)),u.focusAccel=this.focusAccel),u}},{key:"update",value:function(t,e){var i;v(E(u.prototype),"update",this).call(this,t,e),this.isEmitting&&(this._particlesToEmit+=this.emitRate*(e/1e3),this._particlesToEmit>1&&(this.emitParticles(Math.floor(this._particlesToEmit)),this._particlesToEmit=this._particlesToEmit-Math.floor(this._particlesToEmit)));for(var r=0;r<this.deadParticles.length;r++)o.removeItemFromArray(this.deadParticles[r],this.particles),(null===(i=null==this?void 0:this.scene)||void 0===i?void 0:i.world)&&this.scene.world.remove(this.deadParticles[r]);this.deadParticles.length=0}},{key:"draw",value:function(t){this.particles.forEach(function(e){return e.draw(t)})}},{key:"debugDraw",value:function(t){v(E(u.prototype),"debugDraw",this).call(this,t),t.fillStyle=i.Color.Black.toString(),t.fillText("Particles: "+this.particles.length,this.pos.x,this.pos.y+20),this.focus&&(t.fillRect(this.focus.x+this.pos.x,this.focus.y+this.pos.y,3,3),n.line(t,i.Color.Yellow,this.focus.x+this.pos.x,this.focus.y+this.pos.y,this.center.x,this.center.y),t.fillText("Focus",this.focus.x+this.pos.x,this.focus.y+this.pos.y))}}]),u}();exports.ParticleEmitterImpl=V;var k=function(t){_(i,(0,s.Configurable)(V));var e=P(i);function i(t,r,o,n){return b(this,i),e.call(this,t,r,o,n)}return i}();exports.ParticleEmitter=k;
},{"./Actor":"vmFf","./Drawing/Color":"p7Gh","./Algebra":"NGcQ","./Util/Util":"Kkda","./Util/DrawUtil":"UgQh","./Traits/Index":"CPmg","./Configurable":"A4Kj","./Math/Random":"yYMg","./Collision/CollisionType":"liCD","./EntityComponentSystem/Components/TransformComponent":"yq2E","./Graphics/GraphicsComponent":"jeAN","./EntityComponentSystem/Entity":"UY9q",".":"A6Lr","./Drawing/Index":"vS88"}],"oDmR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={Internal:!0,Actions:!0};exports.Actions=exports.Internal=void 0;var t=require("./ActionContext");Object.keys(t).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||r in exports&&exports[r]===t[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return t[r]}}))});var r=require("./Actionable");Object.keys(r).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===r[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return r[t]}}))});var o=require("./RotationType");Object.keys(o).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===o[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return o[t]}}))});var n=u(require("./Action"));function c(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}function u(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=c();if(t&&t.has(e))return t.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var u=o?Object.getOwnPropertyDescriptor(e,n):null;u&&(u.get||u.set)?Object.defineProperty(r,n,u):r[n]=e[n]}return r.default=e,t&&t.set(e,r),r}exports.Actions=n;var i={Actions:n};exports.Internal=i;
},{"./ActionContext":"vA04","./Actionable":"FNCP","./RotationType":"DrJU","./Action":"gDdL"}],"TThz":[function(require,module,exports) {
"use strict";function e(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.ExResponse=void 0;var o=function o(){e(this,o)};exports.ExResponse=o,o.type={any:"",blob:"blob",json:"json",text:"text",document:"document",arraybuffer:"arraybuffer"};
},{}],"uSMl":[function(require,module,exports) {
"use strict";function t(t){return!!t._initialize}function e(t){return!!t.onInitialize}function n(t){return!!t._preupdate}function r(t){return!!t.onPreUpdate}function o(t){return!!t.onPostUpdate}function s(t){return!!t.onPostUpdate}function a(t){return!!t.onPreDraw}function i(t){return!!t.onPostDraw}Object.defineProperty(exports,"__esModule",{value:!0}),exports.has_initialize=t,exports.hasOnInitialize=e,exports.has_preupdate=n,exports.hasOnPreUpdate=r,exports.has_postupdate=o,exports.hasOnPostUpdate=s,exports.hasPreDraw=a,exports.hasPostDraw=i;
},{}],"scJm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./Trait");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(r in exports&&exports[r]===e[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}}))});var r=require("./Audio");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===r[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return r[e]}}))});var t=require("./AudioImplementation");Object.keys(t).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===t[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return t[e]}}))});var n=require("./Drawable");Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===n[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return n[e]}}))});var o=require("./Evented");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===o[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return o[e]}}))});var u=require("./Loadable");Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===u[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return u[e]}}))});var i=require("./LifecycleEvents");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===i[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return i[e]}}))});var s=require("./PointerEventHandlers");Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===s[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return s[e]}}))});
},{"./Trait":"FNCP","./Audio":"FNCP","./AudioImplementation":"TThz","./Drawable":"FNCP","./Evented":"FNCP","./Loadable":"FNCP","./LifecycleEvents":"uSMl","./PointerEventHandlers":"FNCP"}],"iCJC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PerlinDrawer2D=exports.PerlinGenerator=void 0;var t=require("./Random"),e=require("../Drawing/Color"),r=n(require("../Util/Util"));function i(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return i=function(){return t},t}function n(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=i();if(e&&e.has(t))return e.get(t);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var o=n?Object.getOwnPropertyDescriptor(t,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=t[a]}return r.default=t,e&&e.set(t,r),r}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function s(t,e,r){return e&&o(t.prototype,e),r&&o(t,r),t}function h(t,e,r){return e+t*(r-e)}function u(t){return t*t*t*(t*(6*t-15)+10)}var d=function(){function e(i){a(this,e),this._perm=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],this._p=new Uint8Array(512),this._defaultPerlinOptions={octaves:1,frequency:1,amplitude:1,persistance:.5},i=r.extend({},this._defaultPerlinOptions,i),this.persistance=i.persistance,this.amplitude=i.amplitude,this.frequency=i.frequency,this.octaves=i.octaves,i.seed?this._random=new t.Random(i.seed):this._random=new t.Random,this._perm=this._random.shuffle(this._perm);for(var n=0;n<512;n++)this._p[n]=255&this._perm[n%256]}return s(e,[{key:"noise",value:function(){for(var t=this.amplitude,e=this.frequency,r=0,i=0,n=0;n<this.octaves;n++){switch(arguments.length){case 1:r+=this._noise1d(arguments[0]*e)*t;break;case 2:r+=this._noise2d(arguments[0]*e,arguments[1]*e)*t;break;case 3:r+=this._noise3d(arguments[0]*e,arguments[1]*e,arguments[2]*e)*t;break;default:throw new Error("Invalid arguments for perlin noise")}i+=t,t*=this.persistance,e*=2}return r/i}},{key:"sequence",value:function(t,e){e||(e=1/t);for(var r=new Array(t),i=0;i<t;i++)r[i]=this.noise(i*e);return r}},{key:"grid",value:function(t,e,r){r||(r=1/Math.min(t,e));for(var i=new Array(t*e),n=0;n<e;n++)for(var a=0;a<t;a++)i[a+n*t]=this.noise(a*r,n*r);return i}},{key:"_gradient3d",value:function(t,e,r,i){var n=15&t,a=n<8?e:r,o=n<4?r:12===n||14===n?e:i;return(0==(1&n)?a:-a)+(0==(2&n)?o:-o)}},{key:"_gradient2d",value:function(t,e,r){var i=0==(1&t)?e:r;return 0==(2&t)?-i:i}},{key:"_gradient1d",value:function(t,e){return 0==(1&t)?-e:e}},{key:"_noise1d",value:function(t){var e=255&Math.floor(t);return(h(u(t-=Math.floor(t)),this._gradient1d(this._p[e],t),this._gradient1d(this._p[e+1],t-1))+1)/2}},{key:"_noise2d",value:function(t,e){var r=255&Math.floor(t),i=255&Math.floor(e);t-=Math.floor(t),e-=Math.floor(e);var n=u(t),a=u(e),o=this._p[r]+i,s=this._p[r+1]+i;return(h(a,h(n,this._gradient2d(this._p[o],t,e),this._gradient2d(this._p[s],t-1,e)),h(n,this._gradient2d(this._p[o+1],t,e-1),this._gradient2d(this._p[s+1],t-1,e-1)))+1)/2}},{key:"_noise3d",value:function(t,e,r){var i=255&Math.floor(t),n=255&Math.floor(e),a=255&Math.floor(r);t-=Math.floor(t),e-=Math.floor(e),r-=Math.floor(r);var o=u(t),s=u(e),d=u(r),f=this._p[i]+n,l=this._p[i+1]+n,c=this._p[f]+a,p=this._p[l]+a,_=this._p[f+1]+a,v=this._p[l+1]+a;return(h(d,h(s,h(o,this._gradient3d(this._p[c],t,e,r),this._gradient3d(this._p[p],t-1,e,r)),h(o,this._gradient3d(this._p[_],t,e-1,r),this._gradient3d(this._p[v],t-1,e-1,r))),h(s,h(o,this._gradient3d(this._p[c+1],t,e,r-1),this._gradient3d(this._p[p+1],t-1,e,r-1)),h(o,this._gradient3d(this._p[_+1],t,e-1,r-1),this._gradient3d(this._p[v+1],t-1,e-1,r-1))))+1)/2}}]),e}();exports.PerlinGenerator=d;var f=function(){function t(r,i){a(this,t),this.generator=r,this.colorFcn=i,i||(this.colorFcn=function(t){return t<125?e.Color.Black:e.Color.White})}return s(t,[{key:"image",value:function(t,e){var r=document.createElement("img"),i=document.createElement("canvas");i.width=t,i.height=e;var n=i.getContext("2d");return this.draw(n,0,0,t,e),r.src=i.toDataURL(),r}},{key:"draw",value:function(t,e,r,i,n){for(var a=this.generator.grid(i,n),o=t.getImageData(e,r,i,n),s=0;s<n;s++)for(var h=0;h<i;h++){var u=a[h+i*s],d=255&Math.floor(255*u),f=4*(h+s*o.width),l=this.colorFcn(d);o.data[f]=l.r,o.data[f+1]=l.g,o.data[f+2]=l.b,o.data[f+3]=Math.floor(255*l.a)}t.putImageData(o,e,r)}}]),t}();exports.PerlinDrawer2D=f;
},{"./Random":"yYMg","../Drawing/Color":"p7Gh","../Util/Util":"Kkda"}],"HAdL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./PerlinNoise");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(r in exports&&exports[r]===e[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}}))});var r=require("./Random");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===r[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return r[e]}}))});var t=require("./matrix");Object.keys(t).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===t[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return t[e]}}))});var o=require("./vector-view");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===o[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return o[e]}}))});
},{"./PerlinNoise":"iCJC","./Random":"yYMg","./matrix":"uPb3","./vector-view":"Nj7a"}],"hEPc":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.WebAudioInstance=void 0;var e=n(require("../../Util/Util")),t=require("./AudioContext");function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}function n(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var r=s?Object.getOwnPropertyDescriptor(e,a):null;r&&(r.get||r.set)?Object.defineProperty(n,a,r):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),e}var o=function(){function i(e){s(this,i),this._src=e,this._volume=1,this._duration=void 0,this._loop=!1,this._isPlaying=!1,this._isPaused=!1,this._audioContext=t.AudioContextFactory.create(),this._volumeNode=this._audioContext.createGain(),this._currentOffset=0,this._createNewBufferSource()}return r(i,[{key:"loop",get:function(){return this._loop},set:function(e){this._loop=e,this._instance&&(this._instance.loop=e,this._wireUpOnEnded())}},{key:"volume",get:function(){return this._volume},set:function(t){t=e.clamp(t,0,1),this._volume=t,this._isPlaying&&this._volumeNode.gain.setTargetAtTime?this._volumeNode.gain.setTargetAtTime(t,this._audioContext.currentTime,.1):this._volumeNode.gain.value=t}},{key:"duration",get:function(){return this._duration},set:function(e){this._duration=e}},{key:"_playbackRate",get:function(){return this._instance?1/(this._instance.playbackRate.value||1):null}},{key:"isPlaying",value:function(){return this._isPlaying}},{key:"play",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};return this._isPaused&&(this._resumePlayBack(),e()),this._isPlaying||(this._startPlayBack(),e()),this._playingPromise}},{key:"pause",value:function(){this._isPlaying&&(this._isPaused=!0,this._isPlaying=!1,this._instance.stop(0),this._setPauseOffset())}},{key:"stop",value:function(){this._isPlaying&&(this._isPlaying=!1,this._isPaused=!1,this._currentOffset=0,this._instance.stop(0),this._instance.onended||this._handleOnEnded())}},{key:"_startPlayBack",value:function(){var e=this;this._isPlaying=!0,this._isPaused=!1,this._playingPromise=new Promise(function(t){e._playingResolve=t}),this._instance||this._createNewBufferSource(),this._rememberStartTime(),this._volumeNode.connect(this._audioContext.destination),this._instance.start(0,0),this._currentOffset=0,this._wireUpOnEnded()}},{key:"_resumePlayBack",value:function(){if(this._isPaused){this._isPaused=!1,this._isPlaying=!0,this._instance.onended=null,this._createNewBufferSource();var e=this._playbackRate*this._src.duration,t=this._currentOffset%e;this._rememberStartTime(-1e3*t),this._instance.start(0,t),this._wireUpOnEnded()}}},{key:"_wireUpOnEnded",value:function(){var e=this;this.loop||(this._instance.onended=function(){return e._handleOnEnded()})}},{key:"_handleOnEnded",value:function(){this._isPaused||(this._isPlaying=!1,this._playingResolve(!0))}},{key:"_rememberStartTime",value:function(e){this._startTime=(new Date).getTime()+(0|e)}},{key:"_setPauseOffset",value:function(){this._currentOffset=((new Date).getTime()-this._startTime)*this._playbackRate/1e3}},{key:"_createNewBufferSource",value:function(){this._instance=this._audioContext.createBufferSource(),this._instance.buffer=this._src,this._instance.loop=this.loop,this._instance.playbackRate.setValueAtTime(1,0),this._instance.connect(this._volumeNode)}}]),i}();exports.WebAudioInstance=o;
},{"../../Util/Util":"Kkda","./AudioContext":"hSwP"}],"Gbl6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.canPlayFile=r;var e=require("./Log");function r(r){try{var t=new Audio,a=r.match(/.*\.([A-Za-z0-9]+)$/)[1];return!!t.canPlayType("audio/"+a)}catch(n){return e.Logger.getInstance().warn("Cannot determine audio support, assuming no support for the Audio Tag",n),!1}}
},{"./Log":"p1Gn"}],"cD70":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Sound=void 0;var t=require("../../Interfaces/AudioImplementation"),e=require("../Resource"),n=require("./WebAudioInstance"),r=require("./AudioContext"),o=require("../../Events/MediaEvents"),i=require("../../Util/Sound"),a=require("../../Util/Log"),s=require("../../Class");function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=l(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,i=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function l(t,e){if(t){if("string"==typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(t,e):void 0}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e,n){return e&&d(t.prototype,e),n&&d(t,n),t}function y(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}function v(t,e){return(v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function g(t){var e=b();return function(){var n,r=k(t);if(e){var o=k(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return m(this,n)}}function m(t,e){return!e||"object"!==u(e)&&"function"!=typeof e?_(t):e}function _(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function b(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function k(t){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var w=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}u((r=r.apply(t,e||[])).next())})},P=function(l){y(d,s.Class);var f=g(d);function d(){var n;h(this,d),(n=f.call(this)).logger=a.Logger.getInstance(),n._loop=!1,n._volume=1,n._duration=void 0,n._isStopped=!1,n._isPaused=!1,n._tracks=[],n._wasPlayingOnHidden=!1,n._audioContext=r.AudioContextFactory.create(),n._resource=new e.Resource("",t.ExResponse.type.arraybuffer);for(var o=arguments.length,s=new Array(o),u=0;u<o;u++)s[u]=arguments[u];for(var c=0,l=s;c<l.length;c++){var p=l[c];if((0,i.canPlayFile)(p)){n.path=p;break}}return n.path||(n.logger.warn("This browser does not support any of the audio files specified:",s.join(", ")),n.logger.warn("Attempting to use",s[0]),n.path=s[0]),n}return p(d,[{key:"loop",get:function(){return this._loop},set:function(t){this._loop=t;var e,n=c(this._tracks);try{for(n.s();!(e=n.n()).done;){e.value.loop=this._loop}}catch(r){n.e(r)}finally{n.f()}this.logger.debug("Set loop for all instances of sound",this.path,"to",this._loop)}},{key:"volume",get:function(){return this._volume},set:function(t){this._volume=t;var e,n=c(this._tracks);try{for(n.s();!(e=n.n()).done;){e.value.volume=this._volume}}catch(r){n.e(r)}finally{n.f()}this.emit("volumechange",new o.NativeSoundEvent(this)),this.logger.debug("Set loop for all instances of sound",this.path,"to",this._volume)}},{key:"duration",get:function(){return this._duration}},{key:"instances",get:function(){return this._tracks}},{key:"path",get:function(){return this._resource.path},set:function(t){this._resource.path=t}},{key:"isLoaded",value:function(){return!!this.data}},{key:"load",value:function(){return w(this,void 0,void 0,regeneratorRuntime.mark(function t(){var e,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.data){t.next=2;break}return t.abrupt("return",this.data);case 2:return t.next=4,this._resource.load();case 4:return e=t.sent,t.next=7,this.decodeAudio(e.slice(0));case 7:return n=t.sent,this._duration="object"===u(n)?n.duration:void 0,this.emit("processed",new o.NativeSoundProcessedEvent(this,n)),t.abrupt("return",this.data=n);case 11:case"end":return t.stop()}},t,this)}))}},{key:"decodeAudio",value:function(t){return w(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._audioContext.decodeAudioData(t.slice(0));case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),this.logger.error("Unable to decode  this browser may not fully support this format, or the file may be corrupt, if this is an mp3 try removing id3 tags and album art from the file."),e.next=11,Promise.reject();case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}},e,this,[[0,6]])}))}},{key:"wireEngine",value:function(t){var e=this;t&&(this._engine=t,this._engine.on("hidden",function(){t.pauseAudioWhenHidden&&e.isPlaying()&&(e._wasPlayingOnHidden=!0,e.pause())}),this._engine.on("visible",function(){t.pauseAudioWhenHidden&&e._wasPlayingOnHidden&&(e.play(),e._wasPlayingOnHidden=!1)}),this._engine.on("start",function(){e._isStopped=!1}),this._engine.on("stop",function(){e.stop(),e._isStopped=!0}))}},{key:"instanceCount",value:function(){return this._tracks.length}},{key:"isPlaying",value:function(){return this._tracks.some(function(t){return t.isPlaying()})}},{key:"play",value:function(t){return this.isLoaded()?this._isStopped?(this.logger.warn("Cannot start playing. Engine is in a stopped state."),Promise.resolve(!1)):(this.volume=t||this.volume,this._isPaused?this._resumePlayback():this._startPlayback()):(this.logger.warn("Cannot start playing. Resource",this.path,"is not loaded yet"),Promise.resolve(!0))}},{key:"pause",value:function(){if(this.isPlaying()){var t,e=c(this._tracks);try{for(e.s();!(t=e.n()).done;){t.value.pause()}}catch(n){e.e(n)}finally{e.f()}this._isPaused=!0,this.emit("pause",new o.NativeSoundEvent(this)),this.logger.debug("Paused all instances of sound",this.path)}}},{key:"stop",value:function(){var t,e=c(this._tracks);try{for(e.s();!(t=e.n()).done;){t.value.stop()}}catch(n){e.e(n)}finally{e.f()}this.emit("stop",new o.NativeSoundEvent(this)),this._isPaused=!1,this._tracks.length=0,this.logger.debug("Stopped all instances of sound",this.path)}},{key:"getTrackId",value:function(t){return this._tracks.indexOf(t)}},{key:"_resumePlayback",value:function(){return w(this,void 0,void 0,regeneratorRuntime.mark(function t(){var e,n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._isPaused){t.next=9;break}e=[],n=c(this._tracks);try{for(n.s();!(r=n.n()).done;)i=r.value,e.push(i.play())}catch(a){n.e(a)}finally{n.f()}return this._isPaused=!1,this.emit("resume",new o.NativeSoundEvent(this)),this.logger.debug("Resuming paused instances for sound",this.path,this._tracks),t.next=9,Promise.all(e);case 9:return t.abrupt("return",!0);case 10:case"end":return t.stop()}},t,this)}))}},{key:"_startPlayback",value:function(){return w(this,void 0,void 0,regeneratorRuntime.mark(function t(){var e,n,r=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._getTrackInstance(this.data);case 2:return e=t.sent,t.next=5,e.play(function(){r.emit("playbackstart",new o.NativeSoundEvent(r,e)),r.logger.debug("Playing new instance for sound",r.path)});case 5:return n=t.sent,this.emit("playbackend",new o.NativeSoundEvent(this,e)),this._tracks.splice(this.getTrackId(e),1),t.abrupt("return",n);case 9:case"end":return t.stop()}},t,this)}))}},{key:"_getTrackInstance",value:function(t){var e=new n.WebAudioInstance(t);return e.loop=this.loop,e.volume=this.volume,e.duration=this.duration,this._tracks.push(e),e}}]),d}();exports.Sound=P;
},{"../../Interfaces/AudioImplementation":"TThz","../Resource":"lN80","./WebAudioInstance":"hEPc","./AudioContext":"hSwP","../../Events/MediaEvents":"QGKl","../../Util/Sound":"Gbl6","../../Util/Log":"p1Gn","../../Class":"yTUi"}],"ANin":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./Sound");Object.keys(e).forEach(function(t){"default"!==t&&"__esModule"!==t&&(t in exports&&exports[t]===e[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return e[t]}}))});var t=require("./AudioContext");Object.keys(t).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===t[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return t[e]}}))});var r=require("./WebAudioInstance");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===r[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return r[e]}}))});
},{"./Sound":"cD70","./AudioContext":"hSwP","./WebAudioInstance":"hEPc"}],"A4zr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ParseGif=exports.Stream=exports.Gif=void 0;var e=require("./Resource"),t=require("./Texture"),r=require("../Drawing/Color"),n=require("../Drawing/SpriteSheet");function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}var o=function(e,t,r,n){return new(r||(r=Promise))(function(a,i){function s(e){try{l(n.next(e))}catch(t){i(t)}}function o(e){try{l(n.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((n=n.apply(e,t||[])).next())})},l=function(){function i(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.Color.Magenta,s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];a(this,i),this.path=t,this.color=n,this.bustCache=s,this._stream=null,this._gif=null,this._textures=[],this._animation=null,this._transparentColor=null,this._resource=new e.Resource(t,"arraybuffer",s),this._transparentColor=n}return s(i,[{key:"load",value:function(){return o(this,void 0,void 0,regeneratorRuntime.mark(function e(){var r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._resource.load();case 2:return r=e.sent,this._stream=new u(r),this._gif=new p(this._stream,this._transparentColor),n=this._gif.images.map(function(e){return new t.Texture(e.src,!1)}),e.next=8,Promise.all(n.map(function(e){return e.load()}));case 8:return e.abrupt("return",this.data=this._textures=n);case 9:case"end":return e.stop()}},e,this)}))}},{key:"isLoaded",value:function(){return!!this.data}},{key:"asSprite",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this._textures[e].asSprite()}},{key:"asSpriteSheet",value:function(){var e=this._textures.map(function(e){return e.asSprite()});return new n.SpriteSheet(e)}},{key:"asAnimation",value:function(e,t){var r=this.asSpriteSheet();return this._animation=r.getAnimationForAll(e,t),this._animation}},{key:"readCheckBytes",get:function(){return this._gif.checkBytes}}]),i}();exports.Gif=l;var h=function(e){return e.reduce(function(e,t){return 2*e+t},0)},c=function(e){for(var t=[],r=7;r>=0;r--)t.push(!!(e&1<<r));return t},u=function e(t){var r=this;if(a(this,e),this.data=null,this.len=0,this.position=0,this.readByte=function(){if(r.position>=r.data.byteLength)throw new Error("Attempted to read past end of stream.");return r.data[r.position++]},this.readBytes=function(e){for(var t=[],n=0;n<e;n++)t.push(r.readByte());return t},this.read=function(e){for(var t="",n=0;n<e;n++)t+=String.fromCharCode(r.readByte());return t},this.readUnsigned=function(){var e=r.readBytes(2);return(e[1]<<8)+e[0]},this.data=new Uint8Array(t),this.len=this.data.byteLength,0===this.len)throw new Error("No data loaded from file")};exports.Stream=u;var d=function(e,t){for(var r,n,a=0,i=function(e){for(var r=0,n=0;n<e;n++)t.charCodeAt(a>>3)&1<<(7&a)&&(r|=1<<n),a++;return r},s=[],o=1<<e,l=o+1,h=e+1,c=[],u=function(){c=[],h=e+1;for(var t=0;t<o;t++)c[t]=[t];c[o]=[],c[l]=null};;)if(n=r,(r=i(h))!==o){if(r===l)break;if(r<c.length)n!==o&&c.push(c[n].concat(c[r][0]));else{if(r!==c.length)throw new Error("Invalid LZW code.");c.push(c[n].concat(c[n][0]))}s.push.apply(s,c[r]),c.length===1<<h&&h<12&&h++}else u();return s},p=function e(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.Color.Magenta;a(this,e),this._st=null,this._handler={},this._transparentColor=null,this.frames=[],this.images=[],this.globalColorTable=[],this.checkBytes=[],this.parseColorTable=function(e){for(var t=[],r=0;r<e;r++){var a="#"+n._st.readBytes(3).map(function(e){var t=e.toString(16);return 1===t.length?"0"+t:t}).join("");t.push(a)}return t},this.readSubBlocks=function(){var e,t;t="";do{e=n._st.readByte(),t+=n._st.read(e)}while(0!==e);return t},this.parseHeader=function(){var e={sig:null,ver:null,width:null,height:null,colorRes:null,globalColorTableSize:null,gctFlag:null,sorted:null,globalColorTable:[],bgColor:null,pixelAspectRatio:null};if(e.sig=n._st.read(3),e.ver=n._st.read(3),"GIF"!==e.sig)throw new Error("Not a GIF file.");e.width=n._st.readUnsigned(),e.height=n._st.readUnsigned();var t=c(n._st.readByte());e.gctFlag=t.shift(),e.colorRes=h(t.splice(0,3)),e.sorted=t.shift(),e.globalColorTableSize=h(t.splice(0,3)),e.bgColor=n._st.readByte(),e.pixelAspectRatio=n._st.readByte(),e.gctFlag&&(e.globalColorTable=n.parseColorTable(1<<e.globalColorTableSize+1),n.globalColorTable=e.globalColorTable),n._handler.hdr&&n._handler.hdr(e)&&n.checkBytes.push(n._handler.hdr)},this.parseExt=function(e){switch(e.label=n._st.readByte(),e.label){case 249:e.extType="gce",function(e){n.checkBytes.push(n._st.readByte());var t=c(n._st.readByte());e.reserved=t.splice(0,3),e.disposalMethod=h(t.splice(0,3)),e.userInput=t.shift(),e.transparencyGiven=t.shift(),e.delayTime=n._st.readUnsigned(),e.transparencyIndex=n._st.readByte(),e.terminator=n._st.readByte(),n._handler.gce&&n._handler.gce(e)&&n.checkBytes.push(n._handler.gce)}(e);break;case 254:e.extType="com",function(e){e.comment=n.readSubBlocks(),n._handler.com&&n._handler.com(e)&&n.checkBytes.push(n._handler.com)}(e);break;case 1:e.extType="pte",function(e){n.checkBytes.push(n._st.readByte()),e.ptHeader=n._st.readBytes(12),e.ptData=n.readSubBlocks(),n._handler.pte&&n._handler.pte(e)&&n.checkBytes.push(n._handler.pte)}(e);break;case 255:e.extType="app",function(e){switch(n.checkBytes.push(n._st.readByte()),e.identifier=n._st.read(8),e.authCode=n._st.read(3),e.identifier){case"NETSCAPE":!function(e){n.checkBytes.push(n._st.readByte()),e.unknown=n._st.readByte(),e.iterations=n._st.readUnsigned(),e.terminator=n._st.readByte(),n._handler.app&&n._handler.app.NETSCAPE&&n._handler.app.NETSCAPE(e)&&n.checkBytes.push(n._handler.app)}(e);break;default:!function(e){e.appData=n.readSubBlocks(),n._handler.app&&n._handler.app[e.identifier]&&n._handler.app[e.identifier](e)&&n.checkBytes.push(n._handler.app[e.identifier])}(e)}}(e);break;default:e.extType="unknown",function(e){e.data=n.readSubBlocks(),n._handler.unknown&&n._handler.unknown(e)&&n.checkBytes.push(n._handler.unknown)}(e)}},this.parseImg=function(e){e.leftPos=n._st.readUnsigned(),e.topPos=n._st.readUnsigned(),e.width=n._st.readUnsigned(),e.height=n._st.readUnsigned();var t=c(n._st.readByte());e.lctFlag=t.shift(),e.interlaced=t.shift(),e.sorted=t.shift(),e.reserved=t.splice(0,2),e.lctSize=h(t.splice(0,3)),e.lctFlag&&(e.lct=n.parseColorTable(1<<e.lctSize+1)),e.lzwMinCodeSize=n._st.readByte();var r=n.readSubBlocks();e.pixels=d(e.lzwMinCodeSize,r),e.interlaced&&(e.pixels=function(e,t){for(var r=new Array(e.length),n=e.length/t,a=function(n,a){var i=e.slice(a*t,(a+1)*t);r.splice.apply(r,[n*t,t].concat(i))},i=[0,4,2,1],s=[8,8,4,2],o=0,l=0;l<4;l++)for(var h=i[l];h<n;h+=s[l])a(h,o),o++;return r}(e.pixels,e.width)),n.frames.push(e),n.arrayToImage(e),n._handler.img&&n._handler.img(e)&&n.checkBytes.push(n._handler)},this.parseBlock=function(){var e={sentinel:n._st.readByte(),type:""};switch(String.fromCharCode(e.sentinel)){case"!":e.type="ext",n.parseExt(e);break;case",":e.type="img",n.parseImg(e);break;case";":e.type="eof",n._handler.eof&&n._handler.eof(e)&&n.checkBytes.push(n._handler.eof);break;default:throw new Error("Unknown block: 0x"+e.sentinel.toString(16))}"eof"!==e.type&&n.parseBlock()},this.arrayToImage=function(e){var t=0,r=document.createElement("canvas");r.id=t.toString(),r.width=e.width,r.height=e.height,t++;for(var a=r.getContext("2d"),i=0,s=0,o=0;o<e.pixels.length;o++)s%e.width==0&&(i++,s=0),n.globalColorTable[e.pixels[o]]===n._transparentColor.toHex()?a.fillStyle="rgba(0, 0, 0, 0)":a.fillStyle=n.globalColorTable[e.pixels[o]],a.fillRect(s,i,1,1),s++;var l=new Image;l.src=r.toDataURL(),n.images.push(l)},this._st=t,this._handler={},this._transparentColor=i,this.parseHeader(),this.parseBlock()};exports.ParseGif=p;
},{"./Resource":"lN80","./Texture":"HrNa","../Drawing/Color":"p7Gh","../Drawing/SpriteSheet":"ikZV"}],"R9kC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./Resource");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(r in exports&&exports[r]===e[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}}))});var r=require("./Sound/Index");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===r[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return r[e]}}))});var t=require("./Texture");Object.keys(t).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===t[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return t[e]}}))});var o=require("./Gif");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===o[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return o[e]}}))});
},{"./Resource":"lN80","./Sound/Index":"ANin","./Texture":"HrNa","./Gif":"A4zr"}],"SM3q":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={DrawUtil:!0};exports.DrawUtil=void 0;var t=require("./Util");Object.keys(t).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||r in exports&&exports[r]===t[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return t[r]}}))});var r=o(require("./DrawUtil"));function n(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return n=function(){return e},e}function o(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=n();if(t&&t.has(e))return t.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var u=o?Object.getOwnPropertyDescriptor(e,i):null;u&&(u.get||u.set)?Object.defineProperty(r,i,u):r[i]=e[i]}return r.default=e,t&&t.set(e,r),r}exports.DrawUtil=r;
},{"./Util":"Kkda","./DrawUtil":"UgQh"}],"O7SY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MockedElement=exports.BinaryTreeNode=exports.SortedList=void 0;var e=require("./Decorators");function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function i(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var u=function(e,t,n,i){var u,l=arguments.length,o=l<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(u=e[a])&&(o=(l<3?u(o):l>3?u(t,n,o):u(t,n))||o);return l>3&&o&&Object.defineProperty(t,n,o),o},l=function(){function e(n){t(this,e),this._getComparable=n}return i(e,[{key:"find",value:function(e){return this._find(this._root,e)}},{key:"_find",value:function(e,t){return null!=e&&(this._getComparable(t)===e.getKey()?e.getData().indexOf(t)>-1:this._getComparable(t)<e.getKey()?this._find(e.getLeft(),t):this._find(e.getRight(),t))}},{key:"get",value:function(e){return this._get(this._root,e)}},{key:"_get",value:function(e,t){return null==e?[]:t===e.getKey()?e.getData():t<e.getKey()?this._get(e.getLeft(),t):this._get(e.getRight(),t)}},{key:"add",value:function(e){return null==this._root?(this._root=new o(this._getComparable(e),[e],null,null),!0):this._insert(this._root,e)}},{key:"_insert",value:function(e,t){return null!=e&&(this._getComparable(t)===e.getKey()?!(e.getData().indexOf(t)>-1)&&(e.getData().push(t),!0):this._getComparable(t)<e.getKey()?null==e.getLeft()?(e.setLeft(new o(this._getComparable(t),[t],null,null)),!0):this._insert(e.getLeft(),t):null==e.getRight()?(e.setRight(new o(this._getComparable(t),[t],null,null)),!0):this._insert(e.getRight(),t))}},{key:"removeByComparable",value:function(e){this._root=this._remove(this._root,e)}},{key:"_remove",value:function(e,t){if(null==e)return null;if(this._getComparable(t)!==e.getKey())return this._getComparable(t)<e.getKey()?(e.setLeft(this._remove(e.getLeft(),t)),e):(e.setRight(this._remove(e.getRight(),t)),e);var n=e.getData().indexOf(t);if(n>-1){if(e.getData().splice(n,1),0===e.getData().length){if(null==e.getLeft()&&null==e.getRight())return null;if(null==e.getLeft())return e.getRight();if(null==e.getRight())return e.getLeft();var i=this._findMinNode(e.getRight());return e.setKey(i.getKey()),e.setData(i.getData()),e.setRight(this._cleanup(e.getRight(),i)),e}return e}return null}},{key:"_cleanup",value:function(e,t){var n=t.getKey();if(null==e)return null;if(n===e.getKey()){if(null==e.getLeft()&&null==e.getRight())return null;if(null==e.getLeft())return e.getRight();if(null==e.getRight())return e.getLeft();var i=this._findMinNode(e.getRight());return e.setKey(i.getKey()),e.setData(i.getData()),e.setRight(this._cleanup(e.getRight(),i)),e}return t.getKey()<e.getKey()?(e.setLeft(this._cleanup(e.getLeft(),t)),e):(e.setRight(this._cleanup(e.getRight(),t)),e)}},{key:"_findMinNode",value:function(e){for(var t=e;null!=t.getLeft();)t=t.getLeft();return t}},{key:"list",value:function(){var e=new Array;return this._list(this._root,e),e}},{key:"_list",value:function(e,t){null!=e&&(this._list(e.getLeft(),t),e.getData().forEach(function(e){t.push(e)}),this._list(e.getRight(),t))}}]),e}();exports.SortedList=l,exports.SortedList=l=u([(0,e.obsolete)({message:"Will be removed in excalibur v0.26.0",alternateMethod:"Use built in JS array.sort"})],l);var o=function(){function e(n,i,r,u){t(this,e),this._key=n,this._data=i,this._left=r,this._right=u}return i(e,[{key:"getKey",value:function(){return this._key}},{key:"setKey",value:function(e){this._key=e}},{key:"getData",value:function(){return this._data}},{key:"setData",value:function(e){this._data=e}},{key:"getLeft",value:function(){return this._left}},{key:"setLeft",value:function(e){this._left=e}},{key:"getRight",value:function(){return this._right}},{key:"setRight",value:function(e){this._right=e}}]),e}();exports.BinaryTreeNode=o,exports.BinaryTreeNode=o=u([(0,e.obsolete)({message:"Will be removed in excalibur v0.26.0"})],o);var a=function(){function e(n){t(this,e),this._key=0,this._key=n}return i(e,[{key:"getTheKey",value:function(){return this._key}},{key:"setKey",value:function(e){this._key=e}}]),e}();exports.MockedElement=a;
},{"./Decorators":"kQDE"}],"PqN8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Promise=exports.PromiseState=void 0;var e=require("./Util/Decorators");function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function n(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i,s,a=function(e,t,r,n){var i,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(a=(s<3?i(a):s>3?i(t,r,a):i(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a};exports.PromiseState=s,function(e){e[e.Resolved=0]="Resolved",e[e.Rejected=1]="Rejected",e[e.Pending=2]="Pending"}(s||(exports.PromiseState=s={}));var l=i=function(){function e(){t(this,e),this._state=s.Pending,this._successCallbacks=[],this._rejectCallback=function(){}}return n(e,[{key:"then",value:function(e,t){if(e&&(this._successCallbacks.push(e),this.state()===s.Resolved))try{e.call(this,this._value)}catch(r){this._handleError(r)}if(t&&(this._rejectCallback=t,this.state()===s.Rejected))try{t.call(this,this._value)}catch(r){this._handleError(r)}return this}},{key:"error",value:function(e){return e&&(this._errorCallback=e),this}},{key:"resolve",value:function(e){var t=this;if(this._state!==s.Pending)throw new Error("Cannot resolve a promise that is not in a pending state!");this._value=e;try{this._state=s.Resolved,this._successCallbacks.forEach(function(e){e.call(t,t._value)})}catch(r){this._handleError(r)}return this}},{key:"reject",value:function(e){if(this._state!==s.Pending)throw new Error("Cannot reject a promise that is not in a pending state!");this._value=e;try{this._state=s.Rejected,this._rejectCallback.call(this,this._value)}catch(t){this._handleError(t)}return this}},{key:"state",value:function(){return this._state}},{key:"_handleError",value:function(e){if(!this._errorCallback)throw e;this._errorCallback.call(this,e)}}],[{key:"resolve",value:function(e){return(new i).resolve(e)}},{key:"reject",value:function(e){return(new i).reject(e)}},{key:"join",value:function(){var e=[];if(arguments.length>0&&!Array.isArray(arguments[0]))for(var t=0;t<arguments.length;t++)e[t-0]=arguments[t];else 1===arguments.length&&Array.isArray(arguments[0])&&(e=arguments[0]);var r=new i;if(!e||!e.length)return r.resolve();var n=e.length,o=0,s=0,a=[];return e.forEach(function(e){e.then(function(){(o+=1)===n?r.resolve():o+s+a.length===n&&r.reject(a)},function(){o+(s+=1)+a.length===n&&r.reject(a)}).error(function(e){a.push(e),a.length+o+s===n&&r.reject(a)})}),r}}]),e}();exports.Promise=l,exports.Promise=l=i=a([(0,e.obsolete)({message:"ex.Promises are being replaced by native browser promises in v0.26.0",alternateMethod:"Use browser native promises"})],l);
},{"./Util/Decorators":"kQDE"}],"A6Lr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={EX_VERSION:!0,Actor:!0,CollisionType:!0,Events:!0,Label:!0,FontStyle:!0,FontUnit:!0,TextAlign:!0,BaseAlign:!0,Particle:!0,ParticleEmitter:!0,EmitterType:!0,TileMap:!0,Cell:!0,Graphics:!0,Input:!0,Traits:!0,Util:!0};Object.defineProperty(exports,"Actor",{enumerable:!0,get:function(){return u.Actor}}),Object.defineProperty(exports,"CollisionType",{enumerable:!0,get:function(){return p.CollisionType}}),Object.defineProperty(exports,"Label",{enumerable:!0,get:function(){return O.Label}}),Object.defineProperty(exports,"FontStyle",{enumerable:!0,get:function(){return x.FontStyle}}),Object.defineProperty(exports,"FontUnit",{enumerable:!0,get:function(){return x.FontUnit}}),Object.defineProperty(exports,"TextAlign",{enumerable:!0,get:function(){return x.TextAlign}}),Object.defineProperty(exports,"BaseAlign",{enumerable:!0,get:function(){return x.BaseAlign}}),Object.defineProperty(exports,"Particle",{enumerable:!0,get:function(){return j.Particle}}),Object.defineProperty(exports,"ParticleEmitter",{enumerable:!0,get:function(){return j.ParticleEmitter}}),Object.defineProperty(exports,"EmitterType",{enumerable:!0,get:function(){return j.EmitterType}}),Object.defineProperty(exports,"TileMap",{enumerable:!0,get:function(){return _.TileMap}}),Object.defineProperty(exports,"Cell",{enumerable:!0,get:function(){return _.Cell}}),exports.Util=exports.Traits=exports.Input=exports.Graphics=exports.Events=exports.EX_VERSION=void 0;var t=require("./Polyfill"),r=require("./Flags");Object.keys(r).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===r[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return r[t]}}))});var o=require("./Engine");Object.keys(o).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===o[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return o[t]}}))});var n=require("./Screen");Object.keys(n).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===n[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return n[t]}}))});var u=require("./Actor"),p=require("./Collision/CollisionType"),c=require("./Algebra");Object.keys(c).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===c[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return c[t]}}))});var i=require("./Camera");Object.keys(i).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===i[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return i[t]}}))});var s=require("./Class");Object.keys(s).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===s[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return s[t]}}))});var a=require("./Configurable");Object.keys(a).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===a[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return a[t]}}))});var l=require("./Debug");Object.keys(l).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===l[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return l[t]}}))});var f=require("./EventDispatcher");Object.keys(f).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===f[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return f[t]}}))});var b=require("./Events/MediaEvents");Object.keys(b).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===b[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return b[t]}}))});var y=H(require("./Events"));exports.Events=y,Object.keys(y).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===y[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return y[t]}}))});var O=require("./Label"),x=require("./Graphics/FontCommon"),d=require("./Loader");Object.keys(d).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===d[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return d[t]}}))});var j=require("./Particles"),P=require("./Physics");Object.keys(P).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===P[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return P[t]}}))});var h=require("./Scene");Object.keys(h).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===h[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return h[t]}}))});var _=require("./TileMap"),g=require("./Timer");Object.keys(g).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===g[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return g[t]}}))});var m=require("./Trigger");Object.keys(m).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===m[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return m[t]}}))});var E=require("./ScreenElement");Object.keys(E).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===E[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return E[t]}}))});var v=require("./Actions/Index");Object.keys(v).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===v[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return v[t]}}))});var q=require("./Collision/Index");Object.keys(q).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===q[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return q[t]}}))});var M=require("./Drawing/Index");Object.keys(M).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===M[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return M[t]}}))});var w=require("./Interfaces/Index");Object.keys(w).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===w[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return w[t]}}))});var k=require("./Math/Index");Object.keys(k).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===k[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return k[t]}}))});var T=require("./PostProcessing/Index");Object.keys(T).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===T[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return T[t]}}))});var I=require("./Resources/Index");Object.keys(I).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===I[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return I[t]}}))});var C=require("./EntityComponentSystem/index");Object.keys(C).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===C[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return C[t]}}))});var U=H(require("./Graphics/index"));exports.Graphics=U;var A=H(require("./Input/Index"));exports.Input=A;var S=H(require("./Traits/Index"));exports.Traits=S;var F=H(require("./Util/Index"));exports.Util=F;var D=require("./Util/Browser");Object.keys(D).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===D[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return D[t]}}))});var L=require("./Util/Decorators");Object.keys(L).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===L[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return L[t]}}))});var B=require("./Util/Detector");Object.keys(B).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===B[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return B[t]}}))});var G=require("./Util/CullingBox");Object.keys(G).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===G[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return G[t]}}))});var R=require("./Util/EasingFunctions");Object.keys(R).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===R[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return R[t]}}))});var N=require("./Util/Log");Object.keys(N).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===N[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return N[t]}}))});var V=require("./Util/SortedList");Object.keys(V).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===V[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return V[t]}}))});var X=require("./Util/Pool");Object.keys(X).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===X[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return X[t]}}))});var W=require("./Promises");function z(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return z=function(){return e},e}function H(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=z();if(t&&t.has(e))return t.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var u=o?Object.getOwnPropertyDescriptor(e,n):null;u&&(u.get||u.set)?Object.defineProperty(r,n,u):r[n]=e[n]}return r.default=e,t&&t.set(e,r),r}Object.keys(W).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===W[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return W[t]}}))});var J=void 0;exports.EX_VERSION=J,(0,t.polyfill)();
},{"./Polyfill":"oh18","./Flags":"JzY1","./Engine":"CIaB","./Screen":"yomt","./Actor":"vmFf","./Collision/CollisionType":"liCD","./Algebra":"NGcQ","./Camera":"pAjs","./Class":"yTUi","./Configurable":"A4Kj","./Debug":"haDW","./EventDispatcher":"c7EN","./Events/MediaEvents":"QGKl","./Events":"XySq","./Label":"rRqb","./Graphics/FontCommon":"gyMF","./Loader":"jUb1","./Particles":"pJ6L","./Physics":"uSEN","./Scene":"xS6v","./TileMap":"QP5n","./Timer":"y7ZJ","./Trigger":"NgAR","./ScreenElement":"PDm1","./Actions/Index":"oDmR","./Collision/Index":"kKHB","./Drawing/Index":"vS88","./Interfaces/Index":"scJm","./Math/Index":"HAdL","./PostProcessing/Index":"mhi9","./Resources/Index":"R9kC","./EntityComponentSystem/index":"sOyH","./Graphics/index":"qIYM","./Input/Index":"aiZ2","./Traits/Index":"CPmg","./Util/Index":"SM3q","./Util/Browser":"ids7","./Util/Decorators":"kQDE","./Util/Detector":"OWe5","./Util/CullingBox":"nIlm","./Util/EasingFunctions":"LpjS","./Util/Log":"p1Gn","./Util/SortedList":"O7SY","./Util/Pool":"SXsA","./Promises":"PqN8"}],"ArXC":[function(require,module,exports) {
"use strict";function e(e){if(e&&"undefined"!=typeof window){var t=document.createElement("style");return t.setAttribute("type","text/css"),t.innerHTML=e,document.head.appendChild(t),e}}function t(e,t){var n=e.__state.conversionName.toString(),o=Math.round(e.r),i=Math.round(e.g),r=Math.round(e.b),s=e.a,a=Math.round(e.h),l=e.s.toFixed(1),d=e.v.toFixed(1);if(t||"THREE_CHAR_HEX"===n||"SIX_CHAR_HEX"===n){for(var c=e.hex.toString(16);c.length<6;)c="0"+c;return"#"+c}return"CSS_RGB"===n?"rgb("+o+","+i+","+r+")":"CSS_RGBA"===n?"rgba("+o+","+i+","+r+","+s+")":"HEX"===n?"0x"+e.hex.toString(16):"RGB_ARRAY"===n?"["+o+","+i+","+r+"]":"RGBA_ARRAY"===n?"["+o+","+i+","+r+","+s+"]":"RGB_OBJ"===n?"{r:"+o+",g:"+i+",b:"+r+"}":"RGBA_OBJ"===n?"{r:"+o+",g:"+i+",b:"+r+",a:"+s+"}":"HSV_OBJ"===n?"{h:"+a+",s:"+l+",v:"+d+"}":"HSVA_OBJ"===n?"{h:"+a+",s:"+l+",v:"+d+",a:"+s+"}":"unknown format"}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.GUI=exports.gui=exports.dom=exports.controllers=exports.color=void 0;var n=Array.prototype.forEach,o=Array.prototype.slice,i={BREAK:{},extend:function(e){return this.each(o.call(arguments,1),function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(n){this.isUndefined(t[n])||(e[n]=t[n])}.bind(this))},this),e},defaults:function(e){return this.each(o.call(arguments,1),function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(n){this.isUndefined(e[n])&&(e[n]=t[n])}.bind(this))},this),e},compose:function(){var e=o.call(arguments);return function(){for(var t=o.call(arguments),n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},each:function(e,t,o){if(e)if(n&&e.forEach&&e.forEach===n)e.forEach(t,o);else if(e.length===e.length+0){var i,r=void 0;for(r=0,i=e.length;r<i;r++)if(r in e&&t.call(o,e[r],r)===this.BREAK)return}else for(var s in e)if(t.call(o,e[s],s)===this.BREAK)return},defer:function(e){setTimeout(e,0)},debounce:function(e,t,n){var o=void 0;return function(){var i=this,r=arguments;var s=n||!o;clearTimeout(o),o=setTimeout(function(){o=null,n||e.apply(i,r)},t),s&&e.apply(i,r)}},toArray:function(e){return e.toArray?e.toArray():o.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return isNaN(e)}),isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return!1===e||!0===e},isFunction:function(e){return e instanceof Function}},r=[{litmus:i.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:t},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:t},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:t},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:t}}},{litmus:i.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:i.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:i.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(i.isNumber(e.r)&&i.isNumber(e.g)&&i.isNumber(e.b)&&i.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(i.isNumber(e.r)&&i.isNumber(e.g)&&i.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(i.isNumber(e.h)&&i.isNumber(e.s)&&i.isNumber(e.v)&&i.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(i.isNumber(e.h)&&i.isNumber(e.s)&&i.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],s=void 0,a=void 0,l=function(){a=!1;var e=arguments.length>1?i.toArray(arguments):arguments[0];return i.each(r,function(t){if(t.litmus(e))return i.each(t.conversions,function(t,n){if(s=t.read(e),!1===a&&!1!==s)return a=s,s.conversionName=n,s.conversion=t,i.BREAK}),i.BREAK}),a},d=void 0,c={hsv_to_rgb:function(e,t,n){var o=Math.floor(e/60)%6,i=e/60-Math.floor(e/60),r=n*(1-t),s=n*(1-i*t),a=n*(1-(1-i)*t),l=[[n,a,r],[s,n,r],[r,n,a],[r,s,n],[a,r,n],[n,r,s]][o];return{r:255*l[0],g:255*l[1],b:255*l[2]}},rgb_to_hsv:function(e,t,n){var o=Math.min(e,t,n),i=Math.max(e,t,n),r=i-o,s=void 0;return 0===i?{h:NaN,s:0,v:0}:(s=e===i?(t-n)/r:t===i?2+(n-e)/r:4+(e-t)/r,(s/=6)<0&&(s+=1),{h:360*s,s:r/i,v:i/255})},rgb_to_hex:function(e,t,n){var o=this.hex_with_component(0,2,e);return o=this.hex_with_component(o,1,t),o=this.hex_with_component(o,0,n)},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(e,t,n){return n<<(d=8*t)|e&~(255<<d)}},u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},h=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),p=function e(t,n,o){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var r=Object.getPrototypeOf(t);return null===r?void 0:e(r,n,o)}if("value"in i)return i.value;var s=i.get;return void 0!==s?s.call(o):void 0},f=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},m=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},g=function(){function e(){if(_(this,e),this.__state=l.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return h(e,[{key:"toString",value:function(){return t(this)}},{key:"toHexString",value:function(){return t(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),e}();function b(e,t,n){Object.defineProperty(e,t,{get:function(){return"RGB"===this.__state.space?this.__state[t]:(g.recalculateRGB(this,t,n),this.__state[t])},set:function(e){"RGB"!==this.__state.space&&(g.recalculateRGB(this,t,n),this.__state.space="RGB"),this.__state[t]=e}})}function v(e,t){Object.defineProperty(e,t,{get:function(){return"HSV"===this.__state.space?this.__state[t]:(g.recalculateHSV(this),this.__state[t])},set:function(e){"HSV"!==this.__state.space&&(g.recalculateHSV(this),this.__state.space="HSV"),this.__state[t]=e}})}g.recalculateRGB=function(e,t,n){if("HEX"===e.__state.space)e.__state[t]=c.component_from_hex(e.__state.hex,n);else{if("HSV"!==e.__state.space)throw new Error("Corrupted color state");i.extend(e.__state,c.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}},g.recalculateHSV=function(e){var t=c.rgb_to_hsv(e.r,e.g,e.b);i.extend(e.__state,{s:t.s,v:t.v}),i.isNaN(t.h)?i.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=t.h},g.COMPONENTS=["r","g","b","h","s","v","hex","a"],b(g.prototype,"r",2),b(g.prototype,"g",1),b(g.prototype,"b",0),v(g.prototype,"h"),v(g.prototype,"s"),v(g.prototype,"v"),Object.defineProperty(g.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(g.prototype,"hex",{get:function(){return"HEX"!==this.__state.space&&(this.__state.hex=c.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var y=function(){function e(t,n){_(this,e),this.initialValue=t[n],this.domElement=document.createElement("div"),this.object=t,this.property=n,this.__onChange=void 0,this.__onFinishChange=void 0}return h(e,[{key:"onChange",value:function(e){return this.__onChange=e,this}},{key:"onFinishChange",value:function(e){return this.__onFinishChange=e,this}},{key:"setValue",value:function(e){return this.object[this.property]=e,this.__onChange&&this.__onChange.call(this,e),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),e}(),w={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},x={};i.each(w,function(e,t){i.each(e,function(e){x[e]=t})});var E=/(\d+(\.\d+)?)px/;function C(e){if("0"===e||i.isUndefined(e))return 0;var t=e.match(E);return i.isNull(t)?0:parseFloat(t[1])}var A={makeSelectable:function(e,t){void 0!==e&&void 0!==e.style&&(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,n){var o=n,r=t;i.isUndefined(r)&&(r=!0),i.isUndefined(o)&&(o=!0),e.style.position="absolute",r&&(e.style.left=0,e.style.right=0),o&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,n,o){var r=n||{},s=x[t];if(!s)throw new Error("Event type "+t+" not supported.");var a=document.createEvent(s);switch(s){case"MouseEvents":var l=r.x||r.clientX||0,d=r.y||r.clientY||0;a.initMouseEvent(t,r.bubbles||!1,r.cancelable||!0,window,r.clickCount||1,0,0,l,d,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var c=a.initKeyboardEvent||a.initKeyEvent;i.defaults(r,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),c(t,r.bubbles||!1,r.cancelable,window,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.keyCode,r.charCode);break;default:a.initEvent(t,r.bubbles||!1,r.cancelable||!0)}i.defaults(a,o),e.dispatchEvent(a)},bind:function(e,t,n,o){var i=o||!1;return e.addEventListener?e.addEventListener(t,n,i):e.attachEvent&&e.attachEvent("on"+t,n),A},unbind:function(e,t,n,o){var i=o||!1;return e.removeEventListener?e.removeEventListener(t,n,i):e.detachEvent&&e.detachEvent("on"+t,n),A},addClass:function(e,t){if(void 0===e.className)e.className=t;else if(e.className!==t){var n=e.className.split(/ +/);-1===n.indexOf(t)&&(n.push(t),e.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return A},removeClass:function(e,t){if(t)if(e.className===t)e.removeAttribute("class");else{var n=e.className.split(/ +/),o=n.indexOf(t);-1!==o&&(n.splice(o,1),e.className=n.join(" "))}else e.className=void 0;return A},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var t=getComputedStyle(e);return C(t["border-left-width"])+C(t["border-right-width"])+C(t["padding-left"])+C(t["padding-right"])+C(t.width)},getHeight:function(e){var t=getComputedStyle(e);return C(t["border-top-width"])+C(t["border-bottom-width"])+C(t["padding-top"])+C(t["padding-bottom"])+C(t.height)},getOffset:function(e){var t=e,n={left:0,top:0};if(t.offsetParent)do{n.left+=t.offsetLeft,n.top+=t.offsetTop,t=t.offsetParent}while(t);return n},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},k=function(e){function t(e,n){_(this,t);var o=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),i=o;return o.__prev=o.getValue(),o.__checkbox=document.createElement("input"),o.__checkbox.setAttribute("type","checkbox"),A.bind(o.__checkbox,"change",function(){i.setValue(!i.__prev)},!1),o.domElement.appendChild(o.__checkbox),o.updateDisplay(),o}return f(t,y),h(t,[{key:"setValue",value:function(e){var n=p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),n}},{key:"updateDisplay",value:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(),S=function(e){function t(e,n,o){_(this,t);var r=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),s=o,a=r;if(r.__select=document.createElement("select"),i.isArray(s)){var l={};i.each(s,function(e){l[e]=e}),s=l}return i.each(s,function(e,t){var n=document.createElement("option");n.innerHTML=t,n.setAttribute("value",e),a.__select.appendChild(n)}),r.updateDisplay(),A.bind(r.__select,"change",function(){var e=this.options[this.selectedIndex].value;a.setValue(e)}),r.domElement.appendChild(r.__select),r}return f(t,y),h(t,[{key:"setValue",value:function(e){var n=p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),n}},{key:"updateDisplay",value:function(){return A.isActive(this.__select)?this:(this.__select.value=this.getValue(),p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this))}}]),t}(),O=function(e){function t(e,n){_(this,t);var o=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),i=o;function r(){i.setValue(i.__input.value)}return o.__input=document.createElement("input"),o.__input.setAttribute("type","text"),A.bind(o.__input,"keyup",r),A.bind(o.__input,"change",r),A.bind(o.__input,"blur",function(){i.__onFinishChange&&i.__onFinishChange.call(i,i.getValue())}),A.bind(o.__input,"keydown",function(e){13===e.keyCode&&this.blur()}),o.updateDisplay(),o.domElement.appendChild(o.__input),o}return f(t,y),h(t,[{key:"updateDisplay",value:function(){return A.isActive(this.__input)||(this.__input.value=this.getValue()),p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}();function T(e){var t=e.toString();return t.indexOf(".")>-1?t.length-t.indexOf(".")-1:0}var L=function(e){function t(e,n,o){_(this,t);var r=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),s=o||{};return r.__min=s.min,r.__max=s.max,r.__step=s.step,i.isUndefined(r.__step)?0===r.initialValue?r.__impliedStep=1:r.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(r.initialValue))/Math.LN10))/10:r.__impliedStep=r.__step,r.__precision=T(r.__impliedStep),r}return f(t,y),h(t,[{key:"setValue",value:function(e){var n=e;return void 0!==this.__min&&n<this.__min?n=this.__min:void 0!==this.__max&&n>this.__max&&(n=this.__max),void 0!==this.__step&&n%this.__step!=0&&(n=Math.round(n/this.__step)*this.__step),p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,n)}},{key:"min",value:function(e){return this.__min=e,this}},{key:"max",value:function(e){return this.__max=e,this}},{key:"step",value:function(e){return this.__step=e,this.__impliedStep=e,this.__precision=T(e),this}}]),t}();function R(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}var B=function(e){function t(e,n,o){_(this,t);var r=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,o));r.__truncationSuspended=!1;var s=r,a=void 0;function l(){s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}function d(e){var t=a-e.clientY;s.setValue(s.getValue()+t*s.__impliedStep),a=e.clientY}function c(){A.unbind(window,"mousemove",d),A.unbind(window,"mouseup",c),l()}return r.__input=document.createElement("input"),r.__input.setAttribute("type","text"),A.bind(r.__input,"change",function(){var e=parseFloat(s.__input.value);i.isNaN(e)||s.setValue(e)}),A.bind(r.__input,"blur",function(){l()}),A.bind(r.__input,"mousedown",function(e){A.bind(window,"mousemove",d),A.bind(window,"mouseup",c),a=e.clientY}),A.bind(r.__input,"keydown",function(e){13===e.keyCode&&(s.__truncationSuspended=!0,this.blur(),s.__truncationSuspended=!1,l())}),r.updateDisplay(),r.domElement.appendChild(r.__input),r}return f(t,L),h(t,[{key:"updateDisplay",value:function(){return this.__input.value=this.__truncationSuspended?this.getValue():R(this.getValue(),this.__precision),p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}();function N(e,t,n,o,i){return o+(e-t)/(n-t)*(i-o)}var H=function(e){function t(e,n,o,i,r){_(this,t);var s=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,{min:o,max:i,step:r})),a=s;function l(e){e.preventDefault();var t=a.__background.getBoundingClientRect();return a.setValue(N(e.clientX,t.left,t.right,a.__min,a.__max)),!1}function d(){A.unbind(window,"mousemove",l),A.unbind(window,"mouseup",d),a.__onFinishChange&&a.__onFinishChange.call(a,a.getValue())}function c(e){var t=e.touches[0].clientX,n=a.__background.getBoundingClientRect();a.setValue(N(t,n.left,n.right,a.__min,a.__max))}function u(){A.unbind(window,"touchmove",c),A.unbind(window,"touchend",u),a.__onFinishChange&&a.__onFinishChange.call(a,a.getValue())}return s.__background=document.createElement("div"),s.__foreground=document.createElement("div"),A.bind(s.__background,"mousedown",function(e){document.activeElement.blur(),A.bind(window,"mousemove",l),A.bind(window,"mouseup",d),l(e)}),A.bind(s.__background,"touchstart",function(e){if(1!==e.touches.length)return;A.bind(window,"touchmove",c),A.bind(window,"touchend",u),c(e)}),A.addClass(s.__background,"slider"),A.addClass(s.__foreground,"slider-fg"),s.updateDisplay(),s.__background.appendChild(s.__foreground),s.domElement.appendChild(s.__background),s}return f(t,L),h(t,[{key:"updateDisplay",value:function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*e+"%",p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(),F=function(e){function t(e,n,o){_(this,t);var i=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),r=i;return i.__button=document.createElement("div"),i.__button.innerHTML=void 0===o?"Fire":o,A.bind(i.__button,"click",function(e){return e.preventDefault(),r.fire(),!1}),A.addClass(i.__button,"button"),i.domElement.appendChild(i.__button),i}return f(t,y),h(t,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),t}(),P=function(e){function t(e,n){_(this,t);var o=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));o.__color=new g(o.getValue()),o.__temp=new g(0);var r=o;o.domElement=document.createElement("div"),A.makeSelectable(o.domElement,!1),o.__selector=document.createElement("div"),o.__selector.className="selector",o.__saturation_field=document.createElement("div"),o.__saturation_field.className="saturation-field",o.__field_knob=document.createElement("div"),o.__field_knob.className="field-knob",o.__field_knob_border="2px solid ",o.__hue_knob=document.createElement("div"),o.__hue_knob.className="hue-knob",o.__hue_field=document.createElement("div"),o.__hue_field.className="hue-field",o.__input=document.createElement("input"),o.__input.type="text",o.__input_textShadow="0 1px 1px ",A.bind(o.__input,"keydown",function(e){13===e.keyCode&&h.call(this)}),A.bind(o.__input,"blur",h),A.bind(o.__selector,"mousedown",function(){A.addClass(this,"drag").bind(window,"mouseup",function(){A.removeClass(r.__selector,"drag")})}),A.bind(o.__selector,"touchstart",function(){A.addClass(this,"drag").bind(window,"touchend",function(){A.removeClass(r.__selector,"drag")})});var s=document.createElement("div");function a(e){f(e),A.bind(window,"mousemove",f),A.bind(window,"touchmove",f),A.bind(window,"mouseup",c),A.bind(window,"touchend",c)}function d(e){b(e),A.bind(window,"mousemove",b),A.bind(window,"touchmove",b),A.bind(window,"mouseup",u),A.bind(window,"touchend",u)}function c(){A.unbind(window,"mousemove",f),A.unbind(window,"touchmove",f),A.unbind(window,"mouseup",c),A.unbind(window,"touchend",c),p()}function u(){A.unbind(window,"mousemove",b),A.unbind(window,"touchmove",b),A.unbind(window,"mouseup",u),A.unbind(window,"touchend",u),p()}function h(){var e=l(this.value);!1!==e?(r.__color.__state=e,r.setValue(r.__color.toOriginal())):this.value=r.__color.toString()}function p(){r.__onFinishChange&&r.__onFinishChange.call(r,r.__color.toOriginal())}function f(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=r.__saturation_field.getBoundingClientRect(),n=e.touches&&e.touches[0]||e,o=n.clientX,i=n.clientY,s=(o-t.left)/(t.right-t.left),a=1-(i-t.top)/(t.bottom-t.top);return a>1?a=1:a<0&&(a=0),s>1?s=1:s<0&&(s=0),r.__color.v=a,r.__color.s=s,r.setValue(r.__color.toOriginal()),!1}function b(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=r.__hue_field.getBoundingClientRect(),n=1-((e.touches&&e.touches[0]||e).clientY-t.top)/(t.bottom-t.top);return n>1?n=1:n<0&&(n=0),r.__color.h=360*n,r.setValue(r.__color.toOriginal()),!1}return i.extend(o.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),i.extend(o.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:o.__field_knob_border+(o.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),i.extend(o.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),i.extend(o.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),i.extend(s.style,{width:"100%",height:"100%",background:"none"}),j(s,"top","rgba(0,0,0,0)","#000"),i.extend(o.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),V(o.__hue_field),i.extend(o.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:o.__input_textShadow+"rgba(0,0,0,0.7)"}),A.bind(o.__saturation_field,"mousedown",a),A.bind(o.__saturation_field,"touchstart",a),A.bind(o.__field_knob,"mousedown",a),A.bind(o.__field_knob,"touchstart",a),A.bind(o.__hue_field,"mousedown",d),A.bind(o.__hue_field,"touchstart",d),o.__saturation_field.appendChild(s),o.__selector.appendChild(o.__field_knob),o.__selector.appendChild(o.__saturation_field),o.__selector.appendChild(o.__hue_field),o.__hue_field.appendChild(o.__hue_knob),o.domElement.appendChild(o.__input),o.domElement.appendChild(o.__selector),o.updateDisplay(),o}return f(t,y),h(t,[{key:"updateDisplay",value:function(){var e=l(this.getValue());if(!1!==e){var t=!1;i.each(g.COMPONENTS,function(n){if(!i.isUndefined(e[n])&&!i.isUndefined(this.__color.__state[n])&&e[n]!==this.__color.__state[n])return t=!0,{}},this),t&&i.extend(this.__color.__state,e)}i.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var n=this.__color.v<.5||this.__color.s>.5?255:0,o=255-n;i.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+n+","+n+","+n+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,j(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),i.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+n+","+n+","+n+")",textShadow:this.__input_textShadow+"rgba("+o+","+o+","+o+",.7)"})}}]),t}(),D=["-moz-","-o-","-webkit-","-ms-",""];function j(e,t,n,o){e.style.background="",i.each(D,function(i){e.style.cssText+="background: "+i+"linear-gradient("+t+", "+n+" 0%, "+o+" 100%); "})}function V(e){e.style.background="",e.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",e.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var I={load:function(e,t){var n=t||document,o=n.createElement("link");o.type="text/css",o.rel="stylesheet",o.href=e,n.getElementsByTagName("head")[0].appendChild(o)},inject:function(e,t){var n=t||document,o=document.createElement("style");o.type="text/css",o.innerHTML=e;var i=n.getElementsByTagName("head")[0];try{i.appendChild(o)}catch(r){}}},z='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>',M=function(e,t){var n=e[t];return i.isArray(arguments[2])||i.isObject(arguments[2])?new S(e,t,arguments[2]):i.isNumber(n)?i.isNumber(arguments[2])&&i.isNumber(arguments[3])?i.isNumber(arguments[4])?new H(e,t,arguments[2],arguments[3],arguments[4]):new H(e,t,arguments[2],arguments[3]):i.isNumber(arguments[4])?new B(e,t,{min:arguments[2],max:arguments[3],step:arguments[4]}):new B(e,t,{min:arguments[2],max:arguments[3]}):i.isString(n)?new O(e,t):i.isFunction(n)?new F(e,t,""):i.isBoolean(n)?new k(e,t):null};function G(e){setTimeout(e,1e3/60)}var U=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||G,X=function(){function e(){_(this,e),this.backgroundElement=document.createElement("div"),i.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),A.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),i.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var t=this;A.bind(this.backgroundElement,"click",function(){t.hide()})}return h(e,[{key:"show",value:function(){var e=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),i.defer(function(){e.backgroundElement.style.opacity=1,e.domElement.style.opacity=1,e.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){var e=this,t=function t(){e.domElement.style.display="none",e.backgroundElement.style.display="none",A.unbind(e.domElement,"webkitTransitionEnd",t),A.unbind(e.domElement,"transitionend",t),A.unbind(e.domElement,"oTransitionEnd",t)};A.bind(this.domElement,"webkitTransitionEnd",t),A.bind(this.domElement,"transitionend",t),A.bind(this.domElement,"oTransitionEnd",t),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-A.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-A.getHeight(this.domElement)/2+"px"}}]),e}(),K=e(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n");I.inject(K);var Y="dg",J=72,W=20,Q="Default",q=function(){try{return!!window.localStorage}catch(e){return!1}}(),Z=void 0,$=!0,ee=void 0,te=!1,ne=[],oe=function e(t){var n=this,o=t||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),A.addClass(this.domElement,Y),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],o=i.defaults(o,{closeOnTop:!1,autoPlace:!0,width:e.DEFAULT_WIDTH}),o=i.defaults(o,{resizable:o.autoPlace,hideable:o.autoPlace}),i.isUndefined(o.load)?o.load={preset:Q}:o.preset&&(o.load.preset=o.preset),i.isUndefined(o.parent)&&o.hideable&&ne.push(this),o.resizable=i.isUndefined(o.parent)&&o.resizable,o.autoPlace&&i.isUndefined(o.scrollable)&&(o.scrollable=!0);var r,s=q&&"true"===localStorage.getItem(ce(this,"isLocal")),a=void 0,l=void 0;if(Object.defineProperties(this,{parent:{get:function(){return o.parent}},scrollable:{get:function(){return o.scrollable}},autoPlace:{get:function(){return o.autoPlace}},closeOnTop:{get:function(){return o.closeOnTop}},preset:{get:function(){return n.parent?n.getRoot().preset:o.load.preset},set:function(e){n.parent?n.getRoot().preset=e:o.load.preset=e,ge(this),n.revert()}},width:{get:function(){return o.width},set:function(e){o.width=e,fe(n,e)}},name:{get:function(){return o.name},set:function(e){o.name=e,l&&(l.innerHTML=o.name)}},closed:{get:function(){return o.closed},set:function(t){o.closed=t,o.closed?A.addClass(n.__ul,e.CLASS_CLOSED):A.removeClass(n.__ul,e.CLASS_CLOSED),this.onResize(),n.__closeButton&&(n.__closeButton.innerHTML=t?e.TEXT_OPEN:e.TEXT_CLOSED)}},load:{get:function(){return o.load}},useLocalStorage:{get:function(){return s},set:function(e){q&&(s=e,e?A.bind(window,"unload",a):A.unbind(window,"unload",a),localStorage.setItem(ce(n,"isLocal"),e))}}}),i.isUndefined(o.parent)){if(this.closed=o.closed||!1,A.addClass(this.domElement,e.CLASS_MAIN),A.makeSelectable(this.domElement,!1),q&&s){n.useLocalStorage=!0;var d=localStorage.getItem(ce(this,"gui"));d&&(o.load=JSON.parse(d))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=e.TEXT_CLOSED,A.addClass(this.__closeButton,e.CLASS_CLOSE_BUTTON),o.closeOnTop?(A.addClass(this.__closeButton,e.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(A.addClass(this.__closeButton,e.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),A.bind(this.__closeButton,"click",function(){n.closed=!n.closed})}else{void 0===o.closed&&(o.closed=!0);var c=document.createTextNode(o.name);A.addClass(c,"controller-name"),l=ie(n,c);A.addClass(this.__ul,e.CLASS_CLOSED),A.addClass(l,"title"),A.bind(l,"click",function(e){return e.preventDefault(),n.closed=!n.closed,!1}),o.closed||(this.closed=!1)}o.autoPlace&&(i.isUndefined(o.parent)&&($&&(ee=document.createElement("div"),A.addClass(ee,Y),A.addClass(ee,e.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(ee),$=!1),ee.appendChild(this.domElement),A.addClass(this.domElement,e.CLASS_AUTO_PLACE)),this.parent||fe(n,o.width)),this.__resizeHandler=function(){n.onResizeDebounced()},A.bind(window,"resize",this.__resizeHandler),A.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),A.bind(this.__ul,"transitionend",this.__resizeHandler),A.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),o.resizable&&pe(this),a=function(){q&&"true"===localStorage.getItem(ce(n,"isLocal"))&&localStorage.setItem(ce(n,"gui"),JSON.stringify(n.getSaveObject()))},this.saveToLocalStorageIfPossible=a,o.parent||((r=n.getRoot()).width+=1,i.defer(function(){r.width-=1}))};function ie(e,t,n){var o=document.createElement("li");return t&&o.appendChild(t),n?e.__ul.insertBefore(o,n):e.__ul.appendChild(o),e.onResize(),o}function re(e){A.unbind(window,"resize",e.__resizeHandler),e.saveToLocalStorageIfPossible&&A.unbind(window,"unload",e.saveToLocalStorageIfPossible)}function se(e,t){var n=e.__preset_select[e.__preset_select.selectedIndex];n.innerHTML=t?n.value+"*":n.value}function ae(e,t,n){if(n.__li=t,n.__gui=e,i.extend(n,{options:function(t){if(arguments.length>1){var o=n.__li.nextElementSibling;return n.remove(),de(e,n.object,n.property,{before:o,factoryArgs:[i.toArray(arguments)]})}if(i.isArray(t)||i.isObject(t)){var r=n.__li.nextElementSibling;return n.remove(),de(e,n.object,n.property,{before:r,factoryArgs:[t]})}},name:function(e){return n.__li.firstElementChild.firstElementChild.innerHTML=e,n},listen:function(){return n.__gui.listen(n),n},remove:function(){return n.__gui.remove(n),n}}),n instanceof H){var o=new B(n.object,n.property,{min:n.__min,max:n.__max,step:n.__step});i.each(["updateDisplay","onChange","onFinishChange","step","min","max"],function(e){var t=n[e],i=o[e];n[e]=o[e]=function(){var e=Array.prototype.slice.call(arguments);return i.apply(o,e),t.apply(n,e)}}),A.addClass(t,"has-slider"),n.domElement.insertBefore(o.domElement,n.domElement.firstElementChild)}else if(n instanceof B){var r=function(t){if(i.isNumber(n.__min)&&i.isNumber(n.__max)){var o=n.__li.firstElementChild.firstElementChild.innerHTML,r=n.__gui.__listening.indexOf(n)>-1;n.remove();var s=de(e,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[n.__min,n.__max,n.__step]});return s.name(o),r&&s.listen(),s}return t};n.min=i.compose(r,n.min),n.max=i.compose(r,n.max)}else n instanceof k?(A.bind(t,"click",function(){A.fakeEvent(n.__checkbox,"click")}),A.bind(n.__checkbox,"click",function(e){e.stopPropagation()})):n instanceof F?(A.bind(t,"click",function(){A.fakeEvent(n.__button,"click")}),A.bind(t,"mouseover",function(){A.addClass(n.__button,"hover")}),A.bind(t,"mouseout",function(){A.removeClass(n.__button,"hover")})):n instanceof P&&(A.addClass(t,"color"),n.updateDisplay=i.compose(function(e){return t.style.borderLeftColor=n.__color.toString(),e},n.updateDisplay),n.updateDisplay());n.setValue=i.compose(function(t){return e.getRoot().__preset_select&&n.isModified()&&se(e.getRoot(),!0),t},n.setValue)}function le(e,t){var n=e.getRoot(),o=n.__rememberedObjects.indexOf(t.object);if(-1!==o){var i=n.__rememberedObjectIndecesToControllers[o];if(void 0===i&&(i={},n.__rememberedObjectIndecesToControllers[o]=i),i[t.property]=t,n.load&&n.load.remembered){var r=n.load.remembered,s=void 0;if(r[e.preset])s=r[e.preset];else{if(!r[Q])return;s=r[Q]}if(s[o]&&void 0!==s[o][t.property]){var a=s[o][t.property];t.initialValue=a,t.setValue(a)}}}}function de(e,t,n,o){if(void 0===t[n])throw new Error('Object "'+t+'" has no property "'+n+'"');var i=void 0;if(o.color)i=new P(t,n);else{var r=[t,n].concat(o.factoryArgs);i=M.apply(e,r)}o.before instanceof y&&(o.before=o.before.__li),le(e,i),A.addClass(i.domElement,"c");var s=document.createElement("span");A.addClass(s,"property-name"),s.innerHTML=i.property;var a=document.createElement("div");a.appendChild(s),a.appendChild(i.domElement);var l=ie(e,a,o.before);return A.addClass(l,oe.CLASS_CONTROLLER_ROW),i instanceof P?A.addClass(l,"color"):A.addClass(l,u(i.getValue())),ae(e,l,i),e.__controllers.push(i),i}function ce(e,t){return document.location.href+"."+t}function ue(e,t,n){var o=document.createElement("option");o.innerHTML=t,o.value=t,e.__preset_select.appendChild(o),n&&(e.__preset_select.selectedIndex=e.__preset_select.length-1)}function _e(e,t){t.style.display=e.useLocalStorage?"block":"none"}function he(e){var t=e.__save_row=document.createElement("li");A.addClass(e.domElement,"has-save"),e.__ul.insertBefore(t,e.__ul.firstChild),A.addClass(t,"save-row");var n=document.createElement("span");n.innerHTML="&nbsp;",A.addClass(n,"button gears");var o=document.createElement("span");o.innerHTML="Save",A.addClass(o,"button"),A.addClass(o,"save");var r=document.createElement("span");r.innerHTML="New",A.addClass(r,"button"),A.addClass(r,"save-as");var s=document.createElement("span");s.innerHTML="Revert",A.addClass(s,"button"),A.addClass(s,"revert");var a=e.__preset_select=document.createElement("select");if(e.load&&e.load.remembered?i.each(e.load.remembered,function(t,n){ue(e,n,n===e.preset)}):ue(e,Q,!1),A.bind(a,"change",function(){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].innerHTML=e.__preset_select[t].value;e.preset=this.value}),t.appendChild(a),t.appendChild(n),t.appendChild(o),t.appendChild(r),t.appendChild(s),q){var l=document.getElementById("dg-local-explain"),d=document.getElementById("dg-local-storage");document.getElementById("dg-save-locally").style.display="block","true"===localStorage.getItem(ce(e,"isLocal"))&&d.setAttribute("checked","checked"),_e(e,l),A.bind(d,"change",function(){e.useLocalStorage=!e.useLocalStorage,_e(e,l)})}var c=document.getElementById("dg-new-constructor");A.bind(c,"keydown",function(e){!e.metaKey||67!==e.which&&67!==e.keyCode||Z.hide()}),A.bind(n,"click",function(){c.innerHTML=JSON.stringify(e.getSaveObject(),void 0,2),Z.show(),c.focus(),c.select()}),A.bind(o,"click",function(){e.save()}),A.bind(r,"click",function(){var t=prompt("Enter a new preset name.");t&&e.saveAs(t)}),A.bind(s,"click",function(){e.revert()})}function pe(e){var t=void 0;function n(n){return n.preventDefault(),e.width+=t-n.clientX,e.onResize(),t=n.clientX,!1}function o(){A.removeClass(e.__closeButton,oe.CLASS_DRAG),A.unbind(window,"mousemove",n),A.unbind(window,"mouseup",o)}function r(i){return i.preventDefault(),t=i.clientX,A.addClass(e.__closeButton,oe.CLASS_DRAG),A.bind(window,"mousemove",n),A.bind(window,"mouseup",o),!1}e.__resize_handle=document.createElement("div"),i.extend(e.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),A.bind(e.__resize_handle,"mousedown",r),A.bind(e.__closeButton,"mousedown",r),e.domElement.insertBefore(e.__resize_handle,e.domElement.firstElementChild)}function fe(e,t){e.domElement.style.width=t+"px",e.__save_row&&e.autoPlace&&(e.__save_row.style.width=t+"px"),e.__closeButton&&(e.__closeButton.style.width=t+"px")}function me(e,t){var n={};return i.each(e.__rememberedObjects,function(o,r){var s={},a=e.__rememberedObjectIndecesToControllers[r];i.each(a,function(e,n){s[n]=t?e.initialValue:e.getValue()}),n[r]=s}),n}function ge(e){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].value===e.preset&&(e.__preset_select.selectedIndex=t)}function be(e){0!==e.length&&U.call(window,function(){be(e)}),i.each(e,function(e){e.updateDisplay()})}oe.toggleHide=function(){te=!te,i.each(ne,function(e){e.domElement.style.display=te?"none":""})},oe.CLASS_AUTO_PLACE="a",oe.CLASS_AUTO_PLACE_CONTAINER="ac",oe.CLASS_MAIN="main",oe.CLASS_CONTROLLER_ROW="cr",oe.CLASS_TOO_TALL="taller-than-window",oe.CLASS_CLOSED="closed",oe.CLASS_CLOSE_BUTTON="close-button",oe.CLASS_CLOSE_TOP="close-top",oe.CLASS_CLOSE_BOTTOM="close-bottom",oe.CLASS_DRAG="drag",oe.DEFAULT_WIDTH=245,oe.TEXT_CLOSED="Close Controls",oe.TEXT_OPEN="Open Controls",oe._keydownHandler=function(e){"text"===document.activeElement.type||e.which!==J&&e.keyCode!==J||oe.toggleHide()},A.bind(window,"keydown",oe._keydownHandler,!1),i.extend(oe.prototype,{add:function(e,t){return de(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return de(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;i.defer(function(){t.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&ee.removeChild(this.domElement);var e=this;i.each(this.__folders,function(t){e.removeFolder(t)}),A.unbind(window,"keydown",oe._keydownHandler,!1),re(this)},addFolder:function(e){if(void 0!==this.__folders[e])throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var n=new oe(t);this.__folders[e]=n;var o=ie(this,n.domElement);return A.addClass(o,"folder"),n},removeFolder:function(e){this.__ul.removeChild(e.domElement.parentElement),delete this.__folders[e.name],this.load&&this.load.folders&&this.load.folders[e.name]&&delete this.load.folders[e.name],re(e);var t=this;i.each(e.__folders,function(t){e.removeFolder(t)}),i.defer(function(){t.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=A.getOffset(e.__ul).top,n=0;i.each(e.__ul.childNodes,function(t){e.autoPlace&&t===e.__save_row||(n+=A.getHeight(t))}),window.innerHeight-t-W<n?(A.addClass(e.domElement,oe.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-W+"px"):(A.removeClass(e.domElement,oe.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&i.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"}),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},onResizeDebounced:i.debounce(function(){this.onResize()},50),remember:function(){if(i.isUndefined(Z)&&((Z=new X).domElement.innerHTML=z),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;i.each(Array.prototype.slice.call(arguments),function(t){0===e.__rememberedObjects.length&&he(e),-1===e.__rememberedObjects.indexOf(t)&&e.__rememberedObjects.push(t)}),this.autoPlace&&fe(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=me(this)),e.folders={},i.each(this.__folders,function(t,n){e.folders[n]=t.getSaveObject()}),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=me(this),se(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[Q]=me(this,!0)),this.load.remembered[e]=me(this),this.preset=e,ue(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(e){i.each(this.__controllers,function(t){this.getRoot().load.remembered?le(e||this.getRoot(),t):t.setValue(t.initialValue),t.__onFinishChange&&t.__onFinishChange.call(t,t.getValue())},this),i.each(this.__folders,function(e){e.revert(e)}),e||se(this.getRoot(),!1)},listen:function(e){var t=0===this.__listening.length;this.__listening.push(e),t&&be(this.__listening)},updateDisplay:function(){i.each(this.__controllers,function(e){e.updateDisplay()}),i.each(this.__folders,function(e){e.updateDisplay()})}});var ve={Color:g,math:c,interpret:l};exports.color=ve;var ye={Controller:y,BooleanController:k,OptionController:S,StringController:O,NumberController:L,NumberControllerBox:B,NumberControllerSlider:H,FunctionController:F,ColorController:P};exports.controllers=ye;var we={dom:A};exports.dom=we;var xe={GUI:oe};exports.gui=xe;var Ee=oe;exports.GUI=Ee;var Ce={color:ve,controllers:ye,dom:we,gui:xe,GUI:Ee},Ae=Ce;exports.default=Ae;
},{}],"dMVz":[function(require,module,exports) {
module.exports="/ludum-48/instructions.93dce176.png";
},{}],"oInr":[function(require,module,exports) {
module.exports="/ludum-48/sword.06983194.png";
},{}],"g3Ht":[function(require,module,exports) {
module.exports="/ludum-48/dirt_001.f3fa8da3.png";
},{}],"ApYq":[function(require,module,exports) {
module.exports="/ludum-48/dirt_bones.713b1cec.png";
},{}],"dGcn":[function(require,module,exports) {
module.exports="/ludum-48/dirt_back.a0422084.png";
},{}],"Vsuw":[function(require,module,exports) {
module.exports="/ludum-48/dirt_tunnel.9c341750.png";
},{}],"vX90":[function(require,module,exports) {
module.exports="/ludum-48/dirt_side.e06593d9.png";
},{}],"Gcyu":[function(require,module,exports) {
module.exports="/ludum-48/dirt_angle.74ad8e21.png";
},{}],"EGmg":[function(require,module,exports) {
module.exports="/ludum-48/rock_001.ac65660b.png";
},{}],"LEQd":[function(require,module,exports) {
module.exports="/ludum-48/rock_002.3271bc46.png";
},{}],"UX7r":[function(require,module,exports) {
module.exports="/ludum-48/fall.ad192362.wav";
},{}],"ZG0m":[function(require,module,exports) {
module.exports="/ludum-48/clank.897e0dda.wav";
},{}],"Uosn":[function(require,module,exports) {
module.exports="/ludum-48/clank.55f78130.mp3";
},{}],"qhOA":[function(require,module,exports) {
module.exports="/ludum-48/getitem.df5c1677.wav";
},{}],"kqCS":[function(require,module,exports) {
module.exports="/ludum-48/background.99aba926.mp3";
},{}],"RD3R":[function(require,module,exports) {
module.exports="/ludum-48/background.26174288.wav";
},{}],"RCTW":[function(require,module,exports) {
module.exports="/ludum-48/modal.89223b98.png";
},{}],"saFP":[function(require,module,exports) {
module.exports="/ludum-48/mecha-snek.54607980.png";
},{}],"atoM":[function(require,module,exports) {
module.exports="/ludum-48/energy-drink.c3428bd4.png";
},{}],"EvMN":[function(require,module,exports) {
module.exports="/ludum-48/meter.4c9327d9.png";
},{}],"MmYr":[function(require,module,exports) {
module.exports="/ludum-48/spritefont.571876bb.png";
},{}],"IAwo":[function(require,module,exports) {
module.exports="/ludum-48/meerkat_avatars.dda932f5.png";
},{}],"vAH6":[function(require,module,exports) {
module.exports="/ludum-48/digging.c5011241.png";
},{}],"F8qb":[function(require,module,exports) {
module.exports="/ludum-48/digging_2.59fd6c19.png";
},{}],"vdAb":[function(require,module,exports) {
module.exports="/ludum-48/digging_3.13f9061f.png";
},{}],"nAEU":[function(require,module,exports) {
module.exports="/ludum-48/digging_4.18e56a8e.png";
},{}],"ROBb":[function(require,module,exports) {
module.exports="/ludum-48/meerkat_front-facing.ec6efb2c.png";
},{}],"OM5O":[function(require,module,exports) {
module.exports="/ludum-48/chuchu_alt.bcf62943.mp3";
},{}],"hHiy":[function(require,module,exports) {
module.exports="/ludum-48/chuchu_alt.2bb3d70f.wav";
},{}],"QYYA":[function(require,module,exports) {
module.exports="/ludum-48/beetle.b869a86c.png";
},{}],"IUuW":[function(require,module,exports) {
module.exports="/ludum-48/underground_set.4f44c6bd.png";
},{}],"K9oT":[function(require,module,exports) {
module.exports="/ludum-48/underground_set_instruments.5e348aab.png";
},{}],"A3Vr":[function(require,module,exports) {
module.exports="/ludum-48/play-again-button.42b06949.png";
},{}],"n3fM":[function(require,module,exports) {
module.exports="/ludum-48/meerkat_1_front-facing.5b8200e2.png";
},{}],"JSWb":[function(require,module,exports) {
module.exports="/ludum-48/meerkat_2_front-facing.89c0da46.png";
},{}],"KHAO":[function(require,module,exports) {
module.exports="/ludum-48/meerkat_3_front-facing.00ce55c2.png";
},{}],"JMtK":[function(require,module,exports) {
module.exports="/ludum-48/meerkat_4_front-facing.a50f7979.png";
},{}],"pifC":[function(require,module,exports) {
module.exports="/ludum-48/drums_animation.c2872b96.png";
},{}],"rq6s":[function(require,module,exports) {
module.exports="/ludum-48/bass_guitar_animation.e5193487.png";
},{}],"btUk":[function(require,module,exports) {
module.exports="/ludum-48/guitar_animation.93aa6785.png";
},{}],"wcet":[function(require,module,exports) {
module.exports="/ludum-48/singer_jumping_animation.f3705b77.png";
},{}],"abbq":[function(require,module,exports) {
module.exports="/ludum-48/set1.7c05311a.wav";
},{}],"RnCI":[function(require,module,exports) {
module.exports="/ludum-48/set2.b001172c.wav";
},{}],"zqY7":[function(require,module,exports) {
module.exports="/ludum-48/set3lead.c6a7cad8.wav";
},{}],"XJt2":[function(require,module,exports) {
module.exports="/ludum-48/set3bg.417cadee.wav";
},{}],"l5Pu":[function(require,module,exports) {
module.exports="/ludum-48/HMRhyB Chug-A.bbdb083b.wav";
},{}],"r0pT":[function(require,module,exports) {
module.exports="/ludum-48/HMRhyB Chug-B.020df076.wav";
},{}],"UYoZ":[function(require,module,exports) {
module.exports="/ludum-48/HMRhyB Chug-C.7d673d56.wav";
},{}],"Oftf":[function(require,module,exports) {
module.exports="/ludum-48/HMRhyB Chug-D Hi.9ecc3286.wav";
},{}],"DQyx":[function(require,module,exports) {
module.exports="/ludum-48/HMRhyB Chug-D Lo.cab0ff3a.wav";
},{}],"O5ti":[function(require,module,exports) {
module.exports="/ludum-48/HMRhyB Chug-E.57269c0d.wav";
},{}],"ePcA":[function(require,module,exports) {
module.exports="/ludum-48/HMRhyB Chug-F.a0d066e6.wav";
},{}],"dQKa":[function(require,module,exports) {
module.exports="/ludum-48/HMRhyB Chug-G.573dc3d8.wav";
},{}],"mO39":[function(require,module,exports) {
module.exports="/ludum-48/dig.87dd1db7.wav";
},{}],"x5mp":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Resources=void 0;var e=require("excalibur"),r=re(require("./images/instructions.png")),a=re(require("./images/sword.png")),u=re(require("./images/dirt_001.png")),i=re(require("./images/dirt_bones.png")),n=re(require("./images/dirt_back.png")),g=re(require("./images/dirt_tunnel.png")),t=re(require("./images/dirt_side.png")),d=re(require("./images/dirt_angle.png")),s=re(require("./images/rock_001.png")),o=re(require("./images/rock_002.png")),c=re(require("./sound/fall.wav")),m=re(require("./sound/clank.wav")),l=re(require("./sound/clank.mp3")),p=re(require("./sound/getitem.wav")),S=re(require("./sound/background.mp3")),w=re(require("./sound/background.wav")),f=re(require("./images/modal.png")),h=re(require("./images/mecha-snek.png")),q=re(require("./images/energy-drink.png")),_=re(require("./images/meter.png")),G=re(require("./images/spritefont.png")),k=re(require("./images/meerkat_avatars.png")),I=re(require("./images/digging.png")),M=re(require("./images/digging_2.png")),v=re(require("./images/digging_3.png")),D=re(require("./images/digging_4.png")),B=re(require("./images/meerkat_front-facing.png")),y=re(require("./sound/chuchu_alt.mp3")),F=re(require("./sound/chuchu_alt.wav")),C=re(require("./images/beetle.png")),R=re(require("./images/underground_set.png")),b=re(require("./images/underground_set_instruments.png")),H=re(require("./images/play-again-button.png")),P=re(require("./images/meerkat_1_front-facing.png")),x=re(require("./images/meerkat_2_front-facing.png")),A=re(require("./images/meerkat_3_front-facing.png")),U=re(require("./images/meerkat_4_front-facing.png")),j=re(require("./images/animated_meerkats/drums_animation.png")),L=re(require("./images/animated_meerkats/bass_guitar_animation.png")),V=re(require("./images/animated_meerkats/guitar_animation.png")),E=re(require("./images/animated_meerkats/singer_jumping_animation.png")),O=re(require("./sound/set1.wav")),T=re(require("./sound/set2.wav")),z=re(require("./sound/set3lead.wav")),J=re(require("./sound/set3bg.wav")),K=re(require("./sound/dig chugs/HMRhyB Chug-A.wav")),N=re(require("./sound/dig chugs/HMRhyB Chug-B.wav")),Q=re(require("./sound/dig chugs/HMRhyB Chug-C.wav")),W=re(require("./sound/dig chugs/HMRhyB Chug-D Hi.wav")),X=re(require("./sound/dig chugs/HMRhyB Chug-D Lo.wav")),Y=re(require("./sound/dig chugs/HMRhyB Chug-E.wav")),Z=re(require("./sound/dig chugs/HMRhyB Chug-F.wav")),$=re(require("./sound/dig chugs/HMRhyB Chug-G.wav")),ee=re(require("./sound/dig.wav"));function re(e){return e&&e.__esModule?e:{default:e}}var ae={Instructions:new e.Graphics.ImageSource(r.default),Sword:new e.Graphics.ImageSource(a.default),Dirt:new e.Graphics.ImageSource(u.default),DirtBones:new e.Graphics.ImageSource(i.default),DirtSide:new e.Graphics.ImageSource(t.default),DirtBackground:new e.Graphics.ImageSource(n.default),DirtTunnel:new e.Graphics.ImageSource(g.default),DirtAngle:new e.Graphics.ImageSource(d.default),Rock:new e.Graphics.ImageSource(s.default),Rock2:new e.Graphics.ImageSource(o.default),DigSound1:new e.Sound(K.default),DigSound2:new e.Sound(N.default),DigSound3:new e.Sound(Q.default),DigSound4:new e.Sound(W.default),DigSound5:new e.Sound(X.default),DigSound6:new e.Sound(Y.default),DigSound7:new e.Sound(Z.default),DigSound8:new e.Sound($.default),GroundDig:new e.Sound(ee.default),ClankSound:new e.Sound(l.default,m.default),PickUpSound:new e.Sound(p.default),BackgroundMusic:new e.Sound(S.default,w.default),Modal:new e.Graphics.ImageSource(f.default),Snek:new e.Graphics.ImageSource(h.default),SpeedPowerUp:new e.Graphics.ImageSource(q.default),ProgressMeter:new e.Graphics.ImageSource(_.default),SpriteFont:new e.Graphics.ImageSource(G.default),Avatar:new e.Graphics.ImageSource(k.default),Digging:new e.Graphics.ImageSource(I.default),Digging2:new e.Graphics.ImageSource(M.default),Digging3:new e.Graphics.ImageSource(v.default),Digging4:new e.Graphics.ImageSource(D.default),FrontFacing:new e.Graphics.ImageSource(B.default),ChuChu:new e.Sound(y.default,F.default),Beetle:new e.Graphics.ImageSource(C.default),UndergroundSet:new e.Graphics.ImageSource(R.default),UndergroundSetInstruments:new e.Graphics.ImageSource(b.default),PlayAgainButton:new e.Graphics.ImageSource(H.default),MeerkatDrummerFrontFacing:new e.Graphics.ImageSource(P.default),MeerkatBassistFrontFacing:new e.Graphics.ImageSource(A.default),MeerkatVocalistFrontFacing:new e.Graphics.ImageSource(x.default),MeerkatGuitaristFrontFacing:new e.Graphics.ImageSource(U.default),MeerkatDrummerPlaying:new e.Graphics.ImageSource(j.default),MeerkatBassistPlaying:new e.Graphics.ImageSource(L.default),MeerkatVocalistPlaying:new e.Graphics.ImageSource(E.default),MeerkatGuitaristPlaying:new e.Graphics.ImageSource(V.default),SetMusic1:new e.Sound(O.default),SetMusic2:new e.Sound(T.default),SetMusic3Lead:new e.Sound(z.default),SetMusic3Background:new e.Sound(J.default),FallSound:new e.Sound(c.default)};exports.Resources=ae,ae.BackgroundMusic.loop=!0;
},{"excalibur":"A6Lr","./images/instructions.png":"dMVz","./images/sword.png":"oInr","./images/dirt_001.png":"g3Ht","./images/dirt_bones.png":"ApYq","./images/dirt_back.png":"dGcn","./images/dirt_tunnel.png":"Vsuw","./images/dirt_side.png":"vX90","./images/dirt_angle.png":"Gcyu","./images/rock_001.png":"EGmg","./images/rock_002.png":"LEQd","./sound/fall.wav":"UX7r","./sound/clank.wav":"ZG0m","./sound/clank.mp3":"Uosn","./sound/getitem.wav":"qhOA","./sound/background.mp3":"kqCS","./sound/background.wav":"RD3R","./images/modal.png":"RCTW","./images/mecha-snek.png":"saFP","./images/energy-drink.png":"atoM","./images/meter.png":"EvMN","./images/spritefont.png":"MmYr","./images/meerkat_avatars.png":"IAwo","./images/digging.png":"vAH6","./images/digging_2.png":"F8qb","./images/digging_3.png":"vdAb","./images/digging_4.png":"nAEU","./images/meerkat_front-facing.png":"ROBb","./sound/chuchu_alt.mp3":"OM5O","./sound/chuchu_alt.wav":"hHiy","./images/beetle.png":"QYYA","./images/underground_set.png":"IUuW","./images/underground_set_instruments.png":"K9oT","./images/play-again-button.png":"A3Vr","./images/meerkat_1_front-facing.png":"n3fM","./images/meerkat_2_front-facing.png":"JSWb","./images/meerkat_3_front-facing.png":"KHAO","./images/meerkat_4_front-facing.png":"JMtK","./images/animated_meerkats/drums_animation.png":"pifC","./images/animated_meerkats/bass_guitar_animation.png":"rq6s","./images/animated_meerkats/guitar_animation.png":"btUk","./images/animated_meerkats/singer_jumping_animation.png":"wcet","./sound/set1.wav":"abbq","./sound/set2.wav":"RnCI","./sound/set3lead.wav":"zqY7","./sound/set3bg.wav":"XJt2","./sound/dig chugs/HMRhyB Chug-A.wav":"l5Pu","./sound/dig chugs/HMRhyB Chug-B.wav":"r0pT","./sound/dig chugs/HMRhyB Chug-C.wav":"UYoZ","./sound/dig chugs/HMRhyB Chug-D Hi.wav":"Oftf","./sound/dig chugs/HMRhyB Chug-D Lo.wav":"DQyx","./sound/dig chugs/HMRhyB Chug-E.wav":"O5ti","./sound/dig chugs/HMRhyB Chug-F.wav":"ePcA","./sound/dig chugs/HMRhyB Chug-G.wav":"dQKa","./sound/dig.wav":"mO39"}],"foLc":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e={DebugMenuEnabled:!1,TerrainRandomSeed:Math.floor(1e4*Math.random()),CollectibleRandomSeed:Math.floor(1e4*Math.random()),BackgroundVolume:.3,SoundVolume:.3,PickupSoundVolume:.1,DigSoundVolume:.1,ChuchuVolume:.1,DistanceToComplete:210,DistanceToRound:70,MeterTilesHigh:20,TileWidth:64,ChunkWidth:9,ChunkHeight:16,AspectRatio:9/16,InvAspectRatio:1/(9/16),DigTime:200,SpaceMoveDuration:200,BeetleSpaceMoveDuration:1e3,PowerUpSpeedIncreaseFactor:2,PowerUpDurationSeconds:2,RockDigDelay:100,SnekSlowDownByAfterConcert:75,SnekStartingSpeed:800,SnekFastestSpeed:200,SnekFastestSpeedDistance:15,SnekFasterSpeed:350,SnekFasterSpeedDistance:8,SnekSlowDownBy:25,SnekSlowDownDistance:4,SnekStraitPathBoost:30,SnekStraitDownCount:5,SnekStraitPathBoostCooldown:5,SnekBodyLength:7,SnakeMoveDuration:100,SnakeAnimationFrameDuration:100};exports.default=e;
},{}],"RUzD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PlayerTrail=void 0;var t=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),e=function(){function t(t){void 0===t&&(t=1/0),this.capacity=t,this.storage=[]}return t.prototype.enqueue=function(t){if(this.size()===this.capacity)throw Error("Queue has reached max capacity, you cannot add more items");this.storage.push(t)},t.prototype.dequeue=function(){return this.storage.shift()},t.prototype.peekLast=function(){return this.storage[this.size()-1]},t.prototype.size=function(){return this.storage.length},t.prototype.clear=function(){this.storage=[]},t}(),r=function(e){function r(){return e.call(this)||this}return t(r,e),Object.defineProperty(r.prototype,"trail",{get:function(){return this.storage},enumerable:!1,configurable:!0}),r.GetInstance=function(){return r.instance||(r.instance=new r),r.instance},r.prototype.Remove=function(t){this.storage=this.storage.filter(function(e){return!(e.y===t.y&&e.x===t.x)})},r.prototype.RemoveLast=function(){this.storage.pop()},r.prototype.Contains=function(t){return-1!==this.storage.findIndex(function(e){return e.x===t.x&&e.y===t.y})},r.prototype.ClearAfter=function(t){var e=this.storage.findIndex(function(e){return e.x==t.x&&e.y==t.y});this.storage=this.storage.slice(0,e+1)},r}(e);exports.PlayerTrail=r;
},{}],"fRLe":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DirtTerrain=exports.RockTerrain=exports.EmptyTerrain=exports.EmptyTag=exports.DirtTag=exports.RockTag=exports.TunnelTerrain=exports.Terrain=void 0;var t=require("excalibur"),r=require("./resources"),e=i(require("./config"));function i(t){return t&&t.__esModule?t:{default:t}}var o=function(){var t=function(r,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])})(r,e)};return function(r,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),n=function(){function t(t,r,e,i,o){this.actorTag=t,this.isMineable=r,this.mineDelay=e,this.spriteImages=i,this.digSound=o,this.blockSprites=null}return t.prototype.playSound=function(){var t;null===(t=this.digSound)||void 0===t||t.play()},t.prototype.tag=function(){return this.actorTag},t.prototype.mineable=function(){return this.isMineable},t.prototype.delay=function(){return this.mineDelay()},t.prototype.sprites=function(){return this.blockSprites?this.blockSprites:(this.spriteImages&&(this.blockSprites=this.spriteImages.map(function(t){return t.toSprite()})),this.blockSprites)},t.HasBeetle=function(t){return!!t&&t.hasTag("beetle")},t.GetTerrain=function(t){return t?t.hasTag(f)?c:t.hasTag(a)?l:t.hasTag(p)?h:c:c},t.Initialize=function(){exports.EmptyTerrain=c=new t(f,!0,function(){return 0},null,null),exports.RockTerrain=l=new t(a,!1,function(){return e.default.RockDigDelay},[r.Resources.Rock],r.Resources.ClankSound),exports.DirtTerrain=h=new s},t}();exports.Terrain=n;var s=function(t){function i(){return t.call(this,p,!0,function(){return e.default.DigTime},[r.Resources.Dirt],null)||this}return o(i,t),i.prototype.playSound=function(){r.Resources.GroundDig.play()},i}(n),u=function(e){function i(t){var r=e.call(this,f,!0,function(){return 0},null,null)||this;return r.sides=t,r}return o(i,e),i.prototype.sprites=function(){if(this.blockSprites)return this.blockSprites;if(this.blockSprites=[],this.sides.north){var e=r.Resources.DirtSide.toSprite();e.rotation=t.Util.toRadians(180),this.blockSprites.push(e)}if(this.sides.east){var i=r.Resources.DirtSide.toSprite();i.rotation=t.Util.toRadians(-90),this.blockSprites.push(i)}if(this.sides.west){var o=r.Resources.DirtSide.toSprite();o.rotation=t.Util.toRadians(90),this.blockSprites.push(o)}return this.sides.south&&this.blockSprites.push(r.Resources.DirtSide.toSprite()),this.blockSprites},i}(n);exports.TunnelTerrain=u;var a="rock";exports.RockTag=a;var p="dirt";exports.DirtTag=p;var c,l,h,f="empty";exports.EmptyTag=f,exports.EmptyTerrain=c,exports.RockTerrain=l,exports.DirtTerrain=h;
},{"excalibur":"A6Lr","./resources":"x5mp","./config":"foLc"}],"Z7BZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GlobalState=void 0;var e=function(){function e(){this.HasSpeedPowerUp=!1,this.GameOver=!1,this.Round=1,this.RoundWon=!1,this.SnakePause=!1,this.GameWon=!1}return e.GetInstance=function(){return e.instance||(e.instance=new e),e.instance},e}();exports.GlobalState=e;
},{}],"GK6d":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.digEffect=t;var e=require("excalibur");function t(t,i,o){var a=new e.ParticleEmitter(i.bounds.center.x,i.bounds.center.y,1,1);a.minVel=30,a.maxVel=125,a.minAngle=Math.PI/4,a.maxAngle=3*Math.PI/4,a.isEmitting=!1,a.emitRate=5,a.opacity=.5,a.fadeFlag=!0,a.particleLife=1e3,a.maxSize=.4,a.minSize=.2,a.acceleration=new e.Vector(0,500),a.beginColor=e.Color.Red,a.endColor=e.Color.Yellow,a.startSize=.5,a.endSize=.01,a.particleSprite=e.Graphics.Sprite.toLegacySprite(o),a.particleRotationalVelocity=Math.PI/10,a.randomRotation=!0,a.fadeFlag=!0,a.focus=new e.Vector(0,a.pos.y+1e3),a.focusAccel=900,t.add(a),a.emitParticles(5),a.actions.moveTo(a.pos.x+3,a.pos.y+1,1).die()}
},{"excalibur":"A6Lr"}],"rXhO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Player=void 0;var t=require("excalibur"),e=require("./resources"),i=s(require("./config")),r=require("./playerTrail"),o=require("./terrain"),n=require("./globalState"),a=require("./effects");function s(t){return t&&t.__esModule?t:{default:t}}var l=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),c=function(s){function c(o){var a=s.call(this,{pos:(0,t.vec)(5*i.default.TileWidth-i.default.TileWidth/2,5*i.default.TileWidth-i.default.TileWidth/2),width:i.default.TileWidth,height:i.default.TileWidth})||this;return a.level=o,a.trail=r.PlayerTrail.GetInstance(),a.state=n.GlobalState.GetInstance(),a.moving=!1,a.pointerHeld=!1,a.pointerScreenPos=(0,t.vec)(0,0),a.digSprite=e.Resources.Rock2.toSprite(),a.startAngle=Math.PI/2,a.z=10,a.rotation=0,a.traits=a.traits.filter(function(e){return!(e instanceof t.Traits.TileMapCollisionDetection)}),a}return l(c,s),c.prototype.onInitialize=function(r){var o=this;this.frontFacing=e.Resources.FrontFacing.toSprite(),this.graphics.add(this.frontFacing);var n=[e.Resources.Digging,e.Resources.Digging2,e.Resources.Digging3,e.Resources.Digging4],a=n[Math.floor(Math.random()*n.length)],s=t.Graphics.SpriteSheet.fromGrid({image:a,grid:{spriteWidth:64,spriteHeight:64,rows:1,columns:4}}),l=t.Graphics.Animation.fromSpriteSheet(s,[0,1,2,3],100,t.Graphics.AnimationStrategy.PingPong);l.rotation=Math.PI,this.digAnimation=l,this.engine=r,r.input.keyboard.on("hold",function(e){if(!o.state.GameOver){var r=t.Vector.Down;switch(e.key){case t.Input.Keys.A:case t.Input.Keys.Left:r=t.Vector.Left;break;case t.Input.Keys.D:case t.Input.Keys.Right:r=t.Vector.Right;break;case t.Input.Keys.S:case t.Input.Keys.Down:r=t.Vector.Down;break;case t.Input.Keys.W:case t.Input.Keys.Up:r=t.Vector.Up;break;default:return}o.moveToNearestTile(o.pos.add(r.scale(i.default.TileWidth)))}}),r.input.pointers.primary.on("down",function(t){o.state.GameOver||(o.pointerHeld=!0,o.pointerScreenPos=t.screenPos)}),r.input.pointers.primary.on("move",function(t){o.pointerScreenPos=t.screenPos}),r.input.pointers.primary.on("up",function(t){o.pointerHeld=!1})},c.prototype.bestDirection=function(e){var i=Math.atan2(e.y,e.x);i<Math.PI-Math.PI/16&&i>Math.PI/16&&(e=t.Vector.Down);for(var r=[t.Vector.Up,t.Vector.Down,t.Vector.Left,t.Vector.Right],o=t.Vector.Down,n=-Number.MAX_VALUE,a=0,s=r;a<s.length;a++){var l=s[a],c=e.dot(l);c>n&&(n=c,o=l)}return o},c.prototype.onPreUpdate=function(){if(0!==this.vel.size&&(this.rotation=Math.atan2(this.vel.y,this.vel.x)+this.startAngle,this.graphics.use(this.digAnimation)),this.pointerHeld){if(this.state.GameOver)return;var t=this.engine.screen.worldToScreenCoordinates(this.pos),e=this.pointerScreenPos.sub(t).normalize(),r=this.bestDirection(e);this.moveToNearestTile(this.pos.add(r.scale(i.default.TileWidth)))}},c.prototype.isValidMove=function(t,e){var r=Math.floor(t/i.default.TileWidth),o=Math.floor(e/i.default.TileWidth),n=Math.floor(this.pos.x/i.default.TileWidth),a=Math.floor(this.pos.y/i.default.TileWidth),s=Math.abs(n-r),l=Math.abs(a-o),c=1===Math.sqrt(s*s+l*l),h=this.level.getTile(t,e);return c&&!!h},c.prototype.moveToNearestTile=function(r){var n=this;this.graphics.use(this.digAnimation);var s=Math.floor(r.x/i.default.TileWidth),l=Math.floor(r.y/i.default.TileWidth),c=this.isValidMove(r.x,r.y),h=this.state.HasSpeedPowerUp?i.default.PowerUpSpeedIncreaseFactor:1;if(c){if(this.moving)return;this.moving=!0;var u=this.level.getTile(r.x,r.y);if(this.actions.rotateTo(Math.atan2(r.y-this.pos.y,r.x-this.pos.x)+this.startAngle,100,t.RotationType.ShortestPath),u){var p=o.Terrain.GetTerrain(u),d=p.delay()/h;if(p.playSound(),o.Terrain.HasBeetle(u)&&e.Resources.ClankSound.play(),!p.mineable()||o.Terrain.HasBeetle(u))return void this.actions.delay(d).callMethod(function(){n.moving=!1});(0,a.digEffect)(this.engine,u,this.digSprite),this.actions.delay(d).callMethod(function(){n.level.finishDig(r.x,r.y)}),this.actions.easeTo(s*i.default.TileWidth+i.default.TileWidth/2,l*i.default.TileWidth+i.default.TileWidth/2,i.default.SpaceMoveDuration/h,t.EasingFunctions.EaseInOutCubic).callMethod(function(){n.moving=!1,n.trail.Contains(n.pos.clone())?n.trail.ClearAfter(n.pos.clone()):n.trail.enqueue(n.pos.clone())})}}},c}(t.Actor);exports.Player=c;
},{"excalibur":"A6Lr","./resources":"x5mp","./config":"foLc","./playerTrail":"RUzD","./terrain":"fRLe","./globalState":"Z7BZ","./effects":"GK6d"}],"np5A":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Every=void 0;var t,n=function(){var t=function(n,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])})(n,r)};return function(n,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function e(){this.constructor=n}t(n,r),n.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}}();exports.Every=t,function(t){var r=function(){function t(t,n){this.action=t,this.interval=n,this.internalTimer=0}return t.prototype.Update=function(t){this.internalTimer+=t,this.internalTimer>=this.interval&&(this.action(),this.internalTimer=0)},t.prototype.UpdateInterval=function(t){this.interval=t},t}();t.Interval=r;var e=function(t){function r(n,r){return t.call(this,n,60*r*1e3)||this}return n(r,t),r.prototype.UpdateInterval=function(n){t.prototype.UpdateInterval.call(this,60*n*1e3)},r}(r);t.Minute=e;var o=function(t){function r(n,r){return t.call(this,n,1e3*r)||this}return n(r,t),r.prototype.UpdateInterval=function(n){t.prototype.UpdateInterval.call(this,1e3*n)},r}(r);t.Second=o;var i=function(t){function r(n,r){return t.call(this,n,r)||this}return n(r,t),r}(r);t.MiliSecond=i}(t||(exports.Every=t={}));
},{}],"CDgt":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Snek=void 0;var t=require("excalibur"),e=require("./resources"),i=r(require("./config")),n=require("./playerTrail"),o=require("./every"),a=require("./globalState");function r(t){return t&&t.__esModule?t:{default:t}}var s=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),h=function(r){function h(s){var h=r.call(this,{pos:(0,t.vec)(0,5*i.default.TileWidth-i.default.TileWidth/2),width:i.default.TileWidth,height:i.default.TileWidth})||this;return h.level=s,h.playerTrail=n.PlayerTrail.GetInstance(),h.timePerTile=i.default.SnekStartingSpeed,h.chuChuCooldown=0,h.moving=!1,h.snekBody=[],h.isMouthOpen=!1,h.moveSnekTimer=new o.Every.Second(function(){h.moveSnek()},h.timePerTile/1e3),h.updateSnekTimer=new o.Every.Second(function(){h.updateSnekSpeedv2()},1),h.updateFunctions=[h.moveSnekTimer,h.updateSnekTimer],h.spritesheet=t.Graphics.SpriteSheet.fromGrid({image:e.Resources.Snek,grid:{rows:1,columns:72,spriteHeight:96,spriteWidth:96}}),h.headAnim=t.Graphics.Animation.fromSpriteSheet(h.spritesheet,[7,15,23],300,t.Graphics.AnimationStrategy.PingPong),h.bodyDefaultAnimations=[],h.body1Anim=t.Graphics.Animation.fromSpriteSheet(h.spritesheet,[6,14,22],i.default.SnakeAnimationFrameDuration,t.Graphics.AnimationStrategy.PingPong),h.body2Anim=t.Graphics.Animation.fromSpriteSheet(h.spritesheet,[5,13,21],i.default.SnakeAnimationFrameDuration,t.Graphics.AnimationStrategy.PingPong),h.body3Anim=t.Graphics.Animation.fromSpriteSheet(h.spritesheet,[4,12,20],i.default.SnakeAnimationFrameDuration,t.Graphics.AnimationStrategy.PingPong),h.body4Anim=t.Graphics.Animation.fromSpriteSheet(h.spritesheet,[3,11,19],i.default.SnakeAnimationFrameDuration,t.Graphics.AnimationStrategy.PingPong),h.body5Anim=t.Graphics.Animation.fromSpriteSheet(h.spritesheet,[2,10,18],i.default.SnakeAnimationFrameDuration,t.Graphics.AnimationStrategy.PingPong),h.body6Anim=t.Graphics.Animation.fromSpriteSheet(h.spritesheet,[1,9,17],i.default.SnakeAnimationFrameDuration,t.Graphics.AnimationStrategy.PingPong),h.body7Anim=t.Graphics.Animation.fromSpriteSheet(h.spritesheet,[0,8,16],500,t.Graphics.AnimationStrategy.PingPong),h.mouthAnim=t.Graphics.Animation.fromSpriteSheet(h.spritesheet,[55,63,71],50,t.Graphics.AnimationStrategy.Freeze),h.mouthAnimReverse=t.Graphics.Animation.fromSpriteSheet(h.spritesheet,[71,63,55],50,t.Graphics.AnimationStrategy.Freeze),h.headTurboAnim=t.Graphics.Animation.fromSpriteSheet(h.spritesheet,[31,39,47,55],300,t.Graphics.AnimationStrategy.PingPong),h.bodyTurboAnimations=[],h.body1TurboAnim=t.Graphics.Animation.fromSpriteSheet(h.spritesheet,[30,38,46,54],i.default.SnakeAnimationFrameDuration,t.Graphics.AnimationStrategy.PingPong),h.body2TurboAnim=t.Graphics.Animation.fromSpriteSheet(h.spritesheet,[29,37,45,53],i.default.SnakeAnimationFrameDuration,t.Graphics.AnimationStrategy.PingPong),h.body3TurboAnim=t.Graphics.Animation.fromSpriteSheet(h.spritesheet,[28,36,44,52],i.default.SnakeAnimationFrameDuration,t.Graphics.AnimationStrategy.PingPong),h.body4TurboAnim=t.Graphics.Animation.fromSpriteSheet(h.spritesheet,[27,35,43,51],i.default.SnakeAnimationFrameDuration,t.Graphics.AnimationStrategy.PingPong),h.body5TurboAnim=t.Graphics.Animation.fromSpriteSheet(h.spritesheet,[26,34,42,50],i.default.SnakeAnimationFrameDuration,t.Graphics.AnimationStrategy.PingPong),h.body6TurboAnim=t.Graphics.Animation.fromSpriteSheet(h.spritesheet,[25,33,41,49],i.default.SnakeAnimationFrameDuration,t.Graphics.AnimationStrategy.PingPong),h.body7TurboAnim=t.Graphics.Animation.fromSpriteSheet(h.spritesheet,[24,32,40,48],500,t.Graphics.AnimationStrategy.PingPong),h.z=11,h.traits=h.traits.filter(function(e){return!(e instanceof t.Traits.TileMapCollisionDetection)}),h.state=a.GlobalState.GetInstance(),h.bodyDefaultAnimations=[h.body1Anim,h.body2Anim,h.body3Anim,h.body4Anim,h.body5Anim,h.body6Anim,h.body7Anim],h.bodyTurboAnimations=[h.body1TurboAnim,h.body2TurboAnim,h.body3TurboAnim,h.body4TurboAnim,h.body5TurboAnim,h.body6TurboAnim,h.body7TurboAnim],h}return s(h,r),h.prototype.onInitialize=function(t){this.graphics.add("default",this.headAnim),this.graphics.add("turbo",this.headTurboAnim),this.graphics.add("openMouth",this.mouthAnim),this.graphics.add("closeMouth",this.mouthAnimReverse),this.createSnekBody()},h.prototype.onPreUpdate=function(t,e){0!==this.vel.size&&(this.rotation=Math.atan2(this.vel.y,this.vel.x)),this.state.GameOver||(this.moveSnekTimer.UpdateInterval(this.timePerTile/1e3),this.updateFunctions.forEach(function(t){return t.Update(e)}))},h.prototype.updateSnekSpeedv2=function(){var t=this.playerTrail.peekLast();if(t){var n=t.x-this.pos.x,o=t.y-this.pos.y,a=Math.sqrt(n*n+o*o);a>i.default.SnekFasterSpeedDistance*i.default.TileWidth&&(console.log("FASTER SNEK"),this.timePerTile=Math.min(i.default.SnekFasterSpeed,this.timePerTile),this.switchAnimation("turbo")),a>i.default.SnekFastestSpeedDistance*i.default.TileWidth&&(console.log("FASTEST SNEK"),this.timePerTile=Math.min(i.default.SnekFastestSpeed,this.timePerTile),this.switchAnimation("turbo")),a<i.default.SnekSlowDownDistance*i.default.TileWidth&&(console.log("SLOW SNEK DOWN"),this.timePerTile+=i.default.SnekSlowDownBy,this.switchAnimation("default")),this.state.SnakePause&&(console.log("SNEK slows down because your music was so cool"),this.timePerTile+=i.default.SnekSlowDownByAfterConcert,this.state.SnakePause=!1,this.switchAnimation("default")),a<=128&&!this.isMouthOpen&&(this.isMouthOpen=!0,this.graphics.hide(),this.graphics.show("openMouth")),a>128&&this.isMouthOpen&&(this.graphics.hide(),this.graphics.show("closeMouth"),this.isMouthOpen=!1)}var r=this.playerTrail.trail;if(r.length>=2&&this.chuChuCooldown--<=0){for(var s=0,h=0;h<r.length-1&&r[h].x===r[h+1].x;h++)s++;s>=i.default.SnekStraitDownCount&&(console.log("CHU CHU!",s),e.Resources.ChuChu.play(),this.switchAnimation("turbo"),this.timePerTile-=i.default.SnekStraitPathBoost,this.chuChuCooldown=i.default.SnekStraitPathBoostCooldown)}},h.prototype.updateSnekSpeed=function(){},h.prototype.switchAnimation=function(t){if("turbo"===t){this.isMouthOpen||(this.graphics.hide(),this.graphics.show("turbo"));for(var e=0;e<i.default.SnekBodyLength;e++)this.snekBody[e].graphics.hide(),this.snekBody[e].graphics.show("turbo")}else{this.isMouthOpen||(this.graphics.hide(),this.graphics.show("default"));for(e=0;e<i.default.SnekBodyLength;e++)this.snekBody[e].graphics.hide(),this.snekBody[e].graphics.show("default")}},h.prototype.moveSnek=function(){var n=this;if(!this.moving){var o=this.playerTrail.dequeue();if(o){var a=Math.floor(this.pos.x/i.default.TileWidth),r=Math.floor(this.pos.y/i.default.TileWidth);this.moving=!0;var s=Math.floor(o.x/i.default.TileWidth),h=Math.floor(o.y/i.default.TileWidth);this.actions.easeTo(s*i.default.TileWidth+i.default.TileWidth/2,h*i.default.TileWidth+i.default.TileWidth/2,i.default.SnakeMoveDuration,t.EasingFunctions.EaseInOutCubic).callMethod(function(){n.moving=!1,(new t.Random).pickOne([e.Resources.DigSound1,e.Resources.DigSound2,e.Resources.DigSound3,e.Resources.DigSound4,e.Resources.DigSound5,e.Resources.DigSound6,e.Resources.DigSound7,e.Resources.DigSound8]).play()}),this.moveSnekBody(a,r)}}},h.prototype.createSnekBody=function(){for(var e=this,n=function(n){var a=new t.Actor({x:o.pos.x-(n+1)*i.default.TileWidth,y:o.pos.y,width:i.default.TileWidth,height:i.default.TileWidth});a.traits=a.traits.filter(function(e){return!(e instanceof t.Traits.TileMapCollisionDetection)}),a.graphics.add("default",o.bodyDefaultAnimations[n]),a.graphics.add("turbo",o.bodyTurboAnimations[n]),a.onPreUpdate=function(){var t=0===n,o=n===i.default.SnekBodyLength-1;if(0!==a.vel.size){var r,s;t?(r=e,s=e.snekBody[1]):o?(r=e.snekBody[n-1],s=a):(r=e.snekBody[n-1],s=e.snekBody[n+1]);var h=Math.atan2(r.pos.y-s.pos.y,r.pos.x-s.pos.x);a.rotation=h}},o.snekBody.push(a)},o=this,a=0;a<i.default.SnekBodyLength;a++)n(a);this.scene.add(this.snekBody[0]),this.scene.add(this.snekBody[2]),this.scene.add(this.snekBody[4]),this.scene.add(this.snekBody[6]),this.scene.add(this.snekBody[1]),this.scene.add(this.snekBody[3]),this.scene.add(this.snekBody[5])},h.prototype.moveSnekBody=function(e,n){var o=this.getSnekBodyLocations();this.snekBody[0].actions.easeTo(e*i.default.TileWidth+i.default.TileWidth/2,n*i.default.TileWidth+i.default.TileWidth/2,i.default.SnakeMoveDuration,t.EasingFunctions.EaseInOutCubic);for(var a=1;a<this.snekBody.length;a++)this.snekBody[a].actions.easeTo(o[a-1].x*i.default.TileWidth+i.default.TileWidth/2,o[a-1].y*i.default.TileWidth+i.default.TileWidth/2,i.default.SnakeMoveDuration,t.EasingFunctions.EaseInOutCubic)},h.prototype.getSnekBodyLocations=function(){return this.snekBody.map(function(e){return new t.Vector(Math.floor(e.pos.x/i.default.TileWidth),Math.floor(e.pos.y/i.default.TileWidth))})},h.prototype.getSnekBodyGridCoords=function(){return this.snekBody.map(function(t){return t.pos.clone()})},h.prototype.areNumbersApproximatelyEqual=function(t,e){return Math.abs(t-e)<=.01},h}(t.Actor);exports.Snek=h;
},{"excalibur":"A6Lr","./resources":"x5mp","./config":"foLc","./playerTrail":"RUzD","./every":"np5A","./globalState":"Z7BZ"}],"xDd5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DialogCard=void 0;var t=require("excalibur"),r=require("./resources"),e=function(){var t=function(r,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])})(r,e)};return function(r,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),o=function(){return(o=Object.assign||function(t){for(var r,e=1,o=arguments.length;e<o;e++)for(var i in r=arguments[e])Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t}).apply(this,arguments)},i=function(i){function n(r,e){var n=i.call(this,o(o({},e),{width:837,height:480}))||this;return n.text=r,n.topPadding=e.topPadding||0,n.traits=n.traits.filter(function(r){return!(r instanceof t.Traits.TileMapCollisionDetection)}),n.transform.coordPlane=t.CoordPlane.Screen,n}return e(n,i),n.prototype.onInitialize=function(){var e=[];e.push({graphic:t.Graphics.Sprite.from(r.Resources.Modal),pos:(0,t.vec)(0,0)});for(var o=0;o<this.text.length;o++)e.push({graphic:new t.Graphics.Text({text:this.text[o],color:t.Color.White,font:new t.Graphics.Font({family:"Century, Georgia, serif",size:36,textAlign:t.Graphics.TextAlign.Center})}),pos:(0,t.vec)(this.width/2,(o+1)/(this.text.length+1)*300+this.topPadding)});var i=new t.Graphics.GraphicsGroup({members:e});i.width=this.width,i.height=this.height,this.graphics.add(i)},n}(t.ScreenElement);exports.DialogCard=i;
},{"excalibur":"A6Lr","./resources":"x5mp"}],"DKYC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Button=void 0;var t=require("excalibur"),r=require("./resources"),e=function(){var t=function(r,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])})(r,e)};return function(r,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),o=function(){return(o=Object.assign||function(t){for(var r,e=1,o=arguments.length;e<o;e++)for(var n in r=arguments[e])Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n]);return t}).apply(this,arguments)},n=function(n){function i(t,r){var e=n.call(this,o({},r))||this;return e.text=t,e}return e(i,n),i.prototype.onInitialize=function(){var e=new t.Graphics.GraphicsGroup({members:[{graphic:t.Graphics.Sprite.from(r.Resources.PlayAgainButton),pos:(0,t.vec)(0,0)}]});e.width=this.width,e.height=this.height,this.body.useBoxCollider(r.Resources.PlayAgainButton.width,r.Resources.PlayAgainButton.height,t.Vector.Half),this.graphics.add(e)},i}(t.ScreenElement);exports.Button=n;
},{"excalibur":"A6Lr","./resources":"x5mp"}],"tKgm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GameOver=void 0;var t=require("excalibur"),e=require("./dialogueCard"),o=require("./button"),i=require("./globalState"),n=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(e,o)};return function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=function(a){function r(e,o){var n=a.call(this,e/2,o/2,0,0)||this;return n.gameWidth=e,n.gameHeight=o,n.state=i.GlobalState.GetInstance(),n.transform.coordPlane=t.CoordPlane.Screen,n.traits=n.traits.filter(function(e){return!(e instanceof t.Traits.TileMapCollisionDetection)}),n.anchor=(0,t.vec)(.5,.5),n}return n(r,a),r.prototype.onInitialize=function(e){this.backShadow=new t.Graphics.Rectangle({width:2*this.gameWidth,height:2*this.gameHeight,color:t.Color.fromRGB(51,51,51,.5)}),this.graphics.anchor=(0,t.vec)(.5,.5),this.backShadowLayer=this.graphics.layers.create({name:"backshadow",order:1})},r.prototype.updateEndScreen=function(i){var n=this,a=(0,t.vec)(this.pos.x,this.pos.y);this.card=new e.DialogCard(i,{pos:a,topPadding:30}),this.card.transform.coordPlane=t.CoordPlane.Screen,this.scene.add(this.card),this.card.z=100,this.z=100,this.button=new o.Button("Play Again?",{pos:a,width:200,height:100}),this.button.transform.coordPlane=t.CoordPlane.Screen;this.state.newGameFun;this.button.on("pointerdown",function(){n.button.isKilled()||n.state.GameOver}),this.scene.add(this.button),this.button.z=101},r.prototype.show=function(){this.backShadowLayer.show(this.backShadow),this.card.actions.easeTo(this.gameWidth/2,this.gameHeight/3,500,t.EasingFunctions.EaseInOutCubic),this.button.actions.easeTo(this.gameWidth/2,this.gameHeight/3+125,500,t.EasingFunctions.EaseInOutCubic)},r.prototype.hide=function(){this.backShadowLayer.hide(),this.card.actions.easeTo(this.gameWidth/2,2*this.gameHeight,500,t.EasingFunctions.EaseInOutCubic),this.button.actions.easeTo(this.gameWidth/2,2*this.gameHeight,500,t.EasingFunctions.EaseInOutCubic)},r}(t.ScreenElement);exports.GameOver=a;
},{"excalibur":"A6Lr","./dialogueCard":"xDd5","./button":"DKYC","./globalState":"Z7BZ"}],"GYtl":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PowerUpTimer=exports.PowerUp=exports.Collectible=void 0;var t=require("excalibur"),e=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),i=function(){return function(t,e){this.sprite=t,this.name=e}}();exports.Collectible=i;var n=function(t){function i(e,i,n){var r=t.call(this,e,i)||this;return r.powerUpTimer=n,r}return e(i,t),i.prototype.apply=function(){this.powerUpTimer.addPowerUp()},i}(i);exports.PowerUp=n;var r=function(){function e(e,i,n,r){this.scene=e,this.onEnable=i,this.onDisable=n,this.durationSeconds=r,this._timeRemaining=0,this._enabled=!1,this.timer=new t.Timer({interval:1e3*this.durationSeconds}),this.scene.addTimer(this.timer),this._outerDisabled=this.disable.bind(this)}return e.prototype.disable=function(){this.onDisable(),this._enabled=!1,this.timer.off(this._outerDisabled)},e.prototype.enabled=function(){return this._enabled},e.prototype.addPowerUp=function(){this.timer.pause(),this.timer.reset(),this._timeRemaining=this.timeRemaining()+this.durationSeconds,this.onEnable(),this._enabled=!0,this.timer.on(this._outerDisabled),this.timer.unpause()},e.prototype.timeRemaining=function(){var t=this._timeRemaining-this.timer.getTimeRunning();return t<0?0:t},e}();exports.PowerUpTimer=r;
},{"excalibur":"A6Lr"}],"Nyr0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Background=void 0;var e=d(require("./config")),t=require("excalibur"),i=require("./resources");function d(e){return e&&e.__esModule?e:{default:e}}var u=function(){function d(d){this.parallaxFactor=.25,this.backgrounds=[],this.lastChunkId=0,this.useTop=!0;var u=i.Resources.DirtBackground.toSprite(),a=new t.TileMap({x:0,y:5*e.default.TileWidth,rows:e.default.ChunkHeight,cols:e.default.ChunkWidth,cellWidth:e.default.TileWidth,cellHeight:e.default.TileWidth});a.z=-1,a.data.forEach(function(e){e.addSprite(u)});var l=new t.TileMap({x:0,y:e.default.TileWidth*(5+e.default.ChunkHeight),rows:e.default.ChunkHeight,cols:e.default.ChunkWidth,cellWidth:e.default.TileWidth,cellHeight:e.default.TileWidth});l.z=-1,l.data.forEach(function(e){e.addSprite(u)}),d.add(a),d.add(l),this.backgrounds=[a,l]}return d.prototype.setCurrentChunkId=function(t){var i=5*e.default.TileWidth;if(!(t<0)){if(t%2==0)this.backgrounds[0].y=t*(e.default.TileWidth*e.default.ChunkHeight)+i;else this.backgrounds[1].y=t*(e.default.TileWidth*e.default.ChunkHeight)+i;this.lastChunkId=t}},d}();exports.Background=u;
},{"./config":"foLc","excalibur":"A6Lr","./resources":"x5mp"}],"CbHH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.WeightMap=void 0;var t=function(){return function(t,i){this.weight=t,this.obj=i}}(),i=function(){function i(t){this.total=0,this.pairs=[],this.random=t}return i.prototype.add=function(i,o){this.total+=i,this.pairs.push(new t(i,o))},i.prototype.randomSelect=function(t){var i=this.random.next()*this.total,o=0,e=null;return this.pairs.forEach(function(t){e||(i-o<=t.weight&&(e=t.obj),o+=t.weight)}),null!=e?e:t},i}();exports.WeightMap=i;
},{}],"a30k":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ProgressMeter=void 0;var t=s(require("./config")),e=require("excalibur"),r=require("./resources");function s(t){return t&&t.__esModule?t:{default:t}}var i=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function s(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(s.prototype=r.prototype,new s)}}(),o=function(s){function o(){var r=s.call(this,{pos:(0,e.vec)(24,48)})||this;return r.totalDistance=t.default.DistanceToComplete,r.progress=0,r.z=100,r}return i(o,s),o.prototype.onInitialize=function(){this.avatar=r.Resources.Avatar.toSprite();var t=e.Graphics.SpriteSheet.fromGrid({image:r.Resources.ProgressMeter,grid:{spriteHeight:8,spriteWidth:32,rows:8,columns:1}}),s=e.Graphics.SpriteSheet.fromGrid({image:r.Resources.SpriteFont,grid:{spriteWidth:16,spriteHeight:16,rows:3,columns:16}});this.spriteFont=new e.Graphics.SpriteFont({spriteSheet:s,alphabet:"0123456789abcdefghijklmnopqrstuvwxyz,!'&.\"?- ",caseInsensitive:!0,spacing:-8}),this.text=new e.Graphics.Text({text:(this.progress/this.totalDistance*100).toFixed(1)+"M",font:this.spriteFont}),this.text.scale=(0,e.vec)(1.5,1.5),this.meterStart=t.sprites[0],this.meterFill=t.sprites[1],this.meterFillCap=t.sprites[2],this.meterEmpty=t.sprites[3],this.meterEndFill=t.sprites[6],this.meterEnd=t.sprites[7],this.buildMeterGraphics()},o.prototype.updateProgress=function(t){this.progress=e.Util.clamp(t,0,this.totalDistance),this.text.text=this.progress.toFixed(1)+"M"},o.prototype.onPreUpdate=function(){this.buildMeterGraphics()},o.prototype.buildMeterGraphics=function(){var r=t.default.MeterTilesHigh,s=0;this.graphics.hide(),this.graphics.show(this.avatar,{offset:(0,e.vec)(56,32)}),this.graphics.show(this.text,{offset:(0,e.vec)(5,-32)}),this.graphics.show(this.meterStart,{offset:(0,e.vec)(0,8*s++)});for(var i=Math.floor(this.progress/this.totalDistance*r),o=i===r,h=0;h<i;h++)this.graphics.show(this.meterFill,{offset:(0,e.vec)(0,8*s++)});if(!o){this.graphics.show(this.meterFillCap,{offset:(0,e.vec)(0,8*s++)});var n=r-s-1;for(h=0;h<n;h++)this.graphics.show(this.meterEmpty,{offset:(0,e.vec)(0,8*s++)})}this.graphics.show(o?this.meterEndFill:this.meterEnd,{offset:(0,e.vec)(0,8*s++)})},o}(e.ScreenElement);exports.ProgressMeter=o;
},{"./config":"foLc","excalibur":"A6Lr","./resources":"x5mp"}],"oOWz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Beetle=void 0;var t=require("excalibur"),e=n(require("./config")),i=require("./terrain"),o=require("./every"),r=require("./resources");function n(t){return t&&t.__esModule?t:{default:t}}var a=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),l=function(n){function l(i,r,a){var l=n.call(this,{x:i,y:r,width:e.default.TileWidth,height:e.default.TileWidth,color:t.Color.Blue})||this;return l.level=a,l.moving=!1,l.dir=null,l.moveBeetleTimer=new o.Every.Second(function(){l.moveBeetle()},1),l.z=20,l.traits=l.traits.filter(function(e){return!(e instanceof t.Traits.TileMapCollisionDetection)}),l}return a(l,n),l.prototype.onInitialize=function(){var e=t.Graphics.SpriteSheet.fromGrid({image:r.Resources.Beetle,grid:{spriteWidth:64,spriteHeight:64,rows:1,columns:3}});this.animation=t.Graphics.Animation.fromSpriteSheet(e,[0,1,2],100,t.Graphics.AnimationStrategy.PingPong),this.graphics.use(this.animation)},l.prototype.moveBeetle=function(){null===this.dir&&(this.dir=this.randomSelectValidDir()),null!==this.dir&&this.moveToNearestTile(this.pos.add(this.dir.scale(e.default.TileWidth))),this.dir=this.randomSelectValidDir()},l.prototype.randomSelectValidDir=function(){var i=this,o=[t.Vector.Up,t.Vector.Down,t.Vector.Left,t.Vector.Right];return(o=o.filter(function(t){var o=i.pos.add(t.scale(e.default.TileWidth));return i.isValidMove(o.x,o.y)})).length>0?o[l.random.integer(0,o.length-1)]:null},l.prototype.onPreUpdate=function(t,i){if(!this.isOffScreen)if(this.moveBeetleTimer.Update(i),0!==this.vel.size)this.rotation=Math.atan2(this.vel.y,this.vel.x);else if(this.dir&&!this.moving){var o=this.pos.add(this.dir.scale(e.default.TileWidth));this.rotation=Math.atan2(o.y-this.pos.y,o.x-this.pos.x)}},l.prototype.isValidMove=function(t,i){var o=Math.floor(t/e.default.TileWidth),r=Math.floor(i/e.default.TileWidth),n=Math.floor(this.pos.x/e.default.TileWidth),a=Math.floor(this.pos.y/e.default.TileWidth),l=Math.abs(n-o),s=Math.abs(a-r),h=1===Math.sqrt(l*l+s*s),u=this.level.getTile(t,i);return h&&!!u},l.prototype.moveToNearestTile=function(o){var r=this,n=Math.floor(o.x/e.default.TileWidth),a=Math.floor(o.y/e.default.TileWidth);if(this.isValidMove(o.x,o.y)){if(this.moving)return void(this.moving=!1);this.moving=!0;var l=this.level.getTile(this.pos.x,this.pos.y),s=this.level.getTile(o.x,o.y);if(this.actions.rotateTo(Math.atan2(o.y-this.pos.y,o.x-this.pos.x),100,t.RotationType.ShortestPath),s){var h=i.Terrain.GetTerrain(s),u=h.delay();h.mineable()&&!i.Terrain.HasBeetle(s)&&(s.addTag("beetle"),this.actions.delay(u).callMethod(function(){r.level.finishDig(o.x,o.y,!0)}),this.actions.easeTo(n*e.default.TileWidth+e.default.TileWidth/2,a*e.default.TileWidth+e.default.TileWidth/2,e.default.BeetleSpaceMoveDuration,t.EasingFunctions.EaseInOutCubic).callMethod(function(){r.moving=!1,null==l||l.removeComponent("beetle",!0)}))}}},l.random=new t.Random(1337),l}(t.Actor);exports.Beetle=l;
},{"excalibur":"A6Lr","./config":"foLc","./terrain":"fRLe","./every":"np5A","./resources":"x5mp"}],"G1XI":[function(require,module,exports) {
var define;
var e;!function(){"use strict";var t={}.hasOwnProperty;function r(){for(var e=[],n=0;n<arguments.length;n++){var o=arguments[n];if(o){var i=typeof o;if("string"===i||"number"===i)e.push(o);else if(Array.isArray(o)){if(o.length){var s=r.apply(null,o);s&&e.push(s)}}else if("object"===i)if(o.toString===Object.prototype.toString)for(var a in o)t.call(o,a)&&o[a]&&e.push(a);else e.push(o.toString())}}return e.join(" ")}"undefined"!=typeof module&&module.exports?(r.default=r,module.exports=r):"function"==typeof e&&"object"==typeof e.amd&&e.amd?e("classnames",[],function(){return r}):window.classNames=r}();
},{}],"OlbK":[function(require,module,exports) {
var global = arguments[3];
var n=arguments[3],t=o(),r=u(),e=c(),i="undefined"!=typeof window?window:n;function o(){return Object.assign?Object.assign:function(n,t,r,e){for(var i=1;i<arguments.length;i++)l(Object(arguments[i]),function(t,r){n[r]=t});return n}}function u(){if(Object.create)return function(n,r,e,i){var o=a(arguments,1);return t.apply(this,[Object.create(n)].concat(o))};{function n(){}return function(r,e,i,o){var u=a(arguments,1);return n.prototype=r,t.apply(this,[new n].concat(u))}}}function c(){return String.prototype.trim?function(n){return String.prototype.trim.call(n)}:function(n){return n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}}function f(n,t){return function(){return t.apply(n,Array.prototype.slice.call(arguments,0))}}function a(n,t){return Array.prototype.slice.call(n,t||0)}function l(n,t){s(n,function(n,r){return t(n,r),!1})}function p(n,t){var r=y(n)?[]:{};return s(n,function(n,e){return r[e]=t(n,e),!1}),r}function s(n,t){if(y(n)){for(var r=0;r<n.length;r++)if(t(n[r],r))return n[r]}else for(var e in n)if(n.hasOwnProperty(e)&&t(n[e],e))return n[e]}function y(n){return null!=n&&"function"!=typeof n&&"number"==typeof n.length}function b(n){return n&&"[object Function]"==={}.toString.call(n)}function g(n){return n&&"[object Object]"==={}.toString.call(n)}module.exports={assign:t,create:r,trim:e,bind:f,slice:a,each:l,map:p,pluck:s,isList:y,isFunction:b,isObject:g,Global:i};
},{}],"iLeD":[function(require,module,exports) {
var e=require("./util"),t=e.slice,n=e.pluck,r=e.each,i=e.bind,a=e.create,s=e.isList,o=e.isFunction,u=e.isObject;module.exports={createStore:f};var c={version:"2.0.12",enabled:!1,get:function(e,t){var n=this.storage.read(this._namespacePrefix+e);return this._deserialize(n,t)},set:function(e,t){return void 0===t?this.remove(e):(this.storage.write(this._namespacePrefix+e,this._serialize(t)),t)},remove:function(e){this.storage.remove(this._namespacePrefix+e)},each:function(e){var t=this;this.storage.each(function(n,r){e.call(t,t._deserialize(n),(r||"").replace(t._namespaceRegexp,""))})},clearAll:function(){this.storage.clearAll()},hasNamespace:function(e){return this._namespacePrefix=="__storejs_"+e+"_"},createStore:function(){return f.apply(this,arguments)},addPlugin:function(e){this._addPlugin(e)},namespace:function(e){return f(this.storage,this.plugins,e)}};function l(){var e="undefined"==typeof console?null:console;e&&(e.warn?e.warn:e.log).apply(e,arguments)}function f(e,f,h){h||(h=""),e&&!s(e)&&(e=[e]),f&&!s(f)&&(f=[f]);var d=h?"__storejs_"+h+"_":"",p=h?new RegExp("^"+d):null;if(!/^[a-zA-Z0-9_\-]*$/.test(h))throw new Error("store.js namespaces can only have alphanumerics + underscores and dashes");var g=a({_namespacePrefix:d,_namespaceRegexp:p,_testStorage:function(e){try{var t="__storejs__test__";e.write(t,t);var n=e.read(t)===t;return e.remove(t),n}catch(r){return!1}},_assignPluginFnProp:function(e,n){var i=this[n];this[n]=function(){var n=t(arguments,0),a=this;var s=[function(){if(i)return r(arguments,function(e,t){n[t]=e}),i.apply(a,n)}].concat(n);return e.apply(a,s)}},_serialize:function(e){return JSON.stringify(e)},_deserialize:function(e,t){if(!e)return t;var n="";try{n=JSON.parse(e)}catch(r){n=e}return void 0!==n?n:t},_addStorage:function(e){this.enabled||this._testStorage(e)&&(this.storage=e,this.enabled=!0)},_addPlugin:function(e){var t=this;if(s(e))r(e,function(e){t._addPlugin(e)});else if(!n(this.plugins,function(t){return e===t})){if(this.plugins.push(e),!o(e))throw new Error("Plugins must be function values that return objects");var i=e.call(this);if(!u(i))throw new Error("Plugins must return an object of function properties");r(i,function(n,r){if(!o(n))throw new Error("Bad plugin property: "+r+" from plugin "+e.name+". Plugins should only return functions.");t._assignPluginFnProp(n,r)})}},addStorage:function(e){l("store.addStorage(storage) is deprecated. Use createStore([storages])"),this._addStorage(e)}},c,{plugins:[]});return g.raw={},r(g,function(e,t){o(e)&&(g.raw[t]=i(g,e))}),r(e,function(e){g._addStorage(e)}),r(f,function(e){g._addPlugin(e)}),g}
},{"./util":"OlbK"}],"ydJg":[function(require,module,exports) {
var e=require("../src/util"),r=e.Global;function t(){return r.localStorage}function n(e){return t().getItem(e)}function o(e,r){return t().setItem(e,r)}function u(e){for(var r=t().length-1;r>=0;r--){var o=t().key(r);e(n(o),o)}}function a(e){return t().removeItem(e)}function l(){return t().clear()}module.exports={name:"localStorage",read:n,write:o,each:u,remove:a,clearAll:l};
},{"../src/util":"OlbK"}],"qnPi":[function(require,module,exports) {
var e=require("../src/util"),r=e.Global;module.exports={name:"oldFF-globalStorage",read:n,write:t,each:l,remove:a,clearAll:u};var o=r.globalStorage;function n(e){return o[e]}function t(e,r){o[e]=r}function l(e){for(var r=o.length-1;r>=0;r--){var n=o.key(r);e(o[n],n)}}function a(e){return o.removeItem(e)}function u(){l(function(e,r){delete o[e]})}
},{"../src/util":"OlbK"}],"ajOM":[function(require,module,exports) {
var e=require("../src/util"),t=e.Global;module.exports={name:"oldIE-userDataStorage",write:o,read:u,each:c,remove:l,clearAll:m};var n="storejs",r=t.document,a=f(),i=(t.navigator?t.navigator.userAgent:"").match(/ (MSIE 8|MSIE 9|MSIE 10)\./);function o(e,t){if(!i){var r=d(e);a(function(e){e.setAttribute(r,t),e.save(n)})}}function u(e){if(!i){var t=d(e),n=null;return a(function(e){n=e.getAttribute(t)}),n}}function c(e){a(function(t){for(var n=t.XMLDocument.documentElement.attributes,r=n.length-1;r>=0;r--){var a=n[r];e(t.getAttribute(a.name),a.name)}})}function l(e){var t=d(e);a(function(e){e.removeAttribute(t),e.save(n)})}function m(){a(function(e){var t=e.XMLDocument.documentElement.attributes;e.load(n);for(var r=t.length-1;r>=0;r--)e.removeAttribute(t[r].name);e.save(n)})}var v=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g");function d(e){return e.replace(/^\d/,"___$&").replace(v,"___")}function f(){if(!r||!r.documentElement||!r.documentElement.addBehavior)return null;var e,t,a;try{(t=new ActiveXObject("htmlfile")).open(),t.write('<script>document.w=window<\/script><iframe src="/favicon.ico"></iframe>'),t.close(),e=t.w.frames[0].document,a=e.createElement("div")}catch(i){a=r.createElement("div"),e=r.body}return function(t){var r=[].slice.call(arguments,0);r.unshift(a),e.appendChild(a),a.addBehavior("#default#userData"),a.load(n),t.apply(this,r),e.removeChild(a)}}
},{"../src/util":"OlbK"}],"zpTn":[function(require,module,exports) {
var e=require("../src/util"),c=e.Global,n=e.trim;module.exports={name:"cookieStorage",read:a,write:i,each:o,remove:t,clearAll:p};var r=c.document;function a(e){if(!e||!s(e))return null;var c="(?:^|.*;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*";return unescape(r.cookie.replace(new RegExp(c),"$1"))}function o(e){for(var c=r.cookie.split(/; ?/g),a=c.length-1;a>=0;a--)if(n(c[a])){var o=c[a].split("="),i=unescape(o[0]);e(unescape(o[1]),i)}}function i(e,c){e&&(r.cookie=escape(e)+"="+escape(c)+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/")}function t(e){e&&s(e)&&(r.cookie=escape(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/")}function p(){o(function(e,c){t(c)})}function s(e){return new RegExp("(?:^|;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(r.cookie)}
},{"../src/util":"OlbK"}],"XZsG":[function(require,module,exports) {
var e=require("../src/util"),r=e.Global;function t(){return r.sessionStorage}function n(e){return t().getItem(e)}function o(e,r){return t().setItem(e,r)}function u(e){for(var r=t().length-1;r>=0;r--){var o=t().key(r);e(n(o),o)}}function a(e){return t().removeItem(e)}function i(){return t().clear()}module.exports={name:"sessionStorage",read:n,write:o,each:u,remove:a,clearAll:i};
},{"../src/util":"OlbK"}],"Ditp":[function(require,module,exports) {
module.exports={name:"memoryStorage",read:n,write:r,each:o,remove:t,clearAll:a};var e={};function n(n){return e[n]}function r(n,r){e[n]=r}function o(n){for(var r in e)e.hasOwnProperty(r)&&n(e[r],r)}function t(n){delete e[n]}function a(n){e={}}
},{}],"QNYQ":[function(require,module,exports) {
module.exports=[require("./localStorage"),require("./oldFF-globalStorage"),require("./oldIE-userDataStorage"),require("./cookieStorage"),require("./sessionStorage"),require("./memoryStorage")];
},{"./localStorage":"ydJg","./oldFF-globalStorage":"qnPi","./oldIE-userDataStorage":"ajOM","./cookieStorage":"zpTn","./sessionStorage":"XZsG","./memoryStorage":"Ditp"}],"FFlA":[function(require,module,exports) {
"object"!=typeof JSON&&(JSON={}),function(){"use strict";var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta,rep;function f(t){return t<10?"0"+t:t}function this_value(){return this.valueOf()}function quote(t){return rx_escapable.lastIndex=0,rx_escapable.test(t)?'"'+t.replace(rx_escapable,function(t){var e=meta[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var r,n,o,u,f,a=gap,i=e[t];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(t)),"function"==typeof rep&&(i=rep.call(e,t,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,f=[],"[object Array]"===Object.prototype.toString.apply(i)){for(u=i.length,r=0;r<u;r+=1)f[r]=str(r,i)||"null";return o=0===f.length?"[]":gap?"[\n"+gap+f.join(",\n"+gap)+"\n"+a+"]":"["+f.join(",")+"]",gap=a,o}if(rep&&"object"==typeof rep)for(u=rep.length,r=0;r<u;r+=1)"string"==typeof rep[r]&&(o=str(n=rep[r],i))&&f.push(quote(n)+(gap?": ":":")+o);else for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(o=str(n,i))&&f.push(quote(n)+(gap?": ":":")+o);return o=0===f.length?"{}":gap?"{\n"+gap+f.join(",\n"+gap)+"\n"+a+"}":"{"+f.join(",")+"}",gap=a,o}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value),"function"!=typeof JSON.stringify&&(meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(t,e,r){var n;if(gap="",indent="","number"==typeof r)for(n=0;n<r;n+=1)indent+=" ";else"string"==typeof r&&(indent=r);if(rep=e,e&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw new Error("JSON.stringify");return str("",{"":t})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){var j;function walk(t,e){var r,n,o=t[e];if(o&&"object"==typeof o)for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(void 0!==(n=walk(o,r))?o[r]=n:delete o[r]);return reviver.call(t,e,o)}if(text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}();
},{}],"LxJh":[function(require,module,exports) {
function e(){return require("./lib/json2"),{}}module.exports=e;
},{"./lib/json2":"FFlA"}],"Xqes":[function(require,module,exports) {
var e=require("../src/store-engine"),r=require("../storages/all"),s=[require("../plugins/json2")];module.exports=e.createStore(r,s);
},{"../src/store-engine":"iLeD","../storages/all":"QNYQ","../plugins/json2":"LxJh"}],"B9Wb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.resetPreferences=o,exports.savePreferences=f,exports.loadPreferences=u,exports.Preferences=void 0;var e=r(require("store"));function r(e){return e&&e.__esModule?e:{default:e}}var t=function(){return(t=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var s in r=arguments[t])Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s]);return e}).apply(this,arguments)},n={muteBackgroundMusic:!1,muteAll:!1};exports.Preferences=n;var s=t({},n);function o(){exports.Preferences=n=t({},s)}function f(){e.default.set("pref",n)}function u(){exports.Preferences=n=t(t({},n),e.default.get("pref"))}
},{"store":"Xqes"}],"BceJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SoundManager=void 0;var e=require("excalibur"),u=n(require("classnames")),o=n(require("./config")),c=require("./preferences"),s=require("./resources");function n(e){return e&&e.__esModule?e:{default:e}}var r=function(){function n(){}return n.setSoundSpecificVolume=function(){s.Resources.BackgroundMusic.volume=o.default.BackgroundVolume,s.Resources.PickUpSound.volume=o.default.PickupSoundVolume,s.Resources.FallSound.volume=o.default.BackgroundVolume,s.Resources.ChuChu.volume=o.default.ChuchuVolume,s.Resources.DigSound1.volume=o.default.DigSoundVolume,s.Resources.DigSound2.volume=o.default.DigSoundVolume,s.Resources.DigSound3.volume=o.default.DigSoundVolume,s.Resources.DigSound4.volume=o.default.DigSoundVolume,s.Resources.DigSound5.volume=o.default.DigSoundVolume,s.Resources.DigSound6.volume=o.default.DigSoundVolume,s.Resources.DigSound7.volume=o.default.DigSoundVolume,s.Resources.DigSound8.volume=o.default.DigSoundVolume},n.init=function(){n.setSoundSpecificVolume(),c.Preferences.muteBackgroundMusic&&n.muteBackgroundMusic(),c.Preferences.muteAll&&n.muteAll(),$("#mute-music").on("click",function(){return c.Preferences.muteBackgroundMusic?n.unmuteBackgroundMusic():n.muteBackgroundMusic(),(0,c.savePreferences)(),!1}),$("#mute-all").on("click",function(){return c.Preferences.muteAll?n.unmuteAll():n.muteAll(),(0,c.savePreferences)(),!1})},n.muteAll=function(){for(var u in c.Preferences.muteAll=!0,c.Preferences.muteBackgroundMusic=!0,s.Resources){var o=s.Resources[u];o instanceof e.Sound&&(o.volume=0)}n.muteBackgroundMusic(),n._updateMuteAllButton()},n.unmuteAll=function(){for(var u in c.Preferences.muteAll=!1,c.Preferences.muteBackgroundMusic=!1,s.Resources){var r=s.Resources[u];r instanceof e.Sound&&(r.volume=o.default.SoundVolume)}n.setSoundSpecificVolume(),n.unmuteBackgroundMusic(),n._updateMuteAllButton()},n.startBackgroundMusic=function(){s.Resources.BackgroundMusic.volume=c.Preferences.muteBackgroundMusic?0:o.default.BackgroundVolume,s.Resources.BackgroundMusic.loop=!0,s.Resources.BackgroundMusic.isPlaying()||s.Resources.BackgroundMusic.play()},n.stopBackgroundMusic=function(){s.Resources.BackgroundMusic.loop=!1},n.muteBackgroundMusic=function(){c.Preferences.muteBackgroundMusic=!0,s.Resources.BackgroundMusic.volume=0,n._updateMusicButton()},n.unmuteBackgroundMusic=function(){c.Preferences.muteBackgroundMusic=!1,s.Resources.BackgroundMusic.volume=o.default.BackgroundVolume,n._updateMusicButton()},n.playSetMusic=function(e){switch(s.Resources.SetMusic1.volume=c.Preferences.muteAll?0:o.default.SoundVolume,s.Resources.SetMusic2.volume=c.Preferences.muteAll?0:o.default.SoundVolume,s.Resources.SetMusic3Lead.volume=c.Preferences.muteAll?0:o.default.SoundVolume,s.Resources.SetMusic3Background.volume=c.Preferences.muteAll?0:o.default.SoundVolume,e){case 1:s.Resources.SetMusic1.play();break;case 2:s.Resources.SetMusic2.play();break;case 3:s.Resources.SetMusic3Lead.play(),s.Resources.SetMusic3Background.play()}},n._updateMusicButton=function(){$("#mute-music i").get(0).className=(0,u.default)("fa",{"fa-music":!c.Preferences.muteBackgroundMusic,"fa-play":c.Preferences.muteBackgroundMusic})},n._updateMuteAllButton=function(){$("#mute-all i").get(0).className=(0,u.default)("fa",{"fa-volume-up":!c.Preferences.muteAll,"fa-volume-off":c.Preferences.muteAll})},n}();exports.SoundManager=r;
},{"excalibur":"A6Lr","classnames":"G1XI","./config":"foLc","./preferences":"B9Wb","./resources":"x5mp"}],"ST41":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UndergroundSet=void 0;var t=require("excalibur"),e=require("./resources"),i=o(require("./config")),s=require("./sound-manager"),r=require("./globalState"),a=require("./gameOver");function o(t){return t&&t.__esModule?t:{default:t}}var n=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function s(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(s.prototype=i.prototype,new s)}}(),h=function(){return(h=Object.assign||function(t){for(var e,i=1,s=arguments.length;i<s;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},c={drummer:(0,t.vec)(285,617),guitarist:(0,t.vec)(162,687),bassist:(0,t.vec)(523,689),vocalist:(0,t.vec)(336,685)},d={fallDuration:3e3,fallRotationInDegreesPerSecond:120,setDuration:3e3,setDurationAlt:4e3,leaveDuration:1500,snekBodyRotationInDegreesPerSecondMin:150,snekBodyRotationInDegreesPerSecondMax:220,snekBodyMoveSpeed:100},u=function(i){function o(t){var e=i.call(this)||this;return e.playerScreenPos=t,e.state=r.GlobalState.GetInstance(),e}return n(o,i),o.prototype.onInitialize=function(i){this.camera.pos=(0,t.vec)(0,0),this.gameOver=new a.GameOver(i.drawWidth,i.drawHeight),this.background=new t.Actor({x:0,y:0,width:i.drawWidth,height:i.drawHeight,anchor:(0,t.vec)(0,0)});var s=new t.Graphics.GraphicsGroup({members:[{graphic:e.Resources.UndergroundSet.toSprite(),pos:(0,t.vec)(0,0)},{graphic:e.Resources.UndergroundSetInstruments.toSprite(),pos:(0,t.vec)(0,0)}]});this.background.graphics.add(s),this.background.graphics.add("empty",e.Resources.UndergroundSet.toSprite()),this.add(this.background),this.add(this.gameOver);var r=i.screenToWorldCoordinates((0,t.vec)(this.playerScreenPos.x,0));this.drummer=new t.Actor({x:r.x,y:r.y,scale:(0,t.vec)(2,2),width:20,height:40}),this.guitarist=new t.Actor({x:r.x,y:r.y,scale:(0,t.vec)(2,2),width:20,height:40}),this.bassist=new t.Actor({x:r.x,y:r.y,scale:(0,t.vec)(2,2),width:20,height:40}),this.vocalist=new t.Actor({x:r.x,y:r.y,scale:(0,t.vec)(2,2),width:20,height:40}),this.drummer.graphics.add(e.Resources.MeerkatDrummerFrontFacing.toSprite()),this.guitarist.graphics.add(e.Resources.MeerkatGuitaristFrontFacing.toSprite()),this.bassist.graphics.add(e.Resources.MeerkatBassistFrontFacing.toSprite()),this.vocalist.graphics.add(e.Resources.MeerkatVocalistFrontFacing.toSprite()),this.add(this.drummer),this.add(this.guitarist),this.add(this.bassist),this.add(this.vocalist),this.drummerPos=this.engine.screenToWorldCoordinates(c.drummer),this.guitaristPos=this.engine.screenToWorldCoordinates(c.guitarist),this.bassistPos=this.engine.screenToWorldCoordinates(c.bassist),this.vocalistPos=this.engine.screenToWorldCoordinates(c.vocalist)},o.prototype.onActivate=function(){var i=this;s.SoundManager.muteBackgroundMusic(),this.drummer.rx=t.Util.toRadians(d.fallRotationInDegreesPerSecond),this.guitarist.rx=t.Util.toRadians(d.fallRotationInDegreesPerSecond),this.vocalist.rx=t.Util.toRadians(d.fallRotationInDegreesPerSecond),this.bassist.rx=t.Util.toRadians(d.fallRotationInDegreesPerSecond),this.drummer.actions.easeTo(this.drummerPos.x,this.drummerPos.y,d.fallDuration,t.EasingFunctions.EaseInCubic),this.guitarist.actions.easeTo(this.guitaristPos.x,this.guitaristPos.y,d.fallDuration,t.EasingFunctions.EaseInCubic),this.vocalist.actions.easeTo(this.vocalistPos.x,this.vocalistPos.y,d.fallDuration,t.EasingFunctions.EaseInCubic),this.bassist.actions.easeTo(this.bassistPos.x,this.bassistPos.y,d.fallDuration,t.EasingFunctions.EaseInCubic),e.Resources.FallSound.play();var r=new t.Timer({interval:d.fallDuration,fcn:function(){return i.swapToBand()},repeats:!1});this.add(r);var a=new g;a.pos=this.engine.screenToWorldCoordinates((0,t.vec)(.75*this.engine.drawWidth,0)),this.add(a)},o.prototype.swapToBand=function(){var i=this;this.background.graphics.use("empty"),this.remove(this.bassist),this.remove(this.guitarist),this.remove(this.vocalist),this.remove(this.drummer),this.drummer=new t.Actor({x:this.drummerPos.x,y:this.drummerPos.y,width:60,height:40,scale:(0,t.vec)(2,2)}),this.guitarist=new t.Actor({x:this.guitaristPos.x,y:this.guitaristPos.y,width:60,height:40,scale:(0,t.vec)(2,2)}),this.bassist=new t.Actor({x:this.bassistPos.x,y:this.bassistPos.y,width:60,height:40,scale:(0,t.vec)(2,2)}),this.vocalist=new t.Actor({x:this.vocalistPos.x,y:this.vocalistPos.y,width:60,height:40,scale:(0,t.vec)(2,2)});var r={rows:1,columns:3,spriteWidth:32,spriteHeight:40},a=t.Graphics.SpriteSheet.fromGrid({image:e.Resources.MeerkatDrummerPlaying,grid:h(h({},r),{spriteWidth:60})});this.drummer.graphics.use(t.Graphics.Animation.fromSpriteSheet(a,[0,1,2],100,t.Graphics.AnimationStrategy.PingPong));var o=t.Graphics.SpriteSheet.fromGrid({image:e.Resources.MeerkatGuitaristPlaying,grid:h(h({},r),{spriteWidth:40})});this.guitarist.graphics.use(t.Graphics.Animation.fromSpriteSheet(o,[0,1,2],100,t.Graphics.AnimationStrategy.PingPong));var n=t.Graphics.SpriteSheet.fromGrid({image:e.Resources.MeerkatBassistPlaying,grid:h(h({},r),{spriteWidth:32})});this.bassist.graphics.use(t.Graphics.Animation.fromSpriteSheet(n,[0,1,2],100,t.Graphics.AnimationStrategy.PingPong));var c=t.Graphics.SpriteSheet.fromGrid({image:e.Resources.MeerkatVocalistPlaying,grid:h(h({},r),{spriteWidth:40})});this.vocalist.graphics.use(t.Graphics.Animation.fromSpriteSheet(c,[0,1,2],100,t.Graphics.AnimationStrategy.PingPong)),this.add(this.drummer),this.add(this.guitarist),this.add(this.bassist),this.add(this.vocalist),s.SoundManager.playSetMusic(this.state.Round),this.add(new t.Timer({fcn:function(){return i.digAndLeave()},interval:this.getSetDuration(),repeats:!1}))},o.prototype.digAndLeave=function(){var i,s,r=this;if(this.state.GameWon)return null===(i=this.gameOver)||void 0===i||i.updateEndScreen(["The snake's face melted","🤘🤘🤘"]),void(null===(s=this.gameOver)||void 0===s||s.show());this.remove(this.bassist),this.remove(this.guitarist),this.remove(this.vocalist),this.remove(this.drummer),this.background.graphics.use("default"),this.drummer=new t.Actor({x:this.drummerPos.x,y:this.drummerPos.y,scale:(0,t.vec)(2,2),width:20,height:40}),this.guitarist=new t.Actor({x:this.guitaristPos.x,y:this.guitaristPos.y,scale:(0,t.vec)(2,2),width:20,height:40}),this.bassist=new t.Actor({x:this.bassistPos.x,y:this.bassistPos.y,scale:(0,t.vec)(2,2),width:20,height:40}),this.vocalist=new t.Actor({x:this.vocalistPos.x,y:this.vocalistPos.y,scale:(0,t.vec)(2,2),width:20,height:40}),this.drummer.graphics.add(e.Resources.MeerkatDrummerFrontFacing.toSprite()),this.guitarist.graphics.add(e.Resources.MeerkatGuitaristFrontFacing.toSprite()),this.bassist.graphics.add(e.Resources.MeerkatBassistFrontFacing.toSprite()),this.vocalist.graphics.add(e.Resources.MeerkatVocalistFrontFacing.toSprite()),this.add(this.drummer),this.add(this.guitarist),this.add(this.bassist),this.add(this.vocalist);var a=this.engine.screenToWorldCoordinates((0,t.vec)(this.playerScreenPos.x,this.engine.drawHeight));this.drummer.actions.easeTo(a.x,a.y,d.leaveDuration,t.EasingFunctions.EaseOutCubic),this.guitarist.actions.easeTo(a.x,a.y,d.leaveDuration,t.EasingFunctions.EaseOutCubic),this.bassist.actions.easeTo(a.x,a.y,d.leaveDuration,t.EasingFunctions.EaseOutCubic),this.vocalist.actions.easeTo(a.x,a.y,d.leaveDuration,t.EasingFunctions.EaseOutCubic),this.add(new t.Timer({fcn:function(){return r.engine.goToScene("main")},interval:d.leaveDuration,repeats:!1}))},o.prototype.onDeactivate=function(){s.SoundManager.unmuteBackgroundMusic()},o.prototype.getSetDuration=function(){return 1===this.state.Round?d.setDuration:d.setDurationAlt},o}(t.Scene);exports.UndergroundSet=u;var g=function(s){function r(){var i=null!==s&&s.apply(this,arguments)||this;return i.spritesheet=t.Graphics.SpriteSheet.fromGrid({image:e.Resources.Snek,grid:{rows:1,columns:8,spriteHeight:96,spriteWidth:96}}),i}return n(r,s),r.prototype.onInitialize=function(e){this.z=11,this.graphics.add("default",this.spritesheet.sprites[i.default.SnekBodyLength]),this.actions.easeTo(this.pos.x,this.pos.y+200,d.fallDuration);for(var s=[],r=function(e){var r=(0,t.vec)(a.pos.x-(e+1)*i.default.TileWidth,a.pos.y),o=new t.Actor({x:r.x,y:r.y,width:i.default.TileWidth,height:i.default.TileWidth});o.graphics.add("default",a.spritesheet.sprites[i.default.SnekBodyLength-(e+1)]);var n=(0,t.vec)(r.x,r.y+200);o.actions.easeTo(n.x,n.y,d.fallDuration).asPromise().then(function(){o.rx=t.Util.toRadians(t.Util.randomIntInRange(d.snekBodyRotationInDegreesPerSecondMin,d.snekBodyRotationInDegreesPerSecondMax)),o.actions.moveBy(-5,-5,d.snekBodyMoveSpeed).moveBy(10,10,d.snekBodyMoveSpeed).moveBy(-5,-5,d.snekBodyMoveSpeed).moveTo(n.x,n.y,d.snekBodyMoveSpeed).repeatForever()}),s.push(o)},a=this,o=0;o<i.default.SnekBodyLength;o++)r(o);this.scene.add(s[0]),this.scene.add(s[2]),this.scene.add(s[4]),this.scene.add(s[6]),this.scene.add(s[1]),this.scene.add(s[3]),this.scene.add(s[5])},r}(t.Actor);
},{"excalibur":"A6Lr","./resources":"x5mp","./config":"foLc","./sound-manager":"BceJ","./globalState":"Z7BZ","./gameOver":"tKgm"}],"pDJl":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Level=void 0;var e=require("excalibur"),t=require("./player"),i=g(require("./config")),n=require("./resources"),r=require("./snek"),o=require("./gameOver"),s=require("./powerup"),a=require("./terrain"),h=require("./globalState"),l=require("./background"),u=require("./weightmap"),d=require("./progress-meter"),p=require("./beetle"),c=require("./undergroundSet");function g(e){return e&&e.__esModule?e:{default:e}}var T=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),v=function(g){function v(){var t=null!==g&&g.apply(this,arguments)||this;return t.start=5,t.chunkWidth=i.default.ChunkWidth,t.chunkHeight=i.default.ChunkHeight,t.terrainRandom=new e.Random(i.default.TerrainRandomSeed),t.collectibleRandom=new e.Random(i.default.CollectibleRandomSeed),t.terrainWeightMap=new u.WeightMap(t.terrainRandom),t.collectibleWeightMap=new u.WeightMap(t.collectibleRandom),t.beetleWeightMap=new u.WeightMap(p.Beetle.random),t.onScreenChunkId=0,t.previousChunk=null,t.currentChunk=null,t.player=null,t.snek=null,t.progressMeter=null,t.gameOver=null,t.chunks=[],t.beetles=[],t.state=h.GlobalState.GetInstance(),t}return T(v,g),v.prototype.onInitialize=function(h){var u=this;a.Terrain.Initialize();var p=new s.PowerUpTimer(this,function(){u.state.HasSpeedPowerUp=!0},function(){u.state.HasSpeedPowerUp=!1},i.default.PowerUpDurationSeconds);this.bones=n.Resources.DirtBones.toSprite();var c=new e.Actor({pos:(0,e.vec)(h.halfDrawWidth+50,100),width:10,height:200});c.graphics.use(n.Resources.Instructions.toSprite()),this.player=new t.Player(this),this.snek=new r.Snek(this),this.gameOver=new o.GameOver(h.drawWidth,h.drawHeight),this.progressMeter=new d.ProgressMeter,this.add(c),this.add(this.player),this.add(this.snek),this.add(this.gameOver),this.add(this.progressMeter),this.cameraStrategy=new e.ElasticToActorStrategy(this.player,.2,.2),this.camera.addStrategy(this.cameraStrategy),this.camera.on("postupdate",function(e){u.camera.pos.x=u.camera.viewport.width/2}),this.background=new l.Background(this),this.buildTerrainWeightMap(),this.buildCollectibleWeightMap(p),this.buildBeetleWeightMap();var g=this.generateChunk(i.default.TileWidth*this.start);this.setCellToTerrain(g.getCellByIndex(4),a.DirtTerrain),this.previousChunk=null,this.add(this.currentChunk=g),this.chunks.push(this.currentChunk)},v.prototype.onActivate=function(e){e instanceof c.UndergroundSet&&this.transitionBackFromUndergroundSet()},v.prototype.buildTerrainWeightMap=function(){this.terrainWeightMap.add(20,a.RockTerrain),this.terrainWeightMap.add(80,a.DirtTerrain)},v.prototype.buildCollectibleWeightMap=function(e){var t=n.Resources.SpeedPowerUp.toSprite();this.speedPowerUp=new s.PowerUp(t,"speedPowerUp",e),this.collectibleWeightMap.add(1,this.speedPowerUp),this.collectibleWeightMap.add(99,null)},v.prototype.buildBeetleWeightMap=function(){var t=this;this.beetleWeightMap.add(2,function(n,r){var o=(0,e.vec)(i.default.TileWidth*n-i.default.TileWidth/2,i.default.TileWidth*r-i.default.TileWidth/2);return new p.Beetle(o.x,o.y,t)}),this.beetleWeightMap.add(98,null)},v.prototype.onPostUpdate=function(){this.camera.pos.y+i.default.TileWidth*i.default.ChunkHeight/2>=i.default.DistanceToRound*this.state.Round*i.default.TileWidth+i.default.TileWidth*(this.start+1)&&this.camera.removeStrategy(this.cameraStrategy),this.currentChunk&&this.player&&this.camera.pos.y>this.currentChunk.y+i.default.TileWidth*i.default.ChunkHeight/2&&this.loadNextChunk(),this.previousChunk&&this.player&&this.camera.pos.y<=this.previousChunk.y+i.default.TileWidth*i.default.ChunkHeight/2&&this.loadPrevChunk(),this.updateProgress(),this.checkGameState()},v.prototype.updateProgress=function(){var e=Math.max(this.player.pos.y-this.start*i.default.TileWidth,0)/i.default.TileWidth;this.progressMeter.updateProgress(e)},v.prototype.checkGameState=function(){var e,t,n,r,o,s,a,h=this;this.state.GameOver||(((null===(e=this.snek)||void 0===e?void 0:e.pos.x)==(null===(t=this.player)||void 0===t?void 0:t.pos.x)&&(null===(n=this.snek)||void 0===n?void 0:n.pos.y)==(null===(r=this.player)||void 0===r?void 0:r.pos.y)||-1!==(null===(o=this.snek)||void 0===o?void 0:o.getSnekBodyGridCoords().findIndex(function(e){var t;return e.x==(null===(t=h.player)||void 0===t?void 0:t.pos.x)&&e.y==h.player.pos.y})))&&(null===(s=this.gameOver)||void 0===s||s.updateEndScreen(["The Snek got you before","your metal concert, Encore!?"]),null===(a=this.gameOver)||void 0===a||a.show(),this.state.GameOver=!0),this.state.GameWon||this.state.RoundWon||this.progressMeter.progress>=i.default.DistanceToRound*this.state.Round&&(this.state.RoundWon=!0,this.state.GameOver=!0,this.progressMeter.progress>=i.default.DistanceToComplete&&(this.state.GameWon=!0),this.transitionToUndergroundSet()))},v.prototype.transitionToUndergroundSet=function(){var e=new c.UndergroundSet(this.engine.worldToScreenCoordinates(this.player.pos));this.engine.addScene("set",e),this.engine.goToScene("set")},v.prototype.transitionBackFromUndergroundSet=function(){this.engine.removeScene("set"),this.state.GameOver=!1,this.state.Round+=1,this.state.RoundWon=!1,this.state.SnakePause=!0,this.camera.addStrategy(this.cameraStrategy)},v.prototype.getTile=function(e,t){var i,n,r,o;return null!==(o=null!==(n=null===(i=this.currentChunk)||void 0===i?void 0:i.getCellByPoint(e,t))&&void 0!==n?n:null===(r=this.previousChunk)||void 0===r?void 0:r.getCellByPoint(e,t))&&void 0!==o?o:null},v.prototype.generateChunk=function(t){for(var n,r,o,s=this,h=new e.TileMap({x:0,y:t,rows:this.chunkHeight,cols:this.chunkWidth,cellWidth:i.default.TileWidth,cellHeight:i.default.TileWidth}),l=function(e){if(n=u.terrainWeightMap.randomSelect(a.EmptyTerrain),u.setCellToTerrain(e,n),"dirt"===n.tag()&&(r=u.collectibleWeightMap.randomSelect(null),u.setCellCollectible(e,r),!r&&u.terrainRandom.next()<.04&&e.addSprite(u.bones),o=u.beetleWeightMap.randomSelect(null))){var t=Math.floor(e.x/i.default.TileWidth),h=Math.floor(e.y/i.default.TileWidth);console.log("Beetle",t,h);var l=o(t,h);setTimeout(function(){return s.finishDig(l.pos.x,l.pos.y,!0)}),u.add(l)}},u=this,d=0,p=h.data;d<p.length;d++){l(p[d])}return this.ValidateTileMap(h,this.currentChunk),h},v.prototype.ValidateTileMap=function(e,t){var i=e.y,n=null;t&&(n=t.data.filter(function(t){return t.y===i-e.cellHeight}));for(var r=a.DirtTerrain,o=0;o<e.rows;++o){for(var s=e.data.filter(function(e){return e.y===i}),h=0;h<s.length;h++){var l=s[h];if(n){var u=a.Terrain.GetTerrain(s[h]),d=0!=h?n[h-1]:null,p=h!=s.length-1?n[h+1]:null;if(d&&p){var c=a.Terrain.GetTerrain(d),g=a.Terrain.GetTerrain(p);c.mineable()||g.mineable()||u.mineable()||this.setCellToTerrain(l,r)}else u.mineable()&&this.setCellToTerrain(l,r)}else this.setCellToTerrain(l,r)}i+=e.cellHeight,n=s}},v.prototype.loadNextChunk=function(){var e;this.onScreenChunkId++,console.log("Loading chunk id: ",this.onScreenChunkId),this.chunks[this.onScreenChunkId]?e=this.chunks[this.onScreenChunkId]:(e=this.generateChunk(this.onScreenChunkId*(i.default.TileWidth*i.default.ChunkHeight)+this.start*i.default.TileWidth),this.chunks.push(e)),this.previousChunk&&(this.remove(this.previousChunk),console.log("Removing previous chunk")),this.previousChunk=this.currentChunk,this.currentChunk=e,this.background.setCurrentChunkId(this.onScreenChunkId),this.add(this.currentChunk)},v.prototype.loadPrevChunk=function(){var e;if(0!==this.onScreenChunkId){this.onScreenChunkId--,console.log("Loading chunk id: ",this.onScreenChunkId);var t=this.chunks[this.onScreenChunkId];this.currentChunk&&this.remove(this.currentChunk),this.currentChunk=t,this.previousChunk=null!==(e=this.chunks[this.onScreenChunkId-1])&&void 0!==e?e:null,this.background.setCurrentChunkId(this.onScreenChunkId),this.background.setCurrentChunkId(this.onScreenChunkId-1),this.add(t),this.add(this.previousChunk)}else this.currentChunk=this.chunks[0],this.previousChunk=null},v.prototype.finishDig=function(e,t,i){var r,o,s,h;void 0===i&&(i=!1);var l=this.currentChunk,u=null==l?void 0:l.getCellByPoint(e,t);if(u||(u=null==(l=this.previousChunk)?void 0:l.getCellByPoint(e,t)),u){var d=new a.TunnelTerrain(this.determineTunnelSidesForCell(u));this.setCellToTerrain(u,d),-1===u.tags.indexOf("speedPowerUp")||i||(this.speedPowerUp.apply(),n.Resources.PickUpSound.play());var p=this.getNeighbors(u);(null===(r=p.north)||void 0===r?void 0:r.hasTag(a.EmptyTag))&&this.setCellToTerrain(p.north,new a.TunnelTerrain(this.determineTunnelSidesForCell(p.north))),(null===(o=p.south)||void 0===o?void 0:o.hasTag(a.EmptyTag))&&this.setCellToTerrain(p.south,new a.TunnelTerrain(this.determineTunnelSidesForCell(p.south))),(null===(s=p.west)||void 0===s?void 0:s.hasTag(a.EmptyTag))&&this.setCellToTerrain(p.west,new a.TunnelTerrain(this.determineTunnelSidesForCell(p.west))),(null===(h=p.east)||void 0===h?void 0:h.hasTag(a.EmptyTag))&&this.setCellToTerrain(p.east,new a.TunnelTerrain(this.determineTunnelSidesForCell(p.east)))}},v.prototype.getNeighbors=function(e){return{north:this.getTile(e.x,e.y-e.height),south:this.getTile(e.x,e.y+e.height),east:this.getTile(e.x+e.width,e.y),west:this.getTile(e.x-e.width,e.y)}},v.prototype.determineTunnelSidesForCell=function(e){var t={north:!1,south:!1,east:!1,west:!1},i=this.getNeighbors(e),n=i.north,r=i.south,o=i.east,s=i.west;return o&&!o.hasTag(a.EmptyTag)&&(t.east=!0),s&&!s.hasTag(a.EmptyTag)&&(t.west=!0),r&&!(null==r?void 0:r.hasTag(a.EmptyTag))&&(t.south=!0),n&&!n.hasTag(a.EmptyTag)&&(t.north=!0),t},v.prototype.setCellToTerrain=function(e,t){var i=a.Terrain.GetTerrain(e);t.tag()===a.EmptyTag&&e.clearSprites(),e.removeComponent(i.tag(),!0);var n=t.sprites();n&&n.forEach(function(t){return e.addSprite(t)}),e.addTag(t.tag())},v.prototype.setCellCollectible=function(e,t){t&&(e.addSprite(t.sprite),e.addTag(t.name))},v}(e.Scene);exports.Level=v;
},{"excalibur":"A6Lr","./player":"rXhO","./config":"foLc","./resources":"x5mp","./snek":"CDgt","./gameOver":"tKgm","./powerup":"GYtl","./terrain":"fRLe","./globalState":"Z7BZ","./background":"Nyr0","./weightmap":"CbHH","./progress-meter":"a30k","./beetle":"oOWz","./undergroundSet":"ST41"}],"B6dB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.game=exports.Game=void 0,require("regenerator-runtime/runtime");var e=require("excalibur"),t=l(require("dat.gui")),a=require("./resources"),n=require("./level"),r=l(require("./config")),i=require("./globalState"),u=require("./playerTrail"),o=require("./preferences"),s=require("./sound-manager");function l(e){return e&&e.__esModule?e:{default:e}}var d=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!=typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}();e.Physics.enabled=!1;var c=r.default.DebugMenuEnabled;if(c){var f=new t.default.GUI({name:"Ludum 48 Debug"});for(var h in r.default)if("number"==typeof r.default[h])switch(h){case"DigTime":case"SpaceMoveDuration":case"SnakeMoveDuration":f.add(r.default,h,0,10*r.default[h],50);break;case"SnekMinSecondsPerSquare":case"SnekCatchUpSecondsPerSquare":f.add(r.default,h,0,10*r.default[h],.1);break;case"SnekSquaresDistanceBeforeCatchUpSpeed":f.add(r.default,h,0,10*r.default[h],1);break;default:f.add(r.default,h,0,10*r.default[h],10*r.default[h]/20)}}(0,o.loadPreferences)(),s.SoundManager.init(),e.Flags.enable("use-webgl");var p=function(t){function o(){var a=t.call(this,{canvasElementId:"game",width:r.default.TileWidth*r.default.ChunkWidth,height:r.default.TileWidth*(r.default.ChunkWidth*r.default.InvAspectRatio),displayMode:e.DisplayMode.Fit,pointerScope:e.Input.PointerScope.Canvas})||this;return a.state=i.GlobalState.GetInstance(),a.trail=u.PlayerTrail.GetInstance(),a}return d(o,t),o.prototype.initialize=function(){for(var t=this,n=new e.Loader,r=0,i=Object.values(a.Resources);r<i.length;r++){var u=i[r];n.addResource(u)}this.start(n).then(function(){a.Resources.BackgroundMusic.play()}),this.state.newGameFun=this.NewGame.bind(this),this.state.newGameFun(),this.input.keyboard.on("press",function(a){a.key===e.Input.Keys.Semicolon&&t.toggleDebug()}),this.input.keyboard.on("press",function(a){t.state.RoundWon||t.state.GameOver&&a.key===e.Input.Keys.R&&t.state.newGameFun()}),this.input.pointers.primary.on("up",function(e){t.state.GameOver&&t.state.newGameFun()})},o.prototype.NewGame=function(){for(var t in this.scenes){for(var a=0,i=this.scenes[t].actors;a<i.length;a++){i[a].kill()}this.removeScene(t)}this.state.GameOver=!1,this.state.Round=1,this.state.RoundWon=!1,this.state.GameWon=!1;var u=5*r.default.TileWidth-r.default.TileWidth/2;this.trail.clear(),this.trail.enqueue(new e.Vector(1*r.default.TileWidth,u)),this.trail.enqueue(new e.Vector(2*r.default.TileWidth,u)),this.trail.enqueue(new e.Vector(3*r.default.TileWidth,u)),this.trail.enqueue(new e.Vector(4*r.default.TileWidth,u));var o=new n.Level;this.addScene("main",o),this.goToScene("main")},o}(e.Engine);exports.Game=p;var v=new p;exports.game=v,v.initialize();
},{"regenerator-runtime/runtime":"KA2S","excalibur":"A6Lr","dat.gui":"ArXC","./resources":"x5mp","./level":"pDJl","./config":"foLc","./globalState":"Z7BZ","./playerTrail":"RUzD","./preferences":"B9Wb","./sound-manager":"BceJ"}]},{},["B6dB"], null)
//# sourceMappingURL=/ludum-48/src.13463029.js.map